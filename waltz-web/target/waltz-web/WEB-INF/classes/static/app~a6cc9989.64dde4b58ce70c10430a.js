(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1000:function(t,e){t.exports='<div> <div class=row> <div class="col-md-3 text-center"> <waltz-pie data=$ctrl.pie.data selected-segment-key=$ctrl.selectedPieSegment.key config=$ctrl.pie.config> </waltz-pie> </div> <div class=col-md-9> <waltz-pie-segment-table data=$ctrl.pie.data selected-segment-key=$ctrl.selectedPieSegment.key config=$ctrl.pie.config headings=$ctrl.tableHeadings> </waltz-pie-segment-table> </div> </div> <div class=row style=padding-bottom:12px> <div class=col-md-12> <span class="small text-muted" ng-bind=$ctrl.definition.description> </span> </div> </div> <waltz-entity-statistic-detail-table statistic-values=$ctrl.values statistic-definition=$ctrl.definition filter-outcome=$ctrl.selectedPieSegment.key applications=$ctrl.applications org-units=$ctrl.orgUnits last-updated-at=$ctrl.lastUpdatedAt ng-if="$ctrl.values.length > 0"> </waltz-entity-statistic-detail-table> </div>'},1001:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=l(n(1)),a=n(19),o=n(114),r=l(n(1002));function l(t){return t&&t.__esModule?t:{default:t}}var s=100;function d(t){var e=this;e.$onChanges=function(){var t=e.summary?e.summary.tallies:[];e.pie=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{config:{colorProvider:function(t){return(0,a.variableScale)(t.data.key)},labelProvider:function(t){return t.key},size:s},data:i.default.chain(t).map(function(t){return{key:t.id,count:t.count}}).value()}}(t),e.tableHeadings=(0,o.mkSummaryTableHeadings)(e.definition)},e.goToStatistic=function(n){(0,o.navigateToStatistic)(t,n.id,e.parentRef)}}d.$inject=["$state"];var c={bindings:{definition:"<",parentRef:"<",subTitle:"@",summary:"<"},controller:d,template:r.default};e.default=c},1002:function(t,e){t.exports='<div class=waltz-entity-statistic-summary-card> <div ng-if="!($ctrl.pie.data | isEmpty)"> <div class=row> <div class="col-sm-offset-1 col-sm-5"> <h5> <span ng-bind=$ctrl.definition.name> </span> </h5> <div class=small> <span ng-bind="$ctrl.definition.category | toDisplayName:\'entityStatistic\'"> </span> </div> <a class="clickable small" title="Refocus on this statistic" ng-click=$ctrl.goToStatistic($ctrl.definition)> Explore &raquo; </a> </div> <div class="col-sm-6 text-center"> <waltz-pie data=$ctrl.pie.data config=$ctrl.pie.config> </waltz-pie> </div> </div> <div class=row> <div class=col-md-12> <waltz-pie-segment-table data=$ctrl.pie.data config=$ctrl.pie.config headings=$ctrl.tableHeadings> </waltz-pie-segment-table> </div> </div> </div> <div ng-if="$ctrl.pie.data | isEmpty"> <div class=row> <div class=col-sm-12> <waltz-no-data> <message> <strong>No data points</strong> available. <a class="clickable small" title="Refocus on this statistic" ng-if="! ($ctrl.definition.children | isEmpty)" ng-click=$ctrl.goToStatistic($ctrl.definition)> Explore &raquo; </a> </message> </waltz-no-data> </div> </div> </div> </div>'},1003:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=g(n(1)),a=g(n(4)),o=n(14),r=n(90),l=n(25),s=n(30),d=n(5),c=n(82),u=n(46);n(45);var p=n(0),f=n(19),m=g(n(1004));function g(t){return t&&t.__esModule?t:{default:t}}var v={};function y(t,e){t?t(e):console.log("No callback registed")}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2];if(!(0,p.isEmpty)(e)){var o=function(t){var e=t.domain(),n=(0,a.default)(e[0]),o=(0,a.default)(e[1]),r=o.diff(n,"days"),l=Math.ceil(r/16);if(r<2)return i.default.map(i.default.range(r+1),function(t){return n.add(t,"days").toDate().getTime()});for(var s=n.add(l,"days"),d=[];s.isBefore(o);)d.push(s.toDate().getTime()),s=s.add(2*l,"days");return d}(n),l=(0,u.timeFormat)("%d/%m"),s=(0,r.axisBottom)().tickValues(o).tickSize(6).scale(n).tickFormat(function(t){return l(new Date(t))});t.call(s)}}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2];h(t.xAxis,e,n.x),function(t,e){var n=(0,r.axisLeft)().ticks(5).scale(e);t.call(n)}(t.yAxis,n.y)}function b(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return console.log("weshc: no onHover provided")},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:400,e={left:60,right:20,top:20,bottom:30};return{width:t,height:200,margins:e,chart:{width:t-(e.left+e.right),height:200-(e.top+e.bottom)}}}(e),d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=[0,(0,o.max)(t,function(t){return t.count})],i=(0,o.extent)(t,function(t){return t.date}),a=[0,e.width-(e.margins.left+e.margins.right)],r=[e.height-(e.margins.top+e.margins.bottom),0];return{x:(0,s.scaleLinear)().domain(i).range(a),y:(0,s.scaleLinear)().domain(n).range(r)}}(n,r);!function(t,e){t.svg.attrs({width:e.width,height:e.height}),t.chart.attr("transform","translate("+e.margins.left+", "+e.margins.top+")"),t.xAxis.attr("transform","translate(0, "+(e.height-(e.margins.top+e.margins.bottom))+")")}(t,r),w(t,n,d),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],i=(0,c.line)().x(function(t){return n.x(t.date)}).y(function(t){return n.y(t.count)}).curve(c.curveLinear),a=(0,l.nest)().key(function(t){return t.series}).entries(e),o=t.selectAll(".line").data(a,function(t){return t.key}),r=o.enter().append("path").classed("line",!0).attrs({stroke:function(t){return(0,f.variableScale)(t.key)},"stroke-width":1,fill:"none",opacity:.7});o.exit().remove(),o.merge(r).attr("d",function(t){return i(t.values)})}(t.chart,n,d),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],i=t.selectAll(".point").data(e,function(t){return t.date+"_"+t.series}),a=i.enter().append("circle").classed("point",!0).attrs({fill:function(t){return(0,f.variableScale)(t.series)},opacity:.7,r:0});i.exit().remove(),i.merge(a).attr("cx",function(t){return n.x(t.date)}).attr("cy",function(t){return n.y(t.count)}).attr("r",3)}(t.chart,n,d),function(t,e,n,a){var o=i.default.uniqBy(i.default.map(e,"date"),function(t){return t+""}).length,r=n.x.range()[1]/o,l=i.default.chain(e).map("date").uniqBy(function(t){return t.getTime()}).value(),s=t.selectAll("rect.band").data(l,function(t){return t.getTime()}),d=s.enter().append("rect").classed("band",!0).attr("pointer-events","all").style("visibility","hidden").on("mouseenter.band-hover",function(t){y(a,t)}).on("mouseleave.band-hover",function(){y(a,null)});s.merge(d).attrs({x:function(t){return n.x(t)-r/2},y:-15,width:r,height:n.y.range()[0]+30})}(t.chart,n,d,a)}function z(t,e){var n=(0,p.initialiseData)(this,v),a=(0,d.select)(t.find("svg")[0]),o=function(t){var e=t.append("g");return{svg:t,chart:e,xAxis:e.append("g").classed("weshc-axis",!0),yAxis:e.append("g").classed("weshc-axis",!0)}}(a),r=i.default.debounce(function(){var e=t.parent()[0].clientWidth;b(o,e,n.points,n.onHover)},100);n.$onChanges=function(t){t.highlightedDate?a.selectAll(".point").attr("r",function(t){return function(t){return n.highlightedDate&&t.date.getTime()===n.highlightedDate.getTime()}(t)?6:3}):r()},n.$onInit=function(){return angular.element(e).on("resize",r)},n.$onDestroy=function(){return angular.element(e).off("resize",r)}}z.$inject=["$element","$window"];var E={bindings:{points:"<",onHover:"<",highlightedDate:"<"},template:m.default,controller:z};e.default=E},1004:function(t,e){t.exports="<div class=waltz-entity-statistic-history-chart width=100%> <svg> </svg> </div> "},1005:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(n(1)),a=n(46),o=n(19),r=n(0),l=s(n(1006));function s(t){return t&&t.__esModule?t:{default:t}}var d={duration:"MONTH"},c=(0,a.timeFormat)("%a %d %b %Y");function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return i.default.reduce(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return i.default.chain(t).flatMap("tallies").map("id").uniq().value()}(t),function(t,e){return t[e]={color:(0,o.variableScale)(e).toString()},t},{})}function p(t,e){var n=(0,r.initialiseData)(this,d),a=function(t){n.highlightedDate=t;var e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];if(!e)return null;var n=e.getTime();return i.default.find(t,function(t){return n===new Date(t.lastUpdatedAt).getTime()})}(n.history,t);e&&(n.selected=e,n.selected.dateString=c(t),n.total=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tallies:[]};return i.default.sumBy(t.tallies,"count")}(e))};n.onHover=function(e){return t.$applyAsync(function(){return a(e)})},n.$onChanges=function(){n.selected=null,n.points=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return i.default.chain(t).flatMap(function(t){return i.default.map(t.tallies,function(e){return{series:e.id,count:e.count,date:new Date(t.lastUpdatedAt)}})}).orderBy(function(t){return t.date}).value()}(n.history),n.styles=u(n.history),n.statColumnName=function(t,e){return e?t.lookup("rollupKind",e.rollupKind):"Value"}(e,n.definition)}}p.$inject=["$scope","DisplayNameService"];var f={bindings:{history:"<",definition:"<",duration:"<",onChangeDuration:"<"},template:l.default,controller:p};e.default=f},1006:function(t,e){t.exports='<div class=row> <div class=col-sm-7 style=padding:6px> <waltz-entity-statistic-history-chart on-hover=$ctrl.onHover highlighted-date=$ctrl.highlightedDate points=$ctrl.points> </waltz-entity-statistic-history-chart> <div style=text-align:center> Period: <waltz-duration-selector duration=$ctrl.duration on-change=$ctrl.onChangeDuration> </waltz-duration-selector> </div> </div> <div class=col-sm-5> <div ng-if=$ctrl.selected> <h5 ng-bind=$ctrl.selected.dateString></h5> <table class="table table-condensed small"> <thead> <tr> <th></th> <th>Outcome</th> <th ng-bind=$ctrl.statColumnName></th> </tr> </thead> <tbody> <tr ng-repeat="row in $ctrl.selected.tallies | orderBy:\'id\'"> <td> <waltz-icon name=square ng-style=$ctrl.styles[row.id]> </waltz-icon> </td> <td> <span ng-bind=row.id></span> </td> <td> <span ng-bind=row.count></span> </td> </tr> </tbody> <tbody> <tr> <td></td> <td> Total </td> <td> <span ng-bind=$ctrl.total></span> </td> </tr> </tbody> </table> </div> <div ng-if=!$ctrl.selected style=padding-top:30px> <span class="text-muted small"> Hover over the graph to see more detail. </span> </div> </div> </div>'},1007:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),a=function(t){return t&&t.__esModule?t:{default:t}}(n(1008));var o={expandedNodes:[],currentNode:null};function r(){var t=Object.assign(this,o);t.$onChanges=function(){t.definitionTree=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,i.buildHierarchies)(t,!1)}(t.definitions),t.currentNode=(0,i.findNode)(t.definitionTree,t.currentDefinitionId),t.expandedNodes=function(t,e){for(var n=[],a=e;a&&a.parent;)a=(0,i.findNode)(t,a.parent),n.push(a);return n}(t.definitionTree,t.currentNode)},t.treeOptions={nodeChildren:"children",dirSelectable:!0,equality:function(t,e){return t&&e&&t.id===e.id}},t.handleSelection=function(e){e.id!==t.currentDefinitionId&&(t.currentDefinitionId=e.id,t.onSelection(e))}}r.$inject=[];var l={bindings:{definitions:"<",onSelection:"<",currentDefinitionId:"<"},template:a.default,controller:r};e.default=l},1008:function(t,e){t.exports="<div> <treecontrol class=tree-light order-by=\"'-name'\" tree-model=$ctrl.definitionTree selected-node=$ctrl.currentNode expanded-nodes=$ctrl.expandedNodes on-selection=$ctrl.handleSelection(node)> <span ng-bind=node.name></span> </treecontrol> </div>"},1009:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(1)),a=o(n(1010));function o(t){return t&&t.__esModule?t:{default:t}}function r(){var t=this;t.$onChanges=function(e){t.summaries&&(t.summariesByDefinitionId=i.default.keyBy(t.summaries,"entityReference.id"))}}r.$inject=[];var l={template:a.default,controller:r,bindings:{parentRef:"<",definitions:"<",summaries:"<"}};e.default=l},1010:function(t,e){t.exports='<div class=row> <div class="col-sm-6 waltz-stat-summary" ng-repeat="child in $ctrl.definitions.children"> <div style="padding:8px;border-radius:3px;border:1px solid #eee;background-color:#fcfcfc"> <waltz-entity-statistic-summary-card summary=$ctrl.summariesByDefinitionId[child.id] definition=child parent-ref=$ctrl.parentRef sub-title=Child> </waltz-entity-statistic-summary-card> </div> <br> </div> </div>'},1011:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(n(6)),a=n(7),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(226)),r=s(n(1012)),l=s(n(1014));function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module("waltz.entity.svg-diagram",[]);return(0,a.registerStores)(t,[o]),(0,a.registerComponents)(t,[r.default,l.default]),t.name}},1012:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(2),o=function(t){return t&&t.__esModule?t:{default:t}}(n(1013));var r={diagrams:[],visibility:{}};function l(t){var e=(0,i.initialiseData)(this,r);e.$onInit=function(){t.loadViewData(a.CORE_API.EntitySvgDiagramStore.findByEntityReference,[e.parentEntityRef]).then(function(t){e.diagrams=t.data,e.visibility.tab=e.diagrams.length>0?e.diagrams[0].id:null})}}l.$inject=["ServiceBroker"];var s={template:o.default,bindings:{parentEntityRef:"<"},controller:l};e.default={component:s,id:"waltzEntitySvgDiagramsPanel"}},1013:function(t,e){t.exports=' <div ng-if="$ctrl.diagrams.length === 0"> <waltz-no-data> <message> <div> No <strong>diagrams</strong> associated with this item </div> </message> </waltz-no-data> </div> <div ng-if="$ctrl.diagrams.length > 0"> <div class=row> <div class=col-sm-12> <div class=waltz-tabs ng-if="$ctrl.diagrams.length > 1"> <input type=radio ng-repeat-start="diagram in $ctrl.diagrams track by diagram.id" ng-model=$ctrl.visibility.tab ng-value=diagram.id name="{{ $parent.$id }}" id="{{ diagram.id + \'_\' + $id }}"> <label for="{{ diagram.id + \'_\' + $id }}" ng-repeat-end> <span ng-bind="diagram.name || \'Diagram\'"> </span> </label> <div ng-repeat="diagram in $ctrl.diagrams track by diagram.id" ng-class="{ \'wt-active\': diagram.id == $ctrl.visibility.tab }" class=wt-tab> <waltz-entity-svg-diagram-viewer svg=diagram.svg> </waltz-entity-svg-diagram-viewer> <waltz-markdown text=diagram.description> </waltz-markdown> </div> </div> <div ng-if="$ctrl.diagrams.length == 1"> <waltz-entity-svg-diagram-viewer svg=$ctrl.diagrams[0].svg> </waltz-entity-svg-diagram-viewer> <waltz-markdown text=$ctrl.diagrams[0].description> </waltz-markdown> </div> </div> </div> </div>'},1014:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(74),o=n(12),r=n(5),l=n(118),s=function(t){return t&&t.__esModule?t:{default:t}}(n(1015));var d={panZoomEnabled:!1,popup:{style:{position:"absolute",background:"white",display:"none"},text:""}};function c(t,e,n){var s=(0,i.initialiseData)(this,d);s.$onInit=function(){var i=t.find("div")[0];i.innerHTML=s.svg;var d=1,c=[0,0],u=function(){return f.attr("transform","scale("+d+") translate("+c+")")},p=(0,r.select)(i).select("svg"),f=p.select("g"),m=(0,l.zoom)().on("zoom",function(){var t=r.event.transform;t&&(d=t.k,c[0]=t.x,c[1]=t.y,u())});f.selectAll("[data-wesd-node-entity-link]").on("click",function(){var t=(0,r.select)(this).attr("data-wesd-node-entity-link"),n=(0,o.stringToRef)(t),i=(0,a.kindToViewState)(n.kind);e.go(i,{id:n.id})}),f.selectAll("[data-wesd-node-description]").on("mouseenter",function(){var t=(0,r.select)(this).attr("data-wesd-node-description"),e=0,a=0;(0,r.select)(this).each(function(t,n,o){var r=o[0].getBoundingClientRect(),l=i.getBoundingClientRect();e=r.top-l.top,a=r.left-l.left+(r.left>700?-250:100)}),n(function(){s.popup.style.display="inline-block",s.popup.style.left=a+"px",s.popup.style.top=e+"px",s.popup.text=t})}).on("mouseleave",function(){(0,r.select)(this).attr("data-wesd-node-description"),n(function(){s.popup.style.display="none",s.popup.text=""})}),s.zoom=function(t){d+=t,u()},s.panX=function(t){c[0]+=t,u()},s.panY=function(t){c[1]+=t,u()},s.togglePanZoom=function(){s.panZoomEnabled=!s.panZoomEnabled,s.panZoomEnabled?p.call(m).on("dblclick.zoom",null):p.on(".zoom",null)}}}c.$inject=["$element","$state","$timeout"];var u={template:s.default,bindings:{svg:"<"},controller:c};e.default={component:u,id:"waltzEntitySvgDiagramViewer"}},1015:function(t,e){t.exports='<div class=wesd-viewer> </div> <div style=margin-bottom:10px class=waltz-visibility-parent> <div class=waltz-visibility-child-50> <span class="wesd-pan-button btn btn-sm btn-success" ng-if=$ctrl.panZoomEnabled ng-click=$ctrl.togglePanZoom()> Disable Pan and Zoom via mouse </span> <span class="wesd-pan-button btn btn-sm btn-default" ng-if="! $ctrl.panZoomEnabled" ui-popover="Use mouse to drag and the wheel to zoom" ng-click=$ctrl.togglePanZoom()> Enable Pan and Zoom via mouse </span> <span class="wesd-pan-button btn btn-sm btn-default" ng-click=$ctrl.zoom(-0.1)> <waltz-icon name=minus></waltz-icon> </span> <span class="wesd-pan-button btn btn-sm btn-default" ng-click=$ctrl.zoom(0.1)> <waltz-icon name=plus></waltz-icon> </span> <span class="wesd-pan-button btn btn-sm btn-default" ng-click=$ctrl.panX(-50)> <waltz-icon name=chevron-left></waltz-icon> </span> <span class="wesd-pan-button btn btn-sm btn-default" ng-click=$ctrl.panY(50)> <waltz-icon name=chevron-up></waltz-icon> </span> <span class="wesd-pan-button btn btn-sm btn-default" ng-click=$ctrl.panY(-50)> <waltz-icon name=chevron-down></waltz-icon> </span> <span class="wesd-pan-button btn btn-sm btn-default" ng-click=$ctrl.panX(50)> <waltz-icon name=chevron-right></waltz-icon> </span> </div> </div> <div ng-style=$ctrl.popup.style class=wesd-popup> <waltz-markdown text=$ctrl.popup.text></waltz-markdown> </div>'},1016:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(224)),o=function(t){return t&&t.__esModule?t:{default:t}}(n(1017));e.default=function(){var t=angular.module("waltz.entity-tags",[]);return t.config(o.default),(0,i.registerStores)(t,[a]),t.name}},1017:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={url:"tags"},a={url:"/explorer/:tag",views:{"content@":function(t){return t&&t.__esModule?t:{default:t}}(n(1018)).default}};function o(t){t.state("main.entity-tag",i).state("main.entity-tag.explorer",a)}o.$inject=["$stateProvider"],e.default=o},1018:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1)),a=n(25),o=r(n(1019));function r(t){return t&&t.__esModule?t:{default:t}}function l(t,e){var n=this;n.tagSets=[];var o=function(t){e.findByTag(t).then(function(e){var i={tag:t,refs:e,refsByKind:(0,a.nest)().key(function(t){return t.kind}).entries(e)};n.tagSets.push(i)})};e.findAllTags().then(function(t){n.tags=t}),n.addTagSet=o,n.removeTagSet=function(t){n.tagSets=i.default.reject(n.tagSets,function(e){return e===t})},o(t.tag)}l.$inject=["$stateParams","EntityTagStore"],e.default={template:o.default,controller:l,controllerAs:"ctrl",bindToController:!0,scope:{}}},1019:function(t,e){t.exports='<div> <waltz-page-header name="Tag Explorer" icon=tags> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>Tag Explorer</li> </ol> </waltz-page-header> <div class=row> <div class=col-md-8> <waltz-section name="{{ tagSet.tag }}" small="( {{tagSet.refs.length }} )" icon=tag ng-repeat="tagSet in ctrl.tagSets"> <waltz-section-actions> <button class="btn btn-default btn-xs" ng-click=ctrl.removeTagSet(tagSet)> Close </button> </waltz-section-actions> <ul> <li ng-repeat="refGroup in tagSet.refsByKind"> <h4 ng-bind="refGroup.key | toDisplayName:\'entity\'"></h4> <ul> <li ng-repeat="ref in refGroup.values"> <waltz-entity-link entity-ref=ref></waltz-entity-link> </li> </ul> </li> </ul> </waltz-section> </div> <div class=col-md-4> <waltz-section name="All Tags"> <input class=form-control type=search placeholder=Search.... ng-model=tagQuery> <br> <ul class=waltz-keyword-list> <li ng-repeat="tag in ctrl.tags | filter:tagQuery" ng-bind=tag class=clickable ng-click=ctrl.addTagSet(tag)> </li> </ul> </waltz-section> </div> </div> </div> '},1020:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(n(6)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(225)),o=s(n(1021)),r=n(7),l=s(n(1022));function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module("waltz.enum-value",[]);return t.service("EnumValueService",o.default),(0,r.registerStores)(t,[a]),(0,r.registerComponents)(t,[l.default]),t.name}},1021:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(29),a=n(25),o=null;function r(t){var e=function(){return(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||null==o)&&(o=t.findAll().then(function(t){var e=(0,a.nest)().key(function(t){return t.type}).key(function(t){return t.key}).rollup(function(t){return t[0]}).object(t);return Object.assign({},i.enums,e)})),o};return e(),{loadEnums:e}}r.$inject=["EnumValueStore"],e.default=r},1022:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(n(1023));var o={showIcon:!0,showPopover:!0};function r(t,e,n){var a=(0,i.initialiseData)(this,o),r=function(){a.name=t.lookup(a.type,a.key)||a.key,a.description=e.lookup(a.type,a.key),a.icon=n.lookup(a.type,a.key)};a.$onInit=function(){return r()},a.$onChanges=function(){return r()}}r.$inject=["DisplayNameService","DescriptionService","IconNameService"];var l={template:a.default,bindings:{type:"<",key:"<",showIcon:"<?",showPopover:"<?"},controller:r};e.default={component:l,id:"waltzEnumValue"}},1023:function(t,e){t.exports='<span class=waltz-enum-value> <waltz-icon name="{{ $ctrl.icon }}" ng-if=$ctrl.showIcon> </waltz-icon> <span ng-if=$ctrl.showPopover ng-bind=$ctrl.name uib-popover="{{ $ctrl.description }}" popover-append-to-body=true popover-trigger=mouseenter> </span> <span ng-if=!$ctrl.showPopover ng-bind=$ctrl.name> </span> </span>'},1024:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=k(n(6)),a=k(n(1025)),o=k(n(1026)),r=k(n(1027)),l=k(n(1028)),s=k(n(1029)),d=k(n(1030)),c=k(n(1031)),u=k(n(1032)),p=k(n(1033)),f=k(n(1034)),m=k(n(1035)),g=k(n(1036)),v=k(n(1037)),y=k(n(1038)),h=k(n(1039)),w=k(n(1040)),b=k(n(1041)),z=k(n(1042)),E=k(n(1043)),S=k(n(1044));function k(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module("waltz.examples",[]);return t.config(["$stateProvider",function(t){t.state("main.examples",{url:"examples",views:{"docs-content@":{template:a.default},"docs-sidebar@":{template:o.default}}}).state("main.examples.directive-app-selector",{url:"/directive-app-selector",views:{"content@":{template:r.default}}}).state("main.examples.directive-yq-selector",{url:"/directive-yq-selector",views:{"content@":{template:l.default,controller:function(){var t=this;this.onSelect=function(e){t.selected=e}},bindToController:!0,controllerAs:"ctrl"}}}).state("main.examples.directive-bookmark-kind-select",{url:"/directive-bookmark-kind-select",views:{"content@":{template:s.default,controller:function(){var t=this;this.onSelect=function(e){t.value=e}},bindToController:!0,controllerAs:"ctrl"}}}).state("main.examples.directive-change-timeline",{url:"/directive-change-timeline",views:{"content@":{template:d.default,controller:function(){var t=this;this.changes=[{year:2016,quarter:3,size:1},{year:2016,quarter:4,size:2},{year:2018,quarter:1,size:4},{year:2018,quarter:2,size:3}],this.selected={year:2016,quarter:3},this.onSelect=function(e){t.selected=e}},controllerAs:"ctrl",bindToController:!0}}}).state("main.examples.directive-app-overview",{url:"/directive-app-overview",views:{"content@":{template:c.default,controller:["$scope",function(t){t.app={name:"example app",description:"blah",aliases:["aka"],kind:"IN_HOUSE",lifecyclePhase:"PRODUCTION"}}]}}}).state("main.examples.directive-keyword-list",{url:"/directive-keyword-list",views:{"content@":{template:u.default,controller:["$scope",function(t){t.clicked=function(e){t.selected=e}}]}}}).state("main.examples.endpoint-application",{url:"/endpoint-application",views:{"content@":{template:p.default}}}).state("main.examples.endpoint-data-flows",{url:"/data-flows",views:{"content@":{template:f.default}}}).state("main.examples.endpoint-data-types",{url:"/data-types",views:{"content@":{template:m.default}}}).state("main.examples.endpoint-person",{url:"/person",views:{"content@":{template:g.default}}}).state("main.examples.endpoint-server-information",{url:"/server-information",views:{"content@":{template:v.default}}}).state("main.examples.endpoint-capability",{url:"/capability",views:{"content@":{template:y.default}}}).state("main.examples.endpoint-app-capability",{url:"/app-capability",views:{"content@":{template:h.default}}}).state("main.examples.endpoint-organisational-unit",{url:"/organisational-unit",views:{"content@":{template:w.default}}}).state("main.examples.endpoint-involvement",{url:"/involvement",views:{"content@":{template:b.default}}}).state("main.examples.waltz-roadmap",{url:"/waltz-roadmap",views:{"content@":{template:z.default}}}).state("main.examples.waltz-engagement",{url:"/waltz-engagement",views:{"content@":{template:E.default}}}).state("main.examples.waltz-prerequisites",{url:"/waltz-prerequisites",views:{"content@":{template:S.default}}})}]),t.name}},1025:function(t,e){t.exports="<div> <waltz-page-header name=Examples></waltz-page-header> <blockquote> This section of the site demonstrates usage of the various reusable directives/filters etc. <br/> Pick an example from the left hand side </blockquote> </div> "},1026:function(t,e){t.exports='<div> <style>.example-active{font-weight:bolder}</style> <h3>Contents <a ui-sref=main.examples> <waltz-icon name=home></waltz-icon> </a> </h3> <br/> <uib-accordion close-others=true> <uib-accordion-group heading=Waltz> <ul class=list-unstyled> <li ui-sref-active=example-active> <a ui-sref=main.examples.waltz-engagement>Engagement Model</a> </li> <li ui-sref-active=example-active> <a ui-sref=main.examples.waltz-roadmap>Product Roadmap</a> </li> <li ui-sref-active=example-active> <a ui-sref=main.examples.waltz-prerequisites>h/w, s/w Prerequisites</a> </li> </ul> </uib-accordion-group> <uib-accordion-group heading=Directives> <ul class=list-unstyled> <li ui-sref-active=example-active> <a ui-sref=main.examples.directive-app-overview>App Overview</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.directive-app-selector>App Selector</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.directive-bookmark-kind-select>Bookmark Kind Select</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.directive-change-timeline>Change Timeline</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.directive-logical-flow-table>Logical Flow Table</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.directive-keyword-list>Keyword List</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.directive-rating-brush-select>Rating Brush Select</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.directive-rating-group>Rating Group</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.directive-rating-indicator>Rating Indicator</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.directive-yq-selector>Year/Quarter Select</a> </li><li> </li></ul> </uib-accordion-group> <uib-accordion-group heading="Entities & Endpoints"> <ul class=list-unstyled> <li ui-sref-active=example-active> <a ui-sref=main.examples.endpoint-application>Application</a> </li> <li ui-sref-active=example-active> <a ui-sref=main.examples.endpoint-app-capability>Application Capability</a> </li> <li>Bookmarks</li> <li ui-sref-active=example-active> <a ui-sref=main.examples.endpoint-capability>Capability</a> </li> <li>Change Log</li> <li ui-sref-active=example-active> <a ui-sref=main.examples.endpoint-data-flows>Data Flow</a> </li><li> </li><li ui-sref-active=example-active> <a ui-sref=main.examples.endpoint-data-types>Data Types</a> </li> <li ui-sref-active=example-active> <a ui-sref=main.examples.endpoint-involvement>Involvement</a> </li> <li ui-sref-active=example-active> <a ui-sref=main.examples.endpoint-organisational-unit>Organisational Unit</a> </li> <li ui-sref-active=example-active> <a ui-sref=main.examples.endpoint-person>Person</a> </li> <li ui-sref-active=example-active> <a ui-sref=main.examples.endpoint-server-information>Server Information</a> </li> </ul> </uib-accordion-group> <uib-accordion-group heading=Filters> <ul class=list-unstyled> <li ui-sref-active=example-active> toDescription </li> <li ui-sref-active=example-active> toDisplayName </li> <li ui-sref-active=example-active> toIconName </li> </ul> </uib-accordion-group> </uib-accordion> </div> '},1027:function(t,e){t.exports='<div ng-init="selected = {}"> <waltz-page-header name="App Selector"> </waltz-page-header> <blockquote> The <q>waltz-app-selector</q> directive is backed by a full text index (accessible via <code>/api/app/search/{query}</code>). Supply the directive with a model object and the directive will set a <code>app</code> property on it with the chosen selection. </blockquote> <waltz-section name=Demo> <waltz-app-selector model=selected></waltz-app-selector> <hr/> <waltz-app-overview-section ng-if=selected.app app=selected.app></waltz-app-overview-section> </waltz-section> <waltz-section name="Example Code"> <pre>\n            &lt;waltz-app-selector model="selected">&lt;/waltz-app-selector>\n\n            &lt;hr/>\n\n            &lt;waltz-app-overview-section ng-if="selected.app"\n                                        app="selected.app">&lt;/waltz-app-overview-section>\n\n        </pre> </waltz-section> </div> '},1028:function(t,e){t.exports='<div> <waltz-page-header name="Year / Quarter Selector" small=waltz-yq-select> </waltz-page-header> <blockquote> The <q>waltz-yq-select</q> directive provides a simple control to allow a user to select a specific year/quarter. </blockquote> <waltz-section name=Demo> <waltz-yq-select style=font-size:small start="{year: 2015, quarter: 3}" end="{year: 2025, quarter: 1}" selected=ctrl.selected on-select=ctrl.onSelect></waltz-yq-select> </waltz-section> <waltz-section name="Example Code"> <pre>\n&ltwaltz-yq-select start="{year: 2015, quarter: 3}"\n                 end="{year: 2025, quarter: 1}"\n                 selected="ctrl.selectedYQ"\n                 on-select="ctrl.onSelect">&lt;/waltz-yq-select>\n        </pre> The control is does not alter the given selected yr/quarter, instead it calls back on the given <code>on-select</code> function. This should update the <code>selected</code> variable (or reject etc). <br> <h4>Default Parameters</h4> <ul> <li><strong>start</strong> - <code>{ year: currentYear, quarter: 1 }</code> </li> <li><strong>end</strong> - <code>{ year: start.year + 5, quarter: 4 }</code> </li> </ul> </waltz-section> </div> '},1029:function(t,e){t.exports='<div> <waltz-page-header name="Bookmark Kind Select" small=waltz-bookmark-kind-select> </waltz-page-header> <blockquote> Simple dropdown with bookmark kind choices. </blockquote> <waltz-section name=Demo small={{ctrl.value}}> <waltz-bookmark-kind-select value={{ctrl.value}} on-select=ctrl.onSelect> </waltz-bookmark-kind-select> </waltz-section> <waltz-section name="Example Code"> <pre>\n&lt;waltz-bookmark-kind-select value="{ {ctrl.value} }"\n                            on-select="ctrl.onKindSelect">\n&lt;/waltz-bookmark-kind-select>\n</pre> The control is does not alter the given value, instead it calls back on the given <code>on-select</code> function. This should update the <code>value</code> variable (or reject etc). The callback is provided with two arguments, the first is the code, the second is the full description (in case you want display name/icon etc.) </waltz-section> </div> '},1030:function(t,e){t.exports='<div> <waltz-page-header name="Change Timeline" small=waltz-change-timeline> </waltz-page-header> <blockquote> The <code>waltz-change-timeline</code> directive shows a graph representing future changes categorized by year/quarter. Clicking on a bar will implicitly select all periods before it. </blockquote> <waltz-section name=Demo> <waltz-change-timeline selected=ctrl.selected on-select=ctrl.onSelect start="{ year: 2015 }" end="{ year: 2021 }" changes=ctrl.changes> </waltz-change-timeline> <button class="btn btn-sm btn-danger" ng-click="ctrl.selected = null">Clear selection</button> </waltz-section>  <waltz-section name="Example Code"> <pre>\n &lt;waltz-change-timeline selected="ctrl.selected"\n                        on-select="ctrl.onSelect"\n                        start="{ year: 2015 }"\n                        end="{ year: 2021 }"\n                        changes="ctrl.changes">\n &lt;/waltz-change-timeline>\n        </pre> <pre>\nthis.changes = [\n    { year: 2016, quarter: 3, size: 1 },\n    { year: 2016, quarter: 4, size: 2 },\n    { year: 2018, quarter: 1, size: 4 },\n    { year: 2018, quarter: 2, size: 3 }\n]\nthis.selected = { year: 2016, quarter: 3 };\n\nthis.onSelect = (d) => {\n    this.selected = d;\n};\n</pre> The control is does not alter the given selected yr/quarter, instead it calls back on the given <code>on-select</code> function. This should update the <code>selected</code> variable (or reject etc). <br> <h4>Default Parameters</h4> <ul> <li><strong>start</strong> - <code>{ year: currentYear }</code> </li> <li><strong>end</strong> - <code>{ year: start.year + 6 }</code> </li> </ul> </waltz-section> </div> '},1031:function(t,e){t.exports=' <div> <waltz-page-header name="App Overview"> </waltz-page-header> <blockquote> The <q>waltz-app-overview</q> displays a summary of an application record. </blockquote> <waltz-section name=Demo> <waltz-app-overview-section app=app></waltz-app-overview-section> </waltz-section> <waltz-section name="Example Code"> <pre>\n            &lt;waltz-app-overview-section app="app">&lt;/waltz-app-overview-section>\n\n        </pre> </waltz-section> </div> '},1032:function(t,e){t.exports=" <div> <waltz-page-header name=\"Keyword List\" small=waltz-keyword-list> </waltz-page-header> <blockquote> Displays keywords and optionally can be given an click handler </blockquote> <waltz-section name=Demo> <waltz-keyword-list keywords=\"['z', 'b', 'c']\" on-select=clicked(keyword)> </waltz-keyword-list> <span>Selected: {{ selected }} </span> </waltz-section> <waltz-section name=\"Example Code\"> <h4>Markup</h4> <pre>\n&lt;waltz-keyword-list keywords=\"['z', 'b', 'c']\"\n                    on-select=\"clicked(keyword)\">\n&lt;/waltz-keyword-list>\n        </pre> <h4>Script</h4> <pre>\n $scope.clicked = function(keyword) {\n        $scope.selected = keyword;\n };\n        </pre> The <code>on-select</code> callback (&) is optional. If not specified the cursor will not turn into a pointer when hovering over keywords. <hr> <strong>Important</strong> The parameter in the markup callback must be labelled <code>keyword</code> </waltz-section> </div> "},1033:function(t,e){t.exports='<div> <waltz-page-header name=Application small="Endpoint & Entity"> </waltz-page-header> <waltz-section name="Application Entity"> <table class="table table-condensed table-hover"> <thead> <tr> <th>Attribute</th> <th>Description</th> <th>Type</th> <th>Default</th> <th>Restrictions</th> </tr> </thead> <tr> <td> name </td> <td> Primary name of the application, will be used when a reference to the application is shown</td> <td> String </td> <td> - </td> <td> Uniqueness </td> </tr> <tr> <td> id </td> <td> Generated id for the application </td> <td> Long </td> <td> <span class=text-muted>auto assigned</span> </td> <td> PK </td> </tr> <tr> <td> description </td> <td> Description for the application </td> <td> String </td> <td> - </td> <td> - </td> </tr> <tr> <td> asset_code </td> <td> An identifier used within your enterprise to identify the application </td> <td> String </td> <td> - </td> <td> - </td> </tr> <tr> <td> aliases </td> <td> A collection of zero or more aliases for this application, primarily used when searching </td> <td> String[] </td> <td> [] </td> <td> - </td> </tr> <tr> <td> kind </td> <td> Type of the application </td> <td> Enumeration (see below) </td> <td> IN_HOUSE </td> <td> Required </td> </tr> <tr> <td> lifecycle_phase </td> <td> Current point in the applications lifecycle. Used for quick filtering. </td> <td> Enumeration (see below) </td> <td> PRODUCTION </td> <td> Required </td> </tr> <tr> <td> organisational_unit_id </td> <td> Applications are ultimately owned by a single organisational unit, this is often used to determine which rule-sets to apply to an application </td> <td> Long </td> <td> - </td> <td> Required, FK to Organisational Unit </td> </tr> <tr> <td> tags </td> <td> A collection of zero or more tags for this application, primarily used for classifying applications </td> <td> String[] </td> <td> [] </td> <td> - </td> </tr> </table> </waltz-section> <waltz-section name="Enumerated Values"> <h4>Application Kind</h4> <table class="table table-condensed"> <thead> <tr> <th>Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>IN_HOUSE</td> <td>Internally developed applications</td> </tr> <tr> <td>INTERNALLY_HOSTED</td> <td>Third party application hosted within the enterprise (e.g. AutoSys)</td> </tr> <tr> <td>EXTERNALLY_HOSTED</td> <td>Application hosted outside of the enterpries (e.g. SalesForce)</td> </tr> <tr> <td>EUC</td> <td>End User Computing (e.g. custom spreadsheets)</td> </tr> <tr> <td>THIRD_PARTY</td> <td>Third party applications</td> </tr> <tr> <td>CUSTOMISED</td> <td>Customised applications, typically a 3rd party offering that has been tailored to the organisation</td> </tr> </tbody> </table> <hr> <h4>Lifecycle Phase</h4> <table class="table table-condensed"> <thead> <tr> <th>Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>PRODUCTION</td> <td>Application is currently used in production</td> </tr> <tr> <td>DEVELOPMENT</td> <td>Application is under active development</td> </tr> <tr> <td>CONCEPTUAL</td> <td>Conceptual applications can be used as placeholders to show future state enterprise configurations</td> </tr> <tr> <td>RETIRED</td> <td>Application is no longer running in production, nor is actively being developed</td> </tr> </tbody> </table> </waltz-section> <waltz-section name="Example JSON Representation"> <pre>\n{\n  "assetCode": "WLTZ-01",\n  "aliases": [\n    "Rumba",\n    "Tango"\n  ],\n  "organisationalUnitId": 190,\n  "kind": "INTERNALLY_HOSTED",\n  "lifecyclePhase": "PRODUCTION",\n  "id": 1,\n  "name": "Waltz",\n  "description": "An architecture tool!",\n  "tags": [\n    "classifier01"\n  ],\n}\n        </pre> </waltz-section> <waltz-section name="Primary Endpoints"> <table class="table table-condensed"> <thead> <tr> <th>URL</th> <th>Return</th> <th>Description</th> </tr> </thead> <tr> <td><code>api/application/id/(id:long)</code></td> <td>Single application record</td> <td>Returns the application associated to the given id</td> </tr> <tr> <td><code>api/application/search/(query:string)</code></td> <td>List of application records</td> <td>Returns applications which match the given <code>query</code></td> </tr> <tr> <td><code>api/application/org-unit/(org-unit-id:long)</code></td> <td>List of application records</td> <td>Returns applications belonging to the given organisational unit</td> </tr> <tr> <td><code>api/application/org-unit-tree/(org-unit-id:long)</code></td> <td>List of application records</td> <td>Returns applications belonging to the given organisational unit or any of its sub org-units</td> </tr> </table> </waltz-section> </div> '},1034:function(t,e){t.exports='<div> <waltz-page-header name=DataFlows small=Endpoint> </waltz-page-header> <blockquote> The data flow endpoint provides CRUD facilities over the data flows registered between entities. </blockquote> <waltz-section name="Get By Entity Reference"> <p>Retrieves information about data flows for the given entity.</p> <strong>Request </strong> <ul> <li><code>/api/data-flows/entity/{kind}/{id}</code></li> <li><code>GET /api/data-flows/entity/APPLICATION/2</code></li> </ul> <strong>Returns</strong> <p>A json array, each element describing a single logical data flow</p> <pre>\n[\n    {\n        "source": {"kind": "APPLICATION", "id": 1},\n        "target": {"kind": "APPLICATION", "id": 2},\n        "dataTypes": ["TRADE", "PRICE"],\n        "id": 2\n    }, ...\n]\n        </pre> </waltz-section> </div> '},1035:function(t,e){t.exports='<div> <waltz-page-header name=DataFlows small=Endpoint> </waltz-page-header> <blockquote> The data types endpoint provides a simple list of available data-types for use in flows. </blockquote> <waltz-section name="Get All"> <p>Retrieves information about data flows for the given entity.</p> <hr/> <strong>Request </strong> <ul> <li><code>GET /api/data-types</code></li> </ul> <hr/> <strong>Returns</strong> <p>A json array, each element describing a single data type</p> <pre>\n[\n    {\n        "name": "Trade Data",\n        "description": "Information about trades",\n        "code": "TRADE"\n    }, ...\n]</pre> <hr/> <strong>Client Usage</strong> <p> These types are automatically registered with the <code>toDisplayName</code> and <code>toDescription</code> filters when the client is initialised. </p> </waltz-section> </div> '},1036:function(t,e){t.exports='<div> <waltz-page-header name=Person small="Endpoint & Entity"> </waltz-page-header> <waltz-section name="Person Entity"> <table class="table table-condensed table-hover"> <thead> <tr> <th>Attribute</th> <th>Description</th> <th>Type</th> <th>Default</th> <th>Restrictions</th> </tr> </thead> <tr> <td> employee_id </td> <td> Employee Id </td> <td> String </td> <td> - </td> <td> Optional, but strongly encouraged </td> </tr> <tr> <td> id </td> <td> Generated id for the employee </td> <td> Long </td> <td> <span class=text-muted>auto assigned</span> </td> <td> PK </td> </tr> <tr> <td> display_name </td> <td> Employee display name </td> <td> String </td> <td> - </td> <td> - </td> </tr> <tr> <td> email </td> <td> Primary email address for the employee </td> <td> String </td> <td> - </td> <td> - </td> </tr> <tr> <td> user_principal_name </td> <td> The employees account name </td> <td> String </td> <td> - </td> <td> - </td> </tr> <tr> <td> department_name </td> <td> Name of the employee\'s department </td> <td> String </td> <td> - </td> <td> Free format as usually inconsistent in data sources </td> </tr> <tr> <td> kind </td> <td> Type of employee. </td> <td> Enumeration (see below) </td> <td> EMPLOYEE </td> <td> Required </td> </tr> <tr> <td> manager_employee_id </td> <td> The employee id of this employees manager </td> <td> String </td> <td> - </td> <td> If empty, assumed to be a \'root\' level employee </td> </tr> <tr> <td> title </td> <td> Employees title </td> <td> String </td> <td> - </td> <td> - </td> </tr> <tr> <td> mobilePhone </td> <td> Mobile Phone number </td> <td> String </td> <td> - </td> <td> - </td> </tr> <tr> <td> officePhone </td> <td> Office Phone number </td> <td> String </td> <td> - </td> <td> - </td> </tr> </table> </waltz-section> <waltz-section name="Enumerated Values"> <h4>Person Kind</h4> <table class="table table-condensed"> <thead> <tr> <th>Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>EMPLOYEE</td> <td>Directly employed by your organisation</td> </tr> <tr> <td>CONTRACTOR</td> <td>-</td> </tr> <tr> <td>CONSULTANT</td> <td>-</td> </tr> <tr> <td>EUC</td> <td>End User Computing (e.g. custom spreadsheets)</td> </tr> </tbody> </table> </waltz-section> <waltz-section name="Example JSON Representation"> <pre>\n{\n  "employeeId": "RAJMAldzD",\n  "displayName": "Caroline Faulkner",\n  "title": "Administrator",\n  "email": "carolinefaulkner@yahoo.com",\n  "userPrincipalName": "carolinef",\n  "kind": "EMPLOYEE",\n  "managerEmployeeId": "N0FPZkzIR",\n  "departmentName": "Support",\n  "allManagers": null,\n  "officePhone": "0208 6747300",\n  "allManagers": null,\n  "id": 264171\n}\n        </pre> </waltz-section> <waltz-section name="Primary Endpoints"> <table class="table table-condensed"> <thead> <tr> <th>URL</th> <th>Return</th> <th>Description</th> </tr> </thead> <tr> <td><code>api/person/employee-id/(id:string)</code></td> <td>Single employee record</td> <td>Returns the employee associated with the given id</td> </tr> <tr> <td><code>api/person/employee-id/(id:string)/directs</code></td> <td>List of employee record</td> <td>Returns the all employees reporting to the given employee id</td> </tr> <tr> <td><code>api/person/employee-id/(id:string)/manager</code></td> <td>LiSingle employee record</td> <td>Returns the manager record of the given employee id</td> </tr> <tr> <td><code>api/application/org-unit-tree/(org-unit-id:long)</code></td> <td>List of application records</td> <td>Returns applications belonging to the given organisational unit or any of its sub org-units</td> </tr> </table> </waltz-section> </div> '},1037:function(t,e){t.exports='<div> <waltz-page-header name="Server Information" small="Endpoint & Entity"> </waltz-page-header> <waltz-section name="Server Information Entity"> <h4>server_information <small>Table</small></h4> <table class="table table-condensed table-hover"> <thead> <tr> <th>Attribute</th> <th>Description</th> <th>Type</th> <th>Default</th> <th>Restrictions</th> </tr> </thead> <tr> <td> id </td> <td> Generated id for the server record </td> <td> Long </td> <td> <span class=text-muted>auto assigned</span> </td> <td> PK </td> </tr> <tr> <td> hostname </td> <td> Hostname for server </td> <td> String </td> <td> - </td> <td> Required </td> </tr> <tr> <td> operating_system </td> <td> - </td> <td> String </td> <td> - </td> <td> Required </td> </tr> <tr> <td> operating_system_version </td> <td> Detailed version information about the o/s </td> <td> String </td> <td> - </td> <td> Required </td> </tr> <tr> <td> environment </td> <td> Typically similar to: DEV/PROD/QA/PREPROD etc </td> <td> String </td> <td> - </td> <td> Required </td> </tr> <tr> <td> country </td> <td> Country the server resides in </td> <td> String </td> <td> - </td> <td> Required </td> </tr> <tr> <td> location </td> <td> Location of server, e.g. Swindon DataCenter</td> <td> String </td> <td> - </td> <td> Optional </td> </tr> <tr> <td> asset_code </td> <td> Ties the server back to an application record </td> <td> String </td> <td> - </td> <td> Required </td> </tr> <tr> <td> is_virtual </td> <td> Flag to indicate if the server type is virtual (likely to change to server_kind value soon) </td> <td> Boolean / bit </td> <td> false </td> <td> Required </td> </tr> </table> </waltz-section> <waltz-section name="Example JSON Representation"> <pre>\n{\n    "hostname": "mid338a",\n    "operatingSystem": "Linux",\n    "environment": "QA",\n    "location": "New York",\n    "assetCode": "wltz-0177",\n    "id": 2339\n}\n        </pre> </waltz-section> <waltz-section name="Primary Endpoints"> <table class="table table-condensed"> <thead> <tr> <th>URL</th> <th>Return</th> <th>Description</th> </tr> </thead> <tr> <td><code>api/server-info/asset-code/(code:string)</code></td> <td>List of server information records</td> <td>Returns all records associated to the given code</td> </tr> </table> </waltz-section> </div> '},1038:function(t,e){t.exports='<div> <waltz-page-header name=Capability small="Endpoint & Entity"> </waltz-page-header> <waltz-section name="Capability Entity"> <h4>capability <small>Table</small></h4> <table class="table table-condensed table-hover"> <thead> <tr> <th>Attribute</th> <th>Description</th> <th>Type</th> <th>Default</th> <th>Restrictions</th> </tr> </thead> <tbody> <tr> <td> id </td> <td> Id for the Capability </td> <td> Long </td> <td> - </td> <td> PK </td> </tr> <tr> <td> parent_id </td> <td> Optional id of parent Capability </td> <td> Long </td> <td> </td> <td> Optional FK </td> </tr> <tr> <td> name </td> <td> Capability display name </td> <td> String </td> <td> - </td> <td> Required </td> </tr> <tr> <td> description </td> <td> Description of the Capability </td> <td> String </td> <td> - </td> <td> Optional, but strongly encouraged </td> </tr> </tbody> </table> </waltz-section> <waltz-section name="Example JSON Representation"> <pre>\n{\n    "id": 2300,\n    "name": "Balance Services",\n    "description": "Capabilities to consolidate EoD balances and positions from the business and provide them to the Control Functions",\n    "parentId": 2000\n}\n        </pre> </waltz-section> <waltz-section name="Primary Endpoints"> <table class="table table-condensed"> <thead> <tr> <th>URL</th> <th>Return</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>api/capability</code></td> <td>List of capability records</td> <td>Returns the all capabilities registered in the system</td> </tr> </tbody> </table> </waltz-section> </div> '},1039:function(t,e){t.exports='<div> <waltz-page-header name="Application Capability" small="Endpoint & Entity"> </waltz-page-header> <blockquote> The application capability record is used to indicate that an application performs a given capability. </blockquote> <waltz-section name="Application Capability Entity"> <h4>app_capability <small>Table</small></h4> <table class="table table-condensed table-hover"> <thead> <tr> <th>Attribute</th> <th>Description</th> <th>Type</th> <th>Default</th> <th>Restrictions</th> </tr> </thead> <tbody> <tr> <td> application_id </td> <td> Id for application </td> <td> Long </td> <td> - </td> <td> Composite PK (1) </td> </tr> <tr> <td> capability_id </td> <td> Id of Capability </td> <td> Long </td> <td> - </td> <td> Composite PK (2) </td> </tr> <tr> <td> is_primary </td> <td> Flag used to indicate that this is a major focus for the application, primarily used for view filtering </td> <td> Boolean </td> <td> false </td> <td> Required </td> </tr> </tbody> </table> </waltz-section> <waltz-section name="Example JSON Representation"> <strong>Note</strong>, this is an enhanced record - decorated with further details about the application and capability. <br> <pre>\n{\n    "capabilityReference": {\n      "kind": "CAPABILITY",\n      "id": 3100,\n      "name": "Settlements"\n    },\n    "applicationReference": {\n      "kind": "APPLICATION",\n      "id": 1,\n      "name": "Waltz"\n    },\n    "description": "Bank settlement system across all business lines. Providing aggregation of settlement instructions for efficiency.",\n    "isPrimary": false\n}\n        </pre> </waltz-section> <waltz-section name="Primary Endpoints"> <table class="table table-condensed"> <thead> <tr> <th>URL</th> <th>Return</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>api/app-capability/application/(id:long)</code></td> <td>List of app-capability records</td> <td>Returns the all app-capabilities for the given application</td> </tr> <tr> <td><code>api/app-capability/capability/(id:long)</code></td> <td>List of app-capability records</td> <td>Returns the all app-capabilities for the given capability</td> </tr> <tr> <td><code>api/app-capability/org-unit/(id:long)</code></td> <td>List of app-capability records</td> <td>Returns the all app-capabilities for the given organisational unit</td> </tr> <tr> <td><code>api/app-capability/org-unit-tree/(id:long)</code></td> <td>List of app-capability records</td> <td>Returns the all app-capabilities for the given organisational unit and its descendants</td> </tr> </tbody> </table> </waltz-section> </div> '},1040:function(t,e){t.exports='<div> <waltz-page-header name="Organisational Unit" small="Endpoint & Entity"> </waltz-page-header> <waltz-section name="Organisational Unit Entity"> <h4>organisational_unit <small>Table</small></h4> <table class="table table-condensed table-hover"> <thead> <tr> <th>Attribute</th> <th>Description</th> <th>Type</th> <th>Default</th> <th>Restrictions</th> </tr> </thead> <tbody> <tr> <td> id </td> <td> Id for the organisational unit </td> <td> Long </td> <td> <span class=text-muted>auto assigned</span> </td> <td> PK </td> </tr> <tr> <td> parent_id </td> <td> Optional id of parent Org Unit </td> <td> Long </td> <td> </td> <td> Optional FK </td> </tr> <tr> <td> name </td> <td> Organisational Unit display name </td> <td> String </td> <td> - </td> <td> Required </td> </tr> <tr> <td> description </td> <td> Description of the organisational unit </td> <td> String </td> <td> - </td> <td> Optional, but strongly encouraged </td> </tr> <tr> <td> kind </td> <td> Type of the organisational unit, i.e. technology etc.</td> <td> Enumerated value, see below </td> <td> - </td> <td> Required </td> </tr> </tbody> </table> </waltz-section> <waltz-section name="Enumerated Values"> <h4>Organisational Unit Kind</h4> <table class="table table-condensed"> <thead> <tr> <th>Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> BUSINESS </td> <td> - </td> </tr> <tr> <td> CONTROL </td> <td> - </td> </tr> <tr> <td> IT </td> <td> - </td> </tr> </tbody> </table> </waltz-section> <waltz-section name="Example JSON Representation"> <pre>\n{\n  "kind": "CONTROL",\n  "id": 100,\n  "parentId": 60,\n  "name": "Treasury",\n  "description": "All about Treasury"\n}\n        </pre> </waltz-section> <waltz-section name="Primary Endpoints"> <table class="table table-condensed"> <thead> <tr> <th>URL</th> <th>Return</th> <th>Description</th> </tr> </thead> <tr> <td><code>api/org-unit/(id:long)</code></td> <td>Single organisational unit record</td> <td>Returns the org unit associated with the given id</td> </tr> <tr> <td><code>api/org-unit</code></td> <td>List of organisational unit record</td> <td>Returns the all organisational units</td> </tr> </table> </waltz-section> </div> '},1041:function(t,e){t.exports='<div> <waltz-page-header name=Involvement small="Endpoint & Entity"> </waltz-page-header> <blockquote> The Involvement record is used to represent a relationship between a person and an entity (typically an application or an organisational unit) </blockquote> <waltz-section name="Involvement Entity"> <h4>involvement <small>Table</small></h4> <table class="table table-condensed table-hover"> <thead> <tr> <th>Attribute</th> <th>Description</th> <th>Type</th> <th>Default</th> <th>Restrictions</th> </tr> </thead> <tbody> <tr> <td> entity_kind </td> <td> The type of entity the person is involved with, i.e. APPLICATION </td> <td> String </td> <td> - </td> <td> Required </td> </tr> <tr> <td> entity_id </td> <td> Id of the entity the person is involved with</td> <td> Long </td> <td> </td> <td> Required </td> </tr> <tr> <td> kind </td> <td> Type of relationship </td> <td> Enumerated value, see below </td> <td> - </td> <td> Required </td> </tr> <tr> <td> employee_id </td> <td> Employee id of the person involved with the entity </td> <td> String </td> <td> - </td> <td> Required </td> </tr> </tbody> </table> </waltz-section> <waltz-section name="Enumerated Values"> <h4>Involvement Kind</h4> <table class="table table-condensed"> <thead> <tr> <th>Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>IT_ARCHITECT</td> <td> - </td> </tr> <tr> <td>DATA_ARCHITECT</td> <td> - </td> </tr> <tr> <td>PROJECT_MANAGER</td> <td> - </td> </tr> <tr> <td>SUPPORT_MANAGER</td> <td> - </td> </tr> <tr> <td>IT_LEAD</td> <td> -</td> </tr> <tr> <td>DEVELOPER</td> <td> - </td> </tr> <tr> <td>QA</td> <td> - </td> </tr> <tr> <td>BUSINESS_ANALYST</td> <td> - </td> </tr> <tr> <td>SUPPORT</td> <td> - </td> </tr> <tr> <td>BUSINESS_SPONSOR</td> <td> - </td> </tr> </tbody> </table> </waltz-section> <waltz-section name="Example JSON Representation"> <pre>\n{\n    "kind": "QA",\n    "entityReference": {\n      "kind": "APPLICATION",\n      "id": 1\n    },\n    "employeeId": "FdfgI96a2"\n}\n        </pre> </waltz-section> <waltz-section name="Primary Endpoints"> <table class="table table-condensed"> <thead> <tr> <th>URL</th> <th>Return</th> <th>Description</th> </tr> </thead> <tr> <td><code>api/involvement/entity/(entity_kind:string)/(id:long)</code></td> <td>List of involvement records</td> <td>Returns the all records for the given entity</td> </tr> <tr> <td><code>api/involvement/employee/(employee_id:string)</code></td> <td>List of involvement records</td> <td>Returns the all records for the given employee</td> </tr> </table> </waltz-section> </div> '},1042:function(t,e){t.exports="<div> <style>.waltz-roadmap-plan-item p{margin-top:6px}.waltz-roadmap-plan-item{border-bottom:1px dotted #ccc;margin-bottom:10px}.waltz-roadmap-plan-item .done{text-decoration:line-through;background-color:#e1ffe4}</style> <waltz-page-header name=\"Waltz Roadmap\" small=Draft> </waltz-page-header> <blockquote> High level overview of upcoming development themes. This is intended to start the conversation about the product direction and priorities. </blockquote> <waltz-section name=\"2015 Q4\"> <div class=waltz-roadmap-plan-item> <strong>Application Retirement</strong> <p> Define when an application is due to retire (year/quarter), providing an optional list of replacement applications and a textual description. Views will indicate whether a retirement is overdue as well as providing views on upcoming group level (org-unit etc.) retirements. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Data Flow Enhancements</strong> <p> <i>Directed graph:</i> allow for filtering and display of authoritative sources, intra/extra group links, application statuses etc. </p> <p class=done> <i>Authoritative Sources:</i> better support for org-unit hierarchies. Currently the views and edit functionality is focused on singular org-units. </p> <p class=done> <i>Consolidation & Summary:</i> the rated flows, logical flows and authoritative sources can be grouped into one (tabbed) section with a summary view giving highlights. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Capability Enhancements</strong> <p class=done> <i>Auto suggest:</i> given a starting capability recommend other capabilities based on additional capabilities owned by applications sharing the starting set of capabilities. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Data Ingestion</strong> <p> Document proposed data formats for integrating existing data repositories. This work will be available under the 'Entities/Endpoints' section of the documentation. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Application Instances</strong> <p class=done> Basic support for defining instances of applications. Simple approach is to allow for an optional parent asset code. This code can be used when joining to datasets to provide a complete view of an application (e.g. some servers may be registered to a parent code). </p> </div> <div class=waltz-roadmap-plan-item> <strong>Technology</strong> <p> Read-only support for linked technology display. Technology will be indexed by vendor/product/version with products having optional tags to indicate the type of tech (i.e. database, messaging, reporting). Each piece of technology may have an optional description and a flag to indicate if the technology is 'significant' (this will prevent long display lists of un-interesting technology). </p> <p> Libraries will be indexed in the same way, using the maven project co-ordinates (group, name, version) for vendor/product/version. </p> <p> To link technology to applications a join table linking asset-codes to technology will be utilised. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Begin Pilot Implementations</strong> <p> Common import routines to be produced. These may include parsing svn access files for user details, ldap user import etc. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Data Export (On going)</strong> <p> CSV/Graph export of data sets, this is an on-going theme as will need to be revisited as new information is incorporated into Waltz. </p> </div> </waltz-section> <waltz-section name=\"2016 Q1\"> <div class=waltz-roadmap-plan-item> <strong>Technology Capability Model</strong> <p> Similar to the business capability model it may be desirable to have a separate technology capability model. Applications will be able to declare which technology capabilities they perform along with a rating. Currently the plan is to have a single rating per capability for the application, unlike the business capability's rating per perspective/measurable. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Capability Rating Deltas</strong> <p> Ability to record changes to rated capabilites against a predicted implementation date (year/quarter). Deltas can be associated to project initiatives or left as free standing changes. Deltas can be projected onto the current view to see future state and they can also be browsed in with a detail oriented view. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Capability Hierarchy</strong> <p> The capability model expresses a hierarchy, however the current implementation of the editor and perspective views do not reflect this hierarchy. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Multiple Perspectives</strong> <p> Perspectives bundle a group of related measurables together. An application can rate its capabilities against these perspective-measurables. Currently the data model supports multiple perspectives but the user interface does not allow for viewing or creating additional perspectives. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Physical Flows</strong> <p> Attach/Link samples of physical flows to the logical data flows. Annotate with metadata to indicate contents, ownership, frequency, mechanisms etc. </p> <p> This could be expanded out to include OLA type information (expected times, contact points etc.) However it is likely that this information can be sourced elsewhere. </p> </div> </waltz-section> <waltz-section name=\"2016 Q2\"> <div class=waltz-roadmap-plan-item> <strong>Custom, ad-hoc groups</strong> <p> Currently groups of applications are derived from aspects of the underlying model, namely Organisational Unit, Person and Capability. Ad-hoc groups can be created by any user and may contain any number of applications. Aggregate summary views (similar to the Organisational Unit view) will be provided. To ease creation of groups we can utilise existing relationships in Waltz (i.e. add all applications which are downstream of a given starting application). </p> </div> <div class=waltz-roadmap-plan-item> <strong>Universal Search</strong> <p> Expand search to include capabilities and organisational units, custom groups, physical flows etc. </p> </div> <div class=waltz-roadmap-plan-item> <strong>Flow-Path Editor</strong> <p> Combining information about applications, logical data flows and physical data flows will facilitate the creation of a constrained graphical editor which can be used to draw out </p> </div> <div class=waltz-roadmap-plan-item> <strong>Surveys</strong> <p> Issue and collate surveys at an application level. </p> </div> </waltz-section> <waltz-section name=\"2016 Q3\"> <div class=waltz-roadmap-plan-item> <strong>User Capability Combinations (Operational Risk)</strong> <p> By grouping capabilities and then analysing users with access to applications which perform those capabilities it is possible to determine if a given user has a potentially toxic combination (for example they may be a developer who commits to both a trade capture system and a settlement system). </p> </div> <div class=waltz-roadmap-plan-item> <strong>Technology</strong> <p> Creation of a basic technology portfolio comprising both installed software packages and libraries used within an application. Tools will be provided to filter the application portfolio on these technologies to allow for end-of-life and exposure analysis. </p> </div> </waltz-section> <waltz-section name=\"2016 Q4\"> <div class=waltz-roadmap-plan-item> <strong>Plugins</strong> <p> Support for custom extensions developed by customers which can be integrated into the standard views provided by the base-level install of Waltz. </p> </div> </waltz-section> <waltz-section name=\"Change Log\" small=\"(Newest first)\"> <table class=\"table table-striped table-condensed\"> <colgroup> <col width=20%> <col width=80%> </colgroup> <tr> <td>2015/11/16-20</td> <td> <ul> <li>Marked 'Capability Enhancements / Auto suggest' as completed.</li> </ul> </td> </tr> <tr> <td>2015/11/9-15</td> <td> <ul> <li>Marked 'Application Instances' as completed.</li> <li>Added 'Technology' to 2015 Q4.</li> <li>Added 'Technology Capability Model' to 2016 Q1.</li> <li>Added 'Capability Enhancements/AutoSuggest' to 2015 Q4.</li> <li>Added 'Application Instances' to 2015 Q4.</li> <li>Marked 'Authoritative Sources' and 'Consolidation & Summary' from Data Flow Enhancements ('15Q4) as completed.</li> </ul> </td> </tr> </table> </waltz-section> </div>"},1043:function(t,e){t.exports='<div> <style>.waltz-roadmap-plan-item p{margin-top:6px}.waltz-roadmap-plan-item{border-bottom:1px dotted #ccc;margin-bottom:10px}</style> <waltz-page-header name="Engagement Model" small=Draft> </waltz-page-header> <blockquote> High level overview of proposed engagement model </blockquote> <waltz-section name=Proposal> <h4>Adoption:</h4> <p> During early adoption phases (whilst the product approaches a v1.0 release) engagement will be via consultancy arrangements. </p> <p> Once the early adoption period lapses (~ 6-12 months) the software will transition to a support model + additional consultancy / development as required. </p> <br> <h4>Shared Source Model:</h4> <p> During early adoption and subsequent support phases (read) access to the source code will be provided via GitHub. Organizations will be free to copy and/or fork the code (but not resell derivative work), however we will encourage modifications to be submitted back to the repository for inclusion in subsequent releases. </p> <br> <h4>Releases:</h4> <p> Regular releases (initially monthly) will be made available via the GitHub repository along with release notes, migration scripts etc. </p> </waltz-section> </div>'},1044:function(t,e){t.exports=' <div> <style>.waltz-roadmap-plan-item p{margin-top:6px}.waltz-roadmap-plan-item{border-bottom:1px dotted #ccc;margin-bottom:10px}</style> <waltz-page-header name=Prerequisites small=Draft> </waltz-page-header> <blockquote> Hardware / Software Prerequisites </blockquote> <waltz-section name="Application Server"> <p> For the Application server we need (virtual is fine) the following spec: </p> <br> <table class="table table-striped"> <tr> <td>Memory</td> <td>8 GB</td> </tr> <tr> <td>Disk storage</td> <td>64 GB</td> </tr> <tr> <td>Processor</td> <td>Quad Core @ 2.6Ghz</td> </tr> <tr> <td>Operating System</td> <td>Linux</td> </tr> <tr> <td>Other</td> <td>Java 8</td> </tr> </table> </waltz-section> <waltz-section name="Database Server"> <p> CPU requirements should be fairly low. I\'m currently running on a Quad core (2.6ghz) with 4 gb of RAM. </p> <br> <table class="table table-striped"> <tr> <td>Database</td> <td>Postgres 9.3</td> </tr> <tr> <td>Storage</td> <td>~100 GB</td> </tr> </table> </waltz-section> </div>'},1045:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(6)),a=n(1046);e.default=function(){var t=i.default.module("waltz.client.extensions",[]);return(0,a.init)(t),t.name}},1046:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=void 0;var i=n(7),a=n(31),o=l(n(1047)),r=l(n(1049));function l(t){return t&&t.__esModule?t:{default:t}}e.init=function(t){(0,i.registerComponents)(t,[o.default,r.default]),a.dynamicSections.dbAttestationSection={componentId:"attestation-section",name:"Attestations",icon:"check-square-o",id:10001},a.dynamicSectionsByKind.APPLICATION.push(a.dynamicSections.dbAttestationSection)}},1047:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(24),o=function(t){return t&&t.__esModule?t:{default:t}}(n(1048));var r={containerClass:[],changeInitiatives:[],treeData:[],visibility:{sourcesOverlay:!1},onSelect:function(t){return console.log("wcib: default on-select",t)}};function l(){var t=(0,i.initialiseData)(this,r);t.$onChanges=function(){t.changeInitiatives&&(t.treeData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,a.buildHierarchies)(t,!1)}(t.changeInitiatives)),t.scrollHeight&&t.treeData&&t.treeData.length>10&&(t.containerClass=["waltz-scroll-region-"+t.scrollHeight])}}l.$inject=[];var s={template:o.default,bindings:{changeInitiatives:"<",scrollHeight:"<",onSelect:"<"},controller:l};e.default={component:s,id:"waltzDbChangeInitiativeBrowser"}},1048:function(t,e){t.exports='<div ng-class=$ctrl.containerClass> <treecontrol class=tree-light tree-model=$ctrl.treeData options=$ctrl.treeOptions on-selection=$ctrl.onSelect(node) order-by="\'-name\'"> <span title="{{ node.description }}" style=display:inline-block;width:90%;padding:0;margin:0 ng-class="{ \'text-muted\': $ctrl.ratingsMap[node.id].total.total == 0 }" class="no-overflow waltz-visibility-parent"> <span class=clickable> <span ng-bind=node.externalId></span> </span> - <span ng-bind=node.name class=waltz-visibility-child-90 ng-class="{ \'italics\' : ! node.concrete }"> </span> <span ng-bind="node.kind | toDisplayName:\'changeInitiative\' " class="waltz-visibility-child-90 small text-muted" ng-class="{ \'italics\' : ! node.concrete }"> </span> </span> </treecontrol> </div> '},1049:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(0),o=function(t){return t&&t.__esModule?t:{default:t}}(n(1050));var r={name:"DB Change Initiatives",changeInitiatives:[],visibility:{sourcesOverlay:!1}};function l(t){var e=(0,a.initialiseData)(this,r);e.$onChanges=function(){if(e.parentEntityRef){("PERSON"===e.parentEntityRef.kind?t.loadViewData(i.CORE_API.PersonStore.getById,[e.parentEntityRef.id]).then(function(e){return t.loadViewData(i.CORE_API.InvolvementStore.findChangeInitiativesForEmployeeId,[e.data.employeeId])}):"CHANGE_INITIATIVE"===e.parentEntityRef.kind?t.loadViewData(i.CORE_API.ChangeInitiativeStore.findByParentId,[e.parentEntityRef.id]):t.loadViewData(i.CORE_API.ChangeInitiativeStore.findByRef,[e.parentEntityRef.kind,e.parentEntityRef.id])).then(function(t){e.changeInitiatives=t.data})}},e.onSelect=function(t){return e.selectedChangeInitiative=t}}l.$inject=["ServiceBroker"];var s={template:o.default,bindings:{name:"@",parentEntityRef:"<"},controller:l};e.default={component:s,id:"waltzDbChangeInitiativeSection"}},1050:function(t,e){t.exports='<div> <waltz-section-actions> <button class="btn btn-xs waltz-btn-transparent" ng-click="$ctrl.visibility.sourcesOverlay = ! $ctrl.visibility.sourcesOverlay"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.visibility.sourcesOverlay entities="[\'CHANGE_INITIATIVE\']"> </waltz-source-data-overlay> <div class=row ng-if="$ctrl.changeInitiatives.length > 0" style=min-height:100px> <div class=col-md-7> <waltz-db-change-initiative-browser change-initiatives=$ctrl.changeInitiatives scroll-height=300 on-select=$ctrl.onSelect> </waltz-db-change-initiative-browser> </div> <div class=col-md-5> <div ng-if=$ctrl.selectedChangeInitiative class=waltz-fade-if> <h4> <span ng-bind=$ctrl.selectedChangeInitiative.name> </span> <small ng-bind="$ctrl.selectedChangeInitiative.kind | toDisplayName:\'changeInitiative\'"> </small> </h4> <div ng-bind=$ctrl.selectedChangeInitiative.description></div> <br> <div> <div class=row> <div class="col-sm-2 waltz-display-field-label"> Kind: </div> <div class=col-sm-4> <span ng-bind="$ctrl.selectedChangeInitiative.kind | toDisplayName:\'changeInitiative\' "></span> </div> <div class="col-sm-2 waltz-display-field-label"> Phase: </div> <div class=col-sm-4> <span ng-bind="$ctrl.selectedChangeInitiative.lifecyclePhase | toDisplayName:\'changeInitiativeLifecyclePhase\' "></span> </div> </div> <div class=row> <div class="col-sm-2 waltz-display-field-label"> Start: </div> <div class=col-sm-4> <span ng-bind=$ctrl.selectedChangeInitiative.startDate></span> </div> <div class="col-sm-2 waltz-display-field-label"> End: </div> <div class=col-sm-4> <span ng-bind=$ctrl.selectedChangeInitiative.endDate></span> </div> </div> </div> <br> <a ui-sref="main.change-initiative.view ({ id: $ctrl.selectedChangeInitiative.id })" class=clickable> More &raquo; </a> </div> </div> </div> <waltz-no-data ng-if="$ctrl.changeInitiatives.length == 0"> <message> No associated Change Initiatives found </message> </waltz-no-data> </div>'},1051:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=z(n(6)),a=z(n(227)),o=z(n(228)),r=z(n(229)),l=z(n(1052)),s=z(n(1053)),d=z(n(1055)),c=z(n(1057)),u=z(n(1059)),p=z(n(1061)),f=z(n(1063)),m=z(n(1065)),g=z(n(1067)),v=z(n(1070)),y=z(n(1072)),h=z(n(1074)),w=n(7),b=z(n(1076));function z(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module("waltz.flow-diagram",[]);return t.component("waltzFlowDiagram",s.default).component("waltzFlowDiagramLogicalFlowPopup",d.default).component("waltzFlowDiagramNodePopup",c.default).component("waltzFlowDiagramPhysicalFlowPopup",u.default).component("waltzFlowDiagramAnnotationPopup",p.default).component("waltzFlowDiagramEditor",f.default),t.config(b.default),(0,w.registerServices)(t,[l.default]),(0,w.registerComponents)(t,[v.default,y.default,m.default,g.default,h.default]),(0,w.registerStores)(t,[a.default,o.default,r.default]),t.name}},1052:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.service=c;var a=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),o=n(0),r=n(81);var l={dirty:!1,model:{diagramId:null,nodes:[],flows:[],decorations:{},annotations:[]},layout:{positions:{},shapes:{},diagramTransform:null},visibility:{layers:{flowBuckets:!0,annotations:!0,pendingFlows:!0,removedFlows:!0}},detail:{applicationsById:{}}},s=a.default.cloneDeep(l);function d(t){return{kind:t.data.kind,id:t.data.id}}function c(t,e,n,c,u,p,f){var m=function(){s=a.default.cloneDeep(l),v&&v(s)},g=function(t,n){var i=n.payload,o=t.model;switch(n.command){case"TRANSFORM_DIAGRAM":t=a.default.defaultsDeep({},{layout:{diagramTransform:i}},t);break;case"SET_TITLE":o.title=i;break;case"SET_DESCRIPTION":o.description=i;break;case"MOVE":var l=i.refId?(0,r.positionFor)(t,i.refId):(0,r.positionFor)(t,i.id),s=(0,r.positionFor)(t,i.id);s.x=l.x+i.dx,s.y=l.y+i.dy;break;case"UPDATE_ANNOTATION":o.annotations=a.default.map(o.annotations,function(t){if(t.id!==i.id)return t;var e=Object.assign({},t);return e.data.note=i.note,e});break;case"ADD_ANNOTATION":var d=(0,r.toGraphNode)(i),c=a.default.map(o.annotations,"id");a.default.includes(c,i.id)?console.log("Ignoring request to re-add annotation",i):o.annotations=a.default.concat(o.annotations||[],[d]);break;case"ADD_NODE":var u=(0,r.toGraphNode)(i),p=a.default.map(o.nodes,"id");a.default.includes(p,u.id)?console.log("Ignoring request to re-add node",i):(o.nodes=a.default.concat(o.nodes||[],[u]),v(t)),"APPLICATION"!==u.data.kind||t.detail.applicationsById[u.data.id]||e.getById(u.data.id).then(function(e){return t.detail.applicationsById[u.data.id]=e}).then(function(){return v(t)});break;case"ADD_FLOW":var f=(0,r.toGraphFlow)(i),m=a.default.map(o.flows,"id");a.default.includes(m,f.id)?console.log("Ignoring request to add duplicate flow",i):o.flows=a.default.concat(o.flows||[],[f]);break;case"REMOVE_FLOW":o.annotations=a.default.reject(o.annotations,function(t){return(0,r.toGraphId)(t.data.entityReference)===i.id}),o.flows=a.default.reject(o.flows,function(t){return t.id===i.id});break;case"ADD_DECORATION":!function(t,e){var n=(0,r.toGraphId)(t.ref),i=(0,r.toGraphNode)(t.decoration),o=e.decorations[n]||[],l=a.default.map(o,"id");a.default.includes(l,i.id)?console.log("Ignoring request to add duplicate decoration"):e.decorations[n]=a.default.concat(o,[i])}(i,o);break;case"REMOVE_DECORATION":!function(t,e){var n=(0,r.toGraphId)(t.ref),i=(0,r.toGraphNode)(t.decoration),o=e.decorations[n]||[],l=a.default.map(o,"id");a.default.includes(l,i.id)?e.decorations[n]=a.default.reject(o,function(t){return t.id===i.id}):console.log("Ignoring request to removed unknown decoration")}(i,o);break;case"REMOVE_NODE":var g=a.default.chain(o.flows).filter(function(t){return t.source===i.id||t.target===i.id}).map("id").value();o.flows=a.default.reject(o.flows,function(t){return a.default.includes(g,t.id)}),o.nodes=a.default.reject(o.nodes,function(t){return t.id===i.id}),o.annotations=a.default.reject(o.annotations,function(t){var e=(0,r.toGraphId)(t.data.entityReference),n=e===i.id,o=a.default.includes(g,e);return n||o}),a.default.forEach(g,function(t){return o.decorations[t]=[]});break;case"REMOVE_ANNOTATION":o.annotations=a.default.reject(o.annotations,function(t){return t.id===i.id});break;case"SET_POSITION":t.layout.positions[i.id]={x:i.x,y:i.y};break;case"SHOW_LAYER":t.visibility.layers[i]=!0;break;case"HIDE_LAYER":t.visibility.layers[i]=!1;break;default:console.log("WFD: unknown command",n)}return t.dirty=!0,t},v=function(){},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];s=a.default.reduce(t,g,s),v&&v(s)},h=function(){return Object.assign({},s)};return{processCommands:y,getState:h,getAllEntities:function(){var t=function(t){return{kind:t.data.kind,id:t.data.id}},e=a.default.map(s.model.nodes,t),n=a.default.map(s.model.flows,t),i=a.default.chain(s.model.decorations).values().flatten().map(t).value();return a.default.concat(e,n,i)},onChange:function(t){return v=t},isDirty:function(){return s.dirty},save:function(){var t=function(t){var e=a.default.map(t.model.nodes,function(t){return{entityReference:d(t),isNotable:!1}}),n=a.default.map(t.model.flows,function(t){return{entityReference:d(t)}}),i=a.default.chain(t.model.decorations).values().flatten().map(function(t){return{entityReference:d(t),isNotable:!1}}).value(),r=a.default.concat(e,n,i),l={positions:t.layout.positions,diagramTransform:(0,o.ifPresent)(t.layout.diagramTransform,function(t){return t.toString()},"translate(0,0) scale(1)")},s=a.default.map(t.model.annotations,function(t){var e=t.data.entityReference;return{entityReference:{kind:e.kind,id:e.id},note:t.data.note,annotationId:t.data.id}});return{diagramId:t.diagramId,name:t.model.title,description:t.model.description,entities:r,annotations:s,layoutData:JSON.stringify(l)}}(s);return n.save(t).then(function(t){return s.diagramId=t,s.dirty=!1,t})},updateName:function(){var t={newName:s.model.title};return n.updateName(s.diagramId,t)},updateDescription:function(){var t={newDescription:s.model.description};return n.updateDescription(s.diagramId,t)},load:function(o){var l={entityReference:{id:o,kind:"FLOW_DIAGRAM"},scope:"EXACT",entityLifecycleStatuses:["ACTIVE","PENDING","REMOVED"]};m(),s.diagramId=o;var d=[e.findBySelector(l),n.getById(o),c.findByDiagramId(o),u.findByDiagramId(o),p.findBySelector(l),f.findBySelector(l)];return t.all(d).then(function(t){var e=i(t,6),n=e[0],o=e[1],l=e[2],d=e[3],c=e[4],u=e[5];s.detail.applicationsById=a.default.keyBy(n,"id"),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=JSON.parse(e.layoutData),d=a.default.keyBy(o,"id"),c=a.default.chain(i).filter(function(t){return"LOGICAL_DATA_FLOW"===t.entityReference.kind}).map(function(t){return d[t.entityReference.id]}).filter(function(t){return null!=t}).map(function(t){return{command:"ADD_FLOW",payload:Object.assign({},t,{kind:"LOGICAL_DATA_FLOW"})}}).value(),u=a.default.chain(i).filter(function(t){return a.default.includes(["APPLICATION","ACTOR"],t.entityReference.kind)}).map(function(t){return{command:"ADD_NODE",payload:{id:t.entityReference.id,kind:t.entityReference.kind,name:t.entityReference.name,isNotable:t.isNotable}}}).value(),p=a.default.map(i,function(t){return(0,r.toGraphId)(t.entityReference)}),f=a.default.chain(n).filter(function(t){var e="LOGICAL_DATA_FLOW"===t.entityReference.kind?null!==d[t.entityReference.id]:a.default.includes(p,(0,r.toGraphId)(t.entityReference));return e||console.warn("wfdss: WARN - cannot attach annotation to missing element: ",t),e}).map(function(t){return{command:"ADD_ANNOTATION",payload:{kind:"ANNOTATION",id:t.annotationId,entityReference:t.entityReference,note:t.note}}}).value(),m=a.default.map(l,function(t){return{command:"ADD_DECORATION",payload:{ref:{kind:"LOGICAL_DATA_FLOW",id:t.logicalFlowId},decoration:{kind:"PHYSICAL_FLOW",id:t.id}}}}),g=a.default.map(s.positions,function(t,e){return{command:"MOVE",payload:{id:e,dx:t.x,dy:t.y}}}),v=[{command:"TRANSFORM_DIAGRAM",payload:s.diagramTransform}],y=[{command:"SET_TITLE",payload:e.name}],h=[{command:"SET_DESCRIPTION",payload:e.description}];t(u),t(c),t(f),t(g),t(v),t(m),t(y),t(h)}(y,o,l,d,c,u),s.dirty=!1}).then(function(){return h()})},reset:m}}c.$inject=["$q","ApplicationStore","FlowDiagramStore","FlowDiagramAnnotationStore","FlowDiagramEntityStore","LogicalFlowStore","PhysicalFlowStore"];e.default={serviceName:"FlowDiagramStateService",service:c}},1053:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=p(n(1)),a=n(5),o=n(83),r=n(118),l=n(0),s=n(44),d=n(115),c=n(81),u=p(n(1054));function p(t){return t&&t.__esModule?t:{default:t}}var f={},m={annotation:null,canvas:null,flowBucket:null,node:null},g=function(t){return console.log("wfd: default on-click handler",t)},v={node:g,flowBucket:g},y={ANNOTATION:"wfd-annotation",ANNOTATIONS:"wfd-annotations",FLOW:"wfd-flow",FLOW_REMOVED:"wfd-flow-removed",FLOW_PENDING:"wfd-flow-pending",FLOWS:"wfd-flows",FLOW_ARROW:"wfd-flow-arrow",FLOW_ARROW_HEAD:"wfd-flow-arrow-head",FLOW_BUCKET:"wfd-flow-bucket",FLOW_BUCKETS:"wfd-flow-buckets",NODE:"wfd-node",NODES:"wfd-nodes",SUBJECT:"wfd-subject",TITLE:"wdf-title",TITLE_ICON:"wdf-title-icon"},h={svg:{w:1100,h:600},flowBucket:{r:10},annotation:{circle:{r:10},text:{w:120}}},w={svg:null,nodes:null,flows:null},b=Object.assign({},m),z=Object.assign({},v),E=null;function S(t){return E={x:a.event.x,y:a.event.y},(0,a.select)(this).raise().classed("wfd-active",!0)}function k(t){return function(e){var n={command:"MOVE",payload:{id:e.id,dx:a.event.dx,dy:a.event.dy}};t([n])}}function I(t){return E.x==a.event.x&&E.y==a.event.y&&z.node(t),(0,a.select)(this).classed("wfd-active",!1)}function N(t,e){t.each(function(){var t=(0,a.select)(this),n=(0,a.select)(this.parentNode),o=D(t),r=n.select("."+y.FLOW_BUCKET).attr("transform","translate("+o.x+", "+o.y+")");r.select("circle").attr("r",function(t){return i.default.size(e.model.decorations[t.id])>0?1.5*h.flowBucket.r:h.flowBucket.r}),r.select("text").text(function(t){var n=i.default.size(e.model.decorations[t.id]);return 0===n?"":1===n?"":""}),n.select("."+y.FLOW_ARROW_HEAD).call(A,t)})}function D(t){var e=t.node().getTotalLength()/1.7;return t.node().getPointAtLength(e)}function A(t,e){var n=e.node().getPointAtLength(e.node().getTotalLength()/1.4),i=e.node().getPointAtLength(e.node().getTotalLength()/1.6),a=n.x-i.x,o=n.y-i.y,r=Math.atan2(o,a);t.attr("transform","translate("+n.x+", "+n.y+") rotate("+r*(180/Math.PI)+")")}function R(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return console.log("no command processor given")};t.layout.diagramTransform&&w.container.attr("transform",t.layout.diagramTransform),function(t,e,n){if(e){var i=e.selectAll("."+y.NODE).data(t.model.nodes||[],function(t){return t.id});i.exit().remove();var a=(0,o.drag)().on("start",S).on("drag",k(n)).on("end",I),r=b.node?(0,d.d3ContextMenu)(b.node):null,s=i.enter().append("g").classed(y.NODE,!0).on("click.node",function(t){z.node(t)}).on("contextmenu",r).call(a);s.merge(i).attr("transform",function(e){var n=(0,c.positionFor)(t,e);return"translate("+n.x+", "+n.y+")"}),s.append("path"),i.merge(s).call(c.drawNodeShape,t),s.append("text").classed(y.TITLE_ICON,!0).attr("font-family","FontAwesome").text(function(e){return(0,c.shapeFor)(t,e).icon}),i.merge(s).select("."+y.TITLE_ICON).attr("dx",function(e){return(0,c.shapeFor)(t,e).title.dx}).attr("dy",function(e){return(0,c.shapeFor)(t,e).title.dy}),s.append("text").classed(y.TITLE,!0).attr("dx",function(e){return(0,c.shapeFor)(t,e).title.dx+14}).attr("dy",function(e){return(0,c.shapeFor)(t,e).title.dy}),i.merge(s).select("."+y.TITLE).text(function(t){return t.data.name}).each(function(e){var n=this,i=(0,l.perhaps)(function(){return n.getComputedTextLength()},10),a=Math.max(i+32,60);t.layout.shapes[e.id]=(0,c.toNodeShape)(e.data,a)})}}(t,w.nodes,e),function(t,e){if(e){var n=e.selectAll("."+y.FLOW).data(t.model.flows||[],function(t){return t.id});n.exit().remove();var i=n.enter().append("g").classed(y.FLOW,!0).classed(y.FLOW_REMOVED,function(t){return"REMOVED"===t.data.entityLifecycleStatus}).classed(y.FLOW_PENDING,function(t){return"PENDING"===t.data.entityLifecycleStatus}).attr("data-flow-id",function(t){return t.id});i.append("path").classed(y.FLOW_ARROW,!0),i.append("path").classed(y.FLOW_ARROW_HEAD,!0).attr("d","M -8,-4 8,0 -8,4 Z");var a=i.append("g").classed(y.FLOW_BUCKET,!0).on("contextmenu",b.flowBucket?(0,d.d3ContextMenu)(b.flowBucket):null).on("click.flowBucket",z.flowBucket);a.append("circle"),a.append("text").classed("fa-fw",!0).attr("font-family","FontAwesome").attr("dx",-6).attr("dy",5),i.merge(n).select("."+y.FLOW_ARROW).attr("d",function(e){var n=(0,c.positionFor)(t,e.source),i=(0,c.positionFor)(t,e.target),a=(0,c.shapeFor)(t,e.source),o=(0,c.shapeFor)(t,e.target);return(0,s.mkCurvedLine)(n.x+a.cx,n.y+a.cy,i.x+o.cx,i.y+o.cy)}).call(N,t)}}(t,w.flows),function(t,e,n){if(e){var i=e.selectAll("."+y.ANNOTATION).data(t.model.annotations||[],function(t){return t.id}),r=i.enter().append("g").classed(y.ANNOTATION,!0).on("contextmenu",b.annotation?(0,d.d3ContextMenu)(b.annotation):null);i.exit().remove(),r.append("path");var l=function(t,e){var n=e.data.entityReference;if("LOGICAL_DATA_FLOW"===n.kind){var i={subjectPosition:{x:0,y:0},subjectShape:{cx:0,cy:0},annotationPosition:(0,c.positionFor)(t,e.id)};return(0,a.select)('[data-flow-id="'+(0,c.toGraphId)(n)+'"] .'+y.FLOW_ARROW).each(function(){i.subjectPosition=D((0,a.select)(this))}),i}return{subjectPosition:(0,c.positionFor)(t,(0,c.toGraphId)(n)),subjectShape:(0,c.shapeFor)(t,(0,c.toGraphId)(n)),annotationPosition:(0,c.positionFor)(t,e.id)}};i.merge(r).select("path").attr("d",function(e){var n=l(t,e),i=h.annotation.text.w*(n.annotationPosition.x>0?1:-1);return"\n                M"+(n.subjectPosition.x+n.subjectShape.cx)+","+(n.subjectPosition.y+n.subjectShape.cy)+"\n                l"+n.annotationPosition.x+","+n.annotationPosition.y+"\n                l"+i+",0\n            "}),r.append("circle").attr("draggy",10).call((0,o.drag)().on("start",S).on("drag",k(n)).on("end",I)),i.merge(r).select("circle").attr("r",h.annotation.circle.r).each(function(e){var n=l(t,e),i=n.subjectPosition.x+n.annotationPosition.x+n.subjectShape.cx,o=n.subjectPosition.y+n.annotationPosition.y+n.subjectShape.cy;(0,a.select)(this).attr("cx",i).attr("cy",o)}),r.append("text"),i.merge(r).select("text").each(function(e){var n=l(t,e),i=n.annotationPosition.x>0?10:-1*h.annotation.text.w,o=n.subjectPosition.x+n.annotationPosition.x+i+n.subjectShape.cx,r=n.subjectPosition.y+n.annotationPosition.y+18;(0,a.select)(this).attr("transform","translate("+o+", "+r+")")}).text(function(t){return t.data.note}).call(s.wrapText,h.annotation.text.w-5)}}(t,w.annotations,e),function(t){(0,a.selectAll)("."+y.FLOW_BUCKET).style("display",t.flowBuckets?"initial":"none"),(0,a.selectAll)("."+y.ANNOTATION).style("display",t.annotations?"initial":"none"),(0,a.selectAll)("."+y.FLOW_PENDING).style("display",t.pendingFlows?"initial":"none"),(0,a.selectAll)("."+y.FLOW_REMOVED).style("display",t.removedFlows?"initial":"none")}(t.visibility.layers)}function $(t,e){var n=this,i=null;n.$onInit=function(){(0,l.initialiseData)(n,f);var o=t.find("div")[0];Object.assign(w,function(t){var e=(0,a.select)(t).append("svg").attr("width",h.svg.w).attr("height",h.svg.h).attr("viewBox","0 0 "+h.svg.w+" "+h.svg.h),n=e.append("g").attr("transform","translate(0,0) scale(1)");return{svg:e,container:n,annotations:n.append("g").classed(y.ANNOTATIONS,!0),flows:n.append("g").classed(y.FLOWS,!0),nodes:n.append("g").classed(y.NODES,!0)}}(o)),w.svg.on("contextmenu",b.canvas?(0,d.d3ContextMenu)(b.canvas):null),i=(0,s.responsivefy)(w.svg),function(t){var e=(0,r.zoom)().scaleExtent([.25,2]).on("zoom",function(){var e=a.event.transform;t([{command:"TRANSFORM_DIAGRAM",payload:e}])});(0,a.select)("body").on("keyup.zoom",function(){w.svg.on(".zoom",null)}),(0,a.select)("body").on("keydown.zoom",function(){(a.event.metaKey||a.event.ctrlKey)&&w.svg.call(e).on("dblclick.zoom",null)})}(e.processCommands),n.$onChanges()},e.onChange(function(){return R(e.getState(),e.processCommands)}),n.$onChanges=function(t){Object.assign(b,m,n.contextMenus||{}),Object.assign(z,v,n.clickHandlers||{}),R(e.getState(),e.processCommands)},n.$onDestroy=function(){i()}}$.$inject=["$element","FlowDiagramStateService"];var _={template:u.default,bindings:{contextMenus:"<",clickHandlers:"<"},controller:$};e.default=_},1054:function(t,e){t.exports="<div class=waltz-flow-diagram> </div>"},1055:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=d(n(1)),a=n(0),o=n(81),r=n(12),l=n(74),s=d(n(1056));function d(t){return t&&t.__esModule?t:{default:t}}var c={logicalFlows:[],existingEntities:[],node:null,isUpstream:!0,commandProcessor:function(){return console.log("wfdlfp: default command processor")},onDismiss:function(){return console.log("wfdlfp: default on-dismiss")}};function u(t){var e=this;e.$onInit=function(){return(0,a.initialiseData)(e,c)},e.$onChanges=function(n){var a=e.isUpstream?"Select upstream nodes from the list below:":"Select downstream nodes from the list below:",o=e.isUpstream?"Upstream":"Downstream";e.description=a,e.title="Add "+o+" nodes for "+e.node.name,e.flows=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=n?"source":"target",l=n?"target":"source";return i.default.chain(t).filter(function(t){return t[l].id===e.id}).reject(function(t){return t[o].id===e.id}).map(function(t){return Object.assign({},t,{kind:"LOGICAL_DATA_FLOW"})}).map(function(t){var e=t[o],n=i.default.some(a,function(e){return(0,r.sameRef)(e,t)});return{counterpartEntity:e,logicalFlow:t,used:n,existing:n}}).sortBy(function(t){return t.counterpartEntity.name.toLowerCase()}).value()}(e.logicalFlows,e.node,e.isUpstream,e.existingEntities),e.logicalFlowAdditionUrl=t.href((0,l.kindToViewState)(e.node.kind),{id:e.node.id})},e.update=function(){var t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],a=arguments[3],l=i.default.filter(t,function(t){return!t.existing&&t.used}),s=i.default.filter(t,function(t){return t.existing&&!t.used}),d=i.default.chain(l).reject(function(t){return i.default.some(e,function(e){return(0,r.sameRef)(e,t.counterpartEntity)})}).flatMap(function(t){var e={command:"ADD_NODE",payload:t.counterpartEntity},r=i.default.random(-80,80),l=i.default.random(50,80)*(n?-1:1);return[e,{command:"MOVE",payload:{id:(0,o.toGraphId)(t.counterpartEntity),refId:(0,o.toGraphId)(a),dx:r,dy:l}}]}).value(),c=i.default.map(l,function(t){return{command:"ADD_FLOW",payload:t.logicalFlow}}),u=i.default.map(s,function(t){return{command:"REMOVE_FLOW",payload:{id:(0,o.toGraphId)(t.logicalFlow),source:(0,o.toGraphId)(t.logicalFlow.source),target:(0,o.toGraphId)(t.logicalFlow.target)}}});return i.default.concat(d,c,u)}(e.flows,e.existingEntities,e.isUpstream,e.node);e.commandProcessor(t)}}u.$inject=["$state"];var p={template:s.default,bindings:{logicalFlows:"<",existingEntities:"<",node:"<",isUpstream:"<",commandProcessor:"<",onDismiss:"<"},controller:u};e.default=p},1056:function(t,e){t.exports='<h4 ng-bind=$ctrl.title></h4> <p ng-bind=$ctrl.description></p> <div ng-show="$ctrl.flows.length > 6"> <input ng-model=$ctrl.qry type=search placeholder=Filter... class="form-control form-search"> <br> </div> <div ng-class="{ \'waltz-scroll-region-250\' : $ctrl.flows.length > 6}"> <table class="table table-condensed small"> <tr ng-repeat="flow in $ctrl.flows | orderBy: \'entity.name\' | filter: $ctrl.qry"> <td> <label> <input type=checkbox ng-model=flow.used> <waltz-entity-icon-label entity-ref=flow.counterpartEntity> </waltz-entity-icon-label> </label> </td> </tr> </table> </div> <div waltz-has-role=LOGICAL_DATA_FLOW_EDITOR> Can\'t find what you\'re looking for? Click <a class=clickable ng-click=$ctrl.onDismiss() ng-href="{{ $ctrl.logicalFlowAdditionUrl }}" target=_blank rel="noopener noreferrer"> here </a> to add a new node. </div> <hr> <button class="btn btn-success" ng-click=$ctrl.update()> Update </button> <a class=clickable ng-click=$ctrl.onDismiss()> Cancel </a> '},1057:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=l(n(1)),a=n(0),o=n(81),r=l(n(1058));function l(t){return t&&t.__esModule?t:{default:t}}var s={existingEntities:[],selectedNode:null};function d(){var t=this;t.$onInit=function(){return(0,a.initialiseData)(t,s)},t.onNodeSelected=function(e){t.selectedNode=e},t.nodeSelectionFilter=function(e){return!i.default.find(t.existingEntities,function(t){return function(t,e){return t.kind===e.kind&&t.id===e.id}(t,e)})},t.send=function(){var e={command:"ADD_NODE",payload:t.selectedNode},n=i.default.random(-80,80),a=i.default.random(50,80),r={command:"MOVE",payload:{id:(0,o.toGraphId)(t.selectedNode),dx:n,dy:a}};t.commandProcessor([e,r])}}d.$inject=[];var c={template:r.default,bindings:{onDismiss:"<",existingEntities:"<",commandProcessor:"<"},controller:d};e.default=c},1058:function(t,e){t.exports='<h4>Add a new node</h4> <div> <p class="small text-muted"> Nodes that already exist in the diagram will not appear in search </p> </div> <div> <waltz-entity-selector on-select=$ctrl.onNodeSelected entity-kinds="[\'APPLICATION\', \'ACTOR\']" selection-filter=$ctrl.nodeSelectionFilter> </waltz-entity-selector> </div> <div class=waltz-popup-actions> <a class="btn btn-success clickable" ng-click=$ctrl.send()> Add </a> <a class=clickable ng-click=$ctrl.onDismiss()> Cancel </a> </div> '},1059:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1)),a=n(0),o=r(n(1060));function r(t){return t&&t.__esModule?t:{default:t}}var l={logicalFlows:[],existingEntities:[],commandProcessor:function(){return console.log("wdpfp: default command processor")},onDismiss:function(){return console.log("wdpfp: default on-dismiss")}};function s(t){var e=this;e.$onInit=function(){return(0,a.initialiseData)(e,l)},e.$onChanges=function(n){e.description="Define the physical flows",e.title="Define Physical Flows",e.flows=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=i.default.keyBy(e,"id");return i.default.chain(t).map(function(t){var e=i.default.some(n,function(e){return function(t,e){return t.kind===e.kind&&t.id===e.id}(e,{kind:"PHYSICAL_FLOW",id:t.id})});return{used:e,existing:e,physicalFlow:t,specification:a[t.specificationId]}}).sortBy(function(t){return t.specification.name.toLowerCase()}).value()}(e.physicalFlows,e.physicalSpecifications,e.existingEntities),e.physicalFlowRegisterUrl=t.href("main.physical-flow.registration",{kind:e.logicalFlow.source.kind,id:e.logicalFlow.source.id,targetLogicalFlowId:e.logicalFlow.id})},e.update=function(){var t=i.default.filter(e.flows,function(t){return!t.existing&&t.used}),n=i.default.filter(e.flows,function(t){return t.existing&&!t.used}),a=i.default.map(t,function(t){return{command:"ADD_DECORATION",payload:{ref:{id:e.logicalFlow.id,kind:e.logicalFlow.kind},decoration:{id:t.physicalFlow.id,kind:"PHYSICAL_FLOW"}}}}),o=i.default.map(n,function(t){return{command:"REMOVE_DECORATION",payload:{ref:{id:e.logicalFlow.id,kind:e.logicalFlow.kind},decoration:{id:t.physicalFlow.id,kind:"PHYSICAL_FLOW"}}}});e.commandProcessor(a),e.commandProcessor(o)}}s.$inject=["$state"];var d={template:o.default,bindings:{logicalFlow:"<",physicalFlows:"<",physicalSpecifications:"<",existingEntities:"<",commandProcessor:"<",onDismiss:"<"},controller:s};e.default=d},1060:function(t,e){t.exports='<h4 ng-bind=$ctrl.title></h4> <p ng-bind=$ctrl.description></p> <h5>Relevant Flows:</h5> <div ng-show="$ctrl.flows.length > 6"> <input type=search placeholder=Filter.. ng-model=$ctrl.qry class="form-control waltz-search-control"> <br> </div> <div ng-class="{ \'waltz-scroll-region-250\' : $ctrl.flows.length > 6 }"> <table class="table table-condensed small"> <thead> <tr> <th>Name</th> <th>Details</th> </tr> </thead> <tbody> <tr ng-repeat="flow in $ctrl.flows | filter: $ctrl.qry" class=waltz-visibility-parent> <td> <label> <input type=checkbox id=flow_${flow.physicalFlow.id} ng-model=flow.used> <span ng-bind=flow.specification.name> </span> </label> </td> <td> <div class=small> <span ng-bind="flow.specification.format | toDisplayName:\'dataFormatKind\'"></span> , <span ng-bind="flow.physicalFlow.frequency | toDisplayName:\'frequencyKind\'"></span> , <span ng-bind="flow.physicalFlow.transport | toDisplayName:\'transportKind\'"></span> </div> </td> </tr> </tbody> </table> </div> <div waltz-has-role=LOGICAL_DATA_FLOW_EDITOR> Can\'t find what you\'re looking for? Click <a class=clickable ng-click=$ctrl.onDismiss() ng-href={{$ctrl.physicalFlowRegisterUrl}} target=_blank rel="noopener noreferrer"> here </a> to register a new physical flow. </div> <hr> <button class="btn btn-success" ng-click=$ctrl.update()> Update </button> <a class=clickable ng-click=$ctrl.onDismiss()> Cancel </a> '},1061:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(81),o=function(t){return t&&t.__esModule?t:{default:t}}(n(1062));var r={};function l(){var t=this;t.$onInit=function(){return(0,i.initialiseData)(t,r)},t.$onChanges=function(e){t.title=t.annotation.id?"Update Annotation":"Add Annotation",t.actionLabel=t.annotation.id?"Update":"Add",t.note=t.annotation.note},t.send=function(){var e=[];if(t.annotation.id)e.push({command:"UPDATE_ANNOTATION",payload:{note:t.note,id:(0,a.toGraphId)(t.annotation)}});else{var n=Object.assign({},t.annotation,{note:t.note,id:+new Date+"",kind:"ANNOTATION"});e.push({command:"ADD_ANNOTATION",payload:n}),e.push({command:"MOVE",payload:{id:(0,a.toGraphId)(n),dx:30,dy:30}})}t.commandProcessor(e)}}l.$inject=[];var s={template:o.default,bindings:{onDismiss:"<",annotation:"<",commandProcessor:"<"},controller:l};e.default=s},1062:function(t,e){t.exports='<h4 ng-bind=$ctrl.title></h4> <p ng-bind=$ctrl.description></p> <div> <textarea cols=50 rows=5 placeholder="Description ..." ng-model=$ctrl.note>\n    </textarea> </div> <hr> <a class="btn btn-success clickable" ng-click=$ctrl.send() ng-bind=$ctrl.actionLabel> </a> <a class=clickable ng-click=$ctrl.onDismiss()> Cancel </a>'},1063:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(0),o=function(t){return t&&t.__esModule?t:{default:t}}(n(1064)),r=n(2);var l={visibility:{disjointNodePopup:!1,logicalFlowPopup:!1,annotationPopup:!1,physicalFlowPopup:!1,diagramInfoPopup:!1},popup:{title:"",description:""}};function s(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments[2],i=arguments[3];if(t&&n)return n.findByEntityReference(t.data).then(function(n){return{logicalFlows:n,node:t.data,existingEntities:i.getAllEntities(),isUpstream:e}})}function d(t){if(t)return{annotation:{entityReference:{kind:t.data.kind,id:t.data.id}}}}function c(t,e,n,a,o,r){return function(l){var s={title:"Remove Flow",action:function(t,e,n){return a.processCommands([{command:"REMOVE_FLOW",payload:e}])}};return l.data.isRemoved?[s]:[{title:"Add annotation",action:function(t,i,a){e(function(){var t=d(i);n.popup=t,n.visibility.annotationPopup=!0,n.visibility.anyPopup=!0})}},{title:"Define physical flows",action:function(l,s,d){e(function(){(function(t,e,n,a,o){var r={entityReference:{id:e.id,kind:e.kind},scope:"EXACT"},l=n.findByLogicalFlowId(e.id),s=a.findBySelector(r);return t.all([l,s]).then(function(t){var n=i(t,2),a=n[0],r=void 0===a?[]:a,l=n[1];return{logicalFlow:e,physicalFlows:r,physicalSpecifications:void 0===l?[]:l,existingEntities:o.getAllEntities()}})})(t,s.data,o,r,a).then(function(t){n.popup=t,n.visibility.physicalFlowPopup=!0,n.visibility.anyPopup=!0})})}},{divider:!0},s]}}function u(t,e,n,i,o,u,p,f,m,g){var v=(0,a.initialiseData)(this,l);v.contextMenus={canvas:function(t,e,n){return function(i){return[{title:function(t){return"Add an actor or application"},action:function(i,a,o){t(function(){var t={existingEntities:n.getAllEntities()};e.popup=t,e.visibility.disjointNodePopup=!0,e.visibility.anyPopup=!0})}}]}}(n,v,i),node:function(t,e,n,i){return function(a){return[{title:function(t){return"Add upstream source to "+t.data.name},action:function(a,o){t(function(){s(o,!0,e,i).then(function(t){n.popup=t,n.visibility.logicalFlowPopup=!0,n.visibility.anyPopup=!0})})}},{title:function(t){return"Add downstream target from "+t.data.name},action:function(a,o,r){t(function(){s(o,!1,e,i).then(function(t){n.popup=t,n.visibility.logicalFlowPopup=!0,n.visibility.anyPopup=!0})})}},{title:function(t){return"Add annotation to "+t.data.name},action:function(e,i,a){t(function(){n.popup=d(i),n.visibility.annotationPopup=!0})}},{divider:!0},{title:function(t){return"Remove "+t.data.name},action:function(t,e,i){return n.issueCommands([{command:"REMOVE_NODE",payload:e}])}}]}}(n,o,v,i),flowBucket:c(t,n,v,i,p,f),annotation:function(t,e,n){return function(i){return[{title:"Edit",action:function(t,i,a){e(function(){var t=function(t){if(t)return{annotation:t.data}}(i);n.popup=t,n.visibility.annotationPopup=!0,n.visibility.anyPopup=!0})}},{divider:!0},{title:"Remove",action:function(e,n,i){t([{command:"REMOVE_ANNOTATION",payload:n}])}}]}}(i.processCommands,n,v)},m.setupWarningDialog(e,function(){return i.isDirty()}),v.issueCommands=function(t){i.processCommands(t),v.onDismissPopup()},v.onDismissPopup=function(){v.visibility.annotationPopup=!1,v.visibility.disjointNodePopup=!1,v.visibility.logicalFlowPopup=!1,v.visibility.physicalFlowPopup=!1,v.visibility.diagramInfoPopup=!1,v.visibility.anyPopup=!1},v.doSave=function(){i.save().then(function(t){return v.id=t}).then(function(){return u.success("Saved")})},v.$onChanges=function(t){var e=i.getState();v.title=e.model.title,v.id=e.diagramId,v.description=e.model.description},v.onOpenDiagramInfoPopup=function(){v.visibility.diagramInfoPopup=!0,v.visibility.anyPopup=!0},v.onSaveTitle=function(t,e){i.processCommands([{command:"SET_TITLE",payload:e.newVal}]),v.title=e.newVal,i.updateName().then(function(){return u.success("Saved Title")})},v.onSaveDescription=function(t,e){i.processCommands([{command:"SET_DESCRIPTION",payload:e.newVal}]),v.description=e.newVal,i.updateDescription().then(function(){return u.success("Saved Description")})},v.doRemove=function(){confirm("Are you sure you wish to delete this diagram ?")&&g.execute(r.CORE_API.FlowDiagramStore.deleteForId,[v.id]).then(function(){i.reset(),v.onCancel(),u.warning("Diagram deleted")})}}u.$inject=["$q","$scope","$timeout","FlowDiagramStateService","LogicalFlowStore","Notification","PhysicalFlowStore","PhysicalSpecificationStore","PreventNavigationService","ServiceBroker"];var p={template:o.default,bindings:{parentEntityRef:"<",onCancel:"<",onView:"<"},controller:u};e.default=p},1064:function(t,e){t.exports='<div class=waltz-flow-diagram-editor> <div class=row> <div class=col-md-12> <h4> <waltz-editable-field type=text on-save=$ctrl.onSaveTitle save-label=Save initial-val=$ctrl.title> </waltz-editable-field> <waltz-editable-field type=text on-save=$ctrl.onSaveDescription save-label=Save initial-val=$ctrl.description empty-label="No description provided" class="small text-muted"> </waltz-editable-field> </h4> <div> <button class="btn btn-xs btn-success" ng-click=$ctrl.doSave()> <waltz-icon name=cloud-upload> </waltz-icon> Save </button> | <a ng-click=$ctrl.onOpenDiagramInfoPopup() class=clickable> <waltz-icon name=edit> </waltz-icon> Relationships </a> | <button class="btn btn-xs btn-danger" ng-click=$ctrl.doRemove()> <waltz-icon name=trash> </waltz-icon> Delete </button> | <a ng-click=$ctrl.onCancel() class=clickable> <waltz-icon name=close> </waltz-icon> Cancel </a> </div> </div> </div> <div class=row> <div class=col-md-12> <div ng-class="{ \'wfde-dim\' : $ctrl.visibility.anyPopup }"> <waltz-flow-diagram context-menus=$ctrl.contextMenus> </waltz-flow-diagram> </div> </div> </div> <div class=row> <div class=col-md-12> <h5>Help</h5> <div class="help-block small small"> Use the context menu (typically <i>right mouse button</i>) to display menu options: <ul class=small style=padding-left:14px> <li>Use add/remove upstream/downstream nodes to illustrate the logical flows</li> <li>Add annotations to describe in more detail what is happening</li> <li>Decorate flows by describing the associated physical flows</li> </ul> </div> <div class="help-block small small"> This diagram may be moved and re-sized by holding down <kbd>ctrl</kbd> and dragging and/or zooming. The node colour indicates the type; green for applications, red for end user applications and purple for actors. </div> </div> </div> <div class="wfde-pop waltz-fade-if" ng-if=$ctrl.visibility.logicalFlowPopup> <waltz-flow-diagram-logical-flow-popup on-dismiss=$ctrl.onDismissPopup logical-flows=$ctrl.popup.logicalFlows node=$ctrl.popup.node existing-entities=$ctrl.popup.existingEntities is-upstream=$ctrl.popup.isUpstream command-processor=$ctrl.issueCommands> </waltz-flow-diagram-logical-flow-popup> </div> <div class="wfde-pop waltz-fade-if" ng-if=$ctrl.visibility.physicalFlowPopup> <waltz-flow-diagram-physical-flow-popup on-dismiss=$ctrl.onDismissPopup logical-flow=$ctrl.popup.logicalFlow physical-flows=$ctrl.popup.physicalFlows physical-specifications=$ctrl.popup.physicalSpecifications existing-entities=$ctrl.popup.existingEntities command-processor=$ctrl.issueCommands> </waltz-flow-diagram-physical-flow-popup> </div> <div class="wfde-pop waltz-fade-if" ng-if=$ctrl.visibility.annotationPopup> <waltz-flow-diagram-annotation-popup on-dismiss=$ctrl.onDismissPopup annotation=$ctrl.popup.annotation command-processor=$ctrl.issueCommands> </waltz-flow-diagram-annotation-popup> </div> <div class="wfde-pop waltz-fade-if" ng-if=$ctrl.visibility.disjointNodePopup> <waltz-flow-diagram-node-popup on-dismiss=$ctrl.onDismissPopup existing-entities=$ctrl.popup.existingEntities command-processor=$ctrl.issueCommands> </waltz-flow-diagram-node-popup> </div> <div class="wfde-pop waltz-fade-if" ng-if=$ctrl.visibility.diagramInfoPopup> <waltz-flow-diagram-info-popup on-dismiss=$ctrl.onDismissPopup> </waltz-flow-diagram-info-popup> </div> </div> '},1065:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=l(n(1)),a=l(n(1066)),o=n(0),r=n(2);function l(t){return t&&t.__esModule?t:{default:t}}var s={};function d(t){var e=(0,o.initialiseData)(this,s);e.$onInit=function(){t.loadViewData(r.CORE_API.FlowDiagramStore.findByEntityReference,[e.parentEntityRef],{force:!0}).then(function(t){e.diagrams=i.default.orderBy(t.data,"name")})}}d.$inject=["ServiceBroker"];var c={controller:d,template:a.default,bindings:{parentEntityRef:"<",canCreate:"<",onSelectDiagram:"<",onCreateDiagram:"<?",onEditDiagram:"<?"}};e.default={component:c,id:"waltzFlowDiagramsPanelBrowse"}},1066:function(t,e){t.exports='<div> <h4>Flow Diagrams</h4> <div ng-if="$ctrl.diagrams.length > 0"> <div ng-class="{ \'waltz-scroll-region-400\' : $ctrl.diagrams.length > 9 }" style=padding-bottom:6px> <input type=search placeholder=Filter... ng-if="$ctrl.diagrams.length > 5" class="form-search form-control input-sm" style=margin-bottom:.5em ng-model=$ctrl.qry> <table class="table table-condensed table-hover small"> <thead> <tr> <th>Diagram</th> <th>Last Modified</th> <th>Actions</th> </tr> </thead> <tbody> <tr ng-repeat="diagram in $ctrl.diagrams | filter:$ctrl.qry"> <td> <a ng-bind=diagram.name class=clickable ng-click=$ctrl.onSelectDiagram(diagram)> </a> </td> <td> <span class=small> <waltz-last-updated entity=diagram> </waltz-last-updated> </span> </td> <td> <div waltz-has-role=LINEAGE_EDITOR> <a class=clickable ng-click=$ctrl.onEditDiagram(diagram)> Edit </a> | <a class=clickable ng-click=$ctrl.onCloneDiagram(diagram)> Clone </a> </div> </td> </tr> </tbody> <tbody ng-if=$ctrl.canCreate> <tr waltz-has-role=LINEAGE_EDITOR> <td colspan=3> <div style=margin-top:2px> <a class=clickable ng-click=$ctrl.onCreateDiagram()> <waltz-icon name=plus></waltz-icon> Create new diagram </a> </div> </td> </tr> </tbody> </table> </div> </div> <waltz-no-data ng-if="$ctrl.diagrams.length == 0"> <message> No diagrams. <span waltz-has-role=LINEAGE_EDITOR> <a ng-click=$ctrl.onCreateDiagram() class=clickable> Create one? </a> </span> </message> </waltz-no-data> </div>'},1067:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=u(n(1)),o=u(n(1068)),r=n(0),l=n(2),s=n(17),d=n(392),c=n(393);function u(t){return t&&t.__esModule?t:{default:t}}var p={contextPopup:{entityReference:null,entity:null,styling:{}},visibility:{layers:{},menuPopup:!1,contextPopup:!1}};function f(t,e,n){var i=a.default.get(n,"[0].parentElement.clientWidth"),o=a.default.get(n,"[0].parentElement.clientHeight"),r=i/2;return{top:function(t,e,n){var i=e>c.pageHeaderDefaultOffset?40:0,a=e>d.dyamicSectionNavigationDefaultOffset?40:0,o=n/2,r=t.pageY||t.clientY+e;return(r-o>e?r-o:e)+60+i+a}(t,e.pageYOffset,o)+"px",left:(t.clientX<r?t.clientX:t.clientX-r)+"px"}}function m(t,e,n,o,d,c){var u=(0,r.initialiseData)(this,p),m=function(){return u.visibility.layers=d.getState().visibility.layers};u.$onInit=function(){c.loadViewData(l.CORE_API.FlowDiagramStore.getById,[u.parentEntityRef.id],{force:!0}).then(function(t){return u.diagram=t.data}),d.reset(),d.load(u.parentEntityRef.id).then(function(){return m()})},u.toggleLayer=function(t){var e={command:d.getState().visibility.layers[t]?"HIDE_LAYER":"SHOW_LAYER",payload:t};d.processCommands([e]),m()};u.clickHandlers={node:function(e){o(function(){return u.visibility.contextPopup=!1}),u.contextPopup.styling=f(event,n,t);var i=e.data;"APPLICATION"===i.kind&&c.loadViewData(l.CORE_API.ApplicationStore.getById,[i.id]).then(function(t){o(function(){u.contextPopup.entityReference=i,u.contextPopup.entity=t.data,u.visibility.contextPopup=!0})})},flowBucket:function(r){o(function(){return u.visibility.contextPopup=!1}),u.contextPopup.styling=f(event,n,t);var p=d.getState(),m=["model","decorations",r.id],g=a.default.chain(p).get(m).map("data").map("id").value(),v=(0,s.mkSelectionOptions)(u.parentEntityRef),y=c.loadViewData(l.CORE_API.PhysicalFlowStore.findBySelector,[v]).then(function(t){return t.data}),h=c.loadViewData(l.CORE_API.PhysicalSpecificationStore.findBySelector,[v]).then(function(t){return t.data});e.all([y,h]).then(function(t){var e=i(t,2),n=e[0],o=e[1],l=a.default.keyBy(n,"id"),s=a.default.keyBy(o,"id"),d=a.default.chain(g).map(function(t){var e=l[t],n=e.specificationId;return{physicalFlow:e,physicalSpecification:s[n]}}).orderBy("physicalSpecification.name").value();u.contextPopup.entityReference=r.data,u.contextPopup.entity={logical:r,physical:d},u.visibility.contextPopup=!0})}}}m.$inject=["$element","$q","$window","$timeout","FlowDiagramStateService","ServiceBroker"];var g={controller:m,template:o.default,bindings:{parentEntityRef:"<",onEditDiagram:"<",onDismissDiagram:"<"}};e.default={component:g,id:"waltzFlowDiagramsPanelView"}},1068:function(t,e){t.exports=' <div> <h4> <span ng-bind=$ctrl.diagram.name></span> <small> <span class=text-muted> <waltz-last-updated entity=$ctrl.diagram> </waltz-last-updated> </span> <br> <span class=text-muted ng-bind=$ctrl.diagram.description> </span> </small> </h4> <div> <a ng-click="$ctrl.visibility.menuPopup = ! $ctrl.visibility.menuPopup" class=clickable> <waltz-icon name=filter> </waltz-icon> Show relationships and filters </a> <div waltz-has-role=LINEAGE_EDITOR> | <a class=clickable ng-click=$ctrl.onEditDiagram($ctrl.diagram)> <waltz-icon name=edit> </waltz-icon> Edit </a> </div> | <a ui-sref="main.flow-diagram.view ({id: $ctrl.diagram.id })" class=clickable> <waltz-icon name=link> </waltz-icon> Permalink </a> | <a ng-click=$ctrl.onDismissDiagram() class=clickable> <waltz-icon name=close> </waltz-icon> Close </a> </div> <waltz-flow-diagram context-menus=$ctrl.contextMenus click-handlers=$ctrl.clickHandlers> </waltz-flow-diagram> <div> <h5>Help</h5> <div class="help-block small small"> This diagram may be moved and re-sized by holding down <kbd>ctrl</kbd> and dragging and/or zooming. The node colour indicates the type; green for applications, red for end user applications and purple for actors. </div> </div> <div ng-if="$ctrl.visibility.contextPopup && $ctrl.contextPopup.entityReference.kind == \'LOGICAL_DATA_FLOW\'" class="waltz-fade-if wfdpv-context-popup small" ng-style=$ctrl.contextPopup.styling> <h5> Data Flows </h5> <waltz-no-data ng-if="$ctrl.contextPopup.entity.physical.length == 0"> <message>No Physical Flows associated</message> </waltz-no-data> <table class="table table-condesed small"> <tr ng-repeat="flow in $ctrl.contextPopup.entity.physical"> <td> <a ui-sref="main.physical-flow.view ({id: flow.physicalFlow.id })"> <span ng-bind=flow.physicalSpecification.name></span> </a> </td> <td><span ng-bind="flow.physicalSpecification.format | toDisplayName:\'dataFormatKind\'"></span></td> <td><span ng-bind="flow.physicalFlow.transport | toDisplayName:\'transportKind\'"></span></td> <td><span ng-bind="flow.physicalFlow.frequency | toDisplayName:\'frequencyKind\'"></span></td> </tr> </table> <div class=waltz-popup-actions> <a ng-click="$ctrl.visibility.contextPopup = false" class=clickable> <waltz-icon name=close></waltz-icon> Close </a> </div> </div> <div ng-if="$ctrl.visibility.contextPopup && $ctrl.contextPopup.entityReference.kind == \'APPLICATION\'" class="waltz-fade-if wfdpv-context-popup small" ng-style=$ctrl.contextPopup.styling> <h5> <span ng-bind=$ctrl.contextPopup.entity.name> </span> </h5> <table class="waltz-field-table small"> <tr> <td class=wft-label> <span>Asset Code:</span> </td> <td> <span ng-bind=$ctrl.contextPopup.entity.assetCode> </span> </td> </tr> <tr> <td class=wft-label> <span>Criticality:</span> </td> <td> <span ng-bind="$ctrl.contextPopup.entity.businessCriticality | toDisplayName:\'criticality\'"> </span> </td> </tr> <tr> <td class=wft-label> <span>Description:</span> </td> <td> <waltz-markdown text=$ctrl.contextPopup.entity.description></waltz-markdown> </td> </tr> </table> <div class=waltz-popup-actions> <a ng-click="$ctrl.visibility.contextPopup = false" class=clickable> <waltz-icon name=close></waltz-icon> Close </a> | <a class=clickable ui-sref="main.app.view ({id : $ctrl.contextPopup.entity.id })"> Go to app &raquo; </a> </div> </div> <div ng-if=$ctrl.visibility.menuPopup class="waltz-fade-if wfdpv-menu-popup"> <waltz-flow-diagram-measurable-associations read-only=true diagram-id=$ctrl.diagram.id> </waltz-flow-diagram-measurable-associations> <hr> <waltz-flow-diagram-change-initiative-associations read-only=true diagram-id=$ctrl.diagram.id> </waltz-flow-diagram-change-initiative-associations> <hr> <div> <h5>Layers</h5> <div class=small> <waltz-toggle style=display:block label-on=Annotations label-off=Annotations state=$ctrl.visibility.layers.annotations on-toggle="$ctrl.toggleLayer(\'annotations\')"> </waltz-toggle> <waltz-toggle style=display:block label-on="Physical Flows" label-off="Physical Flows" state=$ctrl.visibility.layers.flowBuckets on-toggle="$ctrl.toggleLayer(\'flowBuckets\')"> </waltz-toggle> <waltz-toggle style=display:block label-on="Pending Flows" label-off="Pending Flows" state=$ctrl.visibility.layers.pendingFlows on-toggle="$ctrl.toggleLayer(\'pendingFlows\')"> </waltz-toggle> <waltz-toggle style=display:block label-on="Removed Flows" label-off="Removed Flows" state=$ctrl.visibility.layers.removedFlows on-toggle="$ctrl.toggleLayer(\'removedFlows\')"> </waltz-toggle> </div> <div class="help-block small small"> Toggle the layers to show more/less detail. </div> </div> <div class=waltz-popup-actions> <a class=clickable ng-click="$ctrl.visibility.menuPopup = false"> <waltz-icon name=close></waltz-icon> Close </a> </div> </div> </div>'},1070:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=d(n(1)),o=d(n(1071)),r=n(0),l=n(2),s=n(12);function d(t){return t&&t.__esModule?t:{default:t}}var c={associations:[],visibility:{suggestions:!1,search:!1,inactive:!1},readOnly:!0};function u(t,e){var n=(0,r.initialiseData)(this,c),o=function(){var o=e.loadViewData(l.CORE_API.FlowDiagramEntityStore.findByDiagramId,[n.diagramId],{force:!0}).then(function(t){return a.default.chain(t.data).map("entityReference").filter(function(t){return"MEASURABLE"===t.kind}).value()}),r=e.loadViewData(l.CORE_API.MeasurableStore.findMeasurablesBySelector,[n.diagramRef],{force:!0}).then(function(t){return t.data}),s=e.loadAppData(l.CORE_API.MeasurableCategoryStore.findAll,[]).then(function(t){return t.data});t.all([o,r,s]).then(function(t){var e=i(t,3),o=e[0],r=e[1],l=e[2],s=a.default.map(o,"id"),d=a.default.keyBy(r,"id");n.associatedMeasurables=a.default.chain(s).map(function(t){return d[t]}).sortBy("name").value(),n.suggestedMeasurables=a.default.chain(r).reject(function(t){return a.default.includes(s,t.id)}).sortBy("name").value(),n.categories=a.default.sortBy(l,"name")})};function d(){n.visibility.search=!1,n.visibility.suggestions=!1}n.$onChanges=function(){n.diagramId?(n.diagramRef={entityReference:{kind:"FLOW_DIAGRAM",id:n.diagramId},scope:"EXACT"},o(),n.visibility.inactive=!1):n.visibility.inactive=!0},n.onShowSearch=function(){d(),n.visibility.search=!0},n.onShowSuggestions=function(){d(),n.visibility.suggestions=!0},n.doSearch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments[1];0!==a.default.size(t)?e.loadAppData(l.CORE_API.MeasurableStore.findAll,[]).then(function(e){var o=a.default.filter(e.data,function(t){return!i||t.categoryId===i.id});n.searchResults=(0,r.termSearch)(o,t,["name"])}):n.searchResults=[]},n.onRemove=function(t){e.execute(l.CORE_API.FlowDiagramEntityStore.removeRelationship,[n.diagramId,(0,s.toEntityRef)(t,"MEASURABLE")]).then(function(){return o()})},n.onAdd=function(t){d(),e.execute(l.CORE_API.FlowDiagramEntityStore.addRelationship,[n.diagramId,(0,s.toEntityRef)(t,"MEASURABLE")]).then(function(){return o()})}}u.$inject=["$q","ServiceBroker"];var p={template:o.default,bindings:{diagramId:"<",readOnly:"<"},controller:u};e.default={component:p,id:"waltzFlowDiagramMeasurableAssociations"}},1071:function(t,e){t.exports='<h5> <waltz-icon name=puzzle-piece></waltz-icon> Associated Viewpoints </h5> <div class=small> <table class="table table-condensed small" style=background-color:#fff> <tr ng-if="$ctrl.associatedMeasurables.length == 0"> <td colspan=2>No associated viewpoints</td> </tr> <tbody> <tr ng-repeat="measurable in $ctrl.associatedMeasurables"> <td> <a ng-if=$ctrl.readOnly class=clickable ui-sref="main.measurable.view ({id: measurable.id })" ng-bind=measurable.name> </a> <div ng-if=!$ctrl.readOnly ng-bind=measurable.name></div> <div class="small text-muted" ng-bind="measurable.categoryId | toDisplayName:\'measurableCategory\'"> </div> </td> <td ng-if=!$ctrl.readOnly> <a ng-click=$ctrl.onRemove(measurable) class=clickable> <waltz-icon name=trash title=remove></waltz-icon> </a> </td> </tr> </tbody> <tfoot ng-hide="$ctrl.readOnly || $ctrl.visibility.suggestions || $ctrl.visibility.search"> <tr> <td colspan=2> <a class=clickable ng-click=$ctrl.onShowSuggestions()> <waltz-icon name=plus></waltz-icon> Add </a> </td> </tr> </tfoot> </table> <div> <div ng-if=$ctrl.visibility.suggestions class=waltz-fade-if> <small> The following viewpoints are suggestions based upon actual usage by applications in this diagram. Select one to add an explicit association. </small> <br> <div class=waltz-scroll-region-200 style=background-color:#fff> <table class="table small table-condensed"> <tr ng-repeat="suggestion in $ctrl.suggestedMeasurables"> <td> <a ng-bind=suggestion.name ng-click=$ctrl.onAdd(suggestion) class=clickable></a> <div class="small text-muted" ng-bind="suggestion.categoryId | toDisplayName:\'measurableCategory\'"> </div> </td> </tr> </table> </div> <br> <div class=small> Can\'t find what you are looking for ? Try <a class=clickable ng-click=$ctrl.onShowSearch()> searching... </a> </div> </div> <div ng-if=$ctrl.visibility.search class=waltz-fade-if> <input type=search class="form-control form-search input-sm" placeholder=Search... ng-model=searchQry ng-model-options="{ debounce: 200 }" ng-change="$ctrl.doSearch(searchQry, searchCategory)"> <div ng-if="$ctrl.searchResults.length > 0" ng-class="{ \'waltz-scroll-region-200\' : $ctrl.searchResults.length > 10 }" class=waltz-fade-if> <table class="table small table-condensed"> <tr ng-repeat="result in $ctrl.searchResults"> <td> <a ng-bind=result.name ng-click=$ctrl.onAdd(result) class=clickable></a> <div class="small text-muted" ng-bind="result.categoryId | toDisplayName:\'measurableCategory\'"> </div> </td> </tr> </table> </div> <div> <br> <small> Restrict your search results to a particular category using the drop down selection below. </small> <br> <select class="form-control input-sm" ng-model=searchCategory ng-change="$ctrl.doSearch(searchQry, searchCategory)" ng-options="x as x.name for x in $ctrl.categories"> </select> </div> <br> <small> Go back to the <a class=clickable ng-click=$ctrl.onShowSuggestions()> suggestions </a> </small> </div> </div> </div> '},1072:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=d(n(1)),a=n(0),o=n(2),r=d(n(1073)),l=n(17),s=n(12);function d(t){return t&&t.__esModule?t:{default:t}}var c={associations:[],visibility:{add:!1}};function u(t){var e=(0,a.initialiseData)(this,c),n=function(){t.loadViewData(o.CORE_API.ChangeInitiativeStore.findBySelector,[(0,l.mkSelectionOptions)({id:e.diagramId,kind:"FLOW_DIAGRAM"})],{force:!0}).then(function(t){return e.associations=i.default.sortBy(t.data,"name")})};e.$onInit=function(){n()},e.onRemove=function(i){t.execute(o.CORE_API.FlowDiagramEntityStore.removeRelationship,[e.diagramId,(0,s.toEntityRef)(i,"CHANGE_INITIATIVE")]).then(function(){return n()})},e.onShowAdd=function(){e.visibility.add=!0},e.onHideAdd=function(){e.visibility.add=!1},e.onAdd=function(i){t.execute(o.CORE_API.FlowDiagramEntityStore.addRelationship,[e.diagramId,i]).then(function(){n(),e.onHideAdd()})}}u.$inject=["ServiceBroker"];var p={template:r.default,bindings:{diagramId:"<",readOnly:"<"},controller:u};e.default={component:p,id:"waltzFlowDiagramChangeInitiativeAssociations"}},1073:function(t,e){t.exports='<h5> <waltz-icon name=paper-plane-o></waltz-icon> Associated Change Initiatives </h5> <div class=small> <table class="table table-condensed small" style=background-color:#fff> <tr ng-if="$ctrl.associations.length == 0"> <td colspan=2>No associated change initiatives</td> </tr> <tbody> <tr ng-repeat="association in $ctrl.associations track by association.id"> <td> <a ng-if=$ctrl.readOnly class=clickable ui-sref="main.change-initiative.view ({id: association.id })" ng-bind=association.name> </a> <div ng-if=!$ctrl.readOnly ng-bind=association.name></div> <div class="small text-muted" ng-bind="association.kind | toDisplayName:\'changeInitiative\'"> </div> </td> <td ng-if=!$ctrl.readOnly> <a ng-click=$ctrl.onRemove(association) class=clickable> <waltz-icon name=trash title=remove></waltz-icon> </a> </td> </tr> </tbody> <tfoot ng-hide="$ctrl.readOnly || $ctrl.visibility.suggestions || $ctrl.visibility.search"> <tr> <td colspan=2> <a class=clickable ng-click=$ctrl.onShowAdd()> <waltz-icon name=plus></waltz-icon> Add </a> </td> </tr> </tfoot> </table> <div ng-if=$ctrl.visibility.add class=waltz-fade-if> <waltz-entity-selector entity-kinds="[\'CHANGE_INITIATIVE\']" on-select=$ctrl.onAdd selection-filter=$ctrl.searchFilter> </waltz-entity-selector> </div> </div>'},1074:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(n(1075));var o={};function r(t){var e=this;e.$onInit=function(){return(0,i.initialiseData)(e,o)},e.$onChanges=function(n){var i=t.getState();e.title=i.model.title,e.id=i.diagramId}}r.$inject=["FlowDiagramStateService"];var l={template:a.default,bindings:{onDismiss:"<"},controller:r};e.default={component:l,id:"waltzFlowDiagramInfoPopup"}},1075:function(t,e){t.exports="<div> <waltz-flow-diagram-measurable-associations ng-if=$ctrl.id read-only=false diagram-id=$ctrl.id> </waltz-flow-diagram-measurable-associations> <hr> <waltz-flow-diagram-change-initiative-associations ng-if=$ctrl.id read-only=false diagram-id=$ctrl.id> </waltz-flow-diagram-change-initiative-associations> <strong ng-if=!$ctrl.id> Cannot add additional viewpoints until the diagram has been saved </strong> <div class=waltz-popup-actions> <a ng-click=$ctrl.onDismiss() class=clickable> Done </a> </div> </div>"},1076:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={},a={url:"flow-diagram/{id:int}",views:{"content@":function(t){return t&&t.__esModule?t:{default:t}}(n(1077)).default}};function o(t){t.state("main.flow-diagram",i).state("main.flow-diagram.view",a)}o.$inject=["$stateProvider"],e.default=o},1077:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=c(n(1)),o=n(0),r=n(2),l=n(75),s=n(31),d=c(n(1078));function c(t){return t&&t.__esModule?t:{default:t}}var u={visibility:{},appsSection:s.dynamicSections.appsSection,bookmarksSection:s.dynamicSections.bookmarksSection,changeLogSection:s.dynamicSections.changeLogSection,entityStatisticSummarySection:s.dynamicSections.entityStatisticSummarySection,measurableRatingsBrowserSection:s.dynamicSections.measurableRatingsBrowserSection,technologySummarySection:s.dynamicSections.technologySummarySection};function p(t,e,n,s,d,c,p,f,m,g,v){var y=(0,o.initialiseData)(this,u),h=e.id;y.entityReference={id:h,kind:"FLOW_DIAGRAM"};var w=function(){return y.visibility.layers=d.getState().visibility.layers};d.load(h).then(w),c.getById(h).then(function(t){return y.diagram=t}),p.findByDiagramId(h).then(function(t){y.nodes=a.default.chain(t).map("entityReference").filter(function(t){return"APPLICATION"===t.kind||"ACTOR"===t.kind}).sortBy("name").value()});var b={entityReference:{id:h,kind:"FLOW_DIAGRAM"},scope:"EXACT"},z=m.findBySelector(b),E=g.findBySelector(b).then(function(t){return t}),S=v.loadViewData(r.CORE_API.PhysicalSpecDataTypeStore.findBySpecificationSelector,[b]).then(function(t){return t.data}),k=f.findBySelector(b);t.all([k,z,E,S]).then(function(t){var e=i(t,4),n=e[0],o=e[1],r=e[2],l=e[3],d=a.default.keyBy(r,"id"),c=a.default.chain(l).map(function(t){return Object.assign({},t,{dataTypeName:s.lookup("dataType",t.dataTypeId)})}).groupBy("specificationId").value(),u=a.default.map(o,function(t){return Object.assign({},t,{transportName:s.lookup("transportKind",t.transport),frequencyName:s.lookup("frequencyKind",t.frequency),specificationName:d[t.specificationId]?d[t.specificationId].name:"-",specificationDataTypes:c[t.specificationId]||[]})}),p=a.default.groupBy(u,"logicalFlowId");y.flows=a.default.map(n,function(t){return{logicalFlow:t,physicalFlows:p[t.id]||[]}})}),y.clickHandlers={node:function(t){return n(function(){return y.highlightIds=[t.data.id]},0)},flowBucket:function(t){return n(function(){return y.highlightIds=[t.data.id]},0)}},y.toggleLayer=function(t){var e={command:d.getState().visibility.layers[t]?"HIDE_LAYER":"SHOW_LAYER",payload:t};d.processCommands([e]),w()},y.exportDiagramTable=function(){var t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=a.default.flatMap(t,function(t){return t.physicalFlows.length>0?a.default.map(t.physicalFlows,function(e){return[t.logicalFlow.source.name,t.logicalFlow.target.name,e.transportName,e.frequencyName,e.specificationName,a.default.join(a.default.map(e.specificationDataTypes,"dataTypeName"),";")]}):[[t.logicalFlow.source.name,t.logicalFlow.target.name,"","","",""]]});return[["Source","Target","Transport","Frequency","Specification","Data Types"]].concat(e)}(y.flows);(0,l.downloadTextFile)(t,",",y.diagram.name+"_flows.csv")}}p.$inject=["$q","$stateParams","$timeout","DisplayNameService","FlowDiagramStateService","FlowDiagramStore","FlowDiagramEntityStore","LogicalFlowStore","PhysicalFlowStore","PhysicalSpecificationStore","ServiceBroker"];var f={template:d.default,controller:p,controllerAs:"ctrl"};e.default=f},1078:function(t,e){t.exports=' <waltz-page-header name="{{ ctrl.diagram.name }}" icon=picture-o tour=ctrl.tour small="Flow Diagram"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><span>Flow Diagrams</span></li> <li><span ng-bind=ctrl.diagram.name></span></li> </ol> </waltz-page-header> <div class="waltz-page-summary-attach waltz-page-summary"> <div class=row> <div class=col-md-12> <waltz-flow-diagram click-handlers=ctrl.clickHandlers> </waltz-flow-diagram> </div> </div> <div class=row> <div class=col-md-12> <div class="help-block small small"> This diagram may be moved and resized by holding down <kbd>ctrl</kbd> and dragging and/or zooming. </div> <br> <div> <h5>Toggle Layers</h5> <div class=small> <waltz-toggle style=display:block label-on=Annotations label-off=Annotations state=ctrl.visibility.layers.annotations on-toggle="ctrl.toggleLayer(\'annotations\')"> </waltz-toggle> <waltz-toggle style=display:block label-on="Physical Flows" label-off="Physical Flows" state=ctrl.visibility.layers.flowBuckets on-toggle="ctrl.toggleLayer(\'flowBuckets\')"> </waltz-toggle> <waltz-toggle style=display:block label-on="Pending Flows" label-off="Pending Flows" state=ctrl.visibility.layers.pendingFlows on-toggle="ctrl.toggleLayer(\'pendingFlows\')"> </waltz-toggle> <waltz-toggle style=display:block label-on="Removed Flows" label-off="Removed Flows" state=ctrl.visibility.layers.removedFlows on-toggle="ctrl.toggleLayer(\'removedFlows\')"> </waltz-toggle> </div> <div class="help-block small small"> Toggle the layers to show more/less detail. </div> </div> </div> </div> <hr> <div class=row> <div class=col-md-12> <table class="table table-condensed small"> <thead> <tr> <th>Source</th> <th>Target</th> <th>Transport</th> <th>Frequency</th> <th>Specification</th> <th>Data Types</th> </tr> </thead> <tbody ng-repeat="flow in ctrl.flows"> <tr ng-if="flow.physicalFlows.length == 0" ng-class="{ \'waltz-highlighted-row\' : ctrl.highlightIds.indexOf(flow.logicalFlow.id) > -1}"> <td ng-class="{ \'waltz-highlighted-row\' : ctrl.highlightIds.indexOf(flow.logicalFlow.source.id) > -1 }"> <waltz-entity-link entity-ref=flow.logicalFlow.source></waltz-entity-link> </td> <td> <waltz-entity-link entity-ref=flow.logicalFlow.target></waltz-entity-link> </td> <td>-</td> <td>-</td> <td>-</td> <td>-</td> </tr> <tr ng-repeat="physicalFlow in flow.physicalFlows" ng-if="flow.physicalFlows.length > 0" ng-class="{ \'waltz-highlighted-row\' : ctrl.highlightIds.indexOf(flow.logicalFlow.id) > -1}"> <td ng-class="{\n                                \'waltz-highlighted-row\' : ctrl.highlightIds.indexOf(flow.logicalFlow.source.id) > -1\n                            }"> <waltz-entity-link entity-ref=flow.logicalFlow.source> </waltz-entity-link> </td> <td ng-class="{\n                                \'waltz-highlighted-row\' : ctrl.highlightIds.indexOf(flow.logicalFlow.target.id) > -1\n                            }"> <waltz-entity-link entity-ref=flow.logicalFlow.target> </waltz-entity-link> </td> <td><span ng-bind=physicalFlow.transportName></span></td> <td><span ng-bind=physicalFlow.frequencyName></span></td> <td> <a ui-sref="main.physical-flow.view ({id: physicalFlow.id})" class=clickable ng-bind=physicalFlow.specificationName> </a> </td> <td> <ul class=waltz-keyword-list ng-if="physicalFlow.specificationDataTypes.length > 0"> <li ng-repeat="specDataType in physicalFlow.specificationDataTypes" class=wkl-keyword> <span ng-bind=specDataType.dataTypeName> </span> </li> </ul> <span ng-if="physicalFlow.specificationDataTypes.length === 0"> - </span> </td> </tr> </tbody> </table> <a ng-click=ctrl.exportDiagramTable() class="small clickable pull-right" style=text-decoration:none role=button> <waltz-icon name=download></waltz-icon> Export </a> </div> </div> </div> <br> <waltz-dynamic-section-wrapper section=ctrl.measurableRatingsBrowserSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-dynamic-section-wrapper section=ctrl.appsSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-dynamic-section-wrapper section=ctrl.entityStatisticSummarySection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-dynamic-section-wrapper section=ctrl.technologySummarySection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-dynamic-section-wrapper section=ctrl.bookmarksSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-dynamic-section-wrapper section=ctrl.changeLogSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> '},114:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.updateUrlWithoutReload=function(t,e){t.go(".",{id:e.id},{notify:!1})},e.hasRelatedDefinitions=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return(0,a.notEmpty)(t.children)},e.navigateToStatistic=function(t,e,n){var i={id:n.id,kind:n.kind,statId:e},a="PERSON"===n.kind?"main.entity-statistic.view-person":"main.entity-statistic.view";t.go(a,i)},e.mkSummaryTableHeadings=function(t){return["Outcome",function(t){if(!t)return"";return i.rollupKind[t.rollupKind]?i.rollupKind[t.rollupKind].name:"-"}(t),"%"]};var i=n(267),a=n(0);var o={children:[],parent:null}},217:function(t,e,n){"use strict";function i(t,e){var n=e+"/end-user-application";return{findBySelector:function(e){return t.post(n+"/selector",e).then(function(t){return t.data})},countByOrganisationalUnit:function(){return t.get(n+"/count-by/org-unit").then(function(t){return t.data})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.store=i,i.$inject=["$http","BaseApiUrl"];var a=e.serviceName="EndUserAppStore";e.EndUserAppStore_API={findBySelector:{serviceName:a,serviceFnName:"findBySelector",description:"find EUC apps by org unit selector"},countByOrganisationalUnit:{serviceName:a,serviceFnName:"countByOrganisationalUnit",description:"count EUC apps across all OUs"}}},218:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntityEnumStore_API=e.serviceName=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+"/entity-enum";return{findDefinitionsByEntityKind:function(e){return t.get(n+"/definition/"+e).then(function(t){return t.data})},findValuesByEntity:function(e){return(0,i.checkIsEntityRef)(e),t.get(n+"/value/"+e.kind+"/"+e.id).then(function(t){return t.data})}}}a.$inject=["$http","BaseApiUrl"];var o=e.serviceName="EntityEnumStore";e.EntityEnumStore_API={findDefinitionsByEntityKind:{serviceName:o,serviceFnName:"findDefinitionsByEntityKind",description:"find all entity enum definitions given an entity kind"},findValuesByEntity:{serviceName:o,serviceFnName:"findValuesByEntity",description:"find all entity enum values given an entity reference"}}},219:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntityNamedNoteStore_API=e.serviceName=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+"/entity-named-note";return{findByEntityReference:function(e){return(0,i.checkIsEntityRef)(e),t.get(n+"/entity-ref/"+e.kind+"/"+e.id).then(function(t){return t.data})},save:function(e,a,o){return(0,i.checkIsEntityRef)(e),t.put(n+"/entity-ref/"+e.kind+"/"+e.id+"/"+a,o).then(function(t){return t.data})},remove:function(e,a){return(0,i.checkIsEntityRef)(e),t.delete(n+"/entity-ref/"+e.kind+"/"+e.id+"/"+a).then(function(t){return t.data})}}}a.$inject=["$http","BaseApiUrl"];var o=e.serviceName="EntityNamedNoteStore";e.EntityNamedNoteStore_API={findByEntityReference:{serviceName:o,serviceFnName:"findByEntityReference",description:"finds entity named notes by entity reference"},save:{serviceName:o,serviceFnName:"save",description:"saves an entity named note"},remove:{serviceName:o,serviceFnName:"remove",description:"removes an entity named note"}}},220:function(t,e,n){"use strict";function i(t,e){var n=e+"/entity-named-note-type";return{findAll:function(){return t.get(n).then(function(t){return t.data})},create:function(e){return t.post(n,e).then(function(t){return t.data})},update:function(e,i){return t.put(n+"/"+e,i).then(function(t){return t.data})},remove:function(e){return t.delete(n+"/"+e).then(function(t){return t.data})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.store=i,i.$inject=["$http","BaseApiUrl"];var a=e.serviceName="EntityNamedNoteTypeStore";e.EntityNamedNoteTypeStore_API={findAll:{serviceName:a,serviceFnName:"findAll",description:"finds all entity named note types"},create:{serviceName:a,serviceFnName:"create",description:"creates an entity named note type"},update:{serviceName:a,serviceFnName:"update",description:"updates an entity named note type"},remove:{serviceName:a,serviceFnName:"remove",description:"removes an entity named note type"}}},221:function(t,e,n){"use strict";function i(t,e){var n=e+"/entity-relationship";return{findBetweenEntities:function(e,i){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=n+"/relationship/"+e.kind+"/"+e.id+"/"+i.kind+"/"+i.id,l={directed:a,relationshipKind:o};return t.get(r,{params:l}).then(function(t){return t.data})},findForEntity:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ANY",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=n+"/entity/"+e.kind+"/"+e.id,r={directionality:i,relationshipKind:a};return t.get(o,{params:r}).then(function(t){return t.data})},remove:function(e){var i=n+"/relationship/"+e.a.kind+"/"+e.a.id+"/"+e.b.kind+"/"+e.b.id+"/"+e.relationship;return t.delete(i)},create:function(e){var i=n+"/relationship/"+e.a.kind+"/"+e.a.id+"/"+e.b.kind+"/"+e.b.id+"/"+e.relationship;return t.post(i,{})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.store=i,i.$inject=["$http","BaseApiUrl"];var a=e.serviceName="EntityRelationshipStore";e.EntityRelationshipStore_API={findBetweenEntities:{serviceName:a,serviceFnName:"findBetweenEntities",description:"executes findBetweenEntities [ref, directed? (T|f), List?<RelationshipKinds>]"},findForEntity:{serviceName:a,serviceFnName:"findForEntity",description:"executes findForEntity [ref, directionality? (_ANY_|SOURCE|TARGET), List?<RelationshipKinds>]"},remove:{serviceName:a,serviceFnName:"remove",description:"executes remove [rel]"},create:{serviceName:a,serviceFnName:"create",description:"executes create [rel]"}}},222:function(t,e,n){"use strict";function i(t,e){var n=e+"/entity-search";return{search:function(e,i){return t.post(n+"/"+e,i).then(function(t){return t.data})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.store=i,i.$inject=["$http","BaseApiUrl"];var a=e.serviceName="EntitySearchStore";e.EntitySearchStore_API={search:{serviceName:a,serviceFnName:"search",description:"search for entities, params should be the query and a list of entity kinds"}}},223:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntityStatisticStore_API=void 0;var i=n(8);function a(t,e){var n=e+"/entity-statistic";return{findAllActiveDefinitions:function(){return t.get(n+"/definition").then(function(t){return t.data})},findStatDefinition:function(e){return t.get(n+"/definition/"+e).then(function(t){return t.data})},findStatsForEntity:function(e){return(0,i.checkIsEntityRef)(e),t.get(n+"/"+e.kind+"/"+e.id).then(function(t){return t.data})},findStatValuesByIdSelector:function(e,i){return t.post(n+"/value/"+e,i).then(function(t){return t.data})},findStatAppsByIdSelector:function(e,i){return t.post(n+"/app/"+e,i).then(function(t){return t.data})},findRelatedStatDefinitions:function(e){return t.get(n+"/definition/"+e+"/related").then(function(t){return t.data})},findStatTallies:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i={selector:arguments[1],statisticIds:e};return t.post(n+"/tally",i).then(function(t){return t.data})},calculateStatTally:function(e,i){return t.post(n+"/tally/"+e.id+"/"+e.rollupKind,i).then(function(t){return t.data})},calculateHistoricStatTally:function(e,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"MONTH";return t.post(n+"/tally/historic/"+e.id+"/"+e.rollupKind,i,{params:{duration:a}}).then(function(t){return t.data})}}}a.$inject=["$http","BaseApiUrl"];var o="EntityStatisticStore";e.EntityStatisticStore_API={findAllActiveDefinitions:{serviceName:o,serviceFnName:"findAllActiveDefinitions",description:"finds all active entity statistic definitions"},findStatDefinition:{serviceName:o,serviceFnName:"findStatDefinition",description:"finds entity statistic definition for a given id"},findStatsForEntity:{serviceName:o,serviceFnName:"findStatsForEntity",description:"finds entity statistic for a given entity reference"},findStatValuesByIdSelector:{serviceName:o,serviceFnName:"findStatValuesByIdSelector",description:"finds entity statistic values by app id selector"},findStatAppsByIdSelector:{serviceName:o,serviceFnName:"findStatAppsByIdSelector",description:"finds entity statistic apps by app id selector"},findRelatedStatDefinitions:{serviceName:o,serviceFnName:"findRelatedStatDefinitions",description:"finds related entity statistic definitions for a given stat id"},findStatTallies:{serviceName:o,serviceFnName:"findStatTallies",description:"finds entity statistic tallies for a list of stat ids and an app id selector"},calculateStatTally:{serviceName:o,serviceFnName:"calculateStatTally",description:"calculates entity statistic tallies for a statistic definition and app id selector"},calculateHistoricStatTally:{serviceName:o,serviceFnName:"calculateHistoricStatTally",description:"calculates historic entity statistic tallies for a statistic definition and app id selector"}};e.default={store:a,serviceName:o}},224:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntityTagStore_API=e.serviceName=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+"/entity-tag";return{findAllTags:function(){return t.get(n+"/tags").then(function(t){return t.data})},findByTag:function(e){return t.post(n+"/tags",e).then(function(t){return t.data})},findTagsByEntityRef:function(e){return t.get(n+"/entity/"+e.kind+"/"+e.id).then(function(t){return t.data})},update:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,i.checkIsEntityRef)(e),(0,i.checkIsStringList)(a),t.post(n+"/entity/"+e.kind+"/"+e.id,a).then(function(t){return t.data})}}}a.$inject=["$http","BaseApiUrl"];var o=e.serviceName="EntityTagStore";e.EntityTagStore_API={findAllTags:{serviceName:o,serviceFnName:"findAllTags",description:"executes findAllTags"},findByTag:{serviceName:o,serviceFnName:"findByTag",description:"executes findByTag"},findTagsByEntityRef:{serviceName:o,serviceFnName:"findTagsByEntityRef",description:"executes findTagsByEntityRef"},update:{serviceName:o,serviceFnName:"update",description:"executes update"}};e.default=a},225:function(t,e,n){"use strict";function i(t,e){var n=e+"/enum-value";return{findAll:function(){return t.get(n).then(function(t){return t.data})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.store=i,i.$inject=["$http","BaseApiUrl"];var a=e.serviceName="EnumValueStore";e.EnumValueStore_API={findAll:{serviceName:a,serviceFnName:"findAll",description:"find all enum values"}}},226:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntitySvgDiagramStore_API=e.serviceName=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+"/entity-svg-diagram";return{findByEntityReference:function(e){return(0,i.checkIsEntityRef)(e),t.get(n+"/entity-ref/"+e.kind+"/"+e.id).then(function(t){return t.data})}}}a.$inject=["$http","BaseApiUrl"];var o=e.serviceName="EntitySvgDiagramStore";e.EntitySvgDiagramStore_API={findByEntityReference:{serviceName:o,serviceFnName:"findByEntityReference",description:"finds entity svg diagrams by entity reference"}}},227:function(t,e,n){"use strict";function i(t,e){var n=e+"/flow-diagram";return{getById:function(e){return t.get(n+"/id/"+e).then(function(t){return t.data})},deleteForId:function(e){return t.delete(n+"/id/"+e).then(function(t){return t.data})},findByEntityReference:function(e){return t.get(n+"/entity/"+e.kind+"/"+e.id).then(function(t){return t.data})},makeNewForEntityReference:function(e,i){return t.post(n+"/entity/"+e.kind+"/"+e.id,i).then(function(t){return t.data})},findForSelector:function(e){return t.post(n+"/selector",e).then(function(t){return t.data})},clone:function(e,i){return t.post(n+"/id/"+e+"/clone",i).then(function(t){return t.data})},save:function(e){return t.post(n,e).then(function(t){return t.data})},updateName:function(e,i){return t.post(n+"/update-name/"+e,i).then(function(t){return t.data})},updateDescription:function(e,i){return t.post(n+"/update-description/"+e,i).then(function(t){return t.data})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.store=i,i.$inject=["$http","BaseApiUrl"];var a="FlowDiagramStore";e.default={serviceName:a,store:i};e.FlowDiagramStore_API={getById:{serviceName:a,serviceFnName:"getById",description:"getById"},deleteForId:{serviceName:a,serviceFnName:"deleteForId",description:"deleteForId"},findByEntityReference:{serviceName:a,serviceFnName:"findByEntityReference",description:"findByEntityReference"},findForSelector:{serviceName:a,serviceFnName:"findForSelector",description:"findForSelector"},save:{serviceName:a,serviceFnName:"save",description:"save"},updateName:{serviceName:a,serviceFnName:"updateName",description:"update name"},updateDescription:{serviceName:a,serviceFnName:"updateDescription",description:"update description"},clone:{serviceName:a,serviceFnName:"clone",description:"clone [title?]"},makeNewForEntityReference:{serviceName:a,serviceFnName:"makeNewForEntityReference",description:"makeNewForEntityReference [ref, title?]"}}},228:function(t,e,n){"use strict";function i(t,e){var n=e+"/flow-diagram-annotation";return{findByDiagramId:function(e){return t.get(n+"/diagram/"+e).then(function(t){return t.data})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.store=i,i.$inject=["$http","BaseApiUrl"];e.default={serviceName:"FlowDiagramAnnotationStore",store:i};e.FlowDiagramAnnotationStore_API={findByDiagramId:{serviceName:"FlowDiagramAnnotationStore",serviceFnName:"findByDiagramId",description:"findByDiagramId"}}},229:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FlowDiagramEntityStore_API=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+"/flow-diagram-entity";return{findByDiagramId:function(e){return t.get(n+"/id/"+e).then(function(t){return t.data})},findByEntityReference:function(e){return t.get(n+"/entity/"+e.kind+"/"+e.id).then(function(t){return t.data})},findForSelector:function(e){return t.post(n+"/selector",e).then(function(t){return t.data})},addRelationship:function(e,a){return(0,i.checkIsEntityRef)(a),t.post(n+"/id/"+e+"/"+a.kind+"/"+a.id,{}).then(function(t){return t.data})},removeRelationship:function(e,a){return(0,i.checkIsEntityRef)(a),t.delete(n+"/id/"+e+"/"+a.kind+"/"+a.id).then(function(t){return t.data})}}}a.$inject=["$http","BaseApiUrl"];var o="FlowDiagramEntityStore";e.default={serviceName:o,store:a};e.FlowDiagramEntityStore_API={findByDiagramId:{serviceName:o,serviceFnName:"findByDiagramId",description:"findByDiagramId"},findByEntityReference:{serviceName:o,serviceFnName:"findByEntityReference",description:"findByEntityReference"},findForSelector:{serviceName:o,serviceFnName:"findForSelector",description:"findForSelector"},addRelationship:{serviceName:o,serviceFnName:"addRelationship",description:"addRelationship (diagramId, ref)"},removeRelationship:{serviceName:o,serviceFnName:"removeRelationship",description:"removeRelationship (diagramId, ref)"}}},81:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.determineIfCreateAllowed=function(t){switch(t){case"ACTOR":case"APPLICATION":case"CHANGE_INITIATIVE":case"MEASURABLE":case"PHYSICAL_FLOW":case"PHYSICAL_SPECIFICATION":return!0;default:return!1}},e.toGraphId=a,e.toGraphNode=function(t){return{id:a(t),data:t}},e.toGraphFlow=function(t){return{id:a(t),source:a(t.source),target:a(t.target),data:t}},e.drawNodeShape=function(t,e){t.select("path").attr("d",function(t){return o(e,t).path}).attr("stroke","#ccc").attr("fill",function(t){switch(t.data.kind){case"ACTOR":return"#dfd7ee";case"APPLICATION":var n=e.detail.applicationsById[t.data.id];return n&&"EUC"===n.kind?"#f1d0d0":"#dff1d2";default:return"#dff1d2"}})},e.positionFor=function(t,e){var n=i.default.isString(e)?e:e.id;return t.layout.positions[n]||function(t,e){var n={x:0,y:0};return t.layout.positions[e]=n,n}(t,n)},e.shapeFor=o,e.toNodeShape=s;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(1));function a(t){return i.default.isString(t)?t:t.kind+"/"+t.id}function o(t,e){var n=i.default.isString(e)?e:e.id;return t.layout.shapes[n]||function(t,e){if(!i.default.isObject(e))throw"Cannot initialise shape without an object, was given: "+e;var n=s(i.default.get(e,"data.kind","DEFAULT"));return t.layout.shapes[e.id]=n,n}(t,e)}function r(t){return{path:"M0,0 L"+t+",0 L"+t+",20 L0,20 z",cx:t/2,cy:10,title:{dx:4,dy:13}}}var l={ACTOR:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return Object.assign({},function(t){return{path:"M0,0 L"+t+",0 L"+(t-5)+",20 L5,20 z",cx:t/2,cy:10,title:{dx:8,dy:13}}}(t),{icon:""})},APPLICATION:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return Object.assign({},r(t),{icon:""})},EUC:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return Object.assign({},r(t),{icon:""})},DEFAULT:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return Object.assign({},r(t),{icon:""})}};function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=i.default.isObject(t)?t.kind:t,a=l[n];return a||console.error("Cannot determine shape function for node",t),a(e)}},952:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(6)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(217)),o=n(7);e.default=function(){var t=i.default.module("waltz.end.user.apps",[]);return(0,o.registerStore)(t,a),t.name}},953:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=p(n(6)),a=n(7),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(222)),r=p(n(954)),l=p(n(956)),s=p(n(958)),d=p(n(960)),c=p(n(962)),u=p(n(964));function p(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module("waltz.entity",[]);return(0,a.registerStore)(t,o),t.component("waltzEntityHierarchyNavigator",l.default).component("waltzEntityInvolvementEditor",s.default).component("waltzEntitySelector",d.default).component("waltzImmediateHierarchyNavigator",c.default).component("waltzRelatedEntityEditor",u.default),(0,a.registerComponents)(t,[r.default]),t.name}},954:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(955)),a=n(0);var o={list:[]};function r(){(0,a.initialiseData)(this,o)}r.$inject=[];var l={template:i.default,controller:r,bindings:{list:"<"}};e.default={component:l,id:"waltzEntityLinkList"}},955:function(t,e){t.exports=' <div ng-class="{\'waltz-scroll-region-200\': $ctrl.list.length > 10}" ng-style="{\'width\': $ctrl.list.length > 10 ? \'85%\' : \'100%\'}"> <ul class=list-unstyled ng-if="$ctrl.list.length > 0"> <li ng-repeat="item in $ctrl.list"> <span style=display:inline-block uib-popover-template="\'well/popup.html\'" popover-append-to-body=true popover-placement=right popover-trigger="mouseenter click" popover-enable=item.description popover-popup-delay=200> <waltz-entity-link entity-ref=item> </waltz-entity-link> </span> </li> </ul> <i ng-if="$ctrl.list.length == 0"> - </i> </div> <script type=text/ng-template id=well/popup.html> <div class="small">\n        <waltz-markdown text="item.description"></waltz-markdown>\n    </div> <\/script>'},956:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(1)),a=n(24);function o(t){return t&&t.__esModule?t:{default:t}}var r={model:[],expandedNodes:[],selectedNode:null,onSelect:function(t){return console.log("No handler provided for entity-hierarchy-navigator:onSelect",t)}};var l={template:o(n(957)).default,controller:function(){var t=i.default.defaultsDeep(this,r);t.$onChanges=function(e){e.model&&e.model.currentValue&&(t.forest=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,a.buildHierarchies)(t,!1)}(t.model)),e.selectedNode&&e.selectedNode.currentValue&&(t.currentNode=(0,a.findNode)(t.forest,t.selectedNode.id),t.expandedNodes=function(t,e){for(var n=[],i=e;i.parent;)i=(0,a.findNode)(t,i.parent),n.push(i);return n}(t.forest,t.currentNode))},t.handleSelection=function(e){e!==t.selectedNode&&t.onSelect(e)}},bindings:{selectedNode:"<",model:"<",onSelect:"<"},transclude:{nodeTemplate:"?nodeTemplate"}};e.default=l},957:function(t,e){t.exports='<div> <treecontrol class=tree-light tree-model=$ctrl.forest order-by="\'-name\'" selected-node=$ctrl.currentNode expanded-nodes=$ctrl.expandedNodes on-selection=$ctrl.handleSelection(node)> <span class=clickable title="{{ node.description }}"> <span ng-transclude=nodeTemplate> <span ng-bind=node.name></span> </span> </span> </treecontrol> </div>'},958:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(n(1)),a=n(0),o=n(80),r=n(29),l=s(n(959));function s(t){return t&&t.__esModule?t:{default:t}}var d={allowedInvolvements:[],currentInvolvement:{},currentInvolvements:[],parentEntityRef:null,targetEntityKind:null,targetEntityDisplayName:null,onAdd:function(){return console.log("default onAdd handler for entity-involvement-editor")},onRemove:function(){return console.log("default onRemove handler for entity-involvement-editor")}};function c(){var t=(0,a.initialiseData)(this,d);t.$onChanges=function(e){e.targetEntityKind&&(t.targetEntityDisplayName=i.default.toLower((0,r.getEnumName)(o.entity,t.targetEntityKind))+"s")},t.onEntitySelect=function(e){t.currentInvolvement.entity=e},t.isCurrentInvolvementValid=function(){return t.currentInvolvement&&t.currentInvolvement.entity&&t.currentInvolvement.involvement},t.onInvolvementAdd=function(){var e=t.currentInvolvement;(0,a.invokeFunction)(t.onAdd,e),t.currentInvolvement={}}}c.$inject=[];var u={bindings:{allowedInvolvements:"<",currentInvolvements:"<",parentEntityRef:"<",targetEntityKind:"<",onAdd:"<",onRemove:"<"},template:l.default,controller:c};e.default=u},959:function(t,e){t.exports=' <div class=row> <div class=col-md-6> <div ng-if="$ctrl.currentInvolvements.length > 0"> <p class=waltz-paragraph> Current <span ng-bind=$ctrl.targetEntityDisplayName></span> and their relation to <waltz-entity-icon-label entity-ref=$ctrl.parentEntityRef></waltz-entity-icon-label>. </p> <p class="waltz-paragraph text-muted"> Please use the search field to the right to locate <span ng-bind=$ctrl.targetEntityDisplayName></span> to create a involvement. </p> <div class=waltz-scroll-region style=height:530px> <table class="table table-striped table-condensed"> <thead> <tr> <th>Entity</th> <th>Involvement</th> <th></th> </tr> </thead> <tr ng-repeat="rel in $ctrl.currentInvolvements | orderBy:\'entity.name\'" class=waltz-visibility-parent> <td> <waltz-entity-link entity-ref=rel.entity> </waltz-entity-link> </td> <td> <span ng-bind="rel.involvement | toDisplayName:\'involvementKind\'"> </span> </td> <td> <span class=waltz-visibility-child-50 ng-if=!rel.isReadOnly> <a ng-click=$ctrl.onRemove(rel) class=clickable> Remove </a> </span> </td> </tr> </table> </div> </div> <waltz-no-data ng-if="$ctrl.currentInvolvements.length ==0"> <message> <waltz-icon name=warning></waltz-icon> <strong>No involvements exist.</strong> Please use the search field on the right to start adding involvements. </message> </waltz-no-data> </div> <div class=col-md-6> <p class=waltz-paragraph> Use the search box below to locate <span ng-bind=$ctrl.targetEntityDisplayName></span> and create involvements. </p> <br/> <waltz-entity-selector on-select=$ctrl.onEntitySelect current-selection=$ctrl.currentInvolvement.entity entity-kinds=[$ctrl.targetEntityKind]> </waltz-entity-selector> <br/> <select ng-model=$ctrl.currentInvolvement.involvement ng-options="rel.value as rel.name for rel in $ctrl.allowedInvolvements | orderBy:\'name\'" class=form-control> </select> <br/> <button class="btn btn-info btn-small" ng-disabled=!$ctrl.isCurrentInvolvementValid() ng-click=$ctrl.onInvolvementAdd()> Add </button> </div> </div>'},960:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=r(n(1)),o=r(n(961));function r(t){return t&&t.__esModule?t:{default:t}}var l={entities:[],limit:20,entityKinds:[],required:!1,selectionFilter:function(t){return!0}};function s(t){var e=(0,i.initialiseData)(this,l);e.$onChanges=function(t){e.options={entityKinds:e.entityKinds,limit:e.limit,entityLifecycleStatuses:["ACTIVE","PENDING","REMOVED"]},t.entityKinds&&(e.entities=[]),e.currentSelection&&e.refresh(e.currentSelection.name,e.options)},e.refresh=function(n){if(n)return t.search(n,e.options).then(function(t){e.entities=e.selectionFilter?a.default.filter(t,e.selectionFilter):t})},e.select=function(t){return(0,i.invokeFunction)(e.onSelect,t,e.itemId)},e.mkTracker=function(t){return t.kind+"_"+t.id}}s.$inject=["EntitySearchStore"];var d={bindings:{clearable:"<",currentSelection:"<",entityKinds:"<",itemId:"<",limit:"<",onSelect:"<",required:"<",selectionFilter:"<"},template:o.default,controller:s};e.default=d},961:function(t,e){t.exports="<div class=waltz-entity-selector> <ui-select class=waltz-entity-selector ng-model=$ctrl.currentSelection on-select=$ctrl.select($item) theme=bootstrap ng-required=$ctrl.required> <ui-select-match placeholder=Search... allow-clear={{$ctrl.clearable}}> <waltz-icon fixed-width=true ng-if=\"$ctrl.entityKinds.length > 1\" class=wes-selected-icon name=\"{{ $select.selected.kind | toIconName:'entity' }}\"> </waltz-icon> <span ng-bind-html=$select.selected.name class=wes-selected-name> </span> </ui-select-match> <ui-select-choices repeat=\"entity in $ctrl.entities | orderBy:'kind' track by $ctrl.mkTracker(entity) \" refresh=$ctrl.refresh($select.search) refresh-delay=300> <div uib-popover=\"{{ entity.description }}\" popover-trigger=mouseenter popover-append-to-body=true> <waltz-icon fixed-width=true ng-if=\"$ctrl.entityKinds.length > 1\" name=\"{{ entity.kind | toIconName:'entity' }}\"> </waltz-icon> <span ng-bind-html=\"entity.name | highlight: $select.search\" ng-class=\"{\n                            'wes-entity-removed': entity.entityLifecycleStatus === 'REMOVED',\n                            'wes-entity-pending': entity.entityLifecycleStatus === 'PENDING'\n                      }\"></span> <small class=wes-entity-description ng-bind-html=\"entity.description | highlight: $select.search\" ng-class=\"{\n                            'wes-entity-removed': entity.entityLifecycleStatus === 'REMOVED',\n                            'wes-entity-pending': entity.entityLifecycleStatus === 'PENDING'\n                       }\"> </small> </div> </ui-select-choices> </ui-select> </div>"},962:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(963)),a=n(0);var o={parents:[],children:[]};function r(){(0,a.initialiseData)(this,o)}r.$inject=[];var l={template:i.default,controller:r,bindings:{parents:"<",children:"<"}};e.default=l},963:function(t,e){t.exports='<div class="row waltz-immediate-hierarchy-navigator"> <div class=col-md-6> <strong>Parents: </strong> <waltz-entity-link-list list=$ctrl.parents> </waltz-entity-link-list> </div> <div class=col-md-6> <strong>Children: </strong> <waltz-entity-link-list list=$ctrl.children> </waltz-entity-link-list> </div> </div> '},964:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(n(1)),a=n(0),o=n(80),r=n(29),l=s(n(965));function s(t){return t&&t.__esModule?t:{default:t}}var d={allowedRelationships:[],dropdownEntries:[],currentRelationship:{},currentRelationships:[],parentEntityRef:null,targetEntityKind:null,targetEntityDisplayName:null,onAdd:function(){return console.log("default onAdd handler for related-entity-editor")},onRemove:function(){return console.log("default onAdd handler for related-entity-editor")}};function c(){var t=(0,a.initialiseData)(this,d);t.$onChanges=function(e){e.targetEntityKind&&(t.targetEntityDisplayName=i.default.toLower((0,r.getEnumName)(o.entity,t.targetEntityKind))+"s"),t.dropdownEntries=i.default.map(t.allowedRelationships,function(t){return{code:t.value,name:t.name}})},t.onEntitySelect=function(e){t.currentRelationship.entity=e},t.isCurrentRelationshipValid=function(){return t.currentRelationship&&t.currentRelationship.entity&&t.currentRelationship.relationship},t.onRelationshipAdd=function(){var e=t.currentRelationship;return(0,a.invokeFunction)(t.onAdd,e).then(function(){return t.currentRelationship={}})},t.onRelationshipEdit=function(e,n,i){return t.currentRelationship={entity:i.entity,relationship:e},t.onRemove(i).then(function(){return t.onRelationshipAdd()})}}c.$inject=[];var u={bindings:{allowedRelationships:"<",currentRelationships:"<",parentEntityRef:"<",targetEntityKind:"<",onAdd:"<",onRemove:"<"},template:l.default,controller:c};e.default=u},965:function(t,e){t.exports='<div class=row> <div class=col-md-6> <div ng-if="$ctrl.currentRelationships.length > 0"> <p class=waltz-paragraph> Current <span ng-bind=$ctrl.targetEntityDisplayName></span> and their relation to <waltz-entity-link entity-ref=$ctrl.parentEntityRef></waltz-entity-link>. </p> <p class="waltz-paragraph text-muted"> Please use the search field to the right to locate <span ng-bind=$ctrl.targetEntityDisplayName></span> to create a relationship. </p> <div class=waltz-scroll-region style=height:530px> <table class="table table-striped table-condensed"> <thead> <tr> <th>Entity</th> <th>Relationship</th> <th></th> </tr> </thead> <tr ng-repeat="rel in $ctrl.currentRelationships | orderBy:\'entity.name\'" class=waltz-visibility-parent> <td> <waltz-entity-link entity-ref=rel.entity> </waltz-entity-link> </td> <td> <waltz-editable-dropdown initial-val=rel.relationship entries=$ctrl.dropdownEntries on-save=$ctrl.onRelationshipEdit ctx=rel> </waltz-editable-dropdown> </td> <td> <span class=waltz-visibility-child-50> <a ng-click=$ctrl.onRemove(rel) class=clickable> Remove </a> </span> </td> </tr> </table> </div> </div> <waltz-no-data ng-if="$ctrl.currentRelationships.length ==0"> <message> <waltz-icon name=warning></waltz-icon> <strong>No relationships exist.</strong> Please use the search field on the right to start adding relationships. </message> </waltz-no-data> </div> <div class=col-md-6> <p class=waltz-paragraph> Use the search box below to locate <span ng-bind=$ctrl.targetEntityDisplayName></span> and create relationships. </p> <br/> <waltz-entity-selector on-select=$ctrl.onEntitySelect current-selection=$ctrl.currentRelationship.entity entity-kinds=[$ctrl.targetEntityKind]> </waltz-entity-selector> <br/> <select ng-model=$ctrl.currentRelationship.relationship ng-options="rel.value as rel.name for rel in $ctrl.allowedRelationships" class=form-control> </select> <br/> <button class="btn btn-info btn-small" ng-disabled=!$ctrl.isCurrentRelationshipValid() ng-click=$ctrl.onRelationshipAdd()> Add </button> </div> </div>'},966:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),a=function(t){return t&&t.__esModule?t:{default:t}}(n(967));e.default=function(){var t=angular.module("waltz.entity-diagrams",[]);return(0,i.registerComponents)(t,[a.default]),t.name}},967:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(2),o=n(0),r=c(n(1)),l=c(n(968)),s=n(12),d=n(81);function c(t){return t&&t.__esModule?t:{default:t}}var u={selectedDiagram:null,visibility:{flowDiagramMode:null,makeNew:!0}};function p(t,e,n){var l=(0,o.initialiseData)(this,u),c=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e.loadViewData(a.CORE_API.FlowDiagramStore.findByEntityReference,[l.parentEntityRef],{force:t}).then(function(t){return t.data})},p=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.loadViewData(a.CORE_API.EntitySvgDiagramStore.findByEntityReference,[l.parentEntityRef],{force:t}).then(function(t){return t.data})},f=[{name:"Clone",icon:"clone",execute:function(t){var i=prompt("What shall the cloned copy be called ?","Copy of "+t.name);null!=i?r.default.isEmpty(i.trim())?n.warning("Clone cancelled, no name given"):e.execute(a.CORE_API.FlowDiagramStore.clone,[t.ref.id,i]).then(function(t){n.success("Diagram cloned"),m()}).catch(function(t){return n.error("Failed to clone diagram: "+t.data.message)}):n.warning("Clone cancelled")}}];function m(){var e=[c(!0),p(!1)];return t.all(e).then(function(t){var e=i(t,2),n=e[0],a=void 0===n?[]:n,o=e[1],d=void 0===o?[]:o;return l.diagrams=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return r.default.map(e,t)};return r.default.chain([]).concat(i(function(t){return{id:(0,s.refToString)(t),ref:(0,s.toEntityRef)(t),type:"Flow",name:t.name,icon:"random",description:t.description,actions:n,lastUpdatedAt:t.lastUpdatedAt,lastUpdatedBy:t.lastUpdatedBy}},t)).concat(i(function(t){return{id:"ENTITY_SVG_DIAGRAM/"+t.id,ref:(0,s.toEntityRef)(t,"ENTITY_SVG_DIAGRAM"),type:"Generic",name:t.name,icon:"picture-o",description:t.description,svg:t.svg}},e)).orderBy(function(t){return t.name.toLowerCase()}).value()}(a,d,f),l.selectedDiagram=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return e||r.default.find(t,function(t){return"Generic"===t.type})}(l.diagrams,l.selectedDiagram),l.diagrams})}l.$onInit=function(){m(),l.visibility.makeNew=(0,d.determineIfCreateAllowed)(l.parentEntityRef.kind)},l.$onChanges=function(t){},l.onDiagramSelect=function(t){l.selectedDiagram=t,l.visibility.flowDiagramMode="VIEW"},l.onDiagramDismiss=function(){l.selectedDiagram=null},l.onEditorClose=function(){l.selectedDiagram=null,m()},l.onDiagramEdit=function(t){l.visibility.flowDiagramMode="EDIT"},l.onMakeNewFlowDiagram=function(){var t=prompt("Please enter a name for the new diagram ?");if(null!=t)if(r.default.isEmpty(t.trim()))n.warning("Create cancelled, no name given");else{var i=null;e.execute(a.CORE_API.FlowDiagramStore.makeNewForEntityReference,[l.parentEntityRef,t]).then(function(t){return i="FLOW_DIAGRAM/"+t.data,m()}).then(function(t){n.success("Diagram created, click edit if you wish to make changes");var e=r.default.find(t,{id:i});l.onDiagramSelect(e)}).catch(function(t){return n.error("Failed to create new diagram: "+t.data.message)})}else n.warning("Create cancelled")}}p.$inject=["$q","ServiceBroker","Notification"];var f={template:l.default,bindings:{parentEntityRef:"<"},controller:p};e.default={component:f,id:"waltzEntityDiagramsSection"}},968:function(t,e){t.exports=' <div ng-if="$ctrl.diagrams.length === 0"> <waltz-no-data> <message> <strong> No diagrams </strong> have been associated <div ng-include="\'weds-make-new-diagram.html\'"></div> </message> </waltz-no-data> </div> <div ng-if="$ctrl.diagrams.length > 0"> <div ng-if="$ctrl.selectedDiagram.type !== \'Flow\'"> <div class="row small" ng-if="$ctrl.diagrams.length > 10"> <div class=col-sm-6> <div class="input-group input-group-sm"> <span class=input-group-addon> <waltz-icon name=search></waltz-icon> </span> <input type=search class=form-control ng-model=$ctrl.qry placeholder=Search...> </div> <br> </div> </div> <div ng-class="{\'waltz-scroll-region-300\' : $ctrl.diagrams.length > 10}"> <table class="table table-hover table-condensed"> <thead> <tr> <th>Name</th> <th>Type</th> <th>Last Modified</th> <th>Actions</th> </tr> </thead> <tbody> <tr ng-repeat="diagram in $ctrl.diagrams | filter:$ctrl.qry track by diagram.id" ng-class="{ \'waltz-highlighted-row\' : diagram.name === $ctrl.selectedDiagram.name }" class=waltz-animate-repeat> <td> <a ng-click=$ctrl.onDiagramSelect(diagram) class=clickable> <waltz-icon name="{{ diagram.icon }}"></waltz-icon> <span uib-popover-html=diagram.description popover-trigger=mouseenter popover-append-to-body=true ng-bind=diagram.name> </span> </a> </td> <td> <span ng-bind=diagram.type></span> </td> <td> <span class=small> <waltz-last-updated entity=diagram> </waltz-last-updated> </span> </td> <td> <div waltz-has-role=LINEAGE_EDITOR> <span ng-repeat="action in diagram.actions"> <a ng-click=action.execute(diagram) class=clickable> <waltz-icon name="{{ action.icon }}"></waltz-icon> <span ng-bind=action.name></span> <span ng-if=!$last> | </span> </a> </span> </div> </td> </tr> </tbody> </table> </div> <div ng-include="\'weds-make-new-diagram.html\'"></div> </div> </div> <div ng-if="$ctrl.selectedDiagram.type === \'Generic\'"> <hr> <h4> <span ng-bind=$ctrl.selectedDiagram.name></span> <small> <a class=clickable ng-click=$ctrl.onDiagramDismiss()> ( Dismiss ) </a> </small> </h4> <waltz-entity-svg-diagram-viewer svg=$ctrl.selectedDiagram.svg> </waltz-entity-svg-diagram-viewer> <waltz-markdown text=$ctrl.selectedDiagram.description> </waltz-markdown> </div> <div ng-if="$ctrl.selectedDiagram.type === \'Flow\'"> <div ng-switch=$ctrl.visibility.flowDiagramMode> <div ng-switch-when=VIEW> <waltz-flow-diagrams-panel-view parent-entity-ref=$ctrl.selectedDiagram.ref on-edit-diagram=$ctrl.onDiagramEdit on-dismiss-diagram=$ctrl.onDiagramDismiss> </waltz-flow-diagrams-panel-view> </div> <div ng-switch-when=EDIT> <waltz-flow-diagram-editor parent-entity-ref=$ctrl.selectedDiagram.ref on-cancel=$ctrl.onEditorClose> </waltz-flow-diagram-editor> </div> </div> </div> <script type=text/ng-template id=weds-make-new-diagram.html> <div ng-if="$ctrl.visibility.makeNew">\n        <div waltz-has-role="LINEAGE_EDITOR">\n            <hr>\n            <a ng-click="$ctrl.onMakeNewFlowDiagram()"\n               class="clickable">\n                <waltz-icon name="plus"></waltz-icon>\n                Make new flow diagram\n            </a>\n        </div>\n    </div> <\/script> '},969:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=l(n(6)),a=n(7),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(218)),r=l(n(970));function l(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module("waltz.entity-enum",[]);return(0,a.registerStores)(t,[o]),(0,a.registerComponents)(t,[r.default]),t.name}},970:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=s(n(1)),o=n(0),r=n(2),l=s(n(971));function s(t){return t&&t.__esModule?t:{default:t}}var d={numColumns:2,chunkedEntries:[]};function c(t,e){var n=(0,o.initialiseData)(this,d);n.$onChanges=function(){if(n.parentEntityRef){var o=e.loadViewData(r.CORE_API.EntityEnumStore.findDefinitionsByEntityKind,[n.parentEntityRef.kind]).then(function(t){return t.data}),l=e.loadViewData(r.CORE_API.EntityEnumStore.findValuesByEntity,[n.parentEntityRef]).then(function(t){return t.data});t.all([o,l]).then(function(t){var e=i(t,2),o=e[0],r=e[1],l=a.default.keyBy(r,"definitionId"),s=a.default.chain(o).map(function(t){return{definition:t,value:l[t.id]||{enumValueKey:"-"}}}).sortBy(function(t){return[t.definition.position,t.definition.id]}).value();n.chunkedEntries=function(t,e){for(var n=[],i=0;i<t.length;i+=e)n.push(t.slice(i,i+e));return n}(s,n.numColumns)})}}}c.$inject=["$q","ServiceBroker"];var u={template:l.default,bindings:{parentEntityRef:"<"},controller:c};e.default={component:u,id:"waltzEntityEnum"}},971:function(t,e){t.exports='<div class=row ng-repeat="row in $ctrl.chunkedEntries"> <div class="col-sm-2 waltz-display-field-label" ng-repeat-start="entry in row"> <span ng-bind=entry.definition.name uib-popover="{{ entry.definition.description }}" popover-append-to-body=true popover-trigger=mouseenter> </span> </div> <div class=col-sm-4 ng-repeat-end=""> <waltz-enum-value type=entry.definition.enumValueType key=entry.value.enumValueKey show-icon=false> </waltz-enum-value> </div> </div>'},972:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=c(n(6)),a=n(7),o=d(n(219)),r=d(n(220)),l=c(n(973)),s=c(n(975));function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function c(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module("waltz.entity.named-note",[]);return t.service(o.serviceName,o.store).service(r.serviceName,r.store),(0,a.registerComponents)(t,[l.default,s.default]),t.name}},973:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1)),a=n(0),o=r(n(974));function r(t){return t&&t.__esModule?t:{default:t}}var l={creatableNoteTypes:[],editingNotes:{},expandedNotes:{},newNote:{},baseLabelText:"Show Additional Notes",labelText:"Show Additional Notes",visibility:{notes:!0},onSave:function(t){return console.log("entity named notes panel default save handler: ",t)},onDelete:function(t){return console.log("entity named notes panel default delete handler: ",t)},onEditorDismiss:function(){return console.log("entity named notes panel default dismiss editor handler: ",note)}};function s(){var t=(0,a.initialiseData)(this,l);t.$onChanges=function(n){t.notes&&t.allNoteTypes&&e()};var e=function(){var e=i.default.keyBy(t.notes,"namedNoteTypeId");t.creatableNoteTypes=i.default.chain(t.allNoteTypes).filter(function(t){return!t.isReadOnly}).filter(function(t){return!e[t.id]}).filter(function(e){return-1!==e.applicableEntityKinds.indexOf(t.parentEntityRef.kind)}).sortBy("name").value(),t.noteTypesById=i.default.keyBy(t.allNoteTypes,"id");var n=i.default.chain(t.notes).map(function(e){return t.noteTypesById[e.namedNoteTypeId]}).map(function(t){return t.name}).value();t.labelText=t.baseLabelText+": "+i.default.truncate(i.default.join(n,", "),{length:200})};t.cancelNewNote=function(){(0,a.invokeFunction)(t.onEditorDismiss)},t.saveNewNote=function(){(0,a.invokeFunction)(t.onSave,t.newNote).then(function(){t.newNote={},(0,a.invokeFunction)(t.onEditorDismiss)})},t.startEditNote=function(e){t.editingNotes[e.namedNoteTypeId]={noteTextVal:e.noteText}},t.cancelEditNote=function(e){t.editingNotes[e.namedNoteTypeId]=null},t.updateNote=function(e){var n={namedNoteTypeId:e.namedNoteTypeId,noteText:t.editingNotes[e.namedNoteTypeId].noteTextVal};(0,a.invokeFunction)(t.onSave,n).then(function(){t.editingNotes[e.namedNoteTypeId]=null})},t.deleteNote=function(e){confirm("Are you sure you want to delete this note?")&&(0,a.invokeFunction)(t.onDelete,e)},t.expandNote=function(e){return t.expandedNotes[e.namedNoteTypeId]=!0},t.collapseNote=function(e){return t.expandedNotes[e.namedNoteTypeId]=!1}}s.$inject=[];var d={template:o.default,bindings:{parentEntityRef:"<",notes:"<",allNoteTypes:"<",onSave:"<",onDelete:"<",onEditorDismiss:"<",creatingNote:"<"},controller:s};e.default={component:d,id:"waltzEntityNamedNotesPanel"}},974:function(t,e){t.exports='<div class=waltz-entity-named-notes> <waltz-no-data ng-if="$ctrl.notes.length == 0 && $ctrl.creatingNote === false"> <message> <strong>No notes</strong> have been added </message> </waltz-no-data> <div ng-if="$ctrl.creatingNote === true"> <label>Note Type:</label> <select class="form-control input-sm" placeholder="Note Type" ng-options="noteType.id as noteType.name for noteType in $ctrl.creatableNoteTypes" ng-model=$ctrl.newNote.namedNoteTypeId> </select> <br> <label>Note Text:</label> <textarea class="form-control input-sm" rows=6 placeholder="Markdown is supported" ng-model=$ctrl.newNote.noteText>\n        </textarea> <br> <button class="btn btn-success btn-xs" ng-disabled="! $ctrl.newNote.namedNoteTypeId || ! $ctrl.newNote.noteText" ng-click=$ctrl.saveNewNote()> &nbsp;&nbsp;Save&nbsp; </button> <a class="btn btn-xs" ng-click=$ctrl.cancelNewNote()> Cancel </a> </div> <div ng-if="$ctrl.notes.length > 0 && $ctrl.creatingNote === false"> <table class="wenn-table small table table-condensed table-striped"> <colgroup> <col width=30%> <col width=70%> <col width=20%> </colgroup> <thead> <tr> <th>Note Type</th> <th>Note Text</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat="note in $ctrl.notes" class=waltz-visibility-parent ng-if="$ctrl.creatingNote === false"> <td> <div> <span ng-bind="note.namedNoteTypeId | toDisplayName:\'entityNamedNoteType\'"></span> <span ng-if="! $ctrl.noteTypesById[note.namedNoteTypeId].isReadOnly" class="waltz-visibility-child-30 pull-right" waltz-has-role-for-entity-kind="{{ $ctrl.parentEntityRef.kind }}"> <a class=clickable ng-click=$ctrl.startEditNote(note)> <waltz-icon name=pencil></waltz-icon> Edit </a> &nbsp;&nbsp; <a class=clickable ng-click=$ctrl.deleteNote(note)> <waltz-icon name=trash></waltz-icon> Delete </a> </span> </div> <waltz-markdown class="small text-muted" text="note.namedNoteTypeId | toDescription:\'entityNamedNoteType\'"> </waltz-markdown> <waltz-last-updated class=small entity=note> </waltz-last-updated> <div ng-if="note.noteText.length > 1500"> <br> <a class=clickable ng-if="! $ctrl.expandedNotes[note.namedNoteTypeId]" ng-click=$ctrl.expandNote(note)> <waltz-icon name=plus></waltz-icon> Expand </a> <a class=clickable ng-if=$ctrl.expandedNotes[note.namedNoteTypeId] ng-click=$ctrl.collapseNote(note)> <waltz-icon name=minus></waltz-icon> Collapse </a> </div> </td> <td align=left> <div ng-class="{ \'waltz-scroll-region-350\': note.noteText.length > 1500 && ! $ctrl.expandedNotes[note.namedNoteTypeId] }"> <textarea class="form-control input-sm" ng-if=$ctrl.editingNotes[note.namedNoteTypeId] rows=6 placeholder="Markdown is supported" ng-model=$ctrl.editingNotes[note.namedNoteTypeId].noteTextVal>\n                        </textarea> <waltz-markdown ng-if="! $ctrl.editingNotes[note.namedNoteTypeId]" text=note.noteText> </waltz-markdown> </div> </td> <td> <div ng-if=$ctrl.editingNotes[note.namedNoteTypeId]> <button class="btn btn-success btn-xs" ng-disabled="! $ctrl.editingNotes[note.namedNoteTypeId].noteTextVal" ng-click=$ctrl.updateNote(note)> &nbsp;&nbsp;Save&nbsp; </button> <br> <a class="btn btn-xs" ng-click=$ctrl.cancelEditNote(note)> Cancel </a> </div> </td> </tr> </tbody> </table> </div> </div>'},975:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(n(1)),a=n(2),o=n(0),r=n(112),l=s(n(976));function s(t){return t&&t.__esModule?t:{default:t}}var d={availableTypes:[],notes:[],allNoteTypes:[],hasRole:!1,creatingNote:!1};function c(t,e,n,l){var s=(0,o.initialiseData)(this,d),c=function(){s.availableTypes=function(t,e,n){var a=i.default.map(n,"namedNoteTypeId");return i.default.chain(e).filter(function(t){return!t.isReadOnly}).filter(function(e){return-1!==e.applicableEntityKinds.indexOf(t.kind)}).filter(function(t){return!i.default.includes(a,t.id)}).value()}(s.parentEntityRef,s.allNoteTypes,s.notes)};s.$onInit=function(){s.parentEntityRef&&p().then(c);var t=(0,r.getEditRoleForEntityKind)(s.parentEntityRef.kind);l.whoami().then(function(e){return s.hasRole=l.hasRole(e,t)})};var u=function(){var t={force:arguments.length>0&&void 0!==arguments[0]&&arguments[0],cacheRefreshListener:{componentId:"entity-named-notes-section",fn:f}};return n.loadViewData(a.CORE_API.EntityNamedNoteStore.findByEntityReference,[s.parentEntityRef],t).then(function(t){return s.notes=t.data}).catch(function(t){return e.error("Failed to load data: ",t)})},p=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t.all([u(e),function(){var t={cacheRefreshListener:{componentId:"entity-named-notes-section",fn:f}};return n.loadAppData(a.CORE_API.EntityNamedNoteTypeStore.findAll,[],t).then(function(t){return s.allNoteTypes=t.data})}()])},f=function(t){"REFRESH"===t.eventType&&(0,a.getApiReference)(t.serviceName,t.serviceFnName)===a.CORE_API.EntityNamedNoteStore.findByEntityReference&&u()};s.saveNote=function(t){var i=[s.parentEntityRef,t.namedNoteTypeId,{newStringVal:t.noteText}];return n.execute(a.CORE_API.EntityNamedNoteStore.save,i).then(function(t){t?e.success("Note saved successfully"):e.error("Failed to save note")}).then(function(){return u(!0)}).then(c)},s.deleteNote=function(t){var i=[s.parentEntityRef,t.namedNoteTypeId];return n.execute(a.CORE_API.EntityNamedNoteStore.remove,i).then(function(t){t?e.success("Note deleted successfully"):e.error("Failed to delete note")}).then(function(){return u(!0)}).then(c)},s.editorDismiss=function(){s.creatingNote=!1},s.showEditor=function(){s.creatingNote=!0}}c.$inject=["$q","Notification","ServiceBroker","UserService"];var u={template:l.default,bindings:{parentEntityRef:"<"},controller:c};e.default={component:u,id:"waltzEntityNamedNotesSection"}},976:function(t,e){t.exports=' <div> <waltz-section-actions ng-if="$ctrl.hasRole && $ctrl.availableTypes.length > 0"> <button type=button class="btn btn-xs btn-primary" ng-if="($ctrl.hasRole && $ctrl.availableTypes.length > 0)" ng-click=$ctrl.showEditor()> Add Note </button> </waltz-section-actions> <waltz-entity-named-notes-panel parent-entity-ref=$ctrl.parentEntityRef notes=$ctrl.notes all-note-types=$ctrl.allNoteTypes on-save=$ctrl.saveNote on-delete=$ctrl.deleteNote creating-note=$ctrl.creatingNote on-editor-dismiss=$ctrl.editorDismiss> </waltz-entity-named-notes-panel> </div> '},977:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(6)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(221)),o=n(7);e.default=function(){var t=i.default.module("waltz.entity-relationship",[]);return(0,o.registerStores)(t,[a]),t.name}},978:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=z(n(6)),a=n(7),o=z(n(223)),r=z(n(979)),l=z(n(981)),s=z(n(983)),d=z(n(988)),c=z(n(989)),u=z(n(991)),p=z(n(993)),f=z(n(995)),m=z(n(997)),g=z(n(999)),v=z(n(1001)),y=z(n(1003)),h=z(n(1005)),w=z(n(1007)),b=z(n(1009));function z(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module("waltz.entity.statistics",[]);return t.config(s.default),(0,a.registerStores)(t,[o.default]),t.service("EntityStatisticUtilities",d.default),t.directive("waltzEntityStatisticBooleanRenderer",c.default).directive("waltzEntityStatisticPercentageRenderer",u.default).directive("waltzEntityStatisticNumericRenderer",p.default),(0,a.registerComponents)(t,[r.default,l.default]),t.component("waltzDurationSelector",f.default).component("waltzEntityStatisticDetailTable",m.default).component("waltzEntityStatisticDetailPanel",g.default).component("waltzEntityStatisticSummaryCard",v.default).component("waltzEntityStatisticHistoryChart",y.default).component("waltzEntityStatisticHistoryPanel",h.default).component("waltzEntityStatisticTree",w.default).component("waltzRelatedEntityStatisticsSummaries",b.default),t.name}},979:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(14),a=n(25),o=n(0),r=n(2),l=function(t){return t&&t.__esModule?t:{default:t}}(n(980));var s={entityStatisticsGrouped:[]};function d(t){var e=(0,o.initialiseData)(this,s);e.$onChanges=function(n){e.parentEntityRef&&t.loadViewData(r.CORE_API.EntityStatisticStore.findStatsForEntity,[e.parentEntityRef]).then(function(t){return e.entityStatisticsGrouped=(0,a.nest)().key(function(t){return t.definition.category}).sortKeys(i.ascending).key(function(t){return t.definition.name}).sortKeys(i.ascending).sortValues(function(t,e){return t.value.outcome<e.value.outcome}).entries(t.data)})}}d.$inject=["ServiceBroker"],e.default={component:{template:l.default,bindings:{parentEntityRef:"<"},controller:d},id:"waltzEntityStatisticSection"}},980:function(t,e){t.exports='<div> <div class="row col-sm-12 value" ng-if="$ctrl.entityStatisticsGrouped.length > 0"> <table class="table table-condensed waltz-entity-statistic" style=border-collapse:separate> <thead> <tr> <th></th> <th>Name</th> <th>Outcome</th> <th>Reason</th> <th>Last Refresh</th> </tr> </thead> <tbody ng-repeat-start="(group, stats) in $ctrl.entityStatisticsGrouped"> <tr class=category> <td colspan=5> <waltz-icon name="{{ stats.key | toIconName:\'entityStatistic\' }}"> </waltz-icon> <strong class=small ng-bind="stats.key | toDisplayName:\'entityStatistic\'"> </strong> </td> </tr> </tbody> <tbody ng-repeat-end ng-repeat="stat in stats.values" class="small text-muted"> <tr ng-repeat="statValue in stat.values"> <td></td> <td> <span ng-if=$first ng-bind=statValue.definition.name uib-tooltip={{statValue.definition.description}}> </span> </td> <td ng-switch=statValue.definition.type> <waltz-entity-statistic-boolean-renderer statistic=statValue.definition value=statValue.value ng-switch-when=BOOLEAN> </waltz-entity-statistic-boolean-renderer> <waltz-entity-statistic-percentage-renderer statistic=statValue.definition value=statValue.value ng-switch-when=PERCENTAGE> </waltz-entity-statistic-percentage-renderer> <waltz-entity-statistic-numeric-renderer statistic=statValue.definition value=statValue.value ng-switch-when=NUMERIC> </waltz-entity-statistic-numeric-renderer> <kbd ng-switch-default ng-bind=statValue.value.outcome> </kbd> </td> <td> <span ng-bind=statValue.value.reason> </span> </td> <td> <waltz-from-now timestamp=statValue.value.createdAt> </waltz-from-now> </td> </tr> </tbody> </table> </div> <waltz-no-data ng-if="$ctrl.entityStatisticsGrouped.length == 0"> <message> <strong> No Indicators </strong> for this application. </message> </waltz-no-data> </div> '},981:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(2),o=n(17),r=function(t){return t&&t.__esModule?t:{default:t}}(n(982));var l={activeDefinition:null,activeSummary:null,definitions:[],loading:!1,summaries:{}};function s(t){var e=(0,i.resetData)(this,l);t.loadAppData(a.CORE_API.EntityStatisticStore.findAllActiveDefinitions,[]).then(function(t){return e.definitions=t.data}),e.onDefinitionSelection=function(n){if(e.activeDefinition=n,e.summaries[n.id])e.loading=!1,e.activeSummary=e.summaries[n.id];else{e.loading=!0;var r=(0,o.mkSelectionOptions)(e.parentEntityRef,null,[i.entityLifecycleStatuses.ACTIVE,i.entityLifecycleStatuses.PENDING,i.entityLifecycleStatuses.REMOVED]);t.loadViewData(a.CORE_API.EntityStatisticStore.findStatTallies,[[n.id],r]).then(function(t){e.loading=!1,e.summaries[n.id]=t.data[0],e.activeSummary=t.data[0]})}}}s.$inject=["ServiceBroker"],e.default={component:{template:r.default,bindings:{parentEntityRef:"<"},controller:s},id:"waltzEntityStatisticSummarySection"}},982:function(t,e){t.exports='<div> <div class=row ng-if="$ctrl.definitions.length > 0"> <div class=col-md-5> <div style="border-right:2px solid #f9f9f9"> <waltz-entity-statistic-tree definitions=$ctrl.definitions on-selection=$ctrl.onDefinitionSelection> </waltz-entity-statistic-tree> <hr> <div class="small text-muted waltz-paragraph"> Various indicators are collected for applications. Use the tree control above to select one. Click on its \'explore\' link to see more about that indicator. </div> </div> </div> <div class=col-md-7> <div ng-if="$ctrl.activeSummary == null && ! $ctrl.loading"> <div class="alert alert-info"> <waltz-icon size=lg name=info> </waltz-icon> <span style=padding-left:24px> Select an <strong>indicator</strong> from the tree on the left to see details. </span> </div> </div> <div ng-if="$ctrl.activeSummary != null && $ctrl.loading" style=height:230px> </div> <div ng-if="$ctrl.activeSummary != null && ! $ctrl.loading" class=waltz-fade-if> <waltz-entity-statistic-summary-card summary=$ctrl.activeSummary definition=$ctrl.activeDefinition parent-ref=$ctrl.parentEntityRef sub-title="{{$ctrl.activeDefinition.category | toDisplayName:\'entityStatistic\'}}"> </waltz-entity-statistic-summary-card> </div> </div> </div> <div class=row ng-if="$ctrl.definitions.length == 0"> <div class=col-md-12> <waltz-no-data> <message> <strong> No Indicators </strong> </message> </waltz-no-data> </div> </div> </div> '},983:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(984)),a=o(n(986));function o(t){return t&&t.__esModule?t:{default:t}}var r={url:"entity-statistic"},l={url:"/PERSON/{id:int}/{statId:int}",views:{"content@":i.default}},s={url:"/{kind:string}/{id:int}/{statId:int}",views:{"content@":a.default}};function d(t){t.state("main.entity-statistic",r).state("main.entity-statistic.view-person",l).state("main.entity-statistic.view",s)}d.$inject=["$stateProvider"],e.default=d},984:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(i=(r=l.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=u(n(1)),o=n(0),r=n(17),l=n(114),s=n(31),d=n(2),c=u(n(985));function u(t){return t&&t.__esModule?t:{default:t}}var p={allDefinitions:[],applications:[],bookmarkSection:s.dynamicSections.bookmarksSection,orgUnits:[],statistic:{definition:null,summary:null,values:[]},relatedDefinitions:null,summaries:[],directs:[],duration:"MONTH",managers:[],peers:[],person:null,history:[],visibility:{related:!1},reloading:!1};function f(t,e){var n=(0,r.mkSelectionOptions)(t,e);return n.entityLifecycleStatuses=[o.entityLifecycleStatuses.ACTIVE,o.entityLifecycleStatuses.PENDING,o.entityLifecycleStatuses.REMOVED],n}function m(t,e,n,r){var s=(0,o.resetData)(this,p),c=n.statId,u=n.id,m=r.loadViewData(d.CORE_API.PersonStore.getById,[u]).then(function(t){return t.data});s.statRef={id:c,kind:"ENTITY_STATISTIC"};var g=r.loadViewData(d.CORE_API.EntityStatisticStore.findRelatedStatDefinitions,[c]).then(function(t){return t.data}).then(function(t){return s.relatedDefinitions=t}).then(function(t){return s.statistic.definition=t.self}).then(function(){return s.statRef=Object.assign({},s.statRef,{name:s.statistic.definition.name})}).then(function(){return s.visibility.related=(0,l.hasRelatedDefinitions)(s.relatedDefinitions)}),v=r.loadViewData(d.CORE_API.EntityStatisticStore.findAllActiveDefinitions,[]).then(function(t){return s.allDefinitions=t.data}),y=r.loadAppData(d.CORE_API.OrgUnitStore.findAll,[]).then(function(t){return s.orgUnits=t.data});function h(){var t=f(s.parentRef,"CHILDREN");r.loadViewData(d.CORE_API.EntityStatisticStore.calculateHistoricStatTally,[s.statistic.definition,t,s.duration]).then(function(t){return s.history=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return e?a.default.concat([e],t):t}(t.data,s.statistic.summary)})}t.all([m,g]).then(function(t){var e=i(t,2),n=e[0];e[1];return s.onSelectPerson(n)}).then(v).then(y),s.onSelectPerson=function(t){s.reloading=!0,function(){var t=(0,o.resetData)({},p);s.statistic.summary=t.statistic.summary,s.statistic.values=t.statistic.values,s.summaries=t.summaries,s.history=[]}(),s.person=t;var n={id:t.id,kind:"PERSON"};s.parentRef=n;var i=f(n,"CHILDREN");r.loadViewData(d.CORE_API.EntityStatisticStore.calculateStatTally,[s.statistic.definition,i]).then(function(t){s.statistic.summary=t.data,s.reloading=!1}).then(function(){var t=s.relatedDefinitions.children,e=a.default.chain(t).filter(function(t){return null!==t}).map("id").value();return r.loadViewData(d.CORE_API.EntityStatisticStore.findStatTallies,[e,i]).then(function(t){return t.data})}).then(function(t){return s.summaries=t}),r.loadViewData(d.CORE_API.EntityStatisticStore.findStatValuesByIdSelector,[c,i]).then(function(t){return s.statistic.values=t.data}),r.loadViewData(d.CORE_API.PersonStore.findDirects,[t.employeeId]).then(function(t){return s.directs=t.data}),r.loadViewData(d.CORE_API.PersonStore.findManagers,[t.employeeId]).then(function(t){return s.managers=t.data}),r.loadViewData(d.CORE_API.PersonStore.findDirects,[t.managerEmployeeId]).then(function(t){return t.data}).then(function(e){return a.default.reject(e,function(e){return e.id===t.id})}).then(function(t){return s.peers=t}),r.loadViewData(d.CORE_API.EntityStatisticStore.findStatAppsByIdSelector,[c,i]).then(function(t){return s.applications=t.data}),h(),(0,l.updateUrlWithoutReload)(e,t)},s.onSelectDefinition=function(t){(0,l.navigateToStatistic)(e,t.id,s.parentRef)},s.onChangeDuration=function(t){s.duration=t,h()}}m.$inject=["$q","$state","$stateParams","ServiceBroker"];var g={controller:m,template:c.default,controllerAs:"ctrl"};e.default=g},985:function(t,e){t.exports='<div> <waltz-page-header name="{{ ctrl.statistic.definition.name }}" small=Indicator icon=pie-chart> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li> <a ui-sref="main.person.view ({ empId: ctrl.person.employeeId })" ng-bind=ctrl.person.displayName> </a> </li> <li>Indicators</li> <li ng-bind=ctrl.statistic.definition.name></li> </ol> </waltz-page-header> <div class="waltz-page-summary waltz-page-summary-attach"> <div class=row> <div class=col-sm-8 style="border-right:2px solid #eee"> <div class=row ng-if="!(ctrl.statistic.summary.tallies | isEmpty)"> <div class=col-md-12> <waltz-entity-statistic-detail-panel definition=ctrl.statistic.definition summary=ctrl.statistic.summary values=ctrl.statistic.values applications=ctrl.applications org-units=ctrl.orgUnits> </waltz-entity-statistic-detail-panel> </div> </div> <div ng-if="ctrl.history && !(ctrl.statistic.summary.tallies | isEmpty)"> <hr> <h3>History</h3> <waltz-entity-statistic-history-panel history=ctrl.history duration=ctrl.duration on-change-duration=ctrl.onChangeDuration definition=ctrl.statistic.definition> </waltz-entity-statistic-history-panel> </div> <div ng-if=ctrl.visibility.related> <hr> <h3>Related Indicators</h3> <waltz-related-entity-statistics-summaries definitions=ctrl.relatedDefinitions parent-ref=ctrl.parentRef summaries=ctrl.summaries> </waltz-related-entity-statistics-summaries> </div> </div> <div class=col-sm-8 ng-if="(ctrl.statistic.summary.tallies | isEmpty) && ! ctrl.visibility.related"> <waltz-no-data ng-if="! ctrl.reloading"> <message> <strong>No data points</strong> have been captured for <span ng-bind=ctrl.person.displayName></span>. </message> </waltz-no-data> </div> <div class=col-sm-4 ng-style="{\'border-left\': (ctrl.statistic.summary.tallies.length == 0 && ! ctrl.visibility.related) ? \'2px solid #eee\' : \'none\'}"> <h4> <waltz-icon name=user size=lg></waltz-icon> <span ng-bind=ctrl.person.displayName></span> <small>Tree</small> </h4> <table class="table table-condensed small"> <tbody ng-if="ctrl.managers.length > 0"> <tr ng-repeat="manager in ctrl.managers"> <td> <span ng-if=$first> Managers </span> </td> <td> <a ng-click=ctrl.onSelectPerson(manager) class=clickable> <span ng-bind=manager.displayName></span> </a> </td> </tr> </tbody> <tbody ng-if="ctrl.peers.length > 0"> <tr ng-repeat="peer in ctrl.peers"> <td> <span ng-if=$first> Peers </span> </td> <td> <a ng-click=ctrl.onSelectPerson(peer) class=clickable> <span ng-bind=peer.displayName></span> </a> </td> </tr> </tbody> <tbody ng-if="ctrl.directs.length > 0"> <tr ng-repeat="direct in ctrl.directs"> <td> <span ng-if=$first>Directs</span> </td> <td> <a ng-click=ctrl.onSelectPerson(direct) class=clickable> <span ng-bind=direct.displayName></span> </a> </td> </tr> </tbody> </table> <p class="waltz-paragraph small text-muted" style=padding-top:12px> Select a person listed above to change the vantage point you are viewing this statistic from. </p> <hr> <h4> <waltz-icon fixed-width=true size=lg name="{{ \'ENTITY_STATISTIC\' | toIconName:\'entity\' }}"> </waltz-icon> <span>Indicators <small>Selector</small> </span> </h4> <waltz-entity-statistic-tree definitions=ctrl.allDefinitions on-selection=ctrl.onSelectDefinition current-definition-id=ctrl.statistic.definition.id> </waltz-entity-statistic-tree> <p class="waltz-paragraph small text-muted" style=padding-top:12px> Use the tree above to switch to a different indicator. </p> </div> </div> </div> <br> <waltz-dynamic-section-wrapper parent-entity-ref=ctrl.statRef section=ctrl.bookmarkSection> </waltz-dynamic-section-wrapper> </div> '},986:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=u(n(1)),a=n(0),o=n(74),r=n(17),l=n(114),s=n(31),d=n(2),c=u(n(987));function u(t){return t&&t.__esModule?t:{default:t}}var p={allDefinitions:[],applications:[],orgUnits:[],statistic:{definition:null,summary:null,values:[]},relatedDefinitions:null,summaries:[],navItems:[],selectedNavItem:null,parentStateRef:".",history:[],duration:"MONTH",visibility:{related:!1},reloading:!1,bookmarkSection:s.dynamicSections.bookmarksSection};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return e?i.default.concat([e],t):t}function m(t){var e=(0,r.mkSelectionOptions)(t);return e.entityLifecycleStatuses=[a.entityLifecycleStatuses.ACTIVE,a.entityLifecycleStatuses.PENDING,a.entityLifecycleStatuses.REMOVED],e}function g(t,e,n,r,s){var c=(0,a.resetData)(this,p),u=n.statId,g=n.kind,v=n.id;c.statRef={id:u,kind:"ENTITY_STATISTIC"};var y=s.loadViewData(d.CORE_API.EntityStatisticStore.findRelatedStatDefinitions,[u]).then(function(t){return t.data}).then(function(t){return c.relatedDefinitions=t}).then(function(t){return c.statistic.definition=t.self}).then(function(){return c.statRef=Object.assign({},c.statRef,{name:c.statistic.definition.name})}).then(function(){return c.visibility.related=(0,l.hasRelatedDefinitions)(c.relatedDefinitions)}),h=r.findAllForKind(g,v).then(function(t){return c.navItems=t}),w=s.loadViewData(d.CORE_API.EntityStatisticStore.findAllActiveDefinitions,[]).then(function(t){return c.allDefinitions=t.data}),b=s.loadAppData(d.CORE_API.OrgUnitStore.findAll,[]).then(function(t){return c.orgUnits=t.data});function z(){var t=m(c.parentRef);s.loadViewData(d.CORE_API.EntityStatisticStore.calculateHistoricStatTally,[c.statistic.definition,t,c.duration]).then(function(t){return c.history=f(t.data,c.statistic.summary)})}t.all([h,y]).then(function(){return c.onSelectNavItem(i.default.find(c.navItems,{id:v}))}).then(w).then(b),c.onSelectNavItem=function(t){c.reloading=!0,function(){var t=(0,a.resetData)({},p);c.statistic.summary=t.statistic.summary,c.statistic.values=t.statistic.values,c.summaries=t.summaries,c.history=[]}(),c.selectedNavItem=t;var n={id:t.id,kind:g};c.parentRef=n;var o=m(n);s.loadViewData(d.CORE_API.EntityStatisticStore.calculateStatTally,[c.statistic.definition,o]).then(function(t){c.statistic.summary=t.data,c.reloading=!1}).then(function(){return c.history=f(c.history,c.statistic.summary)}).then(function(){var t=c.relatedDefinitions.children,e=i.default.chain(t).filter(function(t){return null!==t}).map("id").value();return s.loadViewData(d.CORE_API.EntityStatisticStore.findStatTallies,[e,o]).then(function(t){return t.data})}).then(function(t){return c.summaries=t}),s.loadViewData(d.CORE_API.EntityStatisticStore.findStatValuesByIdSelector,[u,o]).then(function(t){return c.statistic.values=t.data}),s.loadViewData(d.CORE_API.EntityStatisticStore.findStatAppsByIdSelector,[u,o]).then(function(t){return c.applications=t.data}),z(),(0,l.updateUrlWithoutReload)(e,t)},c.onSelectDefinition=function(t){(0,l.navigateToStatistic)(e,t.id,c.parentRef)},c.goToParent=function(){var t=(0,o.kindToViewState)(g),n=c.selectedNavItem.id;e.go(t,{id:n})},c.onChangeDuration=function(t){c.duration=t,z()}}g.$inject=["$q","$state","$stateParams","EntityStatisticUtilities","ServiceBroker"];var v={template:c.default,controller:g,controllerAs:"ctrl",bindToController:!0,scope:{}};e.default=v},987:function(t,e){t.exports='<div> <waltz-page-header name="{{ ctrl.statistic.definition.name }}" small=Indicator icon=pie-chart> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li> <a ng-click=ctrl.goToParent() class=clickable ng-bind=ctrl.selectedNavItem.name> </a> </li> <li>Indicators</li> <li ng-bind=ctrl.statistic.definition.name></li> </ol> </waltz-page-header> <div class="waltz-page-summary waltz-page-summary-attach"> <div class=row> <div class=col-sm-8 style="border-right:2px solid #eee"> <div class=row ng-if="!(ctrl.statistic.summary.tallies | isEmpty)"> <div class=col-md-12> <waltz-entity-statistic-detail-panel definition=ctrl.statistic.definition summary=ctrl.statistic.summary values=ctrl.statistic.values applications=ctrl.applications org-units=ctrl.orgUnits> </waltz-entity-statistic-detail-panel> </div> </div> <div class=row ng-if="ctrl.history && !(ctrl.statistic.summary.tallies | isEmpty)"> <div class=col-md-12> <hr> <h3>History</h3> <waltz-entity-statistic-history-panel history=ctrl.history duration=ctrl.duration on-change-duration=ctrl.onChangeDuration definition=ctrl.statistic.definition> </waltz-entity-statistic-history-panel> </div> </div> <div class=row> <div class=col-md-12 ng-if=ctrl.visibility.related> <hr> <h3>Related Indicators</h3> <waltz-related-entity-statistics-summaries definitions=ctrl.relatedDefinitions parent-ref=ctrl.parentRef summaries=ctrl.summaries> </waltz-related-entity-statistics-summaries> </div> </div> </div> <div class=col-sm-8 ng-if="(ctrl.statistic.summary.tallies | isEmpty) && ! ctrl.visibility.related"> <waltz-no-data ng-if="! ctrl.reloading"> <message> <strong>No data points</strong> have been captured for <span ng-bind=ctrl.selectedNavItem.name></span>. </message> </waltz-no-data> </div> <div class=col-sm-4 ng-style="{\'border-left\': (ctrl.statistic.summary.tallies.length == 0 && ! ctrl.visibility.related) ? \'2px solid #eee\' : \'none\'}"> <h4> <waltz-icon fixed-width=true size=lg name="{{ ctrl.parentRef.kind | toIconName:\'entity\' }}"> </waltz-icon> <span ng-bind="ctrl.parentRef.kind | toDisplayName:\'entity\'" ng-if="ctrl.parentRef.kind !== \'MEASURABLE\'"></span> <span ng-bind="ctrl.selectedNavItem.categoryId | toDisplayName:\'measurableCategory\'" ng-if="ctrl.parentRef.kind === \'MEASURABLE\'"></span> <small>Selector</small> </h4> <waltz-entity-hierarchy-navigator model=ctrl.navItems selected-node=ctrl.selectedNavItem on-select=ctrl.onSelectNavItem> </waltz-entity-hierarchy-navigator> <p class="waltz-paragraph small text-muted" style=padding-top:12px> Use the navigational tree above to select a vantage point to view this indicator from. </p> <hr> <h4> <waltz-icon fixed-width=true size=lg name="{{ \'ENTITY_STATISTIC\' | toIconName:\'entity\' }}"> </waltz-icon> <span>Indicators <small>Selector</small> </span> </h4> <waltz-entity-statistic-tree definitions=ctrl.allDefinitions on-selection=ctrl.onSelectDefinition current-definition-id=ctrl.statistic.definition.id> </waltz-entity-statistic-tree> <p class="waltz-paragraph small text-muted" style=padding-top:12px> Use the tree above to switch to a different indicator. </p> </div> </div> </div> <br> <waltz-dynamic-section-wrapper parent-entity-ref=ctrl.statRef section=ctrl.bookmarkSection> </waltz-dynamic-section-wrapper> </div> '},988:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),a=n(2);function o(t){return{findAllForKind:function(e,n){switch(e){case"APP_GROUP":return t.loadViewData(a.CORE_API.AppGroupStore.findMyGroupSubscriptions,[]).then(function(t){return i.default.map(t.data,"appGroup")});case"MEASURABLE":return t.loadAppData(a.CORE_API.MeasurableStore.findAll,[]).then(function(t){return function(t,e){var n=i.default.find(t,{id:e});return n?i.default.filter(t,function(t){return t.categoryId===n.categoryId}):t}(t.data,n)});case"ORG_UNIT":return t.loadAppData(a.CORE_API.OrgUnitStore.findAll,[]).then(function(t){return t.data});case"FLOW_DIAGRAM":return t.loadViewData(a.CORE_API.FlowDiagramStore.getById,[n]).then(function(t){return[t.data]});case"CHANGE_INITIATIVE":return t.loadViewData(a.CORE_API.ChangeInitiativeStore.getById,[n]).then(function(t){return[t.data]});default:throw"esu: Cannot create hierarchy for kind - "+e}}}}o.$inject=["ServiceBroker"],e.default=o},989:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={restrict:"E",replace:!1,scope:{},bindToController:{statistic:"<",value:"<"},controller:function(){},controllerAs:"ctrl",template:function(t){return t&&t.__esModule?t:{default:t}}(n(990)).default};e.default=function(){return i}},990:function(t,e){t.exports="<div> <kbd ng-bind=ctrl.value.outcome> </kbd> </div> "},991:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(n(1));function a(t){return t&&t.__esModule?t:{default:t}}var o={restrict:"E",replace:!1,scope:{},bindToController:{statistic:"<",value:"<"},controller:function(){this.isNumber=function(t){return i.default.isNumber(t)}},controllerAs:"ctrl",template:a(n(992)).default};e.default=function(){return o}},992:function(t,e){t.exports="<div> <kbd> <span ng-if=ctrl.isNumber(ctrl.value.outcome)>{{ctrl.value.outcome | number:2}}%</span> <span ng-if=!ctrl.isNumber(ctrl.value.outcome) ng-bind=ctrl.value.outcome></span> </kbd> </div> "},993:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(n(1));function a(t){return t&&t.__esModule?t:{default:t}}var o={restrict:"E",replace:!1,scope:{},bindToController:{statistic:"<",value:"<"},controller:function(){this.isNumber=function(t){return i.default.isNumber(t)}},controllerAs:"ctrl",template:a(n(994)).default};e.default=function(){return o}},994:function(t,e){t.exports='<div> <kbd> <span ng-if=ctrl.isNumber(ctrl.value.outcome) ng-bind="ctrl.value.outcome | number:2"></span> <span ng-if=!ctrl.isNumber(ctrl.value.outcome) ng-bind=ctrl.value.outcome></span> </kbd> </div> '},995:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1)),a=n(0),o=r(n(996));function r(t){return t&&t.__esModule?t:{default:t}}var l=[{code:"WEEK",name:"1w"},{code:"MONTH",name:"1m"},{code:"QUARTER",name:"3m"},{code:"HALF_YEAR",name:"6m"},{code:"YEAR",name:"1y"}];function s(t){return i.default.map(l,function(e){return Object.assign({},e,{active:e.code===t})})}var d={selection:"MONTH",options:s("MONTH"),onChange:function(t){return console.log("duration-selector: onChange: ",t)}};function c(){var t=(0,a.initialiseData)(this,d);t.$onChanges=function(){return t.options=s(t.duration)},t.onClick=function(e){return t.onChange(e.code)}}c.$inject=[];var u={template:o.default,bindings:{duration:"<",onChange:"<"},controller:c};e.default=u},996:function(t,e){t.exports='<div class="btn-group btn-group-xs" role=group aria-label="Duration Selector"> <button ng-repeat="option in $ctrl.options" class="btn btn-default" ng-class="{ \'active\' : option.active }" ng-click=$ctrl.onClick(option) ng-bind=option.name> </button> </div> '},997:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(n(1)),a=s(n(4)),o=n(0),r=n(27),l=s(n(998));function s(t){return t&&t.__esModule?t:{default:t}}var d="YYYY-MM-DD_HHmmss",c=Object.assign((0,r.mkEntityLinkGridCell)("Application","entity","none"),{sort:{direction:"asc"}}),u=function(t){return{field:"outcome",filter:{term:null,condition:t.filter.EXACT}}},p={field:"application.assetCode",displayName:"Asset Code"},f=function(t,e){return{field:"value",type:e&&"NUMERIC"===e.type?"number":"string",filter:{term:null,condition:t.filter.EXACT}}},m={field:"reason"},g=(0,r.mkLinkGridCell)("Org Unit","orgUnit.name","orgUnit.id","main.org-unit.view"),v={field:"createdAt",displayName:"Last Updated",enableFiltering:!1,visible:!1,cellTemplate:'<div class="ui-grid-cell-contents">\n     <waltz-from-now timestamp="COL_FIELD"></waltz-from-now>\n</div>'};function y(t,e,n,r){var l=this;l.$onChanges=function(t){(l.gridOptions=s(),t.filterOutcome)&&(l.gridOptions.columnDefs[2].filter.term=l.filterOutcome);l.statisticValues&&(0,o.notEmpty)(l.applications)&&(0,o.notEmpty)(l.orgUnits)&&(l.gridOptions.data=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=i.default.keyBy(e,"id"),o=i.default.keyBy(n,"id");return i.default.map(t,function(t){var e=a[t.entity.id];return e?Object.assign({},t,{application:e,orgUnit:o[e.organisationalUnitId]}):t})}(l.statisticValues,l.applications,l.orgUnits))};var s=function(){return{enableGridMenu:!1,enableSorting:!0,enableFiltering:!0,enableColumnMenus:!1,enableHorizontalScrollbar:e.scrollbars.NEVER,onRegisterApi:function(e){t.enabled(e.grid.element,!1),l.gridApi=e},columnDefs:[c,p,u(e),f(e,l.statisticDefinition),m,g,v]}};l.exportData=function(){var t=l.gridApi.grid,e=n.ALL,i=n.ALL,o=l.statisticDefinition.name+"_"+(0,a.default)().format(d)+".csv";r.loadAllDataIfNeeded(t,e,i).then(function(){var n=r.getColumnHeaders(t,i),a=r.getData(t,e,i),l=r.formatAsCsv(n,a,",");r.downloadFile(o,l,!1)})}}y.$inject=["$animate","uiGridConstants","uiGridExporterConstants","uiGridExporterService"];var h={controller:y,bindings:{applications:"<",filterOutcome:"<",lastUpdatedAt:"<",orgUnits:"<",statisticDefinition:"<",statisticValues:"<"},template:l.default};e.default=h},998:function(t,e){t.exports='<div> <div style=font-size:smaller;height:300px ui-grid-exporter ui-grid-resize-columns ui-grid=$ctrl.gridOptions> </div> <div style=padding-top:6px> <a ng-click=$ctrl.exportData() class="small clickable pull-right" style=text-decoration:none role=button> <waltz-icon name=download></waltz-icon> Export </a> <span class="small text-muted pull-right"> <strong>Updated:</strong> <waltz-from-now timestamp=$ctrl.lastUpdatedAt></waltz-from-now>, &nbsp; </span> </div> </div>'},999:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1)),a=n(19),o=n(114);function r(t){return t&&t.__esModule?t:{default:t}}var l=140;var s={bindings:{applications:"<",definition:"<",orgUnits:"<",summary:"<",values:"<"},controller:function(){var t=this,e=function(e){t.selectedPieSegment=e};t.$onChanges=function(){t.pie=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{config:{colorProvider:function(t){return(0,a.variableScale)(t.data.key)},labelProvider:function(t){return t.key},onSelect:arguments[1],size:l},data:i.default.chain(t).map(function(t){return{key:t.id,count:t.count}}).value()}}(t.summary?t.summary.tallies:[],e),t.tableHeadings=(0,o.mkSummaryTableHeadings)(t.definition),t.lastUpdatedAt=t.summary?t.summary.lastUpdatedAt:""}},template:r(n(1e3)).default};e.default=s}}]);