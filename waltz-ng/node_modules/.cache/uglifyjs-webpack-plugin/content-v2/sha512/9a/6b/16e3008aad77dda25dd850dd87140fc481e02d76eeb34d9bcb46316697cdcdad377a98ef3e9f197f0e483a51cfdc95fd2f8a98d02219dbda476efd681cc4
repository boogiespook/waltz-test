{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1079:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=o(n(6)),r=o(n(1080)),i=o(n(1081));function o(t){return t&&t.__esModule?t:{default:t}}function l(t){t.setType({name:\"number\",template:'\\n            <div class=\"form-group\"\\n                 ng-class=\"{ \\'has-error\\': form[options.id].$invalid }\">\\n                <label class=\\'control-label\\'\\n                       for=\\'{{ options.name }}\\'>\\n                    <span ng-bind=\"to.label\"></span>\\n                    <span ng-if=\"to.required\">*</span>\\n                </label>\\n                <input class=\"form-control\" \\n                       id=\"{{ options.id }}\"\\n                       ng-model=\"model[options.key]\" \\n                       type=\"number\"/>\\n            </div>'}),t.setType({name:\"html\",template:'\\n            <div class=\"form-group\"\\n                 ng-class=\"{ \\'has-error\\': form[options.id].$invalid }\">\\n                <label class=\\'control-label\\'\\n                       for=\\'{{ options.name }}\\'>\\n                    <span ng-bind=\"to.label\"></span>\\n                    <span ng-if=\"to.required\">*</span>\\n                </label>\\n                <textarea style=\"font-family:Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New, monospace;\"\\n                          class=\"form-control\" \\n                          id=\"{{ options.id }}\"\\n                          ng-model=\"model[options.key]\"\\n                          rows=\"10\"/>\\n            </div>'})}l.$inject=[\"formlyConfig\"],e.default=function(){var t=a.default.module(\"waltz.formly\",[]);return t.run(l),t.config([\"formlyConfigProvider\",function(t){t.setType({name:\"tags-input\",template:r.default}),t.setType({name:\"org-unit-input\",template:i.default})}]),t.name}},1080:function(t,e){t.exports=\"<div class=form-group> <label>{{options.templateOptions.label}}</label> <tags-input ng-model=model[options.key] placeholder={{options.templateOptions.placeholder}}> <auto-complete ng-if=options.templateOptions.autoCompleteLoader source=options.templateOptions.autoCompleteLoader($query)> </auto-complete> </tags-input> </div>\"},1081:function(t,e){t.exports=\"<waltz-entity-selector on-select=options.templateOptions.onSelect entity-kinds=\\\"['ORG_UNIT']\\\" current-selection=options.templateOptions.ouRef> </waltz-entity-selector>\"},1082:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=i(n(6)),r=i(n(1083));function i(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=a.default.module(\"waltz.history\",[]);return t.service(\"HistoryStore\",r.default),t.name}},1083:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(t){return t&&t.__esModule?t:{default:t}}(n(1));var r=\"history_2\";function i(t){var e=t.get(r);return{put:function(n,i,o,l){var c=t.get(r)||[],s={name:n,state:o,kind:i,stateParams:l},d=a.default.chain([s].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(c))).uniqBy(function(t){return JSON.stringify(t)}).take(10).value();t.set(r,d),e=d},remove:function(n,i,o,l){var c=t.get(r)||[],s={name:n,state:o,kind:i,stateParams:l},d=JSON.stringify(s),u=a.default.filter(c,function(t){return JSON.stringify(t)!==d});t.set(r,u),e=u},getAll:function(){return e||[]}}}i.$inject=[\"localStorageService\"],e.default=i},1084:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=c(n(6)),r=n(7),i=c(n(1085)),o=c(n(1087)),l=c(n(230));function c(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=a.default.module(\"waltz.involvement\",[]);return t.component(\"waltzInvolvedPeopleSection\",i.default),t.service(\"InvolvedSectionService\",o.default),(0,r.registerStore)(t,l.default),t.name}},1085:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],a=!0,r=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(a=(o=l.next()).done)&&(n.push(o.value),!e||n.length!==e);a=!0);}catch(t){r=!0,i=t}finally{try{!a&&l.return&&l.return()}finally{if(r)throw i}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),r=s(n(1)),i=n(0),o=s(n(1086)),l=n(2),c=n(394);function s(t){return t&&t.__esModule?t:{default:t}}var d={allowedInvolvements:[],currentInvolvements:[],gridData:[],gridDataCount:0,exportGrid:function(){},visibility:{editor:!1}};function u(t,e,n,o){var s=(0,i.initialiseData)(this,d),u=function(){var i=n.loadViewData(l.CORE_API.InvolvementStore.findByEntityReference,[s.parentEntityRef],{force:!0}).then(function(t){return t.data}),o=n.loadViewData(l.CORE_API.InvolvementStore.findPeopleByEntityReference,[s.parentEntityRef],{force:!0}).then(function(t){return t.data});t.all([i,o]).then(function(t){var n=a(t,2),i=n[0],o=void 0===i?[]:i,l=n[1],d=void 0===l?[]:l,u=(0,c.aggregatePeopleInvolvements)(o,d);s.gridData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return r.default.chain(t).map(function(t){var n=r.default.map(t.involvements,function(t){return{provenance:t.provenance,displayName:e.lookup(\"involvementKind\",t.kindId)}}),a=r.default.chain(n).map(\"displayName\").join(\", \").value();return{person:t.person,roles:n,rolesDisplayName:a}}).sortBy(\"person.displayName\").value()}(u,e),s.currentInvolvements=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return r.default.chain(t).flatMap(function(t){var e=function(t){return t?{id:t.id,name:t.displayName,kind:\"PERSON\"}:t}(t.person);return r.default.map(t.involvements,function(t){return{entity:e,involvement:+t.kindId,isReadOnly:\"waltz\"!==t.provenance}})}).value()}(u)})};s.$onInit=function(){n.loadAppData(l.CORE_API.InvolvementKindStore.findAll,[]).then(function(t){return s.involementKinds=t.data})},s.$onChanges=function(t){s.parentEntityRef&&u(),s.allowedInvolvements=r.default.map(e.getAllByType(\"involvementKind\"),function(t,e){return{value:+e,name:t}})},s.columnDefs=[{field:\"person.displayName\",displayName:\"Name\",cellTemplate:'\\n                <div class=\"ui-grid-cell-contents\"> \\n                    <a ui-sref=\"main.person.view ({empId: row.entity.person.employeeId})\" ng-bind=\"COL_FIELD\"></a> - \\n                    <a href=\"mailto:{{row.entity.person.email}}\">\\n                        <waltz-icon name=\"envelope-o\"></waltz-icon>\\n                    </a>\\n                </div>'},{field:\"person.title\",displayName:\"Title\"},{field:\"person.officePhone\",displayName:\"Telephone\"},{field:\"rolesDisplayName\",displayName:\"Roles\",sortingAlgorithm:function(t,e){var n=r.default.join(r.default.map(t,\"displayName\")),a=r.default.join(r.default.map(e,\"displayName\"));return n.localeCompare(a)},cellTemplate:'\\n                <div class=\"ui-grid-cell-contents\"> \\n                    <span ng-bind=\"COL_FIELD\" \\n                          uib-popover-template=\"\\'wips/roles-popup.html\\'\"\\n                          popover-trigger=\"mouseenter\"\\n                          popover-append-to-body=\"true\">\\n                    </span>   \\n                </div>'}],s.onGridInitialise=function(t){s.exportGrid=function(){return t.exportFn(\"people.csv\")}},s.onGridChange=function(t){s.gridDataCount=t.entriesCount},s.editMode=function(t){s.visibility.editor=t},s.onAdd=function(t){o.addInvolvement(s.parentEntityRef,t).then(u)},s.onRemove=function(t){o.removeInvolvement(s.parentEntityRef,t).then(u)}}u.$inject=[\"$q\",\"DisplayNameService\",\"ServiceBroker\",\"InvolvedSectionService\"];var f={bindings:{parentEntityRef:\"<\"},template:o.default,controller:u};e.default=f},1086:function(t,e){t.exports='<div id=people-section> <waltz-section-actions> <button waltz-has-role-for-entity-kind={{$ctrl.parentEntityRef.kind}} ng-click=$ctrl.editMode(true) class=\"btn btn-xs btn-primary\" ng-if=\"$ctrl.visibility.editor === false\"> Edit </button> <button ng-click=$ctrl.editMode(false) class=\"btn btn-xs btn-primary\" ng-if=\"$ctrl.visibility.editor === true\"> Done </button> <button ng-click=$ctrl.exportGrid() class=\"btn btn-xs btn-primary\" ng-disabled=\"$ctrl.gridDataCount == 0\"> <waltz-icon name=cloud-download></waltz-icon> Export </button> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.sourceDataOverlay = ! $ctrl.sourceDataOverlay\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.sourceDataOverlay entities=\"[\\'INVOLVEMENT\\']\"> </waltz-source-data-overlay> <div ng-if=\"$ctrl.visibility.editor === false\"> <div ng-if=\"$ctrl.gridData.length > 0\"> <waltz-grid-with-search column-defs=$ctrl.columnDefs entries=$ctrl.gridData search-placeholder-text=\"Search people...\" on-initialise=$ctrl.onGridInitialise on-change=$ctrl.onGridChange> </waltz-grid-with-search> </div> <waltz-no-data ng-if=\"$ctrl.gridData.length == 0\"> <message> <strong> No people </strong> have been associated. </message> </waltz-no-data> </div> <waltz-entity-involvement-editor ng-if=\"$ctrl.visibility.editor === true\" parent-entity-ref=$ctrl.parentEntityRef current-involvements=$ctrl.currentInvolvements target-entity-kind=\"\\'PERSON\\'\" allowed-involvements=$ctrl.allowedInvolvements on-add=$ctrl.onAdd on-remove=$ctrl.onRemove> </waltz-entity-involvement-editor> </div> <script type=text/ng-template id=wips/roles-popup.html> <div>\\n        <table class=\"table table-condensed small table-hover\">\\n            <thead>\\n            <tr>\\n                <th>Role</th>\\n                <th>Provenance</th>\\n            </tr>\\n            </thead>\\n\\n            <tbody>\\n                <tr ng-repeat=\"role in row.entity.roles\">\\n                    <td>\\n                        <span ng-bind=\"role.displayName\"></span>\\n                    </td>\\n                    <td>\\n                        <span ng-bind=\"role.provenance\"></span>\\n                    </td>\\n                </tr>\\n            </tbody>\\n        </table>\\n    </div> <\\/script>'},1087:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(394);function r(t,e){return{addInvolvement:function(n,r){return t.changeInvolvement(n,(0,a.mkChangeCommand)(\"ADD\",r.entity,r.involvement)).then(function(t){t?e.success(\"Involvement added successfully\"):e.warning(\"Failed to add involvement\")})},removeInvolvement:function(n,r){return t.changeInvolvement(n,(0,a.mkChangeCommand)(\"REMOVE\",r.entity,r.involvement)).then(function(t){t?e.success(\"Involvement removed successfully\"):e.warning(\"Failed to remove involvement\")})}}}r.$inject=[\"InvolvementStore\",\"Notification\"],e.default=r},1088:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=l(n(6)),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(231)),i=n(7),o=l(n(1089));function l(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=a.default.module(\"waltz.involvement.kind\",[]);return t.service(\"InvolvementKindService\",o.default),(0,i.registerStores)(t,[r]),t.name}},1089:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=null;function r(t){var e=function(){return(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||null==a)&&(a=t.findAll()),a};return e(),{loadInvolvementKinds:e,update:function(n){if(a&&void 0!==n&&null!==n)return t.update(n).then(function(t){if(\"SUCCESS\"===t.outcome)return e(!0).then(function(t){return!0});throw\"could not update: \"+n})},deleteById:function(n){return t.deleteById(n).then(function(t){return e(!0).then(function(e){return t})})},create:function(n){return t.create(n).then(function(t){if(t>0)return e(!0).then(function(e){return t});throw\"could not create: \"+n})}}}r.$inject=[\"InvolvementKindStore\"],e.default=r},1090:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=l(n(6)),r=n(7),i=l(n(1091)),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(232));function l(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=a.default.module(\"waltz.logical.data.element\",[]);return(0,r.registerStores)(t,[o]),t.config(i.default),t.name}},1091:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(2);var r={},i={url:\"logical-data-element/{id:int}\",views:{\"content@\":function(t){return t&&t.__esModule?t:{default:t}}(n(1092)).default}};function o(t,e,n){var r=e.externalId;n.loadViewData(a.CORE_API.LogicalDataElementStore.getByExternalId,[r]).then(function(e){var n=e.data;n?t.go(\"main.logical-data-element.view\",{id:n.id}):console.log(\"Cannot find logical data element corresponding to external id: \"+r)})}o.$inject=[\"$state\",\"$stateParams\",\"ServiceBroker\"];var l={url:\"logical-data-element/external-id/{externalId:string}\",resolve:{bouncer:o}};function c(t){t.state(\"main.logical-data-element.bouncer\",l).state(\"main.logical-data-element\",r).state(\"main.logical-data-element.view\",i)}c.$inject=[\"$stateProvider\"],e.default=c},1092:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(2),r=n(0),i=n(31),o=function(t){return t&&t.__esModule?t:{default:t}}(n(1093));var l={logicalDataElement:null,tour:[],bookmarksSection:i.dynamicSections.bookmarksSection,entityNamedNotesSection:i.dynamicSections.entityNamedNotesSection,relatedPhysicalFieldSection:i.dynamicSections.relatedPhysicalFieldSection};function c(t,e,n,i){var o=(0,r.initialiseData)(this,l),c=t.id;o.entityReference={id:c,kind:\"LOGICAL_DATA_ELEMENT\"},n.loadViewData(a.CORE_API.LogicalDataElementStore.getById,[c]).then(function(t){return o.logicalDataElement=t.data}).then(function(){return i.initialiseForKey(\"main.logical-data-element.view\",!0)}).then(function(t){return o.tour=t}).then(function(){return function(t,e){if(e){var n=function(t){return{name:t.name,kind:\"LOGICAL_DATA_ELEMENT\",state:\"main.logical-data-element.view\",stateParams:{id:t.id}}}(e);t.put(n.name,n.kind,n.state,n.stateParams)}}(e,o.logicalDataElement)})}c.$inject=[\"$stateParams\",\"HistoryStore\",\"ServiceBroker\",\"TourService\"],e.default={template:o.default,controller:c,controllerAs:\"ctrl\"}},1093:function(t,e){t.exports='<div class=container-fluid> <waltz-page-header name=\"{{ ctrl.logicalDataElement.name }}\" small=\"{{ ctrl.logicalDataElement.type }}\" tour=ctrl.tour icon=asterisk> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li ng-if=ctrl.logicalDataElement ng-bind=\"ctrl.logicalDataElement.name | truncateMiddle:50\"></li> <li ng-if=!ctrl.logicalDataElement>Logical Data Element</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <div class=row ng-if=ctrl.logicalDataElement> <div class=col-md-12> <waltz-sub-section name=Overview> <content> <div class=waltz-sub-section-content> <div ng-bind=ctrl.logicalDataElement.description> </div> </div> </content> </waltz-sub-section> </div> </div> <waltz-no-data ng-if=!ctrl.logicalDataElement> <message>No information for this logical data element</message> </waltz-no-data> </div> <br> <div ng-if=ctrl.logicalDataElement> <waltz-dynamic-section-wrapper section=ctrl.entityNamedNotesSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-dynamic-section-wrapper section=ctrl.relatedPhysicalFieldSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-dynamic-section-wrapper section=ctrl.bookmarksSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> </div> </div>'},1094:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=d(n(6)),r=n(7),i=d(n(1095)),o=d(n(1098)),l=d(n(1138)),c=d(n(233)),s=d(n(1141));function d(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=a.default.module(\"waltz.logical.flow\",[]);return t.config(l.default),(0,i.default)(t),(0,o.default)(t),(0,r.registerStore)(t,c.default),t.service(\"LogicalFlowUtilityService\",s.default),t.name}},1095:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(t){return t&&t.__esModule?t:{default:t}}(n(1096));e.default=function(t){t.directive(\"waltzFlowCloudDiagram\",a.default)}},1096:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(30),r=n(14),i=function(t){return t&&t.__esModule?t:{default:t}}(n(1097));function o(t,e){var n=e.appCounts,i=e.flowCounts;!function(t,e){l(t,\"intra-count\",e.intra+\" app/s\"),l(t,\"in-count\",e.inbound+\" sending app/s\"),l(t,\"out-count\",e.outbound+\" receiving app/s\")}(t,n),function(t,e,n){var a=function(t,e){return t.intra?{inbound:(e.inbound/t.intra).toFixed(2),outbound:(e.outbound/t.intra).toFixed(2),intra:(e.intra/t.intra).toFixed(2)}:{inbound:\"n/a\",outbound:\"n/a\",intra:\"n/a\"}}(e,n);l(t,\"intra-ratio\",\"Intra-app connectivity ratio: \"+a.intra),n.inbound>0&&l(t,\"in-ratio\",\"Connectivity ratio: \"+a.inbound);n.outbound>0&&l(t,\"out-ratio\",\"Connectivity ratio: \"+a.outbound)}(t,n,i),function(t,e,n){c(t,\"intra-ratio\",\"(#unique app connections / #apps in group) \\n => \"+n.intra+\" / \"+e.intra),n.inbound>0&&c(t,\"in-ratio\",\"(#unique app connections / #apps in group) \\n => \"+n.inbound+\" / \"+e.intra);n.outbound>0&&c(t,\"out-ratio\",\"(#unique app connections / #apps in group) \\n => \"+n.outbound+\" / \"+e.intra)}(t,n,i),function(t,e){var n=[e.inbound,e.outbound],i=(0,a.scaleLinear)().domain([(0,r.min)(n),(0,r.max)(n)]).range([.85,1.12]);s(t,\"in-arrow\",i(e.inbound)),s(t,\"out-arrow\",i(e.outbound))}(t,n)}function l(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"\",a=t.getElementById(e).getElementsByTagName(\"text\")[0];a?a.textContent=n:console.log(\"FlowCloudDiagram: Could not find element with id: \"+e)}function c(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"\",a=t.getElementById(e);if(a){var r=document.createElementNS(\"http://www.w3.org/2000/svg\",\"title\");r.textContent=n,a.appendChild(r)}else console.log(\"FlowCloudDiagram: Could not find element with id: \"+e)}function s(t,e,n){var a=\"matrix(\"+n+\", 0, 0, \"+n+\", \"+(125-125*n)+\", \"+(100-100*n)+\" )\";t.getElementById(e).setAttribute(\"transform\",a)}function d(t,e){var n=e[0];t.$watch(\"ctrl.stats\",function(t){t&&o(n,t)})}d.$inject=[\"$scope\",\"$element\"];var u={restrict:\"E\",replace:!0,template:i.default,scope:{},controller:d,controllerAs:\"ctrl\",bindToController:{stats:\"<\"}};e.default=function(){return u}},1097:function(t,e){t.exports='<svg viewBox=\"-40 0 340 250\" version=1.1 xmlns=http://www.w3.org/2000/svg xml:space=preserve> <g id=group transform=matrix(1,0,0,1,-26.6259,-4.26604)> <g id=out-group transform=matrix(1,0,0,1,25.4844,26.7539)> <path id=out-arrow d=M176.13,149.49L190.14,130.61L182.89,130.61L182.89,86.57L169.38,86.57L169.38,130.61L162.12,130.61L176.13,149.49Z style=fill:#0c3658;fill-rule:nonzero /> <g id=out-count transform=matrix(1,0,0,1,147,171.043)> <text text-anchor=start x=0px y=0px style=font-family:Helvetica;font-size:15px;fill:#000> </text> </g> <g id=out-ratio transform=matrix(1,0,0,1,147,191.043)> <text x=0px text-anchor=start y=0px style=font-family:Helvetica;font-size:13px;fill:#000> </text> </g> </g> <g id=in-group transform=matrix(1,0,0,1,27.9766,27.3984)> <path id=in-arrow d=M88.26,70.15L72.54,89.18L80.68,89.18L80.68,133.6L95.84,133.6L95.84,89.18L103.98,89.18L88.26,70.15Z style=fill:#0c3658;fill-rule:nonzero /> <g id=in-count transform=matrix(1,0,0,1,110,170)> <text text-anchor=end style=font-family:Helvetica;font-size:15px;fill:#000> </text> </g> <g id=in-ratio transform=matrix(1,0,0,1,110,190)> <text text-anchor=end style=font-family:Helvetica;font-size:13px;fill:#000> </text> </g> </g> <g id=cloud-group transform=matrix(1.20687,0,0,1.25123,-5.57163,2.28909)> <g id=cloud-shape> <path d=\"M191.81,23.31C183.68,23.31 176.18,25.61 169.92,29.36C160.54,14.55 144.07,4.54 125.31,4.54C102.17,4.54 82.57,19.35 75.48,40.42C71.52,38.96 67.35,38.12 62.98,38.12C43.17,38.12 27.33,53.98 27.33,73.79C27.33,93.61 43.17,109.46 62.98,109.46L191.4,109.46C215.37,109.46 234.55,90.27 234.55,66.28C234.76,42.71 215.37,23.31 191.81,23.31Z\" style=fill:#7da3cd;fill-opacity:.678431;fill-rule:nonzero /> </g> <g id=intra-count transform=matrix(1,0,0,1,125,50)> <text text-anchor=middle style=font-family:Helvetica;font-size:12px;fill:#000> </text> </g> <g id=intra-ratio transform=matrix(1,0,0,1,135,70)> <text text-anchor=middle style=font-family:Helvetica;font-size:10.39px;fill:#000> </text> </g> </g> </g> </svg> '},1098:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(7),r=S(n(1099)),i=S(n(1101)),o=S(n(1103)),l=S(n(1105)),c=S(n(1107)),s=S(n(1109)),d=S(n(1111)),u=S(n(1113)),f=S(n(1115)),p=S(n(1117)),g=S(n(1119)),v=S(n(1121)),m=S(n(1123)),y=S(n(1125)),w=S(n(1127)),h=S(n(1129)),b=S(n(1131)),k=S(n(1133)),I=S(n(1135)),$=S(n(1136));function S(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){(0,a.registerComponents)(t,[r.default,i.default,o.default,c.default,l.default,f.default,p.default,u.default,s.default,d.default]),t.component(\"waltzRatedFlowSummaryInfoCell\",g.default).component(\"waltzRatedSummaryTable\",v.default).component(\"waltzRatedSummaryCell\",m.default).component(\"waltzAppCentricFlowTable\",y.default).component(\"waltzLogicalFlowDiagram\",w.default).component(\"waltzLogicalFlowCounterpartSelector\",h.default).component(\"waltzLogicalFlowsTabgroup\",b.default).component(\"waltzLogicalFlowsTabgroupSection\",k.default).component(\"waltzLogicalFlowTable\",I.default).component(\"waltzFlowFilterOptions\",$.default)}},1099:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=c(n(1)),r=n(6),i=n(0),o=n(2),l=c(n(1100));function c(t){return t&&t.__esModule?t:{default:t}}var s=\"logical-flow-upload-mapping\",d={currentStep:1,columnMappings:null,loadedMappings:null,mappingsComplete:!1,newFlows:[],sourceData:[],sourceColumns:[],targetColumns:[{key:\"source\",name:\"Source\",required:!0,description:\"The source of the flow\"},{key:\"target\",name:\"Target\",required:!0,description:\"The target of the flow\"},{key:\"dataType\",name:\"Data Type\",required:!0,description:\"The flow's data type\"}]};function u(t){var e=(0,i.initialiseData)(this,d);e.backVisible=function(){return e.currentStep>1},e.back=function(){e.currentStep--,3===e.currentStep&&e.parseFlows()},e.nextVisible=function(){return e.currentStep<4},e.canGoNext=function(){switch(e.currentStep){case 1:return e.sourceData.length>0&&e.sourceColumns.length>0;case 2:return!a.default.isEmpty(e.columnMappings)&&e.mappingsComplete;case 3:return e.newFlows.length>0;default:throw\"Unrecognised step number: \"+e.currentStep}},e.next=function(){e.currentStep++,3===e.currentStep&&(!function(t,e,n,a){var i=(0,r.toJson)({sourceColumns:e,targetColumns:n});t.loadViewData(o.CORE_API.SharedPreferenceStore.generateKeyRoute,[i],{force:!0}).then(function(e){return t.execute(o.CORE_API.SharedPreferenceStore.save,[e.data,s,(0,r.toJson)(a)]).then(function(t){return t.data})})}(t,e.sourceColumns,e.targetColumns,e.columnMappings),e.parseFlows()),4===e.currentStep&&e.uploadFlows()},e.spreadsheetLoaded=function(n){e.sourceData=n.rowData,e.sourceColumns=a.default.map(n.columnDefs,\"name\"),function(t,e,n){var a=(0,r.toJson)({sourceColumns:e,targetColumns:n});return t.loadViewData(o.CORE_API.SharedPreferenceStore.generateKeyRoute,[a],{force:!0}).then(function(e){return t.execute(o.CORE_API.SharedPreferenceStore.getByKeyAndCategory,[e.data,s]).then(function(t){return t.data}).then(function(t){return t?JSON.parse(t.value):void 0})})}(t,e.sourceColumns,e.targetColumns).then(function(t){e.loadedMappings=t})},e.onMappingsChanged=function(t){e.columnMappings=t.mappings,e.mappingsComplete=t.isComplete()},e.parserInitialised=function(t){e.parseFlows=t.parseFlows},e.parseComplete=function(t){t.isComplete()&&(e.newFlows=a.default.chain(t.data).filter(function(t){return null===t.existing}).map(function(t){return{source:t.source.entityRef,target:t.target.entityRef,dataType:t.dataType.entityRef,provenance:t.provenance}}).value())},e.uploaderInitialised=function(t){e.uploadFlows=t.uploadFlows},e.uploadComplete=function(){}}u.$inject=[\"ServiceBroker\"];var f={template:l.default,bindings:{},controller:u};e.default={component:f,id:\"waltzBulkLogicalFlowLoaderWizard\"}},1100:function(t,e){t.exports='<div class=waltz-bulk-loader-wizard> <div ng-show=\"$ctrl.currentStep === 1\"> <waltz-static-panels group-key=BULK-UPLOAD.LOGICAL-FLOW render-mode=chromeless> </waltz-static-panels> <waltz-spreadsheet-loader on-spreadsheet-loaded=$ctrl.spreadsheetLoaded> </waltz-spreadsheet-loader> </div> <div ng-show=\"$ctrl.currentStep === 2\"> <waltz-column-mapper source-columns=$ctrl.sourceColumns target-columns=$ctrl.targetColumns existing-mappings=$ctrl.loadedMappings on-change=$ctrl.onMappingsChanged> </waltz-column-mapper> </div> <div ng-show=\"$ctrl.currentStep === 3\"> <waltz-bulk-logical-flow-parser column-mappings=$ctrl.columnMappings source-data=$ctrl.sourceData on-initialise=$ctrl.parserInitialised on-parse-complete=$ctrl.parseComplete> </waltz-bulk-logical-flow-parser> </div> <div ng-show=\"$ctrl.currentStep === 4\"> <waltz-bulk-logical-flow-uploader flows=$ctrl.newFlows on-initialise=$ctrl.uploaderInitialised on-upload-complete=$ctrl.uploadComplete> </waltz-bulk-logical-flow-uploader> </div> <div class=text-right> <br> <hr/> <a class=clickable ng-click=$ctrl.back() ng-if=$ctrl.backVisible()> Back </a> <button class=\"btn btn-xs btn-success\" ng-click=$ctrl.next() ng-if=$ctrl.nextVisible() ng-disabled=!$ctrl.canGoNext()> Next </button> </div> </div>'},1101:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],a=!0,r=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(a=(o=l.next()).done)&&(n.push(o.value),!e||n.length!==e);a=!0);}catch(t){r=!0,i=t}finally{try{!a&&l.return&&l.return()}finally{if(r)throw i}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),r=f(n(1)),i=n(25),o=n(2),l=n(0),c=n(12),s=n(0),d=n(75),u=f(n(1102));function f(t){return t&&t.__esModule?t:{default:t}}var p={columnDefs:[],columnMappings:{},filterCriteria:null,filteredData:[],loading:!1,parsedData:[],sourceData:[],summary:{},onInitialise:function(t){return console.log(\"default onInitialise handler for bulk-logical-flow-parser: \",t)},onParseComplete:function(t){return console.log(\"default onParseComplete handler for bulk-logical-flow-parser: \",t)}};function g(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],n=arguments[2],a=t[r.default.chain(n).toLower().trim().value()];return{identifier:n,entityRef:a?(0,c.toEntityRef)(a,e):null}}function v(t,e,n){return{field:e+\".name\",displayName:t,cellTemplate:'\\n            <div class=\"ui-grid-cell-contents\">\\n                <waltz-entity-link ng-if=\"row.entity.'+e+'\"\\n                                   entity-ref=\"row.entity.'+e+'\">\\n                </waltz-entity-link>\\n                <span ng-if=\"!row.entity.'+e+'\"\\n                      class=\"text-danger bg-danger\">\\n                    <strong ng-bind=\"row.entity.'+n+'\"></strong>\\n                    <small>not found</small>\\n                </span>\\n            </div>'}}function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.default.keys(t);return r.default.map(e,function(e){var i={};return r.default.forEach(a,function(a){var o=t[a],l=n[a]||r.default.identity;i[a]=l(e[o])}),i})}function y(t,e){return t.loadViewData(o.CORE_API.LogicalFlowStore.findBySourceAndTargetEntityReferences,[e],{force:!0}).then(function(e){var n=r.default.map(e.data,\"id\");return t.loadViewData(o.CORE_API.LogicalFlowDecoratorStore.findByFlowIdsAndKind,[n],{force:!0}).then(function(t){var n=r.default.groupBy(t.data,\"dataFlowId\");return r.default.flatMap(e.data,function(t){var e=n[t.id];return r.default.map(e,function(e){return Object.assign({},t,{decorator:e})})})})})}function w(t){switch(t){case\"ERROR\":return function(t){return null===t.source.entityRef||null===t.target.entityRef||null===t.dataType.entityRef||t.source.entityRef&&t.target.entityRef&&(0,c.sameRef)(t.source.entityRef,t.target.entityRef)};case\"NEW\":return function(t){return null===t.existing};case\"EXISTING\":return function(t){return null!==t.existing};default:return function(t){return!0}}}function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=r.default.flatMap(t,function(t){return[t.source,t.target,t.dataType]}),n=r.default.sumBy(t,function(t){return t.source.entityRef&&t.target.entityRef&&(0,c.sameRef)(t.source.entityRef,t.target.entityRef)?1:0});return r.default.sumBy(e,function(t){return null==t.entityRef?1:0})+n}function b(t,e,n){var u=this,f=(0,l.initialiseData)(this,p);f.columnDefs=[v(\"Source\",\"source.entityRef\",\"source.identifier\"),v(\"Target\",\"target.entityRef\",\"target.identifier\"),v(\"Data Type\",\"dataType.entityRef\",\"dataType.identifier\"),{field:\"existing\",displayName:\"\",width:\"10%\",cellTemplate:'\\n                <div class=\"ui-grid-cell-contents\">\\n                    <span ng-if=\"COL_FIELD === null\"\\n                          class=\"label label-success\">New</span>\\n                    <span ng-if=\"COL_FIELD\"\\n                          class=\"label label-warning\">Exists</span>\\n                </div>'}];var b=function(){return 0===h(f.parsedData)},k=function(t){return f.filterCriteria=t,r.default.filter(f.parsedData,w(t))},I=function(){var t=function(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(r,i){try{var o=e[r](i),l=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(l).then(function(t){a(\"next\",t)},function(t){a(\"throw\",t)});t(l)}(\"next\")})}}(regeneratorRuntime.mark(function t(){var e,a,o,l,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!f.columnMappings||!f.sourceData){t.next=11;break}if(!(0===(e=m(f.columnMappings,f.sourceData,f.columnResolvers)).length||h(e)>0)){t.next=4;break}return t.abrupt(\"return\",e);case 4:return a=r.default.map(e,function(t){return{source:t.source.entityRef,target:t.target.entityRef}}),t.next=7,y(n,a);case 7:return o=t.sent,l=(0,i.nest)().key(function(t){return(0,c.refToString)(t.source)}).key(function(t){return(0,c.refToString)(t.target)}).key(function(t){return(0,c.refToString)(t.decorator.decoratorEntity)}).object(o),s=r.default.chain(e).map(function(t){var e=(0,c.refToString)(t.source.entityRef),n=(0,c.refToString)(t.target.entityRef),a=(0,c.refToString)(t.dataType.entityRef),i=r.default.get(l,\"[\"+e+\"][\"+n+\"][\"+a+\"]\"),o=null;return i&&i.length>0&&(o=i[0]),Object.assign({},t,{existing:o})}).sortBy([function(t){return t.source.entityRef.name},function(t){return t.target.entityRef.name},function(t){return t.dataType.entityRef.name}]).value(),t.abrupt(\"return\",s);case 11:case\"end\":return t.stop()}},t,u)}));return function(){return t.apply(this,arguments)}}(),$=function(){f.loading=!0,t.all([n.loadViewData(o.CORE_API.ApplicationStore.findAll).then(function(t){return r.default.keyBy(t.data,function(t){return r.default.toLower(t.assetCode)})}),n.loadViewData(o.CORE_API.DataTypeStore.findAll).then(function(t){var e=r.default.keyBy(t.data,function(t){return r.default.toLower(t.code)}),n=r.default.keyBy(t.data,function(t){return r.default.toLower(t.name)});return Object.assign({},e,n)})]).then(function(t){var n=a(t,2),i=n[0],o=n[1];return f.columnResolvers={source:function(t){return g(i,\"APPLICATION\",t)},target:function(t){return g(i,\"APPLICATION\",t)},dataType:function(t){return g(o,\"DATA_TYPE\",t)}},I().then(function(t){f.parsedData=t,f.filteredData=k(),f.summary=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=r.default.flatMap(t,function(t){return[t.source,t.target,t.dataType]}),n=Object.assign({total:t.length,newFlows:0,existingFlows:0,missingEntities:0,foundEntities:0,circularFlows:0,nonCircularFlows:t.length},r.default.countBy(t,function(t){return null==t.existing?\"newFlows\":\"existingFlows\"}),r.default.countBy(e,function(t){return null==t.entityRef?\"missingEntities\":\"foundEntities\"}),r.default.countBy(t,function(t){return t.source.entityRef&&t.target.entityRef&&(0,c.sameRef)(t.source.entityRef,t.target.entityRef)?\"circularFlows\":\"nonCircularFlows\"}));return n.errors=n.missingEntities+n.circularFlows,n}(f.parsedData),e.$apply(function(){return f.loading=!1});var n={data:f.parsedData,isComplete:b};(0,s.invokeFunction)(f.onParseComplete,n)}).catch(function(t){return console.err(\"error resolving flows: \",t)})})};f.$onInit=function(){var t={parseFlows:$};(0,s.invokeFunction)(f.onInitialise,t)},f.$onChanges=function(t){},f.applyFilter=function(t){f.filteredData=k(t)},f.exportParseErrors=function(){var t=r.default.chain(f.filteredData).filter(w(\"ERROR\")).map(function(t){return[r.default.get(t.source,\"entityRef.name\",t.source.identifier+\" not found\"),r.default.get(t.target,\"entityRef.name\",t.target.identifier+\" not found\"),r.default.get(t.dataType,\"entityRef.name\",t.dataType.identifier+\" not found\")]}).value(),e=[[\"Source\",\"Target\",\"Data Type\"]].concat(t);(0,d.downloadTextFile)(e,\",\",\"logical_flow_errors.csv\")}}b.$inject=[\"$q\",\"$scope\",\"ServiceBroker\"];var k={template:u.default,bindings:{columnMappings:\"<\",sourceData:\"<\",onInitialise:\"<\",onParseComplete:\"<\"},controller:b};e.default={component:k,id:\"waltzBulkLogicalFlowParser\"}},1102:function(t,e){t.exports=' <div class=waltz-bulk-logical-flow-parser> <div class=text-center> <waltz-loading-notification show=$ctrl.loading name=Loading> </waltz-loading-notification> </div> <div ng-if=\"$ctrl.parsedData.length > 0\"> <div> <h4>Summary</h4> <div ng-if=!$ctrl.summary.errors class=text-success> <p> <span ng-bind=$ctrl.summary.total></span> logical flows parsed, <span ng-bind=$ctrl.summary.newFlows></span> logical flows are <a class=\"clickable wbas-inline-link\" ng-click=\"$ctrl.applyFilter(\\'NEW\\')\">new</a> and <span ng-bind=$ctrl.summary.existingFlows></span> already <a class=\"clickable wbas-inline-link\" ng-click=\"$ctrl.applyFilter(\\'EXISTING\\')\">exist</a>. <a class=clickable ng-if=$ctrl.filterCriteria ng-click=$ctrl.applyFilter(null)> show all </a> </p> <p> Ready to save these flows? Click next upload these flows. </p> </div> <div ng-if=\"$ctrl.summary.errors > 0\" class=text-danger> <span ng-bind=$ctrl.summary.errors></span> <a class=\"clickable wbas-inline-link\" ng-click=\"$ctrl.applyFilter(\\'ERROR\\')\"> error<span ng-if=\"$ctrl.summary.errors > 1\">s</span> </a> found in the imported data. Please review below and correct and re-upload file. <a class=clickable ng-if=$ctrl.filterCriteria ng-click=$ctrl.applyFilter(null)> show all </a> <div class=pull-right> <a class=clickable ng-click=$ctrl.exportParseErrors()> <waltz-icon name=cloud-download></waltz-icon> Export errors </a> </div> </div> </div> <br> <waltz-grid-with-search ng-if=\"$ctrl.filteredData.length > 0\" scope-provider=$ctrl column-defs=$ctrl.columnDefs entries=$ctrl.filteredData searchplaceholdertext=Search on-initialise=$ctrl.onGridInitialise> </waltz-grid-with-search> </div> </div>'},1103:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(){var t=v(regeneratorRuntime.mark(function t(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt(\"return\",e.loadViewData(l.CORE_API.LogicalFlowStore.findBySourceAndTargetEntityReferences,[n],{force:a}).then(function(t){return t.data}));case 1:case\"end\":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),r=function(){var t=v(regeneratorRuntime.mark(function t(e){var n,r,i,s,d,f,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!o.default.isEmpty(p)){t.next=2;break}return t.abrupt(\"return\",p);case 2:return t.next=4,a(e,p);case 4:if(n=t.sent,r=(0,c.nest)().key(function(t){return(0,u.refToString)(t.source)}).key(function(t){return(0,u.refToString)(t.target)}).object(n),i=o.default.chain(p).filter(function(t){var e=(0,u.refToString)(t.source),n=(0,u.refToString)(t.target);return void 0===o.default.get(r,\"[\"+e+\"][\"+n+\"]\")}).uniqBy(function(t){return(0,u.refToString)(t.source)+\" \"+(0,u.refToString)(t.target)}).value(),s=o.default.map(i,function(t){return{source:t.source,target:t.target}}),d=n,o.default.isEmpty(s)){t.next=14;break}return t.next=12,e.execute(l.CORE_API.LogicalFlowStore.addFlows,[s]).then(function(t){return t.data});case 12:f=t.sent,d=o.default.union(n,f);case 14:return t.abrupt(\"return\",d);case 15:case\"end\":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),i=function(){var t=v(regeneratorRuntime.mark(function t(e,n,a){var r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=(0,c.nest)().key(function(t){return(0,u.refToString)(t.source)}).key(function(t){return(0,u.refToString)(t.target)}).object(a),i=o.default.map(n,function(t){var e=(0,u.refToString)(t.source),n=(0,u.refToString)(t.target),a=o.default.chain(r).get(\"[\"+e+\"][\"+n+\"]\").map(function(t){return t.dataType}).value();return{flowId:t.id,addedDecorators:a,removedDecorators:[]}}),t.abrupt(\"return\",e.execute(l.CORE_API.LogicalFlowDecoratorStore.updateDecoratorsBatch,[i]).then(function(t){return t.data}));case 3:case\"end\":return t.stop()}},t,this)}));return function(e,n,a){return t.apply(this,arguments)}}(),o=g(n(1)),l=n(2),c=n(25),s=n(0),d=n(0),u=n(12),f=n(27),p=g(n(1104));function g(t){return t&&t.__esModule?t:{default:t}}function v(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(r,i){try{var o=e[r](i),l=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(l).then(function(t){a(\"next\",t)},function(t){a(\"throw\",t)});t(l)}(\"next\")})}}var m={columnDefs:[],loading:!1,onInitialise:function(t){return console.log(\"default onInitialise handler for bulk-logical-flow-uploader: \",t)},onUploadComplete:function(){return console.log(\"default onUploadComplete handler for bulk-logical-flow-uploader\")}};function y(t){var e=(0,s.initialiseData)(this,m),n=function(){e.flows&&(e.loading=!0,r(t,e.flows).then(function(n){return i(t,n,e.flows)}).then(function(t){return e.loading=!1}).then(function(){return(0,d.invokeFunction)(e.onUploadComplete)}))};e.$onInit=function(){e.columnDefs=[(0,f.mkEntityLinkGridCell)(\"Source\",\"source\"),(0,f.mkEntityLinkGridCell)(\"Target\",\"target\"),(0,f.mkEntityLinkGridCell)(\"Data Type\",\"dataType\")];var t={uploadFlows:n};(0,d.invokeFunction)(e.onInitialise,t)}}y.$inject=[\"ServiceBroker\"];var w={template:p.default,bindings:{flows:\"<\",onInitialise:\"<\",onUploadComplete:\"<\"},controller:y};e.default={component:w,id:\"waltzBulkLogicalFlowUploader\"}},1104:function(t,e){t.exports='<div class=waltz-bulk-logical-flow-uploader> <div class=text-center> <waltz-loading-notification show=$ctrl.loading name=Loading> </waltz-loading-notification> </div> <div ng-if=\"!$ctrl.loading && $ctrl.flows.length > 0\"> <h4>Upload Summary</h4> <div> <span ng-bind=$ctrl.flows.length></span> Logical Data Flows were successfully uploaded into Waltz. </div> <br> <waltz-grid-with-search ng-if=\"$ctrl.flows.length > 0\" scope-provider=$ctrl column-defs=$ctrl.columnDefs entries=$ctrl.flows searchplaceholdertext=Search on-initialise=$ctrl.onGridInitialise> </waltz-grid-with-search> </div> </div>'},1105:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=l(n(1)),r=n(0),i=n(2),o=l(n(1106));function l(t){return t&&t.__esModule?t:{default:t}}var c={title:\"-\",flow:null,decorators:[],checkedItemIds:[],expandedItemIds:[],originalSelectedItemIds:[],saving:!1,onSave:function(t){return console.log(\"lfte: default onSave()\",t)},onDelete:function(t){return console.log(\"lfte: default onDelete()\",t)},onCancel:function(t){return console.log(\"lfte: default onCancel()\",t)},onDirty:function(t){return console.log(\"lfte: default onDirty()\",t)}};function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return!a.default.isEqual(t.sort(),e.sort())}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,r.notEmpty)(t)}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a.default.chain(t).filter(function(t){return\"DATA_TYPE\"===t.decoratorEntity.kind}).map(\"decoratorEntity.id\").value()}function f(t){var e=a.default.defaultsDeep(this,c),n=function(){e.title=function(t){return t?\"Datatypes sent from \"+t.source.name+\" to \"+t.target.name:\"?\"}(e.flow),e.checkedItemIds=u(e.decorators),e.originalSelectedItemIds=u(e.decorators),e.expandedItemIds=u(e.decorators)};e.$onInit=function(){t.loadAppData(i.CORE_API.DataTypeStore.findAll).then(function(t){e.allDataTypes=t.data,e.allDataTypesById=a.default.keyBy(t.data,\"id\"),n()})},e.$onChanges=function(){n()},e.save=function(){if(!e.saving){e.saving=!0;var t=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=a.default.difference(e,n),i=a.default.difference(n,e);return{flowId:t.id,addedDecorators:a.default.map(r,function(t){return{id:t,kind:\"DATA_TYPE\"}}),removedDecorators:a.default.map(i,function(t){return{id:t,kind:\"DATA_TYPE\"}})}}(e.flow,e.checkedItemIds,e.originalSelectedItemIds);e.onSave(t).then(function(){return e.saving=!1})}},e.delete=function(){return e.onDelete(e.flow)},e.cancel=function(){return e.onCancel()},e.onChange=function(){return e.onDirty(s(e.checkedItemIds,e.originalSelectedItemIds))},e.canSave=function(){return s(e.checkedItemIds,e.originalSelectedItemIds)&&d(e.checkedItemIds)&&!e.saving},e.anySelected=function(){return d(e.checkedItemIds)},e.typeSelected=function(t){},e.typeChecked=function(t){for(var n=e.allDataTypesById[t];n;){var r=e.allDataTypesById[n.parentId];!1===a.default.get(r,\"concrete\",!0)&&e.typeUnchecked(r.id),n=r}e.checkedItemIds=a.default.union(e.checkedItemIds,[t])},e.toggleTypeChecked=function(t){a.default.some(e.checkedItemIds,function(e){return e===t})?e.typeUnchecked(t):e.typeChecked(t)},e.typeUnchecked=function(t){e.checkedItemIds=a.default.without(e.checkedItemIds,t)}}f.$inject=[\"ServiceBroker\"];var p={bindings:{flow:\"<\",decorators:\"<\",allDataTypes:\"<\",onSave:\"<\",onDelete:\"<\",onCancel:\"<\",onDirty:\"<\"},controller:f,template:o.default};e.default={component:p,id:\"waltzLogicalFlowTypeEditor\"}},1106:function(t,e){t.exports='<div> <div class=row> <div class=col-md-11> <h4> <i>Datatypes sent from:</i> <waltz-entity-icon-label entity-ref=$ctrl.flow.source></waltz-entity-icon-label> <i style=padding:4px> to:</i> <waltz-entity-icon-label entity-ref=$ctrl.flow.target></waltz-entity-icon-label> </h4> <waltz-multi-select-tree-control items=$ctrl.allDataTypes on-click=$ctrl.toggleTypeChecked on-check=$ctrl.typeChecked on-uncheck=$ctrl.typeUnchecked checked-item-ids=$ctrl.checkedItemIds expanded-item-ids=$ctrl.expandedItemIds> <strong ng-bind=node.name uib-popover-template=\"\\'wlfte-popup.html\\'\" popover-popup-delay=300 popover-append-to-body=true popover-trigger=mouseenter> </strong> </waltz-multi-select-tree-control> <div class=pull-right> <button class=\"btn btn-success\" ng-disabled=\"! $ctrl.canSave()\" ng-click=$ctrl.save()> Apply </button> <button class=\"btn btn-danger\" ng-click=$ctrl.delete()> Delete </button> <a href ng-click=$ctrl.cancel()> Cancel </a> </div> </div> </div> <script type=text/ng-template id=wlfte-popup.html> <strong ng-bind=\"node.name\"></strong>\\n        <p class=\"small text-muted\"\\n           ng-bind=\"node.description\">\\n        </p>\\n        <div class=\"alert alert-warning small\" ng-if=\"!node.concrete\">\\n            Direct mappings have been disabled for this data type.\\n            <span ng-if=\"$ctrl.checkedItemIds.indexOf(node.id) > -1\">\\n                Please remove this mapping by selecting a more specific sub type.\\n            </span>\\n        </div> <\\/script> </div>'},1107:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),r=n(2),i=n(0),o=n(395),l=function(t){return t&&t.__esModule?t:{default:t}}(n(1108));var c={allActors:[],app:null,appsById:{},dataTypeUsages:[],flows:[],isDirty:!1,mode:\"\",physicalFlows:[],selectedCounterpart:null,selectedDecorators:null,selectedFlow:null,selectedUsages:[]};function s(t,e){return{source:t,target:e}}function d(t){return{source:t.source,target:t.target}}function u(t,e,n){return e.id===n.id&&\"APPLICATION\"===n.kind&&(t.warning(\"An application may not link to itself.\"),!0)}function f(t){return!!t&&(alert(\"Unsaved changes, either apply them or cancel\"),!0)}function p(t,e,n,l){var p=(0,i.initialiseData)(this,c);p.$onChanges=function(t){p.parentEntityRef&&(v().then(function(){var t={source:{onSelect:function(t){return e.$applyAsync(function(){return m(t)})}},target:{onSelect:function(t){return e.$applyAsync(function(){return y(t)})}},type:{onSelect:function(t){return e.$applyAsync(function(){return h(t)})}}};p.flowTweakers=(0,o.mkTweakers)(t,p.physicalFlows,p.logicalFlows)}),l.loadViewData(r.CORE_API.ActorStore.findAll,[]).then(function(t){return p.allActors=t.data}))};var g=function(t){return a.some(p.logicalFlows,function(e){return e.source.id===t.source.id&&e.target.id===t.target.id})?Promise.resolve():l.execute(r.CORE_API.LogicalFlowStore.addFlow,[d(t)]).then(function(t){return p.logicalFlows.push(t)}).then(v)};var v=function(){return p.cancel(),t.all([l.loadViewData(r.CORE_API.LogicalFlowStore.findByEntityReference,[p.parentEntityRef],{force:!0}).then(function(t){return p.logicalFlows=t.data}),l.loadViewData(r.CORE_API.LogicalFlowDecoratorStore.findBySelectorAndKind,[{entityReference:p.parentEntityRef,scope:\"EXACT\"},\"DATA_TYPE\"],{force:!0}).then(function(t){return p.logicalFlowDecorators=t.data}),l.loadViewData(r.CORE_API.DataTypeUsageStore.findForEntity,[p.parentEntityRef],{force:!0}).then(function(t){return p.dataTypeUsages=t.data}),l.loadViewData(r.CORE_API.PhysicalFlowStore.findByEntityReference,[p.parentEntityRef],{force:!0}).then(function(t){return p.physicalFlows=t.data})])},m=function(t){w(t,{source:{id:t.id,kind:t.kind}})},y=function(t){w(t,{target:{id:t.id,kind:t.kind}})},w=function(t,e){f(p.isDirty)||(p.setMode(\"editCounterpart\"),p.selectedCounterpart=t,p.selectedFlow=a.find(p.logicalFlows,e),p.selectedDecorators=p.selectedFlow?a.filter(p.logicalFlowDecorators,{dataFlowId:p.selectedFlow.id}):[])},h=function(t){p.setMode(\"editDataTypeUsage\"),p.selectedDataType=t,p.selectedUsages=a.chain(p.dataTypeUsages).filter({dataTypeId:t.id}).map(\"usage\").value()},b=function(t){return l.execute(r.CORE_API.LogicalFlowDecoratorStore.updateDecorators,[t]).then(v).then(function(){return n.success(\"Data flow updated\")})};p.cancel=function(){p.selectedCounterpart=null,p.selectedDecorators=null,p.selectedFlow=null,p.isDirty=!1,p.setMode(\"\")},p.updateFlow=function(t){return t.flowId?b(t):l.execute(r.CORE_API.LogicalFlowStore.addFlow,[d(p.selectedFlow)]).then(function(e){return Object.assign(t,{flowId:e.id})}).then(b)},p.deleteFlow=function(t){a.some(p.physicalFlows,{logicalFlowId:t.id})?n.warning(\"This data flow has associated physical flows, please check and remove those first\"):l.execute(r.CORE_API.LogicalFlowStore.removeFlow,[t.id]).then(v).then(function(){return n.warning(\"Data flow removed\")}).catch(function(t){return n.error(a.split(t.data.message,\"/\")[0]||\"System error, please contact support\")})},p.saveUsages=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=p.selectedDataType.id;l.execute(r.CORE_API.DataTypeUsageStore.save,[p.parentEntityRef,e,t]).then(function(){return v()}).then(function(){return n.success(\"Data usage updated\")})};var k=function(t,e){var a={id:e.id,kind:t,name:e.name};u(n,p.parentEntityRef,a)||g(s(a,p.parentEntityRef)).then(function(){return m(a)})},I=function(t,e){var a={id:e.id,kind:t,name:e.name};u(n,p.parentEntityRef,a)||g(s(p.parentEntityRef,a)).then(function(){return y(a)})};p.addSourceApplication=function(t){k(\"APPLICATION\",t)},p.addSourceActor=function(t){k(\"ACTOR\",t)},p.addTargetApplication=function(t){I(\"APPLICATION\",t)},p.addTargetActor=function(t){I(\"ACTOR\",t)},p.setDirtyChange=function(t){return p.isDirty=t},p.setMode=function(t){f(p.isDirty)||(p.mode=t)}}p.$inject=[\"$q\",\"$scope\",\"Notification\",\"ServiceBroker\"];var g={template:l.default,bindings:{parentEntityRef:\"<\"},controller:p};e.default={component:g,id:\"waltzLogicalFlowEditPanel\"}},1108:function(t,e){t.exports=\" <div> <div class=row> <div class=col-md-12> <waltz-source-and-target-graph ng-if=$ctrl.parentEntityRef entity-ref=$ctrl.parentEntityRef logical-flows=$ctrl.logicalFlows decorators=$ctrl.logicalFlowDecorators tweakers=$ctrl.flowTweakers> </waltz-source-and-target-graph> </div> </div> <hr> <form name=dataFlowForm novalidate ng-submit=$ctrl.submit()> <div class=row> <div class=col-sm-5> <div class=alert style=background-color:#f5f5f5;border-radius:10px> <ul class=small> <li> Update Sources and Targets <ul> <li> Click on an the name of the application above to edit the types of data in use </li> <li> To remove an application deselect all of its associated data types </li> </ul> </li> <li> Add Applications / Actors <ul> <li> <a class=clickable ng-click=\\\"$ctrl.setMode('addSource')\\\"> Add an <strong>upstream</strong> source </a> </li> <li> <a class=clickable ng-click=\\\"$ctrl.setMode('addTarget')\\\"> Add a <strong>downstream</strong> target </a> </li> </ul> </li> </ul> </div> </div> <div class=col-sm-7> <div ng-if=\\\"$ctrl.mode === 'addSource'\\\" class=waltz-fade-if> <waltz-logical-flow-counterpart-selector all-actors=$ctrl.allActors on-add-application=$ctrl.addSourceApplication on-add-actor=$ctrl.addSourceActor on-cancel=$ctrl.cancel> <heading> <waltz-icon name=arrow-down></waltz-icon> Add Upstream Source </heading> <help> Applications / Actors which <i ng-bind=$ctrl.app.name></i> either pulls or receives data from are known as upstream sources. </help> </waltz-logical-flow-counterpart-selector> </div> <div ng-if=\\\"$ctrl.mode === 'addTarget'\\\" class=waltz-fade-if> <waltz-logical-flow-counterpart-selector all-actors=$ctrl.allActors on-add-application=$ctrl.addTargetApplication on-add-actor=$ctrl.addTargetActor on-cancel=$ctrl.cancel> <heading> <waltz-icon name=arrow-down></waltz-icon> Add Downstream Target </heading> <help> Applications which either receive or pull data from <i ng-bind=$ctrl.app.name></i> are known as downstream targets. </help> </waltz-logical-flow-counterpart-selector> </div> <div ng-if=\\\"$ctrl.mode === 'editCounterpart'\\\" class=waltz-fade-if> <waltz-logical-flow-type-editor flow=$ctrl.selectedFlow decorators=$ctrl.selectedDecorators on-cancel=$ctrl.cancel on-save=$ctrl.updateFlow on-delete=$ctrl.deleteFlow on-dirty=$ctrl.setDirtyChange> </waltz-logical-flow-type-editor> </div> <div ng-if=\\\"$ctrl.mode === 'editDataTypeUsage'\\\" class=waltz-fade-if> <waltz-app-data-type-usage-editor primary-entity=$ctrl.app type=$ctrl.selectedDataType on-save=$ctrl.saveUsages on-cancel=$ctrl.cancel usages=$ctrl.selectedUsages> </waltz-app-data-type-usage-editor> </div> </div> </div> </form> </div>\"},1109:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=u(n(1)),r=n(30),i=n(5);n(45);var o=n(0),l=n(19),c=n(44),s=n(2),d=u(n(1110));function u(t){return t&&t.__esModule?t:{default:t}}var f=null,p=null;function g(t){return function(e){return console.log(t,e)}}function v(t){return{onSelect:g(\"wsat:\"+t+\".onSelect\"),onEnter:g(\"wsat:\"+t+\".onAppEnter\"),onLeave:g(\"wsat:\"+t+\".onLeave\")}}var m={source:v(\"source\"),target:v(\"target\"),type:v(\"type\"),typeBlock:v(\"typeBlock\")},y={},w=400,h={graph:{width:1e3,height:200},margin:{top:40,left:5,right:5,bottom:50},label:{height:10,minSpacing:8,width:200},header:{height:20},circleSize:24};function b(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.attr(\"transform\",\"translate(\"+e+\", \"+n+\")\")}function k(t,e){var n=function(t){return[t.margin.top,t.graph.height-t.margin.bottom]}(e);return(0,r.scalePoint)().domain(a.default.chain(t).sortBy(function(t){return a.default.toLower(t.name)}).map(\"id\").value()).range(n)}function I(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:\"start\",o=arguments[4],l=t.selectAll(\".wsat-label\").data(e,function(t){return t.id}),c=l.enter().append(\"g\").classed(\"clickable\",!0).classed(\"wsat-label\",!0).attr(\"transform\",function(t,e){return\"translate(0, \"+n(t.id)+\")\"}).attr(\"opacity\",0),s=function(t){switch(t){case\"start\":return 10;case\"end\":return-10;default:return 0}}(r),d=function(t){switch(t){case\"start\":case\"end\":return-6;default:return 0}}(r);c.append(\"text\").attr(\"text-anchor\",r).attr(\"dx\",s).text(function(t){return a.default.truncate(t.name,{length:26})}),c.append(\"text\").classed(\"wsat-icon\",!0).attrs({dx:d,\"font-family\":\"FontAwesome\"}),c.append(\"title\"),l.merge(c).classed(\"wsat-hover\",function(t){return f===t.id}).on(\"mouseenter.highlight\",function(t){f=t.id,p()}).on(\"mouseleave.highlight\",function(t){f=null,p()}).on(\"click.tweaker\",function(t){return o.onSelect(t,i.event)}).on(\"mouseenter.tweaker\",o.onEnter).on(\"mouseleave.tweaker\",o.onLeave).transition().duration(w).attr(\"transform\",function(t,e){return\"translate(0, \"+n(t.id)+\")\"}).attr(\"opacity\",1),o.icon&&(l.merge(c).select(\".wsat-icon\").attr(\"fill\",function(t){return o.icon(t).color}).text(function(t){return o.icon(t).code||\"\"}),l.merge(c).select(\"title\").text(function(t){return o.icon(t).description||\"\"})),l.exit().remove()}function $(t,e,n){var a=t.selectAll(\".wsat-arc\").data(e,function(t){return t.from+\"-\"+t.to}),r=a.enter().append(\"path\").classed(\"wsat-arc\",!0).attrs({opacity:0,stroke:function(t){return(0,l.authoritativeRatingColorScale)(t.rating)},fill:function(t){return(0,l.authoritativeRatingColorScale)(t.rating).brighter()}});a.merge(r).classed(\"wsat-hover\",function(t){return t.to===f||t.from===f}).transition().duration(w).call(n).attr(\"opacity\",1),a.exit().remove()}function S(t,e,n,r,i){t.on(\"click\",i.onSelect);var o=t.selectAll(\".wsat-type-box\").data(e.types,function(t){return t.id}),l=function(t){return a.default.some(e.sourceToType,function(e){return e.to===t})},c=o.enter().append(\"rect\").classed(\"wsat-type-box\",!0).attrs({fill:\"#fafafa\",stroke:\"#ccc\",y:function(t){return n(t.id)-r.height-2},x:r.width/2*-1+2,opacity:0});o.merge(c).transition().duration(w).attrs({x:function(t){var e=r.width/2*-1+2;return l(t.id)?e:e+20},y:function(t){return n(t.id)-r.height-2},width:function(t){return r.width-4-(l(t.id)?0:20)-(function(t){return a.default.some(e.typeToTarget,function(e){return e.from===t})}(t.id)?0:20)},height:r.height+6,opacity:1}),o.exit().remove()}function A(t,e,n){p=function(){return A(t,e,n)};var r=function(t){var e=t.sources,n=void 0===e?[]:e,r=t.targets,i=void 0===r?[]:r,o=t.types,l=void 0===o?[]:o,c=a.default.max([n.length,i.length,l.length,4]),s={width:h.graph.width-(h.margin.left+h.margin.right),height:c*(h.label.height+h.label.minSpacing)},d={height:s.height+h.header.height+h.margin.top+h.margin.bottom};return a.default.defaultsDeep({graph:d,canvas:s},h)}(e);!function(t,e){t.svg.attr(\"width\",e.graph.width).attr(\"height\",e.graph.height);var n=e.margin.left+e.label.width,a=e.margin.top;b(t.sources,n,a);var r=e.canvas.width-e.label.width,i=e.margin.top;b(t.targets,r,i);var o=e.canvas.width/2,l=e.margin.top;b(t.types,o,l)}(t,r),function(t,e){var n=e.margin.top/2,a=t.selectAll(\"text\").data([\"Upstream Sources\",\"Data Types\",\"Downstream Targets\"]),r=a.enter().append(\"text\").text(function(t){return t}).attr(\"text-anchor\",\"middle\");a.merge(r).attr(\"transform\",function(t,a){switch(a){case 0:return\"translate(\"+e.label.width+\", \"+n+\")\";case 1:return\"translate(\"+(e.graph.width/2-20)+\", \"+n+\")\";case 2:return\"translate(\"+(e.graph.width-e.label.width)+\", \"+n+\")\"}});var i=t.selectAll(\"line\").data([!0]),o=i.enter().append(\"line\");i.merge(o).attr(\"x1\",0).attr(\"y1\",n+10).attr(\"x2\",e.graph.width-40).attr(\"y2\",e.margin.top/2+10).attr(\"stroke\",\"#ccc\")}(t.header,r),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"\",r=t.selectAll(\".center-box\").data([1],a.default.identity),i=r.enter().append(\"rect\").classed(\"center-box\",!0).attrs({fill:\"#f5f5f5\",stroke:\"#ddd\"});r.merge(i).attrs({x:-90,y:0,width:180,height:e.graph.height-e.margin.bottom+8}),t.append(\"text\").attr(\"transform\",\"translate(0,16)\").attr(\"fill\",\"#888\").attr(\"text-anchor\",\"middle\").text(a.default.truncate(n,{length:24}))}(t.types,r,e.entityRef.name);var i=function(t,e){return{source:k(t.sources,e),target:k(t.targets,e),type:k(t.types,e)}}(e,r);I(t.sources,e.sources,i.source,\"end\",n.source),I(t.targets,e.targets,i.target,\"start\",n.target),S(t.types,e,i.type,r.label,n.typeBlock),I(t.types,e.types,i.type,\"middle\",n.type),function(t,e,n,a){$(t,e,function(t){return t.attr(\"d\",function(t){return(0,c.mkLineWithArrowPath)(a.margin.left+a.label.width+10,a.margin.top+n.source(t.from)-a.label.height/2,a.canvas.width/2-a.label.width/2,a.margin.top+n.type(t.to)-a.label.height/2)})})}(t.inbound,e.sourceToType,i,r),function(t,e,n,a){$(t,e,function(t){return t.attr(\"d\",function(t){return(0,c.mkLineWithArrowPath)(a.canvas.width/2+a.label.width/2,a.margin.top+n.type(t.from)-a.label.height/2,a.canvas.width-(a.label.width+10),a.margin.top+n.target(t.to)-a.label.height/2)})})}(t.outbound,e.typeToTarget,i,r)}function D(t,e,n){var r=(0,o.initialiseData)(this,y),l=function(t){var e=t.append(\"g\").classed(\"wsat-header\",!0),n=t.append(\"g\").classed(\"wsat-sources\",!0).classed(\"wsat-apps\",!0),a=t.append(\"g\").classed(\"wsat-targets\",!0).classed(\"wsat-apps\",!0),r=t.append(\"g\").classed(\"wsat-types\",!0),i=t.append(\"g\").classed(\"wsat-outbound\",!0);return{header:e,inbound:t.append(\"g\").classed(\"wsat-inbound\",!0),outbound:i,sources:n,svg:t,targets:a,types:r}}((0,i.select)(t.find(\"svg\")[0])),c=a.default.debounce(function(){if(r.entityRef){h.graph.width=t.parent()[0].clientWidth;var e=a.default.defaultsDeep(r.tweakers,m);n.loadAppData(s.CORE_API.DataTypeStore.findAll).then(function(t){var n=t.data,i=function(t){var e=t.logicalFlows,n=void 0===e?[]:e,r=t.decorators,i=void 0===r?[]:r,o=t.entityRef,l=t.allTypes,c=void 0===l?[]:l,s=a.default.map(n,\"id\"),d=a.default.filter(i,function(t){return a.default.includes(s,t.dataFlowId)}),u=a.default.groupBy(n,function(t){return t.source.id===o.id?\"outbound\":\"inbound\"}),f=u.inbound,p=void 0===f?[]:f,g=u.outbound,v=void 0===g?[]:g,m=a.default.chain(p).map(\"source\").uniqBy(\"id\").value(),y=a.default.chain(v).map(\"target\").uniqBy(\"id\").value(),w=a.default.keyBy(c,\"id\"),h=a.default.chain(d).filter(function(t){return\"DATA_TYPE\"===t.decoratorEntity.kind}).groupBy(\"dataFlowId\").value(),b=a.default.chain(p).flatMap(function(t){return a.default.map(h[t.id]||[],function(e){return{from:t.source.id,to:e.decoratorEntity.id,rating:e.rating}})}).value(),k=a.default.chain(v).flatMap(function(t){return a.default.map(h[t.id]||[],function(e){return{from:e.decoratorEntity.id,to:t.target.id,rating:e.rating}})}).value();return{sources:m,targets:y,types:a.default.chain(d).map(function(t){return t.decoratorEntity}).filter(function(t){return\"DATA_TYPE\"===t.kind}).map(function(t){return t.id}).uniq().map(function(t){return w[t]}).orderBy(function(t){return t.name}).value(),sourceToType:b,typeToTarget:k,entityRef:o}}({logicalFlows:r.logicalFlows||[],decorators:r.decorators||[],entityRef:r.entityRef,allTypes:n});A(l,i,e)})}},100);r.$onChanges=function(t){return c()},r.$onInit=function(){return angular.element(e).on(\"resize\",c)},r.$onDestroy=function(){return angular.element(e).off(\"resize\",c)}}D.$inject=[\"$element\",\"$window\",\"ServiceBroker\"];var C={bindings:{entityRef:\"<\",logicalFlows:\"<\",decorators:\"<\",tweakers:\"<\"},template:d.default,controller:D};e.default={component:C,id:\"waltzSourceAndTargetGraph\"}},1110:function(t,e){t.exports=\"<div class=waltz-source-and-target-graph width=100%> <svg> </svg> </div> \"},1111:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=d(n(1)),r=n(5),i=n(0),o=n(75),l=n(2),c=n(395),s=d(n(1112));function d(t){return t&&t.__esModule?t:{default:t}}var u={filteredFlowData:{selectedTypeId:0,flows:[],decorators:[]}};function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0==t)return{selectedTypeId:0,decorators:n,flows:e};var r=a.default.filter(n,function(e){return e.decoratorEntity.id===t}),i=a.default.map(r,\"dataFlowId\"),o=a.default.filter(e,function(t){return a.default.includes(i,t.id)});return{selectedTypeId:t,decorators:r,flows:o}}function p(t,e,n,s,d){var p=(0,i.initialiseData)(this,u);p.showAll=function(){return p.filteredFlowData=f(0,p.logicalFlows,p.decorators)},p.$onChanges=function(i){(i.logicalFlows||i.decorators)&&(p.filteredFlowData=p.showAll());var o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t?{sourceFlowsByEntityId:a.default.chain(e).filter(function(e){return e.target.id===t.id&&e.target.kind===t.kind}).reduce(function(t,e){return t[e.source.id]=e.id,t},{}).value(),targetFlowsByEntityId:a.default.chain(e).filter(function(e){return e.source.id===t.id&&e.source.kind===t.kind}).reduce(function(t,e){return t[e.target.id]=e.id,t},{}).value()}:{}}(p.entityRef,p.logicalFlows),l=a.default.keyBy(p.logicalFlows,\"id\");function s(t,e,n,r){var i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a.default.chain(t).filter({decoratorEntity:{kind:\"DATA_TYPE\"}}).groupBy(function(t){return t.dataFlowId}).mapValues(function(t){return a.default.map(t,function(t){return{id:t.decoratorEntity.id,rating:t.rating}})}).value()}(p.decorators)[n]||[],o=l[n];return{type:e,types:i,physicalFlows:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],r=a.default.keyBy(e,\"id\");return a.default.chain(t).filter(function(t){return t.logicalFlowId===n}).map(function(t){return Object.assign({},t,{specification:r[t.specificationId]})}).value()}(p.physicalFlows,p.physicalSpecifications,n),entity:t,logicalFlowId:n,logicalFlow:o,y:r.layerY}}var d={source:{onSelect:function(t,n){return e(function(){var e=o.sourceFlowsByEntityId[t.id];p.selected=s(t,\"source\",e,n)})}},target:{onSelect:function(t,n){return e(function(){var e=o.targetFlowsByEntityId[t.id];p.selected=s(t,\"target\",e,n)})}},type:{onSelect:function(a){r.event.stopPropagation(),e(function(){return p.filteredFlowData=f(a.id,p.logicalFlows,p.decorators)}).then(function(){!function(t,e){t.scrollIntoView({behavior:\"smooth\",block:\"start\"}),e.scrollBy(0,-90)}(t[0],n)})}},typeBlock:{onSelect:function(){r.event.stopPropagation(),e(function(){p.filteredFlowData.selectedTypeId>0&&p.showAll()})}}};p.tweakers=(0,c.mkTweakers)(d,p.physicalFlows,p.logicalFlows)},p.exportLogicalFlowData=function(){var t=[\"Source\",\"Source code\",\"Target\",\"Target code\",\"Data Types\"],e=a.default.chain(p.decorators).filter(function(t){return\"DATA_TYPE\"===t.decoratorEntity.kind}).map(function(t){return{id:t.dataFlowId,code:t.decoratorEntity.id}}).groupBy(\"id\").value(),n=a.default.chain(p.logicalFlows).flatMap(function(t){return[t.source,t.target]}).filter(function(t){return\"APPLICATION\"===t.kind}).map(function(t){return t.id}).uniq().value();d.loadViewData(l.CORE_API.ApplicationStore.findByIds,[n]).then(function(n){var r=a.default.keyBy(n.data,\"id\"),i=function(t){var e=[t.id,\"assetCode\"];return\"APPLICATION\"===t.kind?a.default.get(r,e,\"-\"):t.kind},l=a.default.map(p.logicalFlows,function(t){return[t.source.name,i(t.source),t.target.name,i(t.target),function(t){var n=e[t]||[];return a.default.chain(n).map(function(t){return t.code}).map(function(t){return s.lookup(\"dataType\",t)}).value().join(\"; \")}(t.id)]}),c=a.default.concat([t],l);(0,o.downloadTextFile)(c,\",\",\"logical_flows.csv\")})}}p.$inject=[\"$element\",\"$timeout\",\"$window\",\"DisplayNameService\",\"ServiceBroker\"];var g={template:s.default,bindings:{entityRef:\"<\",logicalFlows:\"<\",decorators:\"<\",physicalFlows:\"<\",physicalSpecifications:\"<\"},controller:p};e.default={component:g,id:\"waltzSourceAndTargetPanel\"}},1112:function(t,e){t.exports='<div class=\"row waltz-source-and-target-panel\"> <div class=\"col-sm-12 waltz-visibility-parent\"> <waltz-source-and-target-graph entity-ref=$ctrl.entityRef logical-flows=$ctrl.filteredFlowData.flows decorators=$ctrl.filteredFlowData.decorators tweakers=$ctrl.tweakers> </waltz-source-and-target-graph> <div ng-if=\"$ctrl.filteredFlowData.selectedTypeId > 0\" class=\"small text-muted\"> <hr> <waltz-icon name=filter></waltz-icon> Showing only <span ng-bind=\"$ctrl.filteredFlowData.selectedTypeId | toDisplayName:\\'dataType\\'\"></span> - <a class=\"clickable btn btn-xs btn-success\" ng-click=$ctrl.showAll()> Show All </a> <hr> </div> <div class=pull-right style=margin-right:30px;margin-bottom:4px> <a class=\"clickable waltz-visibility-child-30\" ng-click=$ctrl.exportLogicalFlowData()> <waltz-icon name=download></waltz-icon> Export logical flows </a> </div> </div> <div ng-if=$ctrl.selected ng-style=\"{\\n            top: ($ctrl.selected.y) + \\'px\\',\\n            right: $ctrl.selected.type == \\'source\\' ? \\'100px\\' : null,\\n            left: $ctrl.selected.type == \\'target\\' ? \\'100px\\' : null\\n         }\" class=\"wsatp-popup waltz-fade-if\"> <h4> <span ng-if=\"$ctrl.selected.type === \\'source\\'\"> <waltz-entity-link entity-ref=$ctrl.selected.logicalFlow.source> </waltz-entity-link> &rarr; <waltz-entity-icon-label entity-ref=$ctrl.selected.logicalFlow.target> </waltz-entity-icon-label> </span> <span ng-if=\"$ctrl.selected.type === \\'target\\'\"> <waltz-entity-icon-label entity-ref=$ctrl.selected.logicalFlow.source> </waltz-entity-icon-label> &rarr; <waltz-entity-link entity-ref=$ctrl.selected.logicalFlow.target> </waltz-entity-link> </span> <a class=\"clickable pull-right small\" style=color:#00f ng-click=\"$ctrl.selected = null\"> <waltz-icon name=close></waltz-icon> Close </a> </h4> <div> <waltz-entity-link entity-ref=\"{\\n                    kind: \\'LOGICAL_DATA_FLOW\\',\\n                    id: $ctrl.selected.logicalFlow.id,\\n                    name: \\'More about this logical flow &raquo;\\'}\"> </waltz-entity-link> </div> <hr> <strong>Data Types</strong> <div ng-if=\"$ctrl.selected.types.length > 0\" class=wsatp-data-types> <ul class=list-inline> <li ng-repeat=\"type in $ctrl.selected.types\"> <a ui-sref=\"main.data-type.view ({id: type.id})\"> <span class=label ng-class=\"{\\n                                \\'label-success\\' : type.rating == \\'PRIMARY\\',\\n                                \\'label-warning\\' : type.rating == \\'SECONDARY\\',\\n                                \\'label-danger\\' : type.rating == \\'DISCOURAGED\\',\\n                                \\'label-default\\' : type.rating == \\'NO_OPINION\\',\\n                              }\" ng-bind=\"type.id | toDisplayName:\\'dataType\\'\"> </span> </a> </li> </ul> </div> <hr> <strong>Physical Data</strong> <span class=\"small pull-right\"> <a class=clickable ui-sref=\\'main.physical-flow.registration({\\n                            kind: $ctrl.selected.type === \"source\" ? $ctrl.selected.entity.kind : $ctrl.entityRef.kind,\\n                            id: $ctrl.selected.type === \"source\" ? $ctrl.selected.entity.id : $ctrl.entityRef.id,\\n                            targetLogicalFlowId: $ctrl.selected.logicalFlowId\\n                        })\\'> Register physical flow </a> </span> <div ng-if=\"$ctrl.selected.physicalFlows.length > 0\" ng-class=\"{\\'waltz-scroll-region-250\\': $ctrl.selected.physicalFlows.length > 8}\"> <table class=\"table table-condensed small small\"> <thead> <tr> <th>Name</th> <th>Format</th> <th>Transport</th> <th>Frequency</th> </tr> </thead> <tbody> <tr ng-repeat=\"pf in $ctrl.selected.physicalFlows\"> <td> <a ui-sref=\"main.physical-flow.view ({ id: pf.id })\"> <span ng-bind=pf.specification.name></span> </a> </td> <td> <span ng-bind=pf.specification.format></span> </td> <td> <span ng-bind=pf.transport></span> </td> <td> <span ng-bind=pf.frequency></span> </td> </tr> </tbody> </table> </div> <waltz-no-data ng-if=\"$ctrl.selected.physicalFlows.length == 0\"> <message> No records of physical data flows found. </message> </waltz-no-data> </div> </div>'},1113:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=l(n(1)),r=n(0),i=n(2),o=l(n(1114));function l(t){return t&&t.__esModule?t:{default:t}}var c={infoCell:null,visibility:{chart:!1}};function s(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t)return null;if((0,r.isEmpty)(e.flows))return null;var i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.default.keyBy(e,\"id\");return a.default.chain(t).filter(function(t){return\"APPLICATION\"===t.target.kind}).map(\"target.id\").uniq().map(function(t){return n[t]}).value()}(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.default.chain(e).map(\"dataFlowId\").uniq().value();return a.default.filter(t,function(t){return a.default.includes(n,t.id)})}(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.default.map(e,\"id\");return a.default.filter(t,function(t){return a.default.includes(n,t.target.id)})}(e.flows,n),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n={decoratorEntity:{kind:\"DATA_TYPE\",id:t.dataType.id},rating:t.rating};return a.default.filter(e,n)}(t,e.decorators)),n);return{dataType:t.dataType,rating:t.rating,applications:i}}function d(t){var e=a.default.defaultsDeep(this,c),n=function(t){if(e.visibility.chart=e.visibility.chart||a.default.size(t)>0,\"DATA_TYPE\"===e.entityReference.kind){var n=[];return function t(r){n.push(r),a.default.chain(e.dataTypes).filter(function(t){return t.parentId===r}).forEach(function(e){return t(e.id)}).value()}(e.entityReference.id),a.default.filter(t,function(t){var e=t.decoratorEntityReference;return e.kind=a.default.includes(n,e.id)})}return t};e.$onInit=function(){t.loadAppData(i.CORE_API.DataTypeStore.findAll).then(function(t){return e.dataTypes=t.data})},e.$onChanges=function(){if(e.entityReference){var a={entityReference:e.entityReference,scope:\"CHILDREN\"},r={entityReference:e.entityReference,scope:\"EXACT\"};t.loadViewData(i.CORE_API.ApplicationStore.findBySelector,[a]).then(function(t){return e.apps=t.data}),t.loadViewData(i.CORE_API.LogicalFlowDecoratorStore.summarizeInboundBySelector,[a]).then(function(t){return e.childSummaries=n(t.data)}),t.loadViewData(i.CORE_API.LogicalFlowDecoratorStore.summarizeInboundBySelector,[r]).then(function(t){return e.exactSummaries=n(t.data)})}},e.onTableClick=function(n){if(\"CELL\"===n.type){var a={entityReference:e.entityReference,scope:\"CHILDREN\"},r={};t.loadViewData(i.CORE_API.LogicalFlowStore.findBySelector,[a]).then(function(e){return r.flows=e.data,t.loadViewData(i.CORE_API.LogicalFlowDecoratorStore.findBySelector,[a])}).then(function(t){r.decorators=t.data,e.infoPanel=s(n,r,e.apps)})}}}d.$inject=[\"ServiceBroker\"];var u={template:o.default,controller:d,bindings:{entityReference:\"<\"}};e.default={component:u,id:\"waltzRatedFlowSummaryPanel\"}},1114:function(t,e){t.exports='<div> <div ng-if=$ctrl.visibility.chart> <div class=row> <div class=col-md-7> <waltz-rated-summary-table decorator-entities=$ctrl.dataTypes exact-summaries=$ctrl.exactSummaries child-summaries=$ctrl.childSummaries on-click=$ctrl.onTableClick> </waltz-rated-summary-table> </div> <div class=col-md-5> <div class=waltz-fade-if ng-if=\"$ctrl.infoPanel != null\"> <waltz-rated-flow-summary-info-cell applications=$ctrl.infoPanel.applications type=$ctrl.infoPanel.dataType flows=$ctrl.infoPanel.flows org-unit-id=$ctrl.entityReference rating=$ctrl.infoPanel.rating> </waltz-rated-flow-summary-info-cell> </div> </div> </div> <div class=row style=padding-top:12px> <div class=col-md-12> <div class=\"small text-muted\"> This diagram summarises the data types sent to applications in this group. </div> </div> </div> </div> <waltz-no-data ng-if=\"! $ctrl.visibility.chart\"> <message> No inbound data flows registered for this <span ng-bind=\"$ctrl.entityReference.kind | toDisplayName:\\'entity\\' | lowercase\"></span> </message> </waltz-no-data> </div> '},1115:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=d(n(1)),r=n(2),i=n(0),o=n(10),l=n(19),c=n(390),s=d(n(1116));function d(t){return t&&t.__esModule?t:{default:t}}var u={visibility:{detail:!1}};function f(t,e,n){var s=(0,i.initialiseData)(this,u);s.$onChanges=function(){s.stats&&(s.enrichedDataTypeCounts=e.enrichDataTypeCounts(s.stats.dataTypeCounts,t),n.loadAppData(r.CORE_API.DataTypeStore.findAll).then(function(t){return(0,c.findUnknownDataType)(t.data)}).then(function(t){var e=t?t.id:null;if(e){s.visibility.summaries=!0,s.summaryConfig={colorProvider:function(t){return\"KNOWN\"===t.data.key?(0,o.color)(l.green):(0,o.color)(l.red)},valueProvider:function(t){return t.count},idProvider:function(t){return t.data.key},labelProvider:function(t){return a.default.capitalize(t.key)},size:40},s.overviewConfig=Object.assign({},s.summaryConfig,{size:80});s.summaries=a.default.map([{title:\"Intra\",prop:\"intra\"},{title:\"Inbound\",prop:\"inbound\"},{title:\"Outbound\",prop:\"outbound\"},{title:\"All\",prop:\"total\"}],function(t){return{summary:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=arguments[2];return a.default.chain(t).map(function(t){return{typeId:t.dataType.id,count:t[n]}}).reduce(function(t,n){return n.typeId===Number(e)?t.UNKNOWN+=n.count:t.KNOWN+=n.count,t},{KNOWN:0,UNKNOWN:0}).map(function(t,e){return{key:e,count:t}}).value()}(s.enrichedDataTypeCounts,e,t.prop),title:t.title}})}}))}}f.$inject=[\"DisplayNameService\",\"LogicalFlowUtilityService\",\"ServiceBroker\"];var p={bindings:{stats:\"<\"},controller:f,template:s.default};e.default={component:p,id:\"waltzLogicalFlowsDataTypeSummaryPane\"}},1116:function(t,e){t.exports='<div style=padding-top:.6em> <strong>Data Type Categories</strong> <p class=\"text-muted small\"> The charts below show the number of flow decorations that have been aligned to known data types. <a ng-click=\"$ctrl.visibility.detail = !$ctrl.visibility.detail\" class=clickable> <span ng-bind=\"$ctrl.visibility.detail ? \\'Hide\\' : \\'Show\\'\"> </span> breakdown by data type. </a> </p> <div class=row ng-if=!$ctrl.visibility.detail> <div class=col-md-6 ng-repeat=\"summary in $ctrl.summaries\"> <waltz-pie-table data=summary.summary title=\"{{ summary.title }}\" config=$ctrl.overviewConfig> </waltz-pie-table> </div> </div> <div ng-if=$ctrl.visibility.detail class=waltz-fade-if> <table class=\"table table-condensed small table-striped\"> <colgroup> <col width=40%> <col width=15%> <col width=15%> <col width=15%> <col width=15%> </colgroup> <thead> <tr> <th>Category</th> <th style=text-align:right>Intra</th> <th style=text-align:right>Inbound</th> <th style=text-align:right>Outbound</th> <th style=text-align:right>Total</th> </tr> </thead> <tbody> <tr ng-repeat=\"row in $ctrl.enrichedDataTypeCounts | orderBy:\\'dataType.name\\'\"> <td> <span ng-bind=row.dataType.name></span> </td> <td align=right style=padding-right:1.5em> <span ng-bind=row.intra></span> </td> <td align=right style=padding-right:1.5em> <span ng-bind=row.inbound></span> </td> <td align=right style=padding-right:1.5em> <span ng-bind=row.outbound></span> </td> <td align=right style=padding-right:1.5em> <span ng-bind=row.total></span> </td> </tr> </tbody> <tbody ng-if=$ctrl.visibility.summaries> <tr> <td> Known / Unknown </td> <td align=right ng-repeat=\"summary in $ctrl.summaries\"> <div uib-popover-template=\"\\'wlft-summary-popup.html\\'\" popover-placement=bottom popver-append-to-body=true popover-trigger=mouseenter> <waltz-pie data=summary.summary config=$ctrl.summaryConfig> </waltz-pie> </div> </td> </tr> </tbody> </table> </div> </div>'},1117:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=l(n(1)),r=n(2),i=n(17),o=l(n(1118));function l(t){return t&&t.__esModule?t:{default:t}}var c={type:\"ALL\",scope:\"INTRA\"},s={applications:[],flows:[],decorators:[],selectedNode:null,isolatedNode:null,usedDataTypes:[],filterOptions:c,options:{graphTweakers:{node:{enter:function(t){return console.log(\"default graphTweaker.node.entry, selection: \",t)}},link:{enter:function(t){return t.attr(\"stroke\",\"red\")}}}},optionsVisible:!1,visibility:{boingyEverShown:!1,ignoreLimits:!1,summaries:!1,loadingFlows:!1,loadingStats:!1}};function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,e=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=a.default.chain(t).map(\"dataFlowId\").uniq().value();return function(t){return a.default.includes(e,t.id)}}(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]),i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"INTRA\";return function(n){switch(e){case\"INTRA\":return a.default.includes(t,n.target.id)&&a.default.includes(t,n.source.id);case\"ALL\":return!0;case\"INBOUND\":return a.default.includes(t,n.target.id);case\"OUTBOUND\":return a.default.includes(t,n.source.id)}}}(n,t.scope),o=function(t){return t?function(e){return e.source.id===t.id||e.target.id===t.id}:function(){return!0}}(e);return function(t){return r(t)&&i(t)&&o(t)}}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c,i=arguments[4],o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;return function(e){var n=\"DATA_TYPE\"===e.decoratorEntity.kind,a=\"ALL\"===t.type||e.decoratorEntity.id===Number(t.type);return n&&a}}(r),l=a.default.filter(n,o),s=d(r,i,a.default.map(e,\"id\"),l),u=a.default.filter(t,s);return{flows:u,entities:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a.default.chain(t).flatMap(function(t){return[t.source,t.target]}).uniqBy(\"id\").value()}(u),decorators:l}}function f(t,e,n,o){var l=a.default.defaultsDeep(this,s);function c(){a.default.forEach(l.filteredFlowData.entities,function(t){t.fx=null,t.fy=null})}var d=function(){l.visibility.loadingFlows=!0;var t=n.loadViewData(r.CORE_API.LogicalFlowStore.findBySelector,[l.selector]).then(function(t){return l.flows=t.data}),i=n.loadViewData(r.CORE_API.LogicalFlowDecoratorStore.findBySelector,[l.selector]).then(function(t){l.decorators=t.data,l.usedDataTypes=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.default.keyBy(t,\"id\");return a.default.chain(e).filter(function(t){return\"DATA_TYPE\"===t.decoratorEntity.kind}).map(\"decoratorEntity.id\").uniq().map(function(t){return n[t]}).orderBy(\"name\").value()}(l.allDataTypes,l.decorators)}),o=n.loadViewData(r.CORE_API.ApplicationStore.findBySelector,[l.selector]).then(function(t){return l.applications=t.data});return e.all([t,i,o]).then(function(){l.filterChanged(),l.visibility.loadingFlows=!1})};l.filterChanged=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.filterOptions;l.filterOptions=e,l.flows&&l.decorators&&(l.filteredFlowData=u(l.flows,l.applications,l.decorators,e,l.isolatedNode),l.graphTweakers=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return console.log(\"dftg: no nodeSelectFn given\",t)},i=a.default.map(e,\"id\"),o=t.buildGraphTweakers(i,n),l=o.node.enter;return o.node.enter=function(t){return t.on(\"click.node-select\",r).call(l)},o}(o,l.applications,l.filteredFlowData.decorators,function(e){return t.$applyAsync(function(){return l.selectedNode=e})}))},l.isolate=function(t){c(),l.isolatedNode=t,l.filterChanged()},l.dismissSelectedNode=function(){c(),l.isolatedNode=null,l.selectedNode=null,l.filterChanged()},l.refocusNode=function(t){l.selectedNode=t,l.isolate(t)},l.$onChanges=function(t){l.parentEntityRef&&(l.selector=(0,i.mkSelectionOptions)(l.parentEntityRef),d())},l.$onInit=function(){n.loadAppData(r.CORE_API.DataTypeStore.findAll).then(function(t){return l.allDataTypes=t.data})}}f.$inject=[\"$scope\",\"$q\",\"ServiceBroker\",\"LogicalFlowUtilityService\"];var p={controller:f,bindings:{parentEntityRef:\"<\"},template:o.default};e.default={component:p,id:\"waltzLogicalFlowsBoingyGraph\"}},1118:function(t,e){t.exports='<br> <waltz-loading-notification show=$ctrl.visibility.loadingFlows name=\"Loading Flow Data\"> </waltz-loading-notification> <div class=row> <div class=col-sm-4> <waltz-flow-filter-options visible=$ctrl.optionsVisible on-change=$ctrl.filterChanged used-types=$ctrl.usedDataTypes> </waltz-flow-filter-options> <hr> <div ng-show=\"$ctrl.selectedNode != null\"> <h5> <waltz-entity-icon-label entity-ref=$ctrl.selectedNode></waltz-entity-icon-label> <span class=\"pull-right clickable\" ng-click=$ctrl.dismissSelectedNode()> <a class=clickable>&#10006;</a> </span> </h5> <div> <a ng-click=$ctrl.isolate($ctrl.selectedNode) class=clickable> <waltz-icon name=crosshairs></waltz-icon> Isolate </a> <span class=\"small text-muted\"> - show only this <span ng-bind=\"$ctrl.selectedNode.kind | toDisplayName:\\'entity\\'\"></span> and its neighbours </span> </div> <hr> <waltz-app-centric-flow-table app=$ctrl.selectedNode flows=$ctrl.flows decorators=$ctrl.decorators on-select=$ctrl.refocusApp> </waltz-app-centric-flow-table> <div> See more on <waltz-entity-link entity-ref=$ctrl.selectedNode></waltz-entity-link> &raquo; </div> </div> </div> <div class=col-sm-8 style=\"border-left:1px solid #ccc\"> <div ng-if=\"$ctrl.filteredFlowData.entities.length == 0  && $ctrl.flows.length > 0\"> <div class=\"alert alert-warning\"> <strong>No data to show</strong> given the current filter options. Use the filters on the left to change these options. </div> </div> <div ng-if=\"$ctrl.filteredFlowData.entities.length >= 400 && !$ctrl.visibility.ignoreLimits\"> <div class=\"alert alert-warning\"> This graph will have <strong>too many nodes</strong> to render smoothly. Use the configure button too limit the amount of data to show. Alternatively the data is available via the \\'Table\\' tab. <br> If you still want to see the graph click <a class=clickable ng-click=\"$ctrl.visibility.ignoreLimits = true\"> here </a> - however be aware that your machine may struggle. </div> </div> <div ng-if=\"$ctrl.filteredFlowData.flows.length > 0\"> <div ng-if=\"$ctrl.filteredFlowData.entities.length < 400  || $ctrl.visibility.ignoreLimits\"> <waltz-logical-flow-diagram data=$ctrl.filteredFlowData tweakers=$ctrl.graphTweakers> </waltz-logical-flow-diagram> <div class=\"small text-muted\"> Dragging nodes will pin them. Double click to unpin. If an application is gray it is not a member of this group. </div> </div> </div> </div> </div> '},1119:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a={template:function(t){return t&&t.__esModule?t:{default:t}}(n(1120)).default,bindings:{applications:\"<\",type:\"<\",rating:\"<\"}};e.default=a},1120:function(t,e){t.exports='<table class=\"table table-condensed small\"> <colgroup> <col width=30%> <col width=70%> </colgroup> <tbody> <tr> <td> <strong>Data Type</strong> </td> <td> <span ng-bind=$ctrl.type.name> </span> </td> </tr> <tr> <td> <strong>Rating</strong> </td> <td> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=$ctrl.rating> </waltz-enum-value> </td> </tr> <tr> <td> <strong>Consuming Apps</strong> </td> <td> <div class=waltz-scroll-region style=height:200px> <ul class=list-unstyled> <li ng-repeat=\"app in $ctrl.applications | orderBy:\\'name\\'\"> <a ui-sref=\"main.app.view ({ id: app.id })\" ng-bind=app.name> </a> </li> </ul> </div> </td> </tr> </tbody> </table>'},1121:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=o(n(1)),r=n(25),i=n(0);function o(t){return t&&t.__esModule?t:{default:t}}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,r.nest)().key(function(t){return t.decoratorEntityReference.id}).key(function(t){return t.rating}).rollup(function(t){return(0,i.notEmpty)(t)?t[0].count:0}).map(t)}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=(0,r.nest)().key(function(t){return t.decoratorEntityReference.id}).rollup(function(t){return a.default.sumBy(t,\"count\")}).map(n),o=l(n);return{maxCounts:i,directCounts:l(e),totalCounts:o,decorators:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.default.keyBy(t,\"id\");return a.default.chain(e).map(\"decoratorEntityReference.id\").uniq().map(function(t){return n[t]}).filter(function(t){return null!=t}).sortBy(\"name\").value()}(t,n)}}var s={bindings:{exactSummaries:\"<\",childSummaries:\"<\",decoratorEntities:\"<\",onClick:\"<\"},template:o(n(1122)).default,controller:function(){var t=this,e=function(e,n){t.onClick(n),e&&e.stopPropagation()};t.$onChanges=function(){return Object.assign(t,c(t.decoratorEntities,t.exactSummaries,t.childSummaries))},t.columnClick=function(t,n){return e(t,{type:\"COLUMN\",rating:n})},t.rowClick=function(t,n){return e(t,{type:\"ROW\",dataType:n})},t.cellClick=function(t,n,a){return e(t,{type:\"CELL\",dataType:n,rating:a})}}};e.default=s},1122:function(t,e){t.exports='<div class=waltz-rated-summary-table> <table class=\"table table-condensed\"> <colgroup> <col width=15%> <col width=20%> <col width=20%> <col width=20%> <col width=20%> <col width=5%> </colgroup> <thead> <tr> <th>Data Type</th> <th ng-click=\"$ctrl.columnClick($event, \\'PRIMARY\\')\"> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=\"\\'PRIMARY\\'\"> </waltz-enum-value> </th> <th ng-click=\"$ctrl.columnClick($event, \\'SECONDARY\\')\"> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=\"\\'SECONDARY\\'\"> </waltz-enum-value> </th> <th ng-click=\"$ctrl.columnClick($event, \\'DISCOURAGED\\')\"> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=\"\\'DISCOURAGED\\'\"> </waltz-enum-value> </th> <th ng-click=\"$ctrl.columnClick($event, \\'NO_OPINION\\')\"> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=\"\\'NO_OPINION\\'\"> </waltz-enum-value> </th> <th>Total</th> </tr> </thead> <tbody> <tr ng-repeat=\"decorator in $ctrl.decorators\" ng-click=\"$ctrl.rowClick($event, decorator)\"> <td> <span ng-bind=decorator.name> </span> </td> <td> <span ng-if=\"$ctrl.totalCounts.get(decorator.id).get(\\'PRIMARY\\') > 0\"> <waltz-rated-summary-cell direct-count=\"$ctrl.directCounts.get(decorator.id).get(\\'PRIMARY\\')\" total-count=\"$ctrl.totalCounts.get(decorator.id).get(\\'PRIMARY\\')\" rating=\"\\'PRIMARY\\'\" max-count=$ctrl.maxCounts.get(decorator.id) decorator=decorator ng-click=\"$ctrl.cellClick($event, decorator, \\'PRIMARY\\')\" class=\"wrst-primary clickable\"> </waltz-rated-summary-cell> </span> </td> <td> <span ng-if=\"$ctrl.totalCounts.get(decorator.id).get(\\'SECONDARY\\') > 0\"> <waltz-rated-summary-cell direct-count=\"$ctrl.directCounts.get(decorator.id).get(\\'SECONDARY\\')\" total-count=\"$ctrl.totalCounts.get(decorator.id).get(\\'SECONDARY\\')\" rating=\"\\'PRIMARY\\'\" max-count=$ctrl.maxCounts.get(decorator.id) decorator=decorator ng-click=\"$ctrl.cellClick($event, decorator, \\'SECONDARY\\')\" class=\"wrst-secondary clickable\"> </waltz-rated-summary-cell> </span> </td> <td> <span ng-if=\"$ctrl.totalCounts.get(decorator.id).get(\\'DISCOURAGED\\') > 0\"> <waltz-rated-summary-cell direct-count=\"$ctrl.directCounts.get(decorator.id).get(\\'DISCOURAGED\\')\" total-count=\"$ctrl.totalCounts.get(decorator.id).get(\\'DISCOURAGED\\')\" rating=\"\\'PRIMARY\\'\" max-count=$ctrl.maxCounts.get(decorator.id) decorator=decorator ng-click=\"$ctrl.cellClick($event, decorator, \\'DISCOURAGED\\')\" class=\"wrst-discouraged clickable\"> </waltz-rated-summary-cell> </span> </td> <td> <span ng-if=\"$ctrl.totalCounts.get(decorator.id).get(\\'NO_OPINION\\') > 0\"> <waltz-rated-summary-cell direct-count=\"$ctrl.directCounts.get(decorator.id).get(\\'NO_OPINION\\')\" total-count=\"$ctrl.totalCounts.get(decorator.id).get(\\'NO_OPINION\\')\" rating=\"\\'PRIMARY\\'\" max-count=$ctrl.maxCounts.get(decorator.id) decorator=decorator ng-click=\"$ctrl.cellClick($event, decorator, \\'NO_OPINION\\')\" class=\"wrst-no-opinion clickable\"> </waltz-rated-summary-cell> </span> </td> <td> <span class=\"small text-muted\" ng-bind=$ctrl.maxCounts.get(decorator.id)> </span> </td> </tr> </tbody> </table> </div>'},1123:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=r(n(1));function r(t){return t&&t.__esModule?t:{default:t}}var i={popoverText:\"...\",onClick:function(){return console.log(\"No on-click handler passed to rating-flow-summary-cell\")}};var o={bindings:{totalCount:\"<\",directCount:\"<\",maxCount:\"<\",decorator:\"<\",rating:\"<\",onClick:\"&\"},controller:function(){var t=a.default.defaultsDeep(this,i);t.cellClick=function(e){t.onClick(),e.stopPropagation()},t.$onChanges=function(){t.popoverText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t?t.name+\".  Direct: \"+e+\", indirect: \"+(n-e)+\" (total: \"+n+\")\":\"?\"}(t.decorator,t.directCount,t.totalCount),t.stackValues=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return[t,(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)-t]}(t.directCount,t.totalCount)}},template:r(n(1124)).default};e.default=o},1124:function(t,e){t.exports='<div uib-popover=\"{{ $ctrl.popoverText }}\" popover-trigger=mouseenter> <waltz-simple-stack-chart max=$ctrl.maxCount values=$ctrl.stackValues> </waltz-simple-stack-chart> </div> '},1125:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=o(n(1)),r=n(0),i=o(n(1126));function o(t){return t&&t.__esModule?t:{default:t}}var l={onSelect:function(t){return console.log(\"Default handler for appCentricFlowTable.onSelect(). \",t)}};function c(){var t=(0,r.initialiseData)(this,l);t.$onChanges=function(e){t.groupedFlows=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t)return{};var r=a.default.chain(n).filter(function(t){return\"DATA_TYPE\"===t.decoratorEntity.kind}).map(function(t){return{dataFlowId:t.dataFlowId,id:t.decoratorEntity.id,rating:t.rating}}).keyBy(\"dataFlowId\").value();return a.default.chain(e).filter(function(e){return e.target.id===t.id||e.source.id===t.id}).map(function(e){return Object.assign({},e,{direction:e.target.id===t.id?\"Incoming\":\"Outgoing\"})}).map(function(t){return Object.assign({},t,{decorator:r[t.id]})}).map(function(t){return Object.assign({},t,{counterpart:\"Incoming\"===t.direction?t.source:t.target})}).sortBy(\"direction\").groupBy(\"direction\").value()}(t.app,t.flows,t.decorators)}}c.$inject=[];var s={bindings:{app:\"<\",flows:\"<\",decorators:\"<\",onSelect:\"<\"},template:i.default,controller:c};e.default=s},1126:function(t,e){t.exports='<table class=\"table table-condensed table-hover small\"> <thead> <tr> <th>Direction</th> <th>Node</th> <th>Type</th> <th></th> </tr> </thead> <tbody class=small ng-repeat=\"(direction, flows) in $ctrl.groupedFlows\"> <tr ng-repeat=\"flow in flows | orderBy:\\'source.name\\'\"> <td> <span ng-if=$first ng-bind=direction> </span> </td> <td class=waltz-visibility-parent> <a ng-click=$ctrl.onSelect(flow.counterpart) class=clickable> <waltz-entity-icon-label entity-ref=flow.counterpart></waltz-entity-icon-label> </a> </td> <td> <a ui-sref=\"main.data-type.view ({id: flow.decorator.id })\" class=clickable> <span ng-bind=\"flow.decorator.id | toDisplayName:\\'dataType\\'\"> </span> </a> </td> <td> <div uib-tooltip=\"{{flow.decorator.rating | toDescription:\\'AuthoritativenessRating\\'}}\" tooltip-append-to-body=true tooltip-placement=top> <waltz-rating-indicator-cell rating=flow.decorator.rating> </waltz-rating-indicator-cell> </div> </td> </tr> </tbody> </table> '},1127:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(0),r=n(44),i=n(5),o=n(405),l=n(83),c=n(82),s=n(118);n(45);var d=f(n(1)),u=f(n(1128));function f(t){return t&&t.__esModule?t:{default:t}}var p=800,g=500,v={zoomEnabled:!1},m={enter:function(t){return t},exit:function(t){return t},update:function(t){return t}},y=(0,o.forceSimulation)().velocityDecay(.5).force(\"center\",(0,o.forceCenter)(p/2,g/2)).force(\"charge\",(0,o.forceManyBody)().strength(-110).distanceMin(1).distanceMax(400)).force(\"collide\",(0,o.forceCollide)()).force(\"link\",(0,o.forceLink)().id(function(t){return t.id}).iterations(2).distance(55)),w=(0,c.symbol)().size(128).type(c.symbolWye);function h(t){t.append(\"text\").attr(\"dx\",9).attr(\"dy\",\".35em\").text(function(t){return t.name})}function b(t){t.filter(function(t){return\"APPLICATION\"===t.kind}).append(\"circle\").attr(\"class\",\"wdfd-glyph\").attr(\"r\",6),t.filter(function(t){return\"ACTOR\"===t.kind}).append(\"path\").attr(\"class\",\"wdfd-glyph\").attr(\"d\",w)}function k(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=d.default.defaults(n.link,m),o=d.default.defaults(n.node,m),c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return d.default.chain(t).map(function(t){return{id:t.source.id+\"_\"+t.target.id,source:t.source.id,target:t.target.id,data:t}}).uniqBy(\"id\").value()}(t.flows),s=t.entities,u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=arguments[2],a=e.selectAll(\".wdfd-link\").data(t,function(t){return t.id}),r=a.enter().append(\"path\").classed(\"wdfd-link\",!0).attr(\"stroke\",\"#444\").attr(\"stroke-opacity\",.6).call(n.enter);return a.exit().remove(),a.merge(r).call(n.update)}(c,e.svg.select(\".links\"),a),f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m,a=e.selectAll(\".wdfd-node\").data(t,function(t){return t.id}),r=a.enter().append(\"g\").classed(\"wdfd-node\",!0).on(\"dblclick.unfix\",function(t){t.fx=null,t.fy=null}).call((0,l.drag)().on(\"start\",function(t){i.event.active||y.alphaTarget(.1).restart(),t.fx=t.x,t.fy=t.y}).on(\"drag\",function(t){t.fx=i.event.x,t.fy=i.event.y}).on(\"end\",function(t){i.event.active||y.alphaTarget(0).restart(),t.fx=i.event.x,t.fy=i.event.y}));return r.call(h).call(b).call(n.enter),a.exit().call(n.exit).remove(),a.merge(r)}(s,e.svg.select(\".nodes\"),o);return y.nodes(s).on(\"tick\",function(){f.attr(\"transform\",function(t){return\"translate(\"+t.x+\", \"+t.y+\")\"}),u.call(r.lineWithArrowPath)}),y.force(\"link\").links(c),y}function I(t,e){var n=(0,a.initialiseData)(this,v),o=(0,i.select)(e[0]).select(\".viz\"),l=function(t){var e=t.append(\"svg\").attr(\"width\",p).attr(\"height\",g).attr(\"viewBox\",\"0 0 \"+p+\" \"+g),n=(0,r.responsivefy)(e);return e.append(\"g\").attr(\"class\",\"links\"),e.append(\"g\").attr(\"class\",\"nodes\"),{svg:e,destroyResizeListener:n}}(o),c=d.default.debounce(function(){k(n.data,l,n.tweakers),y.alpha(.4).restart()},250);n.$onChanges=function(e){e.data&&t(c)},n.$onInit=function(){y.restart()},n.$onDestroy=function(){y.stop(),l.destroyResizeListener()};var u=(0,s.zoom)().scaleExtent([.25,2]).on(\"zoom\",function(){var t=o.select(\"svg\"),e=i.event.transform;t.select(\".nodes\").attr(\"transform\",e),t.select(\".links\").attr(\"transform\",e)});n.enableZoom=function(){o.select(\"svg\").call(u),n.zoomEnabled=!0},n.disableZoom=function(){o.select(\"svg\").on(\".zoom\",null),n.zoomEnabled=!1},n.resetSimulation=function(){d.default.forEach(n.data.entities,function(t){t.x=null,t.y=null,t.fx=null,t.fy=null}),o.select(\"svg\").transition().duration(750).call(u.transform,s.zoomIdentity),c()}}I.$inject=[\"$timeout\",\"$element\"];var $={bindings:{data:\"<\",tweakers:\"<\"},template:u.default,controller:I};e.default=$},1128:function(t,e){t.exports='<div id=waltz-boingy-graph class=viz> </div> <div style=position:absolute;bottom:24px;left:48px class=waltz-visibility-parent> <button class=\"btn btn-default btn-xs waltz-visibility-child-30\" ng-if=\"! $ctrl.zoomEnabled\" uib-popover=\"Drag background to pan, use wheel to zoom in/out\" popover-trigger=mouseenter popover-placement=top popover-append-to-body=true ng-click=$ctrl.enableZoom()> Enable Pan & Zoom </button> <button class=\"btn btn-success btn-xs waltz-visibility-child-50\" ng-if=$ctrl.zoomEnabled ng-click=$ctrl.disableZoom()> Disable Pan & Zoom </button> <button class=\"btn btn-default btn-xs waltz-visibility-child-30\" uib-popover=\"Restart the layout process\" popover-trigger=mouseenter popover-placement=top popover-append-to-body=true ng-click=$ctrl.resetSimulation()> Reset </button> </div>'},1129:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(0),r=n(80),i=function(t){return t&&t.__esModule?t:{default:t}}(n(1130));var o={actorIcon:r.entity.ACTOR.icon,applicationIcon:r.entity.APPLICATION.icon,visibility:{addingApplication:!0}};function l(){var t=this;t.$onInit=function(){return(0,a.initialiseData)(t,o)},t.$onChanges=function(t){},t.showAddActor=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.visibility.addingApplication=!e}}l.$inject=[];var c={template:i.default,bindings:{allActors:\"<\",onAddApplication:\"<\",onAddActor:\"<\",onCancel:\"<\"},controller:l,transclude:{help:\"help\",heading:\"heading\"}};e.default=c},113:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.NEITHER=e.OUTBOUND=e.INBOUND=void 0,e.isLogicalFlowInbound=s,e.isLogicalFlowOutbound=d,e.categorizeDirection=function(t,e){return s(t,e)?o:d(t,e)?l:c},e.determineStatMethod=function(t){return\"DATA_TYPE\"===t?i.CORE_API.DataTypeUsageStore.calculateStats:i.CORE_API.LogicalFlowStore.calculateStats},e.resolveSourceAndTarget=function(t,e){var n=function(e){var n=\"APPLICATION\"===e.kind?i.CORE_API.ApplicationStore.getById:i.CORE_API.ActorStore.getById;return t.loadViewData(n,[e.id]).then(function(t){return Object.assign({},t.data,{entityReference:e})})},a={},r=n(e.source).then(function(t){return a.source=t}),o=n(e.source).then(function(t){return a.target=t});return r.then(function(){return o}).then(function(){return a})};var a=n(8),r=n(12),i=n(2),o=e.INBOUND=\"INBOUND\",l=e.OUTBOUND=\"OUTBOUND\",c=e.NEITHER=\"NEITHER\";function s(t,e){return(0,a.checkIsLogicalFlow)(t),(0,a.checkIsEntityRef)(e),(0,r.sameRef)(t.target,e,{skipChecks:!0})}function d(t,e){return(0,a.checkIsLogicalFlow)(t),(0,a.checkIsEntityRef)(e),(0,r.sameRef)(t.source,e,{skipChecks:!0})}},1130:function(t,e){t.exports='<h4 ng-transclude=heading></h4> <div ng-if=$ctrl.visibility.addingApplication> <waltz-basic-app-selector on-add=$ctrl.onAddApplication on-cancel=$ctrl.onCancel> </waltz-basic-app-selector> <div ng-transclude=help class=\"small waltz-paragraph text-muted\"> </div> <div class=waltz-paragraph> <waltz-icon name=\"{{ $ctrl.actorIcon }}\"></waltz-icon> Select an <a class=clickable ng-click=$ctrl.showAddActor(true)> actor </a> instead. </div> </div> <div ng-if=!$ctrl.visibility.addingApplication> <waltz-basic-actor-selector all-actors=$ctrl.allActors on-add=$ctrl.onAddActor on-cancel=$ctrl.onCancel> </waltz-basic-actor-selector> <div class=waltz-paragraph> <waltz-icon name=\"{{ $ctrl.applicationIcon }}\"></waltz-icon> Select an <a class=clickable ng-click=$ctrl.showAddActor(false)> application </a> instead. </div> </div> '},1131:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=c(n(1)),r=n(2),i=n(17),o=n(113),l=c(n(1132));function c(t){return t&&t.__esModule?t:{default:t}}var s={flows:[],decorators:[],visibility:{loadingFlows:!1,loadingStats:!1}};function d(t,e){var n=a.default.defaultsDeep(this,s);n.tabSelected=function(a,i){i>0&&function(){n.visibility.loadingFlows=!0;var a=e.loadViewData(r.CORE_API.LogicalFlowStore.findBySelector,[n.selector]).then(function(t){return n.flows=t.data}),i=e.loadViewData(r.CORE_API.LogicalFlowDecoratorStore.findBySelector,[n.selector]).then(function(t){n.decorators=t.data});t.all([a,i]).then(function(){n.visibility.loadingFlows=!1})}(),1===i&&(n.visibility.boingyEverShown=!0),n.currentTabIndex=i},n.$onChanges=function(){n.parentEntityRef&&(n.selector=(0,i.mkSelectionOptions)(n.parentEntityRef),n.loadingStats=!0,e.loadViewData((0,o.determineStatMethod)(n.parentEntityRef.kind),[n.selector]).then(function(t){n.loadingStats=!1,n.stats=t.data}))}}d.$inject=[\"$q\",\"ServiceBroker\"];var u={controller:d,bindings:{parentEntityRef:\"<\"},template:l.default};e.default=u},1132:function(t,e){t.exports='<div class=\"row waltz-logical-flows-tabgroup\"> <div class=col-md-12> <uib-tabset active=active> <uib-tab index=0 heading=Summary select=\"$ctrl.tabSelected(\\'summary\\', 0)\"> <div class=row> <div class=col-sm-4> <br> <waltz-flow-cloud-diagram width=300 height=300 stats=$ctrl.stats> </waltz-flow-cloud-diagram> </div> <div class=\"col-sm-12 col-md-8\"> <waltz-logical-flows-data-type-summary-pane stats=$ctrl.stats> </waltz-logical-flows-data-type-summary-pane> </div> </div> </uib-tab> <uib-tab index=1 heading=Graph select=\"$ctrl.tabSelected(\\'graph\\', 1)\"> <br> <div ng-if=\"$ctrl.currentTabIndex == 1\"> <waltz-logical-flows-boingy-graph parent-entity-ref=$ctrl.parentEntityRef> </waltz-logical-flows-boingy-graph> </div> </uib-tab> <uib-tab index=2 heading=Table select=\"$ctrl.tabSelected(\\'table\\', 2)\"> <br> <waltz-loading-notification show=$ctrl.visibility.loadingFlows name=\"Loading Flow Data\"> </waltz-loading-notification> <div ng-if=\"$ctrl.currentTabIndex == 2\"> <div style=height:300px> <waltz-logical-flow-table flows=$ctrl.flows decorators=$ctrl.decorators on-initialise=$ctrl.onTableInitialise> </waltz-logical-flow-table> </div> <div style=\"padding:.3em;border-top:1px solid #eee\" class=pull-right> <waltz-data-extract-link name=Export styling=link filename=logical-flows.csv extract=logical-flows method=POST request-body=$ctrl.selector> </waltz-data-extract-link> </div> </div> <div ng-if=\"$ctrl.filteredFlowData.flows.length == 0 && $ctrl.flows.length > 0\"> <div class=\"alert alert-warning\"> <strong>No data to show</strong> given the current filter options. Use the configure button above to adjust these options. </div> </div> </uib-tab> </uib-tabset> </div> </div> <script type=text/ng-template id=wlft-summary-popup.html> <div class=\"small\">\\n        <strong ng-bind=\"summary.title\"></strong>\\n\\n        <table class=\"table table-condensed small\" style=\"margin-top: 0.4em\">\\n            <tr ng-repeat=\"d in summary.summary\">\\n                <td>\\n                    <span ng-bind=\"d.key == \\'KNOWN\\' ? \\'Known\\' : \\'Unknown\\'\"></span>\\n                </td>\\n                <td><span ng-bind=\"d.count\"></span></td>\\n            </tr>\\n        </table>\\n    </div> <\\/script>'},1133:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=l(n(1)),r=n(17),i=n(113),o=l(n(1134));function l(t){return t&&t.__esModule?t:{default:t}}var c={export:function(){return console.log(\"lfts: default do-nothing export function\")},visibility:{exportButton:!1,sourcesOverlay:!1}};function s(t){var e=a.default.defaultsDeep(this,c),n=function(n){e.loadingStats=!0,t.loadViewData((0,i.determineStatMethod)(e.parentEntityRef.kind),[n]).then(function(t){e.loadingStats=!1,e.stats=t.data,e.hasFlows=function(t){var e=a.default.get(t,\"flowCounts\",{});return a.default.sum(a.default.values(e))>0}(e.stats)})};e.$onInit=function(){},e.$onChanges=function(){e.parentEntityRef&&(e.selector=(0,r.mkSelectionOptions)(e.parentEntityRef),n(e.selector))}}s.$inject=[\"ServiceBroker\"];var d={controller:s,bindings:{parentEntityRef:\"<\"},template:o.default};e.default=d},1134:function(t,e){t.exports='<div> <waltz-section-actions> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.visibility.sourcesOverlay = ! $ctrl.visibility.sourcesOverlay\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.visibility.sourcesOverlay entities=\"[\\'LOGICAL_DATA_FLOW\\']\"> </waltz-source-data-overlay> <div ng-if=$ctrl.hasFlows> <waltz-logical-flows-tabgroup parent-entity-ref=$ctrl.parentEntityRef> </waltz-logical-flows-tabgroup> </div> <div ng-if=!$ctrl.hasFlows> <waltz-no-data> <message> <strong>No related flows found.</strong> </message> </waltz-no-data> </div> </div>'},1135:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),r=n(27),i=n(73);var o=[(0,r.mkEntityLinkGridCell)(\"Source\",\"source\",\"none\"),(0,r.mkEntityLinkGridCell)(\"Target\",\"target\",\"none\"),(0,r.mkEntityLinkGridCell)(\"Data Type\",\"dataType\",\"none\"),{field:\"rating\",displayName:\"Authoritativeness\",cellTemplate:'<span>\\n                     <waltz-rating-indicator-cell rating=\"row.entity.rating\" \\n                                                  show-name=\"true\">\\n                     </waltz-rating-indicator-cell>\\n                   </span>',sortingAlgorithm:function(t,e){return t.name.localeCompare(e.name)},exportFormatter:function(t){return t.name}}];function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return a.default.chain(t).filter(function(t){return\"DATA_TYPE\"===t.decoratorEntity.kind}).map(function(t){return Object.assign({},{dataFlowId:t.dataFlowId,dataType:{id:t.decoratorEntity.id,name:function(t){return e.lookup(\"dataType\",t)}(t.decoratorEntity.id),kind:\"DATA_TYPE\"},authSourceRating:t.rating})}).groupBy(\"dataFlowId\").value()}function c(t){var e=this;e.$onChanges=function(){var n=(0,i.mkAuthoritativeRatingSchemeItems)(t),r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],r=arguments[3],i=l(e,n);return a.default.flatMap(t,function(t){return a.default.map(i[t.id],function(e){return Object.assign({dataType:e.dataType,rating:r[e.authSourceRating]},t)})})}(e.flows,e.decorators,t,n);e.columnDefs=o,e.gridData=r}}c.$inject=[\"DisplayNameService\"];var s={bindings:{decorators:\"<\",flows:\"<\",onInitialise:\"<\"},template:'<div class=\"row\">\\n                    <div class=\"col-md-12\">\\n                        <waltz-grid-with-search column-defs=\"$ctrl.columnDefs\"\\n                                                entries=\"$ctrl.gridData\"\\n                                                on-initialise=\"$ctrl.onInitialise\">\\n                        </waltz-grid-with-search>\\n                    </div>\\n                  </div>',controller:c};e.default=s},1136:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=l(n(1)),r=n(24),i=n(2),o=l(n(1137));function l(t){return t&&t.__esModule?t:{default:t}}var c={selectedType:\"ALL\",selectedScope:\"ALL\",visibility:{tree:!1},onChange:function(){return console.log(\"No change handler registered for flow-filter-options-overlay::onChange\")}};function s(t){var e=a.default.defaults(this,c);e.onShowAll=function(){e.selectedType=\"ALL\",e.visibility.tree=!1,e.notifyChanges()},e.onShowTree=function(){e.visibility.tree=!0},e.onSelectType=function(t){e.selectedType=t,e.notifyChanges()},e.$onInit=function(){t.loadAppData(i.CORE_API.DataTypeStore.findAll).then(function(t){return e.allDataTypes=t.data})},e.$onChanges=function(){e.notifyChanges();var t=a.default.map(e.usedTypes,\"id\"),n=a.default.map(e.allDataTypes,function(e){return Object.assign({},e,{isUsed:a.default.includes(t,e.id)})});e.hierarchy=(0,r.buildHierarchies)(n,!1)},e.notifyChanges=function(){var t={type:e.selectedType||\"ALL\",scope:e.selectedScope||\"ALL\"};e.onChange(t)},e.notifyChanges()}s.$inject=[\"ServiceBroker\"];var d={controller:s,bindings:{onChange:\"<\",usedTypes:\"<\"},template:o.default};e.default=d},1137:function(t,e){t.exports=\"<div class=waltz-flow-filter-options> <h5> <waltz-icon name=flask></waltz-icon> Data Types <small>Filter</small> </h5> <hr> <div ng-if=!$ctrl.visibility.tree> Showing all flows for all data types. <br> <a class=clickable ng-click=$ctrl.onShowTree()> Select specific data types </a> </div> <div ng-if=$ctrl.visibility.tree> <treecontrol class=\\\"tree-light small\\\" tree-model=$ctrl.hierarchy order-by=\\\"'-name'\\\" options=$ctrl.treeOptions> <span uib-popover={{node.description}} popover-trigger=mouseenter popover-popup-delay=400 popover-append-to-body=true class=waltz-visibility-parent> <span ng-bind=node.name ng-style=\\\"{ 'font-style': node.isUsed ? 'normal' : 'italic' }\\\" ng-click=$ctrl.onSelectType(node.id)> </span> </span> </treecontrol> <br> Alternatively, <a class=clickable ng-click=$ctrl.onShowAll()> show all. </a> </div> <hr> <h5> <waltz-icon name=filter></waltz-icon> Scope <small>Filter</small> </h5> <div class=\\\"waltz-paragraph small\\\" style=padding-bottom:4px> Select one of the following scopes: <div class=wffo-scopes> <label> <input type=radio ng-change=$ctrl.notifyChanges() ng-model=$ctrl.selectedScope value=INTRA> Intra - <span class=text-muted> Only show flows between applications in this group </span> </label> <label> <input type=radio ng-model=$ctrl.selectedScope ng-change=$ctrl.notifyChanges() value=INBOUND> Inbound - <span class=text-muted> Show flows originating from outside this group </span> </label> <label> <input type=radio ng-model=$ctrl.selectedScope ng-change=$ctrl.notifyChanges() value=OUTBOUND> Outbound - <span class=text-muted> Show flows going to applications outside this group </span> </label> <label> <input type=radio ng-model=$ctrl.selectedScope ng-change=$ctrl.notifyChanges() value=ALL> All - <span class=text-muted> Show all flows </span> </label> </div> </div> </div>\"},1138:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a={},r={url:\"logical-flow/{id:int}\",views:{\"content@\":function(t){return t&&t.__esModule?t:{default:t}}(n(1139)).default}};function i(t){t.state(\"main.logical-flow\",a).state(\"main.logical-flow.view\",r)}i.$inject=[\"$stateProvider\"],e.default=i},1139:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n(1140)),i=n(31),o=n(2);var l={logicalFlow:null,bookmarksSection:i.dynamicSections.bookmarksSection,changeLogSection:i.dynamicSections.changeLogSection,entityNamedNotesSection:i.dynamicSections.entityNamedNotesSection,entityDiagramsSection:i.dynamicSections.entityDiagramsSection};function c(t,e,n,r,i){var c=(0,a.initialiseData)(this,l),s=e.id;c.entityReference={id:s,kind:\"LOGICAL_DATA_FLOW\"},i.loadViewData(o.CORE_API.LogicalFlowStore.getById,[s]).then(function(t){return c.logicalFlow=t.data});c.deleteFlow=function(){confirm(\"Are you sure you want to delete this flow ?\")&&i.execute(o.CORE_API.LogicalFlowStore.removeFlow,[c.logicalFlow.id]).then(function(e){e.data>0?r.success(\"Logical Flow between \"+c.logicalFlow.source.name+\" and \"+c.logicalFlow.target.name+\" deleted\"):r.error(e.message),function(t,e){var n=e.getAll()[0];n?t.go(n.state,n.stateParams):t.go(\"main.home\")}(t,n)}).then(function(t){return function(t){t>0?(r.success(\"Logical flow deleted\"),function(t,e){if(e){var n=function(t){return{name:t.source.name+\" to \"+t.target.name,kind:\"LOGICAL_DATA_FLOW\",state:\"main.logical-flow.view\",stateParams:{id:t.id}}}(e);t.remove(n.name,n.kind,n.state,n.stateParams)}}(n,c.logicalFlow)):r.error(t.message)}(t.data)})}}c.$inject=[\"$state\",\"$stateParams\",\"HistoryStore\",\"Notification\",\"ServiceBroker\"],e.default={template:r.default,controller:c,controllerAs:\"ctrl\"}},1140:function(t,e){t.exports='<div class=container-fluid> <waltz-page-header name=\"{{ ctrl.logicalFlow.source.name }} {{ ctrl.logicalFlow ? \\'&rarr;\\' : \\'\\' }} {{ ctrl.logicalFlow.target.name }}\" icon=random> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li ng-if=ctrl.logicalFlow> <waltz-entity-link entity-ref=ctrl.logicalFlow.source></waltz-entity-link> </li> <li ng-if=!ctrl.logicalFlow> Logical Flow </li> <li> <waltz-entity-link entity-ref=ctrl.logicalFlow.target></waltz-entity-link> </li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <div ng-if=ctrl.logicalFlow> <div class=row> <div class=col-md-12> <waltz-data-type-usage-panel parent-entity-ref=ctrl.entityReference help-text=\"Data types referenced by this logical flow\"> </waltz-data-type-usage-panel> </div> </div> <div class=\"small text-muted\" ng-if=\"ctrl.logicalFlow.lastUpdatedBy && ctrl.logicalFlow.lastUpdatedAt && ctrl.logicalFLow\"> Last updated by <span ng-bind=ctrl.logicalFlow.lastUpdatedBy></span> (<waltz-from-now timestamp=ctrl.logicalFlow.lastUpdatedAt></waltz-from-now>) </div> </div> <waltz-no-data ng-if=!ctrl.logicalFlow> <message>No information for this logical flow</message> </waltz-no-data> </div> <div ng-if=ctrl.logicalFlow> <br> <waltz-dynamic-section-wrapper section=ctrl.entityNamedNotesSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-physical-flow-section parent-entity-ref=ctrl.entityReference> </waltz-physical-flow-section> <waltz-dynamic-section-wrapper section=ctrl.entityDiagramsSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-dynamic-section-wrapper section=ctrl.bookmarksSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> <waltz-dynamic-section-wrapper section=ctrl.changeLogSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> </div> </div>'},1141:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),r=n(19);e.default=[function(){return{buildGraphTweakers:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.default.groupBy(e,\"dataFlowId\"),i=function(t){var e=t.data.id,r=n[e]||[];return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a.default.find([\"DISCOURAGED\",\"SECONDARY\",\"PRIMARY\",\"NO_OPINION\"],function(e){return a.default.includes(t,e)})||\"NO_OPINION\"}(a.default.map(r,\"rating\"))};return{node:{enter:function(e){e.classed(\"wdfd-intra-node\",function(e){return a.default.includes(t,e.id)}).classed(\"wdfd-extra-node\",function(e){return!a.default.includes(t,e.id)}).on(\"dblclick.unfix\",function(t){t.fx=null,t.fy=null})},update:a.default.identity,exit:a.default.identity},link:{update:function(t){return t.attr(\"stroke\",function(t){var e=i(t);return(0,r.authoritativeRatingColorScale)(e)}).attr(\"fill\",function(t){var e=i(t);return(0,r.authoritativeRatingColorScale)(e).brighter()})},enter:function(t){return t.attr(\"stroke-width\",1.5)},exit:a.default.identity}}},enrichDataTypeCounts:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return a.default.chain(t).map(function(t){var n={dataType:{id:t.entityReference.id,name:e.lookup(\"dataType\",t.entityReference.id)},inbound:0,outbound:0,intra:0,total:0};return a.default.forEach(t.tallies,function(t){n[a.default.lowerCase(t.id)]=t.count,n.total+=t.count}),n}).value()}}}]},1142:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var a=function(t){return t&&t.__esModule?t:{default:t}}(n(6)),r=n(7),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(234));e.default=function(){var t=a.default.module(\"waltz.logical.flow.decorator\",[]);return(0,r.registerStores)(t,[i]),t.name}},1581:function(t,e,n){\"use strict\";var a=c(n(6));n(407);var r=c(n(438)),i=c(n(1575)),o=c(n(1578)),l=c(n(1579));function c(t){return t&&t.__esModule?t:{default:t}}var s=a.default.module(\"waltz.app\",r.default);function d(t){t.aHrefSanitizationWhitelist(/^\\s*(mailto|https?|sip|chrome-extension):/)}s.config([\"$compileProvider\",function(t){t.debugInfoEnabled(!1),console.log(\"debug disabled, re-enable with:\",\"angular.reloadWithDebugInfo();\")}]),(0,i.default)(s),(0,o.default)(s),(0,l.default)(s),d.$inject=[\"$compileProvider\"],s.config(d),s.run([\"UserAgentInfoStore\",function(t){return t.save()}])},230:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.InvolvementStore_API=void 0;var a=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),r=n(8);function i(t,e){var n=e+\"/involvement\";return{findAppsForEmployeeId:function(e){return t.get(n+\"/employee/\"+e+\"/applications\").then(function(t){return t.data})},findEndUserAppsByIdSelector:function(e){return t.post(n+\"/end-user-application\",e).then(function(t){return t.data})},findByEmployeeId:function(e){return t.get(n+\"/employee/\"+e).then(function(t){return t.data})},findByEntityReference:function(e,r){var i=a.default.isObject(e)?e:{id:r,kind:e};return t.get(n+\"/entity/\"+i.kind+\"/\"+i.id).then(function(t){return t.data})},findPeopleByEntityReference:function(e,r){var i=a.default.isObject(e)?e:{id:r,kind:e};return t.get(n+\"/entity/\"+i.kind+\"/\"+i.id+\"/people\").then(function(t){return t.data})},changeInvolvement:function(e,a){return(0,r.checkIsEntityInvolvementChangeCommand)(a),t.post(n+\"/entity/\"+e.kind+\"/\"+e.id,a).then(function(t){return t.data})}}}i.$inject=[\"$http\",\"BaseApiUrl\"];var o=\"InvolvementStore\";e.InvolvementStore_API={findAppsForEmployeeId:{serviceName:o,serviceFnName:\"findAppsForEmployeeId\",description:\"finds apps by employee id\"},findEndUserAppsByIdSelector:{serviceName:o,serviceFnName:\"findEndUserAppsByIdSelector\",description:\"finds end user apps by app id selector\"},findByEmployeeId:{serviceName:o,serviceFnName:\"findByEmployeeId\",description:\"find involvements by employee id\"},findByEntityReference:{serviceName:o,serviceFnName:\"findByEntityReference\",description:\"find involvements by entity reference\"},findPeopleByEntityReference:{serviceName:o,serviceFnName:\"findPeopleByEntityReference\",description:\"find people by involved entity reference\"},changeInvolvement:{serviceName:o,serviceFnName:\"changeInvolvement\",description:\"change person involvement for a given entity reference\"}};e.default={store:i,serviceName:o}},231:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.InvolvementKindStore_API=e.serviceName=void 0,e.store=r;var a=n(8);function r(t,e){var n=e+\"/involvement-kind\";return{findAll:function(){return t.get(n).then(function(t){return t.data})},getById:function(e){return t.get(n+\"/id/\"+e).then(function(t){return t.data})},create:function(e){return(0,a.checkIsCreateInvolvementKindCommand)(e),t.post(n+\"/update\",e).then(function(t){return t.data})},update:function(e){return t.put(n+\"/update\",e).then(function(t){return t.data})},deleteById:function(e){return t.delete(n+\"/\"+e).then(function(t){return t.data})}}}r.$inject=[\"$http\",\"BaseApiUrl\"];var i=e.serviceName=\"InvolvementKindStore\";e.InvolvementKindStore_API={findAll:{serviceName:i,serviceFnName:\"findAll\",description:\"executes findAll\"},getById:{serviceName:i,serviceFnName:\"getById\",description:\"executes getById\"},create:{serviceName:i,serviceFnName:\"create\",description:\"executes create\"},update:{serviceName:i,serviceFnName:\"update\",description:\"executes update\"},deleteById:{serviceName:i,serviceFnName:\"deleteById\",description:\"executes deleteById\"}}},232:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LogicalDataElementStore_API=e.serviceName=void 0,e.store=r;var a=n(8);function r(t,e){var n=e+\"/logical-data-element\";return{getById:function(e){return t.get(n+\"/id/\"+e).then(function(t){return t.data})},getByExternalId:function(e){return t.get(n+\"/external-id/\"+e).then(function(t){return t.data})},findAll:function(e){return t.get(n+\"/all\").then(function(t){return t.data})},findBySelector:function(e){return(0,a.checkIsIdSelector)(e),t.post(n+\"/selector\",e).then(function(t){return t.data})}}}r.$inject=[\"$http\",\"BaseApiUrl\"];var i=e.serviceName=\"LogicalDataElementStore\";e.LogicalDataElementStore_API={getById:{serviceName:i,serviceFnName:\"getById\",description:\"executes getById\"},getByExternalId:{serviceName:i,serviceFnName:\"getByExternalId\",description:\"executes getByExternalId\"},findAll:{serviceName:i,serviceFnName:\"findAll\",description:\"executes findAll\"},findBySelector:{serviceName:i,serviceFnName:\"findBySelector\",description:\"executes findBySelector\"}}},233:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LogicalFlowStore_API=void 0,e.store=i;var a=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),r=n(8);function i(t,e){var n=e+\"/logical-flow\";return{findBySelector:function(e){return(0,r.checkIsIdSelector)(e),t.post(n+\"/selector\",e).then(function(t){return t.data})},findByEntityReference:function(e,i){var o=a.default.isObject(e)?e:{kind:e,id:i};return(0,r.checkIsEntityRef)(o),t.get(n+\"/entity/\"+o.kind+\"/\"+o.id).then(function(t){return t.data})},findBySourceAndTargetEntityReferences:function(e){return t.post(n+\"/source-targets\",e).then(function(t){return t.data})},findUpstreamFlowsForEntityReferences:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.post(n+\"/find-upstream-flows\",e).then(function(t){return t.data})},calculateStats:function(e){return(0,r.checkIsIdSelector)(e),t.post(n+\"/stats\",e).then(function(t){return t.data})},countByDataType:function(){return t.get(n+\"/count-by/data-type\").then(function(t){return t.data})},removeFlow:function(e){return t.delete(n+\"/\"+e).then(function(t){return t.data})},getById:function(e){return t.get(n+\"/\"+e).then(function(t){return t.data})},addFlow:function(e){return t.post(\"\"+n,e).then(function(t){return t.data})},addFlows:function(e){return t.post(n+\"/list\",e).then(function(t){return t.data})},cleanupOrphans:function(){return t.get(n+\"/cleanup-orphans\").then(function(t){return t.data})},cleanupSelfReferences:function(){return t.get(n+\"/cleanup-self-references\").then(function(t){return t.data})}}}i.$inject=[\"$http\",\"BaseApiUrl\"];var o=\"LogicalFlowStore\";e.default={serviceName:o,store:i};e.LogicalFlowStore_API={findBySelector:{serviceName:o,serviceFnName:\"findBySelector\",description:\"find logical flows for a selector\"},findByEntityReference:{serviceName:o,serviceFnName:\"findByEntityReference\",description:\"find logical flows involving a given entity\"},findBySourceAndTargetEntityReferences:{serviceName:o,serviceFnName:\"findBySourceAndTargetEntityReferences\",description:\"find logical flows for the source and target entity references\"},findUpstreamFlowsForEntityReferences:{serviceName:o,serviceFnName:\"findUpstreamFlowsForEntityReferences\",description:\"findUpstreamFlowsForEntityReferences - given a list of entity reference returns all flows feeding any of those apps\"},calculateStats:{serviceName:o,serviceFnName:\"calculateStats\",description:\"calculate statistics for flows\"},countByDataType:{serviceName:o,serviceFnName:\"countByDataType\",description:\"summarizes flows by their data types\"},removeFlow:{serviceName:o,serviceFnName:\"removeFlow\",description:\"removes a single logical flow\"},getById:{serviceName:o,serviceFnName:\"getById\",description:\"retrieve a single logical flow (or null) given an id\"},addFlow:{serviceName:o,serviceFnName:\"addFlow\",description:\"adds a single logical flow\"},addFlows:{serviceName:o,serviceFnName:\"addFlows\",description:\"adds a list of logical flows\"},cleanupOrphans:{serviceName:o,serviceFnName:\"cleanupOrphans\",description:\"mark flows as removed if either endpoint is missing\"},cleanupSelfReferences:{serviceName:o,serviceFnName:\"cleanupSelfReferences\",description:\"mark flows as removed where the flow source and target are the same\"}}},234:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.LogicalFlowDecoratorStore_API=e.serviceName=void 0,e.store=r;var a=n(8);function r(t,e){var n=e+\"/logical-flow-decorator\";return{findBySelectorAndKind:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"DATA_TYPE\";return(0,a.checkIsApplicationIdSelector)(e),t.post(n+\"/selector/kind/\"+r,e).then(function(t){return t.data})},findBySelector:function(e){return(0,a.checkIsIdSelector)(e),t.post(n+\"/selector\",e).then(function(t){return t.data})},findByFlowIdsAndKind:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"DATA_TYPE\";return t.post(n+\"/flow-ids/kind/\"+a,e).then(function(t){return t.data})},updateDecorators:function(e){return t.post(n+\"/\"+e.flowId,e).then(function(t){return t.data})},updateDecoratorsBatch:function(e){return t.post(n+\"/batch\",e)},summarizeInboundBySelector:function(e){return(0,a.checkIsApplicationIdSelector)(e),t.post(n+\"/summarize-inbound\",e).then(function(t){return t.data})},summarizeOutboundBySelector:function(e){return(0,a.checkIsApplicationIdSelector)(e),t.post(n+\"/summarize-outbound\",e).then(function(t){return t.data})},summarizeInboundForAll:function(){return t.get(n+\"/summarize-inbound\").then(function(t){return t.data})}}}r.$inject=[\"$http\",\"BaseApiUrl\"];var i=e.serviceName=\"LogicalFlowDecoratorStore\";e.LogicalFlowDecoratorStore_API={findBySelectorAndKind:{serviceName:i,serviceFnName:\"findBySelectorAndKind\",description:\"executes findBySelectorAndKind\"},findBySelector:{serviceName:i,serviceFnName:\"findBySelector\",description:\"executes findBySelector\"},findByFlowIdsAndKind:{serviceName:i,serviceFnName:\"findByFlowIdsAndKind\",description:\"executes findByFlowIdsAndKind - arg1: [flowIds], arg2: decoratorKind\"},updateDecorators:{serviceName:i,serviceFnName:\"updateDecorators\",description:\"executes updateDecorators\"},updateDecoratorsBatch:{serviceName:i,serviceFnName:\"updateDecoratorsBatch\",description:\"executes updateDecoratorsBatch\"},summarizeInboundBySelector:{serviceName:i,serviceFnName:\"summarizeInboundBySelector\",description:\"executes summarizeInboundBySelector - arg1: app_selector\"},summarizeOutboundBySelector:{serviceName:i,serviceFnName:\"summarizeOutboundBySelector\",description:\"executes summarizeOutboundBySelector - arg1: app_selector\"},summarizeInboundForAll:{serviceName:i,serviceFnName:\"summarizeInboundForAll\",description:\"executes summarizeForAll (no args)\"}}},394:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.aggregatePeopleInvolvements=function(t,e){var n=a.default.chain(t).groupBy(\"employeeId\").mapValues(function(t){return a.default.map(t,function(t){return{kindId:t.kindId,provenance:t.provenance}})}).value();return a.default.chain(e).map(function(t){return{person:t,involvements:n[t.employeeId]}}).uniqBy(function(t){return t.person.id}).value()},e.mkChangeCommand=function(t,e,n){return{operation:t,personEntityRef:e,involvementKindId:n}};var a=function(t){return t&&t.__esModule?t:{default:t}}(n(1))},395:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.mkTweakers=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=function(t){return t.kind+\"/\"+t.id},o=a.keyBy(n,\"id\"),l=function(t){return a.countBy(e,function(e){var n=o[e.logicalFlowId];return n?r(n[t]):null})},c=l(\"source\"),s=l(\"target\");return t.source.icon=function(t){return i(c[r(t)])},t.target.icon=function(t){return i(s[r(t)])},Object.assign({},t)};var a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1));var r={files:\"\",file:\"\",question:\"\",questionCircle:\"\",folder:\"\"};function i(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0){case 0:return{code:r.questionCircle,description:\"No physical files specified\",color:\"#c66\"};case 1:return{code:r.file,description:\"One linked physical files\",color:\"#000\"};case 2:return{code:r.files,description:\"Two linked physical files\",color:\"#000\"};default:return{code:r.folder,description:\"Several linked physical files\",color:\"#000\"}}}}}]);","extractedComments":[]}