{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{199:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ActorStore_API=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+\"/actor\";return{findAll:function(){return t.get(n).then(function(t){return t.data})},getById:function(e){return t.get(n+\"/id/\"+e).then(function(t){return t.data})},create:function(e){return(0,i.checkIsCreateActorCommand)(e),t.post(n+\"/update\",e).then(function(t){return t.data})},update:function(e){return t.put(n+\"/update\",e).then(function(t){return t.data})},deleteById:function(e){return t.delete(n+\"/\"+e).then(function(t){return t.data})},search:function(e){return t.get(n+\"/search/\"+e).then(function(t){return t.data||[]})}}}a.$inject=[\"$http\",\"BaseApiUrl\"];e.default={serviceName:\"ActorStore\",store:a};e.ActorStore_API={findAll:{serviceName:\"ActorStore\",serviceFnName:\"findAll\",description:\"executes findAll\"},getById:{serviceName:\"ActorStore\",serviceFnName:\"getById\",description:\"executes getById\"},create:{serviceName:\"ActorStore\",serviceFnName:\"create\",description:\"executes create\"},update:{serviceName:\"ActorStore\",serviceFnName:\"update\",description:\"executes update\"},deleteById:{serviceName:\"ActorStore\",serviceFnName:\"deleteById\",description:\"executes deleteById\"},search:{serviceName:\"ActorStore\",serviceFnName:\"search\",description:\"executes search\"}}},200:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AliasStore_API=e.serviceName=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+\"/entity/alias\";return{update:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,i.checkIsEntityRef)(e),(0,i.checkIsStringList)(a),t.post(n+\"/\"+e.kind+\"/\"+e.id,a).then(function(t){return t.data})},getForEntity:function(e){return(0,i.checkIsEntityRef)(e),t.get(n+\"/\"+e.kind+\"/\"+e.id).then(function(t){return t.data})}}}a.$inject=[\"$http\",\"BaseApiUrl\"];var r=e.serviceName=\"AliasStore\";e.AliasStore_API={update:{serviceName:r,serviceFnName:\"update\",description:\"executes update\"},getForEntity:{serviceName:r,serviceFnName:\"getForEntity\",description:\"executes getForEntity\"}}},201:function(t,e,n){\"use strict\";function i(t,e){var n=e+\"/app-group\";return{findMyGroupSubscriptions:function(e){return t.get(n+\"/my-group-subscriptions\").then(function(t){return t.data})},getById:function(e){return t.get(n+\"/id/\"+e+\"/detail\").then(function(t){return t.data})},findByIds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.post(n+\"/id\",e).then(function(t){return t.data})},findPublicGroups:function(e){return t.get(n+\"/public\").then(function(t){return t.data})},findPrivateGroups:function(){return t.get(n+\"/private\").then(function(t){return t.data})},findRelatedByEntityRef:function(e){return t.get(n+\"/related/\"+e.kind+\"/\"+e.id).then(function(t){return t.data})},subscribe:function(e){return t.post(n+\"/id/\"+e+\"/subscribe\",{}).then(function(t){return t.data})},unsubscribe:function(e){return t.post(n+\"/id/\"+e+\"/unsubscribe\",{}).then(function(t){return t.data})},addOwner:function(e,i){return t.post(n+\"/id/\"+e+\"/members/owners\",i).then(function(t){return t.data})},removeOwner:function(e,i){return t.delete(n+\"/id/\"+e+\"/members/owners/\"+i).then(function(t){return t.data})},createNewGroup:function(){return t.post(n,{}).then(function(t){return t.data})},deleteGroup:function(e){return t.delete(n+\"/id/\"+e).then(function(t){return t.data})},updateGroupOverview:function(e,i){return t.post(n+\"/id/\"+e,i).then(function(t){return t.data})},addApplication:function(e,i){return t.post(n+\"/id/\"+e+\"/applications\",i).then(function(t){return t.data})},removeApplication:function(e,i){return t.delete(n+\"/id/\"+e+\"/applications/\"+i).then(function(t){return t.data})},addApplications:function(e,i){return t.post(n+\"/id/\"+e+\"/applications/list\",i).then(function(t){return t.data})},removeApplications:function(e,i){return t.post(n+\"/id/\"+e+\"/applications/list/remove\",i).then(function(t){return t.data})},addChangeInitiative:function(e,i){return t.post(n+\"/id/\"+e+\"/change-initiatives\",i).then(function(t){return t.data})},removeChangeInitiative:function(e,i){return t.delete(n+\"/id/\"+e+\"/change-initiatives/\"+i).then(function(t){return t.data})},search:function(e){return t.get(n+\"/search/\"+e).then(function(t){return t.data})}}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.store=i,i.$inject=[\"$http\",\"BaseApiUrl\"];var a=e.serviceName=\"AppGroupStore\";e.AppGroupStore_API={findMyGroupSubscriptions:{serviceName:a,serviceFnName:\"findMyGroupSubscriptions\",description:\"executes findMyGroupSubscriptions\"},findRelatedByEntityRef:{serviceName:a,serviceFnName:\"findRelatedByEntityRef\",description:\"executes findRelatedByEntityRef\"},getById:{serviceName:a,serviceFnName:\"getById\",description:\"executes getById\"},findByIds:{serviceName:a,serviceFnName:\"findByIds\",description:\"executes findByIds\"},findPublicGroups:{serviceName:a,serviceFnName:\"findPublicGroups\",description:\"executes findPublicGroups\"},findPrivateGroups:{serviceName:a,serviceFnName:\"findPrivateGroups\",description:\"executes findPrivateGroups\"},subscribe:{serviceName:a,serviceFnName:\"subscribe\",description:\"executes subscribe (params: id)\"},unsubscribe:{serviceName:a,serviceFnName:\"unsubscribe\",description:\"executes unsubscribe (params: id)\"},addOwner:{serviceName:a,serviceFnName:\"addOwner\",description:\"executes addOwner\"},removeOwner:{serviceName:a,serviceFnName:\"removeOwner\",description:\"executes removeOwner\"},createNewGroup:{serviceName:a,serviceFnName:\"createNewGroup\",description:\"executes createNewGroup\"},deleteGroup:{serviceName:a,serviceFnName:\"deleteGroup\",description:\"executes deleteGroup\"},updateGroupOverview:{serviceName:a,serviceFnName:\"updateGroupOverview\",description:\"executes updateGroupOverview\"},addApplication:{serviceName:a,serviceFnName:\"addApplication\",description:\"executes addApplication\"},removeApplication:{serviceName:a,serviceFnName:\"removeApplication\",description:\"executes removeApplication\"},addApplications:{serviceName:a,serviceFnName:\"addApplications\",description:\"executes addApplications\"},removeApplications:{serviceName:a,serviceFnName:\"removeApplications\",description:\"executes removeApplications\"},addChangeInitiative:{serviceName:a,serviceFnName:\"addChangeInitiative\",description:\"executes addChangeInitiative\"},removeChangeInitiative:{serviceName:a,serviceFnName:\"removeChangeInitiative\",description:\"executes removeChangeInitiative\"},search:{serviceName:a,serviceFnName:\"search\",description:\"find app groups for the given search terms\"}}},202:function(t,e,n){\"use strict\";function i(t,e){var n=e+\"/app\";return{getById:function(e){return t.get(n+\"/id/\"+e).then(function(t){return t.data})},getAppTagsById:function(e){return t.get(n+\"/id/\"+e+\"/tags\").then(function(t){return t.data})},findRelatedById:function(e){return t.get(n+\"/id/\"+e+\"/related\").then(function(t){return t.data})},findByIds:function(e){return t.post(n+\"/by-ids\",e).then(function(t){return t.data})},findAll:function(e){return t.get(n+\"/all\").then(function(t){return t.data})},findBySelector:function(e){return t.post(n+\"/selector\",e).then(function(t){return t.data})},findByAssetCode:function(e){return t.get(n+\"/asset-code/\"+e).then(function(t){return t.data})},countByOrganisationalUnit:function(){return t.get(n+\"/count-by/org-unit\").then(function(t){return t.data})},registerNewApp:function(e){return t.post(n,e).then(function(t){return t.data})},search:function(e){return t.get(n+\"/search/\"+e).then(function(t){return t.data})},update:function(e,i){return t.post(n+\"/\"+e,i).then(function(t){return t.data})}}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.store=i,i.$inject=[\"$http\",\"BaseApiUrl\"];var a=e.serviceName=\"ApplicationStore\";e.ApplicationStore_API={getById:{serviceName:a,serviceFnName:\"getById\",description:\"retrieve a single app (or null) given an id\"},getAppTagsById:{serviceName:a,serviceFnName:\"getAppTagsById\",description:\"find tags for the given app\"},findRelatedById:{serviceName:a,serviceFnName:\"findRelatedById\",description:\"find related apps for the given app id\"},findByIds:{serviceName:a,serviceFnName:\"findByIds\",description:\"find apps for the given list of app ids\"},findAll:{serviceName:a,serviceFnName:\"findAll\",description:\"find all apps\"},findBySelector:{serviceName:a,serviceFnName:\"findBySelector\",description:\"find apps for the given selector options\"},findByAssetCode:{serviceName:a,serviceFnName:\"findByAssetCode\",description:\"executes findByAssetCode\"},countByOrganisationalUnit:{serviceName:a,serviceFnName:\"countByOrganisationalUnit\",description:\"returns number of apps in the given ou\"},registerNewApp:{serviceName:a,serviceFnName:\"registerNewApp\",description:\"registers a new application\"},search:{serviceName:a,serviceFnName:\"search\",description:\"find apps for the given search terms\"},update:{serviceName:a,serviceFnName:\"update\",description:\"updates an application\"}}},203:function(t,e,n){\"use strict\";function i(t,e){var n=e+\"/assessment-definition\";return{getById:function(e){return t.get(n+\"/id/\"+e).then(function(t){return t.data})},findAll:function(){return t.get(n).then(function(t){return t.data})},findByKind:function(e){return t.get(n+\"/kind/\"+e).then(function(t){return t.data})}}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.store=i,i.$inject=[\"$http\",\"BaseApiUrl\"];var a=e.serviceName=\"AssessmentDefinitionStore\";e.AssessmentDefinitionStore_API={getById:{serviceName:a,serviceFnName:\"getById\",description:\"retrieve a single definition (or null) given an id\"},findAll:{serviceName:a,serviceFnName:\"findAll\",description:\"find all assessment definitions\"},findByKind:{serviceName:a,serviceFnName:\"findByKind\",description:\"find all assessment definitions for an entity kind \"}}},204:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AssessmentRatingStore_API=e.serviceName=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+\"/assessment-rating\";return{findForEntityReference:function(e){return(0,i.checkIsEntityRef)(e),t.get(n+\"/entity/\"+e.kind+\"/\"+e.id).then(function(t){return t.data})},create:function(e,a,r){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,i.checkIsEntityRef)(e),t.post(n+\"/entity/\"+e.kind+\"/\"+e.id+\"/\"+a,{ratingId:r,description:l}).then(function(t){return t.data})},update:function(e,a,r){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,i.checkIsEntityRef)(e),t.put(n+\"/entity/\"+e.kind+\"/\"+e.id+\"/\"+a,{ratingId:r,description:l}).then(function(t){return t.data})},remove:function(e,a){return(0,i.checkIsEntityRef)(e),t.delete(n+\"/entity/\"+e.kind+\"/\"+e.id+\"/\"+a).then(function(t){return t.data})}}}a.$inject=[\"$http\",\"BaseApiUrl\"];var r=e.serviceName=\"AssessmentRatingStore\";e.AssessmentRatingStore_API={findForEntityReference:{serviceName:r,serviceFnName:\"findForEntityReference\",description:\"find all assessment ratings for an entity\"},create:{serviceName:r,serviceFnName:\"create\",description:\"create a rating\"},update:{serviceName:r,serviceFnName:\"update\",description:\"update a rating\"},remove:{serviceName:r,serviceFnName:\"remove\",description:\"remove a rating\"}}},205:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AttestationInstanceStore_API=e.serviceName=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+\"/attestation-instance\";return{attestInstance:function(e){return t.post(n+\"/attest/\"+e)},findByRunId:function(e){return t.get(n+\"/run/\"+e).then(function(t){return t.data})},findByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?\"all\":\"unattested\";return t.get(n+\"/\"+e+\"/user\").then(function(t){return t.data})},findHistoricalForPendingByUser:function(){return t.get(n+\"/historical/user\").then(function(t){return t.data})},findPersonsById:function(e){return t.get(n+\"/\"+e+\"/person\").then(function(t){return t.data})},findByEntityRef:function(e){return(0,i.checkIsEntityRef)(e),t.get(n+\"/entity/\"+e.kind+\"/\"+e.id).then(function(t){return t.data})},cleanupOrphans:function(){return t.get(n+\"/cleanup-orphans\").then(function(t){return t.data})}}}a.$inject=[\"$http\",\"BaseApiUrl\"];var r=e.serviceName=\"AttestationInstanceStore\";e.AttestationInstanceStore_API={attestInstance:{serviceName:r,serviceFnName:\"attestInstance\",description:\"create an attestation\"},findByRunId:{serviceName:r,serviceFnName:\"findByRunId\",description:\"find attestations by a run id\"},findByUser:{serviceName:r,serviceFnName:\"findByUser\",description:\"find attestations for a user\"},findHistoricalForPendingByUser:{serviceName:r,serviceFnName:\"findHistoricalForPendingByUser\",description:\"find historical attestations for pending attestations for which this user has to attest\"},findPersonsById:{serviceName:r,serviceFnName:\"findPersonsById\",description:\"find recipients (person) for an instance\"},findByEntityRef:{serviceName:r,serviceFnName:\"findByEntityRef\",description:\"find instances for an entity\"},cleanupOrphans:{serviceName:r,serviceFnName:\"cleanupOrphans\",description:\"clean up orphan attestations and recipients for applications that no longer exist\"}}},206:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AttestationRunStore_API=void 0;var i=n(8);function a(t,e){var n=e+\"/attestation-run\";return{getCreateSummary:function(e){return t.post(n+\"/create-summary\",e).then(function(t){return t.data})},create:function(e){return t.post(n,e).then(function(t){return t.data})},getById:function(e){return t.get(n+\"/id/\"+e).then(function(t){return t.data})},findAll:function(){return t.get(\"\"+n).then(function(t){return t.data})},findByRecipient:function(){return t.get(n+\"/user\").then(function(t){return t.data})},findResponseSummaries:function(){return t.get(n+\"/summary/response\").then(function(t){return t.data})},findByEntityRef:function(e){return(0,i.checkIsEntityRef)(e),t.get(n+\"/entity/\"+e.kind+\"/\"+e.id).then(function(t){return t.data})}}}a.$inject=[\"$http\",\"BaseApiUrl\"];var r=\"AttestationRunStore\";e.AttestationRunStore_API={getCreateSummary:{serviceName:r,serviceFnName:\"getCreateSummary\",description:\"get create summary when creating an attestation run\"},create:{serviceName:r,serviceFnName:\"create\",description:\"create an attestation run\"},getById:{serviceName:r,serviceFnName:\"getById\",description:\"attestation run by id\"},findAll:{serviceName:r,serviceFnName:\"findAll\",description:\"all attestation runs\"},findByRecipient:{serviceName:r,serviceFnName:\"findByRecipient\",description:\"attestation runs for recipient\"},findResponseSummaries:{serviceName:r,serviceFnName:\"findResponseSummaries\",description:\"attestation run response summaries\"},findByEntityRef:{serviceName:r,serviceFnName:\"findByEntityRef\",description:\"find runs for an entity\"}};e.default={serviceName:r,store:a}},207:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AssetCostStore_API=e.serviceName=void 0,e.store=a;var i=n(8);function a(t,e){var n=e+\"/asset-cost\";return{findByCode:function(e){return t.get(n+\"/code/\"+e).then(function(t){return t.data})},findByAppId:function(e){return t.get(n+\"/app-cost/\"+e).then(function(t){return t.data})},findAppCostsByAppIdSelector:function(e){return(0,i.checkIsIdSelector)(e),t.post(n+\"/app-cost/apps\",e).then(function(t){return t.data})},findTopAppCostsByAppIdSelector:function(e){return(0,i.checkIsIdSelector)(e),t.post(n+\"/app-cost/top-apps\",e).then(function(t){return t.data})},findTotalCostForAppSelector:function(e,a){(0,i.checkIsIdSelector)(e);var r=n+\"/app-cost/apps/total\",l=a?{params:{year:a}}:{};return t.post(r,e,l).then(function(t){return t.data})},calculateCombinedAmountsForSelector:function(e){return(0,i.checkIsIdSelector)(e),t.post(n+\"/amount/app-selector\",e).then(function(t){return t.data})}}}a.$inject=[\"$http\",\"BaseApiUrl\"];var r=e.serviceName=\"AssetCostStore\";e.AssetCostStore_API={findByCode:{serviceName:r,serviceFnName:\"findByCode\",description:\"executes findByCode\"},findByAppId:{serviceName:r,serviceFnName:\"findByAppId\",description:\"executes findByAppId\"},findAppCostsByAppIdSelector:{serviceName:r,serviceFnName:\"findAppCostsByAppIdSelector\",description:\"executes findAppCostsByAppIdSelector\"},findTopAppCostsByAppIdSelector:{serviceName:r,serviceFnName:\"findTopAppCostsByAppIdSelector\",description:\"executes findTopAppCostsByAppIdSelector\"},findTotalCostForAppSelector:{serviceName:r,serviceFnName:\"findTotalCostForAppSelector\",description:\"executes findTotalCostForAppSelector\"},calculateCombinedAmountsForSelector:{serviceName:r,serviceFnName:\"calculateCombinedAmountsForSelector\",description:\"executes calculateCombinedAmountsForSelector\"}}},208:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.AuthSourcesStore_API=e.serviceName=void 0,e.store=r;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),a=n(8);function r(t,e){var n=e+\"/authoritative-source\";return{calculateConsumersForDataTypeIdSelector:function(e){return(0,a.checkIsIdSelector)(e),t.post(n+\"/data-type/consumers\",e).then(function(t){return t.data})},findByReference:function(e,a){var r=i.default.isObject(e)?e:{kind:e,id:a};return t.get(n+\"/entity-ref/\"+r.kind+\"/\"+r.id).then(function(t){return t.data})},findAll:function(e){return t.get(n).then(function(t){return t.data})},findByApp:function(e){return t.get(n+\"/app/\"+e).then(function(t){return t.data})},update:function(e){return(0,a.checkIsAuthSourceUpdateCommand)(e),t.put(n,e)},insert:function(e){return(0,a.checkIsAuthSourceCreateCommand)(e),t.post(n,e)},recalculateAll:function(){return t.get(n+\"/recalculate-flow-ratings\").then(function(t){return t.data})},remove:function(e){return t.delete(n+\"/id/\"+e)},findNonAuthSources:function(e){return(0,a.checkIsEntityRef)(e),t.get(n+\"/non-auth-for/\"+e.kind+\"/\"+e.id).then(function(t){return t.data})},findAuthSources:function(e){return(0,a.checkIsEntityRef)(e),t.get(n+\"/auth-for/\"+e.kind+\"/\"+e.id).then(function(t){return t.data})},cleanupOrphans:function(){return t.get(n+\"/cleanup-orphans\").then(function(t){return t.data})}}}r.$inject=[\"$http\",\"BaseApiUrl\"];var l=e.serviceName=\"AuthSourcesStore\";e.AuthSourcesStore_API={calculateConsumersForDataTypeIdSelector:{serviceName:l,serviceFnName:\"calculateConsumersForDataTypeIdSelector\",description:\"calculateConsumersForDataTypeIdSelector\"},findByReference:{serviceName:l,serviceFnName:\"findByReference\",description:\"findByReference\"},findAll:{serviceName:l,serviceFnName:\"findAll\",description:\"findAll\"},findByApp:{serviceName:l,serviceFnName:\"findByApp\",description:\"findByApp\"},update:{serviceName:l,serviceFnName:\"update\",description:\"update\"},insert:{serviceName:l,serviceFnName:\"insert\",description:\"insert\"},recalculateAll:{serviceName:l,serviceFnName:\"recalculateAll\",description:\"recalculateAll\"},remove:{serviceName:l,serviceFnName:\"remove\",description:\"remove\"},findNonAuthSources:{serviceName:l,serviceFnName:\"findNonAuthSources\",description:\"findNonAuthSources\"},findAuthSources:{serviceName:l,serviceFnName:\"findAuthSources\",description:\"findAuthSources (entityRef)\"},cleanupOrphans:{serviceName:l,serviceFnName:\"cleanupOrphans\",description:\"cleanupOrphans\"}}},209:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.BookmarkStore_API=void 0;var i=n(8);function a(t,e){var n=e+\"/bookmarks\";return{save:function(e){return t.post(n,e)},findByParent:function(e){return(0,i.checkIsEntityRef)(e),t.get(n+\"/\"+e.kind+\"/\"+e.id).then(function(t){return t.data})},remove:function(e){return t.delete(n+\"/\"+e)}}}a.$inject=[\"$http\",\"BaseApiUrl\"];e.BookmarkStore_API={save:{serviceName:\"BookmarkStore\",serviceFnName:\"save\",description:\"save a bookmark\"},findByParent:{serviceName:\"BookmarkStore\",serviceFnName:\"findByParent\",description:\"find by parent entity reference\"},remove:{serviceName:\"BookmarkStore\",serviceFnName:\"remove\",description:\"remove a bookmark\"}};e.default={serviceName:\"BookmarkStore\",store:a}},210:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ChangeInitiativeStore_API=void 0;var i=n(8);function a(t,e){var n=e+\"/change-initiative\";return{findBySelector:function(e){return(0,i.checkIsIdSelector)(e),t.post(n+\"/selector\",e).then(function(t){return t.data})},findHierarchyBySelector:function(e){return(0,i.checkIsIdSelector)(e),t.post(n+\"/hierarchy/selector\",e).then(function(t){return t.data})},findRelatedForId:function(e){return t.get(n+\"/id/\"+e+\"/related\").then(function(t){return t.data})},getById:function(e){return t.get(n+\"/id/\"+e).then(function(t){return t.data})},search:function(e){return t.get(n+\"/search/\"+e).then(function(t){return t.data})},changeRelationship:function(e,a){return(0,i.checkIsEntityRelationshipChangeCommand)(a),t.post(n+\"/id/\"+e+\"/entity-relationship\",a).then(function(t){return t.data})}}}a.$inject=[\"$http\",\"BaseApiUrl\"];var r=\"ChangeInitiativeStore\";e.ChangeInitiativeStore_API={findBySelector:{serviceName:r,serviceFnName:\"findBySelector\",description:\"finds change initiatives by id selector\"},findHierarchyBySelector:{serviceName:r,serviceFnName:\"findHierarchyBySelector\",description:\"finds change initiatives (and parents) by id selector\"},getById:{serviceName:r,serviceFnName:\"getById\",description:\"get a change initiative by id\"},findRelatedForId:{serviceName:r,serviceFnName:\"findRelatedForId\",description:\"find related change initiatives related to one with supplied id\"},search:{serviceName:r,serviceFnName:\"search\",description:\"search change initiatives\"},changeRelationship:{serviceName:r,serviceFnName:\"changeRelationship\",description:\"change relationship between a change initiative and entity reference\"}};e.default={store:a,serviceName:r}},211:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.ChangeLogStore_API=void 0;var i=n(8);function a(t,e){var n=e+\"/change-log\";return{findByEntityReference:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return(0,i.checkIsEntityRef)(e),t.get(n+\"/\"+e.kind+\"/\"+e.id,{params:{limit:a}}).then(function(t){return t.data})},findForUserName:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.get(n+\"/user/\"+e,{params:{limit:i}}).then(function(t){return t.data})}}}a.$inject=[\"$http\",\"BaseApiUrl\"];e.ChangeLogStore_API={findByEntityReference:{serviceName:\"ChangeLogStore\",serviceFnName:\"findByEntityReference\",description:\"finds change log entries for a given entity reference and limit (default: 30)\"},findForUserName:{serviceName:\"ChangeLogStore\",serviceFnName:\"findForUserName\",description:\"finds change log entries for a given user name and limit (default: no limit)\"}};e.default={store:a,serviceName:\"ChangeLogStore\"}},263:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.businessCriticalityField=e.overallRatingField=e.lifecyclePhaseField=e.typeField=e.orgUnitField=e.descriptionField=e.parentAssetCodeField=e.assetCodeField=e.nameField=void 0;var i=n(107),a=n(108),r=n(88),l=n(29),o=(e.nameField={type:\"input\",key:\"name\",templateOptions:{label:\"Name\",placeholder:\"Name of application or service\",required:!0}},e.assetCodeField={type:\"input\",key:\"assetCode\",templateOptions:{label:\"Asset Code\",placeholder:\"Asset code associated with application\"}},e.parentAssetCodeField={type:\"input\",key:\"parentAssetCode\",templateOptions:{label:\"Parent Asset Code\",placeholder:\"Optional parent code\"}},e.descriptionField={type:\"textarea\",key:\"description\",templateOptions:{label:\"Description\",rows:13,placeholder:\"Name of application or service\"}},e.orgUnitField={key:\"organisationalUnitId\",type:\"org-unit-input\",formControl:{$dirty:!1},templateOptions:{label:\"Owning Organisational Unit\",onSelect:function(t){o.model[o.key]=t.id,o.formControl={$dirty:!0}}}});e.typeField={type:\"select\",key:\"applicationKind\",templateOptions:{valueProp:\"code\",labelProp:\"name\",options:(0,l.toOptions)(i.applicationKind),label:\"Type\",placeholder:\"Type of application\",required:!0}},e.lifecyclePhaseField={type:\"select\",key:\"lifecyclePhase\",templateOptions:{valueProp:\"code\",labelProp:\"name\",options:(0,l.toOptions)(r.lifecyclePhase),label:\"Current Lifecycle Phase\",placeholder:\"\",required:!0}},e.overallRatingField={type:\"select\",key:\"overallRating\",templateOptions:{valueProp:\"code\",labelProp:\"name\",options:[{code:\"A\",name:\"Invest\"},{code:\"G\",name:\"Hold\"},{code:\"R\",name:\"Disinvest\"},{code:\"Z\",name:\"Unknown\"}],label:\"Overall Rating\",placeholder:\"\",required:!0}},e.businessCriticalityField={type:\"select\",key:\"businessCriticality\",templateOptions:{valueProp:\"code\",labelProp:\"name\",options:(0,l.toOptions)(a.criticality),label:\"Business Criticality\",placeholder:\"\",required:!0}}},269:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.mapToDisplayNames=function(t){return{kindDisplay:(0,o.getEnumName)(i.applicationKind,t.applicationKind),overallRatingDisplay:(0,o.getEnumName)(r.investmentRating,t.overallRating),businessCriticalityDisplay:(0,o.getEnumName)(a.criticality,t.businessCriticality),riskRatingDisplay:(0,o.getEnumName)(a.criticality,t.riskRating),lifecyclePhaseDisplay:(0,o.getEnumName)(l.lifecyclePhase,t.lifecyclePhase)}};var i=n(107),a=n(108),r=n(266),l=n(88),o=n(29)},270:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.mkEnrichedAssessmentDefinitions=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=(0,a.indexRatingSchemes)(e),l=i.default.keyBy(n,\"assessmentDefinitionId\");return i.default.chain(t).map(function(t){var e=i.default.get(r,\"[\"+t.ratingSchemeId+\"]\"),n=i.default.get(l,\"[\"+t.id+\"]\",null),a=null!=n?i.default.get(e,\"ratingsById[\"+n.ratingId+\"]\"):null,o=i.default.map(e.ratings,function(t){return Object.assign({},{name:t.name,code:t.id,position:t.position})});return Object.assign({},t,{rating:n,ratingItem:a,dropdownEntries:o})}).orderBy(\"name\").value()};var i=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),a=n(73)},666:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=l(n(6)),a=l(n(667)),r=n(7);function l(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module(\"waltz.access-log\",[]);return(0,r.registerStores)(t,[a.default]),t.name}},667:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(1));function a(t,e){var n=e+\"/access-log\";return{findActiveUsers:function(e){return t.get(n+\"/active/\"+e).then(function(t){return t.data})},findForUserName:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.get(n+\"/user/\"+e,{params:{limit:i}}).then(function(t){return t.data})},write:function(e,a){var r=i.default.isObject(a)?JSON.stringify(a):a;return t.post(n+\"/\"+e+\"/\"+r,null).then(function(t){return t.data})}}}a.$inject=[\"$http\",\"BaseApiUrl\"],e.default={store:a,serviceName:\"AccessLogStore\"}},668:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(7),a=d(n(669)),r=d(n(199)),l=d(n(671)),o=d(n(674)),s=d(n(675)),c=d(n(677));function d(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=angular.module(\"waltz.actor\",[]);return t.config(l.default).service(\"ActorService\",o.default),(0,i.registerComponents)(t,[a.default]),(0,i.registerStores)(t,[r.default]),t.component(\"waltzActorSelector\",s.default).component(\"waltzBasicActorSelector\",c.default),t.name}},669:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(n(670));var r={};function l(){var t=(0,i.initialiseData)(this,r);t.$onChanges=function(e){t.actor&&(t.entityRef={kind:\"ACTOR\",id:t.actor.id})}}l.$inject=[],e.default={component:{template:a.default,bindings:{actor:\"<\"},controller:l},id:\"waltzActorOverview\"}},670:function(t,e){t.exports=\"<div> <div class=row> <div class=col-sm-2> <label> Name </label> </div> <div class=col-sm-6> <span ng-bind=$ctrl.actor.name> </span> </div> </div> <div class=row> <div class=col-sm-2> <label> Description </label> </div> <div class=col-sm-10> <span ng-bind=$ctrl.actor.description> </span> </div> </div> </div>\"},671:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i={},a={url:\"actor/{id:int}\",views:{\"content@\":function(t){return t&&t.__esModule?t:{default:t}}(n(672)).default}};function r(t){t.state(\"main.actor\",i).state(\"main.actor.view\",a)}r.$inject=[\"$stateProvider\"],e.default=r},672:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(n(673)),r=n(2);var l={sections:[],availableSections:[],logs:[]};function o(t,e,n,a){var o=(0,i.initialiseData)(this,l),s=t.id;o.entityRef={kind:\"ACTOR\",id:s},o.$onInit=function(){o.availableSections=e.findAvailableSectionsForKind(\"ACTOR\"),o.sections=e.findUserSectionsForKind(\"ACTOR\"),n.loadViewData(r.CORE_API.ActorStore.getById,[s]).then(function(t){o.actor=t.data,o.entityRef=Object.assign({},o.entityRef,{name:o.actor.name}),function(t,e){if(e){var n=function(t){return{name:t.name,kind:\"ACTOR\",state:\"main.actor.view\",stateParams:{id:t.id}}}(e);t.put(n.name,n.kind,n.state,n.stateParams)}}(a,o.actor)})},o.addSection=function(t){return o.sections=e.openSection(t,\"ACTOR\")},o.removeSection=function(t){return o.sections=e.removeSection(t,\"ACTOR\")}}o.$inject=[\"$stateParams\",\"DynamicSectionManager\",\"ServiceBroker\",\"HistoryStore\"];var s={template:a.default,controller:o,controllerAs:\"ctrl\"};e.default=s},673:function(t,e){t.exports='<div> <waltz-page-header name=\"{{ ctrl.actor.name }}\" small=Actor icon=user-circle> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li>  <li ng-bind=ctrl.actor.name></li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-actor-overview actor=ctrl.actor> </waltz-actor-overview> </div> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-dynamic-section-navigation available-sections=ctrl.availableSections open-sections=ctrl.sections on-select=ctrl.addSection> </waltz-dynamic-section-navigation> </div> <br> <waltz-dynamic-sections-view sections=ctrl.sections parent-entity-ref=ctrl.entityRef on-remove=ctrl.removeSection> </waltz-dynamic-sections-view> </div>'},674:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=null;function a(t){var e=function(){return(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||null==i)&&(i=t.findAll()),i};return e(),{loadActors:e,update:function(n){if(i&&void 0!==n&&null!==n)return t.update(n).then(function(t){if(\"SUCCESS\"===t.outcome)return e(!0).then(function(t){return!0});throw\"could not update: \"+n})},deleteById:function(n){return t.deleteById(n).then(function(t){return e(!0).then(function(e){return t})})},create:function(n){return t.create(n).then(function(t){if(t>0)return e(!0).then(function(e){return t});throw\"could not create: \"+n})}}}a.$inject=[\"ActorStore\"],e.default=a},675:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=l(n(1)),a=n(0),r=l(n(676));function l(t){return t&&t.__esModule?t:{default:t}}var o={allActors:[],actors:[]};function s(){var t=(0,a.initialiseData)(this,o);t.refresh=function(e){if(e){var n=i.default.lowerCase(e);t.actors=i.default.filter(t.allActors,function(t){return i.default.startsWith(i.default.lowerCase(t.name),n)})}},t.select=function(e){(0,a.invokeFunction)(t.onSelect,Object.assign(e,{kind:\"ACTOR\"}))}}s.$inject=[];var c={bindings:{allActors:\"<\",onSelect:\"<\"},template:r.default,controller:s};e.default=c},676:function(t,e){t.exports='<div> <ui-select ng-model=$ctrl.model.actor on-select=$ctrl.select($item) theme=bootstrap> <ui-select-match placeholder=\"Search for an actor...\"> {{$select.selected.name}} </ui-select-match> <ui-select-choices repeat=\"actor in $ctrl.actors\" refresh=$ctrl.refresh($select.search) refresh-delay=300> <span ng-bind-html=\"actor.name | highlight: $select.search\"></span> <small style=display:block ng-bind-html=\"actor.description | highlight: $select.search\"></small> </ui-select-choices> </ui-select> </div> '},677:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(n(678));var r={addLabel:\"Add\",cancelLabel:\"Cancel\",onCancel:function(){return console.log(\"No onCancel provided to basic actor selector\")},onAdd:function(t){return console.log(\"No onAdd provided to basic actor selector\",t)},onSelect:function(t){return console.log(\"No onSelect provided to basic actor selector\",t)}};function l(){var t=(0,i.initialiseData)(this,r);t.add=function(e){e&&t.onAdd(e)},t.cancel=function(){return t.onCancel()},t.select=function(e){t.selectedActor=e,(0,i.invokeFunction)(t.onSelect,e)}}l.$inject=[];var o={bindings:{allActors:\"<\",addLabel:\"@\",cancelLabel:\"@\",onCancel:\"<\",onAdd:\"<\",onSelect:\"<\"},template:a.default,controller:l};e.default=o},678:function(t,e){t.exports='<div class=row> <div class=col-md-8> <waltz-actor-selector all-actors=$ctrl.allActors on-select=$ctrl.select> </waltz-actor-selector> </div> <div class=col-md-4> <button ng-click=$ctrl.add($ctrl.selectedActor) ng-disabled=\"$ctrl.selectedActor == null\" class=\"btn btn-sm btn-primary\"> <waltz-icon name=plus></waltz-icon> <span ng-bind=$ctrl.addLabel></span> </button> <a class=clickable ng-click=$ctrl.cancel()> <span ng-bind=$ctrl.cancelLabel></span> </a> </div> </div> '},679:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(200)),a=n(7);e.default=function(){var t=angular.module(\"waltz.alias\",[]);return(0,a.registerStores)(t,[i]),t.name}},680:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(7),a=y(n(681)),r=y(n(709)),l=y(n(710)),o=y(n(712)),s=y(n(714)),c=y(n(716)),d=y(n(718)),u=y(n(720)),p=y(n(722)),f=y(n(724)),m=y(n(726)),v=y(n(728)),g=y(n(730)),h=y(n(732));function y(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=angular.module(\"waltz.applications\",[]);return(0,r.default)(t),t.config(a.default),t.directive(\"waltzAppSelector\",d.default).directive(\"waltzAssetCodeExplorer\",u.default).directive(\"waltzBasicAppSelector\",p.default),t.component(\"waltzAppsByInvestmentPie\",f.default).component(\"waltzAppsByLifecyclePhasePie\",m.default).component(\"waltzAppsSection\",v.default).component(\"waltzAppSummary\",g.default).component(\"waltzAppTable\",h.default),(0,i.registerComponents)(t,[l.default,o.default,s.default,c.default]),t.name}},681:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(682),a=s(n(683)),r=s(n(685)),l=s(n(705)),o=s(n(707));function s(t){return t&&t.__esModule?t:{default:t}}var c={url:\"application\"},d={url:\"/registration\",views:{\"content@\":l.default}},u={url:\"/{id:int}?{sections:string}\",reloadOnSearch:!1,views:{\"content@\":o.default}},p={url:\"/asset-code/{assetCode}\",views:{\"content@\":a.default},resolve:{resolvedAppsByAssetCode:i.appByAssetCodeResolver}},f={url:\"/{id:int}/edit\",resolve:{app:i.appResolver,orgUnits:i.orgUnitsResolver},views:{\"content@\":r.default}};function m(t){t.state(\"main.app\",c).state(\"main.app.registration\",d).state(\"main.app.view\",u).state(\"main.app.asset-code\",p).state(\"main.app.edit\",f)}m.$inject=[\"$stateProvider\"],e.default=m},682:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.appResolver=a,e.appByAssetCodeResolver=r,e.orgUnitsResolver=l;var i=n(2);function a(t,e){return t.loadViewData(i.CORE_API.ApplicationStore.getById,[e.id]).then(function(t){return t.data})}function r(t,e){return t.loadViewData(i.CORE_API.ApplicationStore.findByAssetCode,[e.assetCode]).then(function(t){return t.data})}function l(t){return t.loadAppData(i.CORE_API.OrgUnitStore.findAll).then(function(t){return t.data})}a.$inject=[\"ServiceBroker\",\"$stateParams\"],r.$inject=[\"ServiceBroker\",\"$stateParams\"],l.$inject=[\"ServiceBroker\"]},683:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(684));function a(t,e,n){this.resolvedAppsByAssetCode=n||[],this.assetCode=e.assetCode;1==this.resolvedAppsByAssetCode.length&&function(e){t.go(\"main.app.view\",{id:e.id},{location:!1})}(n[0])}a.$inject=[\"$state\",\"$stateParams\",\"resolvedAppsByAssetCode\"],e.default={template:i.default,controller:a,controllerAs:\"ctrl\"}},684:function(t,e){t.exports='<div ng-if=\"ctrl.resolvedAppsByAssetCode.length > 1\"> <waltz-page-header icon=desktop name=\"Matching Applications\" small=\"{{ ctrl.assetCode }}\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>Waltz</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <ul class=list-unstyled> <li ng-repeat=\"resolvedApp in ctrl.resolvedAppsByAssetCode | orderBy:\\'name\\'\"> <a ng-bind=resolvedApp.name ui-sref=\"main.app.view ({ id: resolvedApp.id })\"> </a> </li> </ul> </div> </div>'},685:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(n(1)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(263)),r=n(2),l=o(n(704));function o(t){return t&&t.__esModule?t:{default:t}}var s=[{className:\"row\",fieldGroup:[{className:\"col-xs-8\",fieldGroup:[a.nameField,a.orgUnitField]},{className:\"col-xs-4\",fieldGroup:[a.assetCodeField,a.parentAssetCodeField]}]},{className:\"row\",fieldGroup:[{className:\"col-xs-8\",fieldGroup:[a.descriptionField]},{className:\"col-xs-4\",fieldGroup:[a.overallRatingField,a.typeField,a.lifecyclePhaseField,a.businessCriticalityField]}]}];function c(t){var e=function(t){var e=t.originalModel?t.originalModel[t.key]:void 0,n=t.model[t.key];return\"tags-input\"===t.type?{original:JSON.stringify(e),current:JSON.stringify(i.default.map(n,\"text\"))}:{original:e,current:n}}(t);return Object.assign({},{key:t.key,name:t.templateOptions.label,dirty:t.formControl.$dirty},e)}function d(t,e,n,l,o){var d=this;d.$onInit=function(){d.application=t,d.fieldLayout=s,d.formModel=Object.assign({},{app:t}),o.loadViewData(r.CORE_API.OrgUnitStore.getById,[t.organisationalUnitId]).then(function(t){return function(t){return{kind:\"ORG_UNIT\",id:t.id,name:t.name,description:t.description}}(t.data)}).then(function(t){return a.orgUnitField.templateOptions.ouRef=t}).then(function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.nameField.model=e.app,t.descriptionField.model=e.app,t.assetCodeField.model=e.app,t.parentAssetCodeField.model=e.app,t.orgUnitField.model=e.app,t.typeField.model=e.app,t.lifecyclePhaseField.model=e.app,t.overallRatingField.model=e.app,t.businessCriticalityField.model=e.app}(a,d.formModel)})},d.onSubmit=function(){var r=i.default.chain(a).map(c).filter(function(t){return t.dirty}).value(),o={app:d.formModel.app,changes:r};e.update(t.id,o).then(function(){n.success(\"Application updated\"),l.go(\"main.app.view\",{id:t.id})},function(t){console.error(t),n.error(\"Error: \"+t.statusText)})}}d.$inject=[\"app\",\"ApplicationStore\",\"Notification\",\"$state\",\"ServiceBroker\"],e.default={template:l.default,controller:d,controllerAs:\"ctrl\"}},704:function(t,e){t.exports='<div> <waltz-page-header icon=edit name=\"{{ ctrl.application.name }}\" small=Editor> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=\"main.app.view ({ id: ctrl.application.id })\">{{ ctrl.application.name }}</a></li> <li>Edit</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <form ng-submit=ctrl.onSubmit() name=ctrl.form novalidate> <formly-form form=ctrl.form model=ctrl.formModel fields=ctrl.fieldLayout> </formly-form> <hr/> <input type=submit ng-disabled=\"ctrl.form.$pristine || ctrl.form.$invalid\" value=Save style=margin-left:12px class=\"btn btn-success\"> <a ui-sref=\"main.app.view ({ id: ctrl.application.id })\" class=clickable> Cancel </a> </form> </div> </div> '},705:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=l(n(1)),a=n(263),r=l(n(706));function l(t){return t&&t.__esModule?t:{default:t}}var o=function(t,e,n){var r=this,l=[];n.findAll().then(function(t){l=t,a.orgUnitField.templateOptions.options=i.default.map(t,function(t){return{name:t.name,code:t.id}})});var o={lifecyclePhase:\"PRODUCTION\",applicationKind:\"IN_HOUSE\"},s=[{className:\"row\",fieldGroup:[{className:\"col-xs-8\",fieldGroup:[a.nameField,a.orgUnitField]},{className:\"col-xs-4\",fieldGroup:[a.assetCodeField,a.parentAssetCodeField]}]},{className:\"row\",fieldGroup:[{className:\"col-xs-8\",fieldGroup:[a.descriptionField]},{className:\"col-xs-4\",fieldGroup:[a.overallRatingField,a.typeField,a.lifecyclePhaseField,a.businessCriticalityField]}]}],c=[];function d(){var n=Object.assign({},o,{aliases:i.default.map(o.aliases,\"text\"),tags:i.default.map(o.tags,\"text\")});t.registerNewApp(n).then(function(t){e.success(\"New Application registered\");var n=t.registered,a=t.message,r=t.id,o=t.originalRequest,s=o.name,d=o.organisationalUnitId,u=o.applicationKind,p=o.lifecyclePhase;c.push({success:n,message:a,app:{id:r,name:s,applicationKind:u,lifecyclePhase:p,organisationalUnit:i.default.find(l,{id:d})}})},function(t){e.success(\"Failed to register application, see below\"),c.push({success:!1,message:t.data.message,app:{name:t.config.data.name}})})}r.$onInit=function(){a.nameField.model=o,a.assetCodeField.model=o,a.descriptionField.model=o,a.orgUnitField.model=o,a.orgUnitField.templateOptions.ouRef=null,a.parentAssetCodeField.model=o,a.typeField.model=o,a.lifecyclePhaseField.model=o,a.overallRatingField.model=o,a.businessCriticalityField.model=o,r.fields=s,r.model=o,r.onSubmit=d,r.registrations=c}};o.$inject=[\"ApplicationStore\",\"Notification\",\"OrgUnitStore\"],e.default={template:r.default,controller:o,controllerAs:\"ctrl\"}},706:function(t,e){t.exports='<div> <waltz-page-header name=\"Application Registration\"></waltz-page-header> <div class=row> <div class=col-md-7> <waltz-section name=\"Registration Form\"> <form ng-submit=ctrl.onSubmit() name=ctrl.form novalidate> <formly-form form=ctrl.form model=ctrl.model fields=ctrl.fields> <button type=submit class=\"btn btn-success\" style=margin-left:12px ng-disabled=ctrl.form.$invalid> Register </button> </formly-form> </form> </waltz-section> </div> <div class=col-md-5> <div ng-if=\"ctrl.registrations.length > 0\"> <waltz-section name=\"Recent Registrations\"> <table class=\"table table-condensed\"> <tr ng-repeat=\"registration in ctrl.registrations\" ng-class=\"{ \\'bg-success\\' : registration.success, \\'danger\\' : ! registration.success }\" ng-include=\"registration.success ? \\'applications/app-registration-success.frag\\' : \\'applications/app-registration-failure.frag\\'\"> </tr> </table> </waltz-section> </div> </div> </div> <script type=text/ng-template id=applications/app-registration-success.frag> <td>\\n            <waltz-icon name=\"check\"></waltz-icon>\\n            <a ui-sref=\"main.app.view ({ id: registration.app.id })\">\\n                <strong>\\n                    {{ registration.app.name }}\\n                </strong>\\n            </a>\\n        </td>\\n        <td>\\n            {{ registration.app.kind | toDisplayName:\\'applicationKind\\' }}\\n        </td>\\n        <td>\\n            {{ registration.app.lifecyclePhase | toDisplayName:\\'lifecyclePhase\\' }}\\n        </td>\\n        <td>\\n            <a ui-sref=\"main.org-unit.view ({ id: registration.app.organisationalUnit.id })\">\\n                {{ registration.app.organisationalUnit.name }}\\n            </a>\\n        </td> <\\/script> <script type=text/ng-template id=applications/app-registration-failure.frag> <td>\\n            <waltz-icon name=\"close\"></waltz-icon>\\n            <strong>\\n                {{ registration.app.name }}\\n            </strong>\\n        </td>\\n        <td colspan=\"3\">\\n            <span class=\"text-muted\">\\n                {{ registration.message }}\\n            </span>\\n        </td> <\\/script> </div> '},707:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(2),a=function(t){return t&&t.__esModule?t:{default:t}}(n(708));var r={app:{},availableSections:[],parentEntityRef:{},sections:[]},l=function(t,e){e&&t.put(e.name,\"APPLICATION\",\"main.app.view\",{id:e.id})};function o(t,e,n,a){var o=Object.assign(this,r);function s(t){n.loadViewData(i.CORE_API.ApplicationStore.getById,[t]).then(function(t){return o.app=t.data}).then(function(){return function(t){l(a,t),o.parentEntityRef=Object.assign({},o.parentEntityRef,{name:t.name})}(o.app)})}o.$onInit=function(){var n=t.id,i={id:n,kind:\"APPLICATION\"};o.availableSections=e.findAvailableSectionsForKind(\"APPLICATION\"),o.sections=e.findUserSectionsForKind(\"APPLICATION\"),o.parentEntityRef=i,s(n)},o.addSection=function(t){return o.sections=e.openSection(t,\"APPLICATION\")},o.removeSection=function(t){return o.sections=e.removeSection(t,\"APPLICATION\")}}o.$inject=[\"$stateParams\",\"DynamicSectionManager\",\"ServiceBroker\",\"HistoryStore\"],e.default={template:a.default,controller:o,controllerAs:\"ctrl\"}},708:function(t,e){t.exports=' <div> <waltz-page-header icon=desktop name=\"{{ ctrl.app.name }}\" small=\"{{ ctrl.app.assetCode }}\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>Applications</li> <li><span ng-bind=ctrl.app.name></span></li> </ol> </waltz-page-header> <waltz-app-overview parent-entity-ref=ctrl.parentEntityRef> </waltz-app-overview> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-dynamic-section-navigation available-sections=ctrl.availableSections open-sections=ctrl.sections on-select=ctrl.addSection> </waltz-dynamic-section-navigation> </div> <br> <waltz-dynamic-sections-view sections=ctrl.sections parent-entity-ref=ctrl.parentEntityRef on-remove=ctrl.removeSection> </waltz-dynamic-sections-view> </div> '},709:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(7),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(202));e.default=function(t){(0,i.registerStore)(t,a)}},710:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(n(1)),a=n(2),r=n(0),l=o(n(711));function o(t){return t&&t.__esModule?t:{default:t}}var s={currentYear:null,costsMostRecentYear:null,mostRecentCosts:[],mostRecentTotal:null};function c(t){var e=(0,r.initialiseData)(this,s),n=function(){t.loadViewData(a.CORE_API.AssetCostStore.findByAppId,[e.parentEntityRef.id]).then(function(t){e.currentYear=(new Date).getFullYear(),e.costs=t.data,e.costsMostRecentYear=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=(new Date).getFullYear();return i.default.chain(t).map(\"cost.year\").max().value()||e}(e.costs),e.mostRecentCosts=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return i.default.filter(e,function(e){return e.cost.year===t})}(e.costsMostRecentYear,e.costs),e.mostRecentTotal=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return i.default.sumBy(t,\"cost.amount\").toFixed(2)}(e.mostRecentCosts)})};e.$onInit=function(){t.loadAppData(a.CORE_API.SourceDataRatingStore.findAll).then(function(t){return e.sourceDataRatings=t.data}),n(),e.$onChanges=n}}c.$inject=[\"ServiceBroker\"];var d={bindings:{parentEntityRef:\"<\"},template:l.default,controller:c};e.default={component:d,id:\"waltzAppCostsSection\"}},711:function(t,e){t.exports='<div> <waltz-source-data-section-addon ratings=$ctrl.sourceDataRatings entities=\"[\\'ASSET_COST\\']\"> </waltz-source-data-section-addon> <waltz-no-data ng-if=\"$ctrl.costs.length == 0\"> <message> <strong> No costs registered </strong> against this application </message> </waltz-no-data> <div ng-if=\"$ctrl.costs.length > 0\" class=row> <div class=col-sm-8> <uib-tabset> <uib-tab> <uib-tab-heading> Summary </uib-tab-heading> <div class=row> <div class=\"col-md-offset-1 col-md-4\"> <br> <h3> Application TCO: <waltz-currency-amount amount=$ctrl.mostRecentTotal> </waltz-currency-amount> </h3> <h4> <span ng-bind=$ctrl.costsMostRecentYear></span> <span ng-if=\"$ctrl.costsMostRecentYear == $ctrl.currentYear\">YTD</span> </h4> </div> <div class=col-md-7> <br> <table class=\"table small table-condensed\"> <thead> <tr> <th>Type</th> <th>Cost</th> </tr> </thead> <tbody> <tr ng-repeat=\"item in $ctrl.mostRecentCosts\"> <td> <waltz-enum-value type=\"\\'CostKind\\'\" show-icon=false key=item.cost.costKind> </waltz-enum-value> </td> <td> <waltz-currency-amount amount=item.cost.amount></waltz-currency-amount> </td> </tr> </tbody> </table> </div> </div> </uib-tab> <uib-tab select=\"showTableTab = true\"> <uib-tab-heading> Detail </uib-tab-heading> <div class=row style=padding-top:1em> <div class=col-md-12> <div ng-if=showTableTab> <waltz-asset-cost-table costs=$ctrl.costs csv-name={{$ctrl.parentEntityRef.name}}-costs.csv> </waltz-asset-cost-table> </div> </div> </div> </uib-tab> </uib-tabset> </div> <div class=col-sm-4> <waltz-static-panels group-key=SECTION.ASSET_COSTS.ABOUT class=small render-mode=minimal-border> </waltz-static-panels> </div> </div> </div>'},712:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(n(1)),a=n(0),r=n(2),l=o(n(713));function o(t){return t&&t.__esModule?t:{default:t}}var s={aliases:[],app:null,appGroups:[],complexity:null,organisationalUnit:null,tags:[],visibility:{aliasEditor:!1,tagEditor:!1}};function c(t,e){var n=(0,a.initialiseData)(this,s);n.$onInit=function(){e.loadViewData(r.CORE_API.ApplicationStore.getById,[n.parentEntityRef.id]).then(function(t){return n.app=t.data}).then(function(){e.loadViewData(r.CORE_API.ComplexityStore.findBySelector,[{entityReference:n.parentEntityRef,scope:\"EXACT\"}]).then(function(t){return n.complexity=i.default.get(t.data,\"[0]\")})}).then(function(){e.loadAppData(r.CORE_API.OrgUnitStore.getById,[n.app.organisationalUnitId]).then(function(t){return n.organisationalUnit=t.data})}),e.loadViewData(r.CORE_API.AliasStore.getForEntity,[n.parentEntityRef]).then(function(t){return n.aliases=t.data}),e.loadViewData(r.CORE_API.EntityTagStore.findTagsByEntityRef,[n.parentEntityRef]).then(function(t){return n.tags=t.data}),e.loadAppData(r.CORE_API.AppGroupStore.findRelatedByEntityRef,[n.parentEntityRef]).then(function(t){return n.appGroups=t.data})},n.showAliasEditor=function(){return n.visibility.aliasEditor=!0},n.showTagEditor=function(){return n.visibility.tagEditor=!0},n.dismissAliasEditor=function(){return n.visibility.aliasEditor=!1},n.dismissTagEditor=function(){return n.visibility.tagEditor=!1},n.tagSelected=function(e){var n={tag:e};t.go(\"main.entity-tag.explorer\",n)},n.saveAliases=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.execute(r.CORE_API.AliasStore.update,[n.parentEntityRef,t]).then(function(t){n.aliases=t.data,n.dismissAliasEditor()})},n.saveTags=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.execute(r.CORE_API.EntityTagStore.update,[n.parentEntityRef,t]).then(function(t){n.tags=t.data,n.dismissTagEditor()})}}c.$inject=[\"$state\",\"ServiceBroker\"];var d={bindings:{parentEntityRef:\"<\"},template:l.default,controller:c};e.default={component:d,id:\"waltzAppOverview\"}},713:function(t,e){t.exports='<div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-section-actions> <a waltz-has-role=APP_EDITOR class=\"btn btn-xs btn-primary\" ui-sref=\"main.app.edit ({id: $ctrl.app.id})\"> Edit </a> </waltz-section-actions> <div class=waltz-display-section> <div class=row> <div class=col-sm-7> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Name </div> <div class=col-sm-4> <span ng-bind=$ctrl.app.name></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Asset Code </div> <div class=col-sm-4> <waltz-asset-code-explorer application=$ctrl.app> </waltz-asset-code-explorer> </div> </div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Lifecycle Phase </div> <div class=col-sm-4> <span ng-bind=\"$ctrl.app.lifecyclePhase | toDisplayName:\\'lifecyclePhase\\'\"></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Type </div> <div class=col-sm-4> <span ng-bind=\"$ctrl.app.applicationKind | toDisplayName:\\'applicationKind\\'\"></span> </div> </div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Owning Org Unit </div> <div class=col-sm-4> <a ng-bind=$ctrl.organisationalUnit.name ui-sref=\"main.org-unit.view ({ id: $ctrl.organisationalUnit.id })\"> </a> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Overall Rating </div> <div class=col-sm-4> <waltz-rating-indicator-cell rating=\"$ctrl.app.overallRating | useDefaultRatingScheme:\\'investment\\' \" show-name=true> </waltz-rating-indicator-cell> </div> </div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Aliases </div> <div class=col-sm-4> <waltz-keyword-list ng-if=!$ctrl.visibility.aliasEditor keywords=$ctrl.aliases> <last> <span class=small> <a ng-click=$ctrl.showAliasEditor() class=clickable> update </a> </span> </last> <empty> <i class=text-muted> No aliases defined, <a class=clickable ng-click=$ctrl.showAliasEditor()> add one. </a> </i> </empty> </waltz-keyword-list> <waltz-keyword-edit ng-if=$ctrl.visibility.aliasEditor keywords=$ctrl.aliases on-save=$ctrl.saveAliases on-cancel=$ctrl.dismissAliasEditor> </waltz-keyword-edit> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Tags </div> <div class=col-sm-4> <waltz-keyword-list keywords=$ctrl.tags on-select=$ctrl.tagSelected(keyword)> <last> <span class=small> <a ng-click=$ctrl.showTagEditor() class=clickable> update </a> </span> </last> <empty> <i class=text-muted> No aliases defined, <a class=clickable ng-click=$ctrl.showTagEditor()> add one. </a> </i> </empty> </waltz-keyword-list> <waltz-keyword-edit ng-if=$ctrl.visibility.tagEditor keywords=$ctrl.tags on-save=$ctrl.saveTags on-cancel=$ctrl.dismissTagEditor> </waltz-keyword-edit> </div> </div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Complexity Rating: </div> <div class=col-sm-4> <span class=waltz-clickable-definition popover-trigger=focus tabindex=99 popover-placement=right popover-animation=true popover-title=\"Application Complexity Rating\" uib-popover-template=\"\\'popup-app-complexity.html\\'\"> <span ng-bind=\"$ctrl.complexity.overallScore | toFixed:2\"></span> </span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Business Criticality </div> <div class=col-sm-4> <span ng-bind=\"$ctrl.app.businessCriticality | toDisplayName:\\'criticality\\'\"></span> </div> </div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Planned Retirement: </div> <div class=col-sm-4> <waltz-from-now ng-if=$ctrl.app.plannedRetirementDate timestamp=$ctrl.app.plannedRetirementDate> </waltz-from-now> <span ng-if=\"! $ctrl.app.plannedRetirementDate\"> - </span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Actual Retirement: </div> <div class=col-sm-4> <waltz-from-now ng-if=$ctrl.app.actualRetirementDate timestamp=$ctrl.app.actualRetirementDate> </waltz-from-now> <span ng-if=\"! $ctrl.app.actualRetirementDate\"> - </span> </div> </div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Description </div> <div class=col-sm-10> <waltz-markdown text=$ctrl.app.description> </waltz-markdown> </div> </div> <div class=row ng-if=\"$ctrl.appGroups.length > 0\"> <div class=\"col-sm-2 waltz-display-field-label\"> Application Groups </div> <div class=col-sm-10> <ul class=\"list-unstyled list-inline\"> <li ng-repeat=\"appGroup in $ctrl.appGroups | orderBy:\\'name\\'\"> <waltz-entity-link entity-ref=appGroup> </waltz-entity-link> <span ng-hide=$last>, </span> </li> </ul> </div> </div> </div> <div class=col-sm-5> <waltz-assessment-rating-sub-section parent-entity-ref=$ctrl.parentEntityRef> </waltz-assessment-rating-sub-section> </div> </div> <script type=text/ng-template id=popup-app-complexity.html> <div>\\n                <table class=\"table small\">\\n                    <tr>\\n                        <td>Characteristic Complexity</td>\\n                        <td>\\n                            <span ng-bind=\"$ctrl.complexity.measurableComplexity.score | toFixed:2\"></span>\\n                        </td>\\n                    </tr>\\n                    <tr>\\n                        <td>Connection Complexity</td>\\n                        <td>\\n                            <span ng-bind=\"$ctrl.complexity.connectionComplexity.score | toFixed:2\"></span>\\n                        </td>\\n                    </tr>\\n                    <tr>\\n                        <td>Server Complexity</td>\\n                        <td>\\n                            <span ng-bind=\"$ctrl.complexity.serverComplexity.score | toFixed:2\"></span>\\n                        </td>\\n                    </tr>\\n                </table>\\n\\n                <div class=\"text-muted small\">\\n                    Complexity scores are re-calculated periodically against a baseline measurement.  The\\n                    scores should fall between 0 and 1, indicating their proximity to the baseline.\\n                </div>\\n\\n            </div> <\\/script> </div> </div> '},714:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=c(n(1)),a=n(2),r=n(0),l=n(0),o=n(12),s=c(n(715));function c(t){return t&&t.__esModule?t:{default:t}}var d={ADD:\"ADD\",REPLACE:\"REPLACE\"},u={bulkEntriesString:\"\",existingRefs:[],searchResults:[],filteredSearchResults:[],mode:\"ADD\",removedResults:[],searchSummary:{},showNotFoundOnly:!1,visibility:{editor:!0,loading:!1},onSave:function(t){return console.log(\"default onSave handler for bulk-application-selector: \",t)}};function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=i.default.keyBy(t,\"assetCode\"),r=i.default.keyBy(n,\"id\");return i.default.chain(e).map(function(t){var e=a[t],n=e?(0,o.toEntityRef)(e,\"APPLICATION\"):null;return{identifier:t,entityRef:n,action:n?function(t,e){if(e)return t?(0,o.sameRef)(t,e)?\"NO_CHANGE\":void 0:\"ADD\"}(r[n.id],n):null}}).value()}function f(t){var e=(0,r.initialiseData)(this,u),n=function(){return i.default.filter(e.searchResults,function(t){return!e.showNotFoundOnly||null==t.entityRef})};e.resolve=function(){e.searchResults=[],e.visibility.loading=!0,e.visibility.editor=!1,e.showNotFoundOnly=!1;return function(n){return t.loadViewData(a.CORE_API.ApplicationStore.findAll).then(function(t){return p(t.data,n,e.existingRefs)})}(i.default.map(i.default.split(e.bulkEntriesString,/,|;|\\n|\\|/),function(t){return i.default.trim(t)})).then(function(t){e.searchResults=t,e.filteredSearchResults=n(),e.visibility.loading=!1,e.searchSummary=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object.assign({total:t.length},i.default.countBy(t,function(t){return null==t.entityRef?\"notFound\":\"found\"}))}(e.searchResults);var a=i.default.keyBy(t,\"entityRef.id\");e.removedResults=i.default.chain(e.existingRefs).filter(function(t){return!a[t.id]}).map(function(t){return{entityRef:t,action:\"REMOVE\"}}).value()})},e.save=function(){var t=i.default.filter(e.searchResults,function(t){return\"ADD\"===t.action});e.mode===d.REPLACE&&(t=i.default.concat(t,e.removedResults)),(0,l.invokeFunction)(e.onSave,t)},e.toggleNotFound=function(){e.showNotFoundOnly=!e.showNotFoundOnly,e.filteredSearchResults=n()}}f.$inject=[\"ServiceBroker\"];var m={template:s.default,bindings:{existingRefs:\"<\",onSave:\"<\"},controller:f};e.default={component:m,id:\"waltzBulkApplicationSelector\"}},715:function(t,e){t.exports='<div class=waltz-bulk-application-selector> <waltz-loading-notification show=$ctrl.visibility.loading name=Searching> </waltz-loading-notification> <div ng-if=$ctrl.visibility.editor> <textarea rows=8 cols=95 style=width:100% placeholder=\"Please insert application identifiers separated by newline, comma, semi-colon or pipe characters\" ng-model=$ctrl.bulkEntriesString ng-model-options=\"{debounce: 300}\" ng-change=$ctrl.bulkEntriesChanged()>\\n        </textarea> </div> <div ng-if=\"!$ctrl.visibility.editor && !$ctrl.visibility.loading\"> <div> <h4>Summary</h4> <span ng-if=!$ctrl.searchSummary.notFound class=text-success> All identifers found, ready to save selection </span> <span ng-if=\"$ctrl.searchSummary.notFound > 0\" class=text-danger> <span ng-bind=$ctrl.searchSummary.notFound></span> identifer<span ng-if=\"$ctrl.searchSummary.notFound > 1\">s</span> <a class=\"clickable wbas-inline-link\" ng-click=$ctrl.toggleNotFound()>not found</a>. Please review below and <a class=\"clickable wbas-inline-link\" ng-click=\"$ctrl.visibility.editor = true\">correct</a>. <a class=clickable ng-if=$ctrl.showNotFoundOnly ng-click=$ctrl.toggleNotFound()> show all </a> </span> </div> <br> <div ng-class=\"{\\'waltz-scroll-region-250\\': $ctrl.filteredSearchResults.length > 15 }\"> <table class=\"table table-condensed small\"> <thead> <tr> <th>Identifier</th> <th>Application</th> <th>Action</th> </tr> </thead> <tbody> <tr ng-repeat=\"result in $ctrl.filteredSearchResults\" ng-class=\"{\\n                                    \\'text-danger\\': !result.entityRef,\\n                                    \\'bg-danger\\': !result.entityRef,\\n                                    \\'bg-warning\\': result.action === \\'ADD\\',\\n                                  }\"> <td> <span ng-bind=result.identifier> </span> </td> <td> <waltz-entity-link ng-if=result.entityRef entity-ref=result.entityRef> </waltz-entity-link> <span ng-if=!result.entityRef class=\"text-danger bg-danger\"> Not found </span> </td> <td> <span ng-bind=\"result.action | toDisplayName:\\'action\\'\"></span> </td> </tr> </tbody> </table> </div> <div ng-if=\"$ctrl.mode === \\'REPLACE\\'\" class=waltz-fade-if> <br> The following applications are not in the replacement list of identifiers and will be removed from this Application Group if you select \\'Replace\\'. <div ng-if=\"$ctrl.removedResults.length === 0\" class=text-warning> No applications will be removed. </div> <div ng-if=\"$ctrl.removedResults.length > 0\" ng-class=\"{\\'waltz-scroll-region-250\\': $ctrl.removedResults.length > 15 }\"> <table class=\"table table-condensed small\"> <thead> <tr> <th>Application</th> <th>Action</th> </tr> </thead> <tbody> <tr ng-repeat=\"result in $ctrl.removedResults\" class=bg-warning> <td> <waltz-entity-link entity-ref=result.entityRef> </waltz-entity-link> </td> <td> <span ng-bind=\"result.action | toDisplayName:\\'action\\'\"></span> </td> </tr> </tbody> </table> </div> </div> </div> <div ng-if=!$ctrl.visibility.loading style=padding-top:5px> <span class=pull-left ng-if=\"! $ctrl.visibility.editor\"> Mode: &nbsp; <span uib-tooltip=\"Only add new applications\"> <input type=radio name=mode value=ADD ng-model=$ctrl.mode ng-change=$ctrl.modeChange($ctrl.mode)> Add only </span> &nbsp; <span uib-tooltip=\"Replace existing applications, i.e. add new ones and remove those not in the new list\"> <input type=radio name=mode value=REPLACE ng-model=$ctrl.mode ng-change=$ctrl.modeChange($ctrl.mode)> Replace </span> </span> <span class=pull-right> <button ng-if=$ctrl.visibility.editor class=\"btn btn-xs btn-primary\" ng-click=$ctrl.resolve()> Search </button> <button ng-if=!$ctrl.visibility.editor class=\"btn btn-xs btn-success\" ng-click=$ctrl.save() ng-disabled=$ctrl.searchSummary.notFound> Save </button> <a ng-if=!$ctrl.visibility.editor class=clickable ng-click=\"$ctrl.visibility.editor = true\"> Back </a> </span> </div> </div>'},716:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var l,o=t[Symbol.iterator]();!(i=(l=o.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),a=m(n(1)),r=n(0),l=n(27),o=n(269),s=n(149),c=n(2),d=n(17),u=n(12),p=n(110),f=m(n(717));function m(t){return t&&t.__esModule?t:{default:t}}var v={columnDefs:[Object.assign((0,l.mkEntityLinkGridCell)(\"Name\",\"app\"),{width:\"25%\"}),{field:\"relationshipDisplay\",name:\"Relationship\"},{field:\"app.assetCode\"},{field:\"app.kindDisplay\",name:\"Kind\"},{field:\"app.overallRatingDisplay\",name:\"Overall Rating\"},{field:\"app.businessCriticalityDisplay\",name:\"Business Criticality\"},{field:\"app.lifecyclePhaseDisplay\",name:\"Lifecycle Phase\"}],allowedRelationships:[],entityRelationships:[],visibility:{editor:!1}};function g(t,e,n){return{operation:t,entityReference:{id:e.id,kind:\"APPLICATION\"},relationship:n}}function h(t,e,n){var l=(0,r.initialiseData)(this,v);function f(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=p.fetchRelationshipFunctionsByKind[l.parentEntityRef.kind],f=n.loadViewData(r,[l.parentEntityRef.id],{force:e}).then(function(t){return a.default.chain(t.data).flatMap(function(t){return[{entity:t.a,relationship:t.relationship},{entity:t.b,relationship:t.relationship}]}).filter(function(t){return\"APPLICATION\"===t.entity.kind}).reject(function(t){return(0,u.sameRef)(t.entity,l.parentEntityRef,{skipChecks:!0})}).value()}),m=n.loadViewData(c.CORE_API.ApplicationStore.findBySelector,[(0,d.mkSelectionOptions)(l.parentEntityRef,(0,d.getDefaultScopeForEntityKind)(l.parentEntityRef.kind),[\"ACTIVE\",\"PENDING\",\"REMOVED\"])],{force:e}).then(function(t){return a.default.map(t.data,function(t){return Object.assign({},t,(0,o.mapToDisplayNames)(t))})});return t.all([m,f]).then(function(t){var e=i(t,2),n=e[0],r=e[1];l.gridData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.default.keyBy(e,\"id\");return a.default.map(t,function(t){return{relationshipDisplay:s.relationshipKind[t.relationship]?s.relationshipKind[t.relationship].name:t.relationship,app:n[t.entity.id]}})}(r,n),l.entityRelationships=a.default.map(r,function(t){return Object.assign({},{relationship:t.relationship,entity:{id:t.entity.id,name:t.entity.name,kind:\"APPLICATION\"}})})})}l.$onChanges=function(t){l.parentEntityRef&&(l.allowedRelationships=p.allowedRelationshipsByKind[l.parentEntityRef.kind],f(!1))},l.onInitialise=function(t){l.export=function(){return t.exportFn(\"app-relationships.csv\")}},l.editMode=function(t){l.visibility.editor=t},l.onAdd=function(t){var i=p.changeRelationshipFunctionsByKind[l.parentEntityRef.kind];return n.execute(i,[l.parentEntityRef.id,g(\"ADD\",t.entity,t.relationship)]).then(function(t){return t.data?e.success(\"Relationship added successfully\"):e.warning(\"Failed to add relationship\"),f(!0)})},l.onRemove=function(t){var i=p.changeRelationshipFunctionsByKind[l.parentEntityRef.kind];return n.execute(i,[l.parentEntityRef.id,g(\"REMOVE\",t.entity,t.relationship)]).then(function(t){return t.data?e.success(\"Relationship removed successfully\"):e.warning(\"Failed to remove relationship\"),f(!0)})}}h.$inject=[\"$q\",\"Notification\",\"ServiceBroker\"];var y={template:f.default,bindings:{editRole:\"@?\",parentEntityRef:\"<\"},controller:h};e.default={id:\"waltzRelatedAppsSection\",component:y}},717:function(t,e){t.exports='<div> <waltz-section-actions> <button waltz-has-role=\"{{ $ctrl.editRole }}\" ng-click=$ctrl.editMode(true) class=\"btn btn-xs btn-primary\" ng-if=\"$ctrl.visibility.editor === false\"> Edit </button> <button ng-click=$ctrl.editMode(false) class=\"btn btn-xs btn-primary\" ng-if=\"$ctrl.visibility.editor === true\"> View </button> <button class=\"btn btn-xs btn-primary\" ng-click=$ctrl.export()> <waltz-icon name=cloud-download></waltz-icon> Export </button> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.visibility.appOverlay = ! $ctrl.visibility.appOverlay\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <div ng-if=\"$ctrl.visibility.editor === false\"> <waltz-source-data-overlay visible=$ctrl.visibility.appOverlay entities=\"[\\'APPLICATION\\']\"> </waltz-source-data-overlay> <div ng-if=\"$ctrl.gridData.length > 0\"> <waltz-grid-with-search entries=$ctrl.gridData column-defs=$ctrl.columnDefs on-initialise=$ctrl.onInitialise> </waltz-grid-with-search> </div> <waltz-no-data ng-if=\"$ctrl.gridData.length == 0\"> <message> There are <strong>no application </strong> associations. </message> </waltz-no-data> </div> <waltz-related-entity-editor ng-if=\"$ctrl.visibility.editor === true\" parent-entity-ref=$ctrl.parentEntityRef current-relationships=$ctrl.entityRelationships target-entity-kind=\"\\'APPLICATION\\'\" allowed-relationships=$ctrl.allowedRelationships on-add=$ctrl.onAdd on-remove=$ctrl.onRemove> </waltz-related-entity-editor> </div> '},718:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(n(719));var r={apps:[]};function l(t){var e=(0,i.initialiseData)(this,r);e.refresh=function(n){if(n)return t.search(n).then(function(t){e.apps=t})},e.select=function(t){return(0,i.invokeFunction)(e.onSelect,t)}}l.$inject=[\"ApplicationStore\"];var o={restrict:\"E\",replace:!0,template:a.default,scope:{},bindToController:{model:\"=\",onSelect:\"<\"},controller:l,controllerAs:\"ctrl\"};e.default=function(){return o}},719:function(t,e){t.exports='<div> <ui-select ng-model=ctrl.model.app on-select=ctrl.select($item) theme=bootstrap> <ui-select-match placeholder=\"Search for app...\"> {{$select.selected.name}} </ui-select-match> <ui-select-choices repeat=\"app in ctrl.apps\" refresh=ctrl.refresh($select.search) refresh-delay=300> <span ng-bind-html=\"app.name | highlight: $select.search\"></span> <span class=small ng-if=\"app.aliases.length > 0\"> ( <span class=small ng-bind-html=\"app.aliases.join(\\', \\') | highlight: $select.search\"></span> ) </span> <small style=display:block ng-bind-html=\"app.description | highlight: $select.search\"></small> </ui-select-choices> </ui-select> </div> '},720:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(721));function a(t){var e=this;e.status=\"CLOSED\",e.loadRelated=function(){e.status=\"LOADING\",t.findRelatedById(e.application.id).then(function(t){e.related=t,e.status=\"LOADED\"})}}a.$inject=[\"ApplicationStore\"],e.default=function(){return{restrict:\"E\",replace:!0,template:i.default,scope:{},controller:a,controllerAs:\"ctrl\",bindToController:{application:\"=\"}}}},721:function(t,e){t.exports='<span> <span class=waltz-clickable-definition popover-title=\"Related by asset code\" popover-trigger=focus ng-click=ctrl.loadRelated() tabindex=98 popover-placement=left uib-popover-template=\"\\'asset-code-explorer-popover.html\\'\"> <span ng-if=ctrl.application.assetCode> {{ ctrl.application.assetCode }} </span> <span ng-if=ctrl.application.parentAssetCode class=text-muted> (&nbsp;parent code: {{ ctrl.application.parentAssetCode }}&nbsp;) </span> <span ng-if=\"! ctrl.application.assetCode\" class=text-muted> <i> Not provided </i> </span> </span> <script type=text/ng-template id=asset-code-explorer-popover.html> <div>\\n\\n            <style>\\n                .popover {\\n                    max-width: 450px;\\n                }\\n            </style>\\n\\n            <div ng-show=\"ctrl.status == \\'LOADING\\'\">\\n                Loading\\n            </div>\\n\\n            <div ng-show=\"ctrl.status == \\'LOADED\\' && (ctrl.related | isEmpty)\">\\n                Nothing found\\n            </div>\\n\\n            <div ng-show=\"ctrl.status == \\'LOADED\\' && ctrl.related != null\">\\n\\n                <div class=\"form-group\" ng-if=\"ctrl.related[\\'PARENT\\'].length > 0\">\\n                    <label>\\n                        Parent/s\\n                        <span class=\"text-muted\">({{ ctrl.application.parentAssetCode }})</span>\\n                    </label>\\n                    <ul class=\"list-unstyled\">\\n                        <li ng-repeat=\"parent in ctrl.related[\\'PARENT\\']\">\\n                            <a ui-sref=\"main.app.view ({id: parent.id})\">{{ parent.name }}</a>\\n                            <small> - {{ parent.description | limitTo: 40 }} </small>\\n                        </li>\\n                    </ul>\\n                </div>\\n\\n                <div class=\"form-group\" ng-if=\"ctrl.related[\\'SHARING\\'].length > 0\">\\n                    <label>\\n                        Sharing same asset code\\n                        <span class=\"text-muted\">({{ ctrl.application.assetCode }})</span>\\n                    </label>\\n                    <ul class=\"list-unstyled\">\\n                        <li ng-repeat=\"sharer in ctrl.related[\\'SHARING\\']\">\\n                            <a ui-sref=\"main.app.view ({id: sharer.id})\">{{ sharer.name }}</a>\\n                            <small> - {{ sharer.description | limitTo: 40 }} </small>\\n                        </li>\\n                    </ul>\\n                </div>\\n\\n                <div class=\"form-group\" ng-if=\"ctrl.related[\\'CHILD\\'].length > 0\">\\n                    <label>Children</span></label>\\n                    <ul class=\"list-unstyled\">\\n                        <li ng-repeat=\"child in ctrl.related[\\'CHILD\\']\">\\n                            <a ui-sref=\"main.app.view ({id: child.id})\">{{ child.name }}</a>\\n                            <small> - {{ child.description | limitTo: 40 }} </small>\\n                        </li>\\n                    </ul>\\n                </div>\\n\\n                <div class=\"form-group\" ng-if=\"ctrl.related[\\'SIBLING\\'].length > 0\">\\n                    <label>\\n                        Siblings, sharing same parent code\\n                        <span class=\"text-muted\">\\n                            ({{ ctrl.application.parentAssetCode }})\\n                        </span>\\n                    </label>\\n                    <ul class=\"list-unstyled\">\\n                        <li ng-repeat=\"sibling in ctrl.related[\\'SIBLING\\']\">\\n                            <a ui-sref=\"main.app.view ({id: sibling.id})\">{{ sibling.name }}</a>\\n                            <small> - {{ sibling.description | limitTo: 40 }} </small>\\n                        </li>\\n                    </ul>\\n                </div>\\n\\n            </div>\\n        </div> <\\/script> </span> '},722:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=l(n(1)),a=n(0),r=l(n(723));function l(t){return t&&t.__esModule?t:{default:t}}var o={addLabel:\"Add\",cancelLabel:\"Cancel\",onCancel:function(){return console.log(\"No onCancel provided to basic app selector\")},onAdd:function(t){return console.log(\"No onAdd provided to basic app selector\",t)},onSelect:function(t){return console.log(\"No onSelect provided to basic app selector\",t)}};function s(){var t=i.default.defaultsDeep(this,o);t.add=function(e){e&&t.onAdd(e)},t.cancel=function(){return t.onCancel()},t.select=function(e){return(0,a.invokeFunction)(t.onSelect,e)}}s.$inject=[];var c={restrict:\"E\",replace:!1,template:r.default,scope:{},bindToController:{addLabel:\"@\",cancelLabel:\"@\",onCancel:\"<\",onAdd:\"<\",onSelect:\"<\"},controller:s,controllerAs:\"ctrl\"};e.default=function(){return c}},723:function(t,e){t.exports='<div class=row> <div class=col-md-8> <waltz-app-selector model=ctrl.newSource on-select=ctrl.select> </waltz-app-selector> </div> <div class=col-md-4> <button ng-click=ctrl.add(ctrl.newSource.app) ng-disabled=\"ctrl.newSource.app == null\" class=\"btn btn-sm btn-primary\"> <waltz-icon name=plus></waltz-icon> <span ng-bind=ctrl.addLabel></span> </button> <a class=clickable ng-click=ctrl.cancel()> <span ng-bind=ctrl.cancelLabel></span> </a> </div> </div> '},724:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(19),a=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n(725));var l=80,o={R:\"Disinvest\",A:\"Maintain\",G:\"Invest\"},s={colorProvider:function(t){return(0,i.ragColorScale)(t.data.key)},size:l,labelProvider:function(t){return o[t.key]||\"Unknown\"}};var c={template:r.default,bindings:{applications:\"<\",size:\"<\"},controller:function(){var t=this;t.config=s,t.data=[],t.$onChanges=function(){t.config.size=t.size?t.size:l,t.data=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,a.toKeyCounts)(t,function(t){return t.overallRating})}(t.applications)}}};e.default=c},725:function(t,e){t.exports='<div> <waltz-pie-table data=$ctrl.data config=$ctrl.config class=clickable waltz-jump-to=apps-section icon=money title=\"Apps By Investment Status\"> </waltz-pie-table> </div> '},726:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(19),a=n(88),r=n(0),l=function(t){return t&&t.__esModule?t:{default:t}}(n(727));var o=80,s={colorProvider:function(t){return(0,i.lifecyclePhaseColorScale)(t.data.key)},size:o,labelProvider:function(t){return a.lifecyclePhase[t.key]?a.lifecyclePhase[t.key].name:\"Unknown\"}};var c={template:l.default,bindings:{applications:\"<\",size:\"<\"},controller:function(){var t=this;t.config=s,t.data=[],t.$onChanges=function(){t.config.size=t.size?t.size:o,t.data=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,r.toKeyCounts)(t,function(t){return t.lifecyclePhase})}(t.applications)}}};e.default=c},727:function(t,e){t.exports='<div> <waltz-pie-table data=$ctrl.data config=$ctrl.config class=clickable waltz-jump-to=apps-section icon=desktop title=\"Apps By Lifecycle Phase\"> </waltz-pie-table> </div> '},728:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=s(n(1)),a=n(0),r=n(17),l=n(2),o=s(n(729));function s(t){return t&&t.__esModule?t:{default:t}}var c={apps:[],endUserApps:[]},d={management:\"End User\",kind:\"EUC\",overallRating:\"Z\"};function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return i.default.concat(t,e)}function p(t){var e=(0,a.initialiseData)(this,c),n=function(){e.combinedApps=u(e.apps,e.endUserApps)};e.$onInit=function(){var a=(0,r.mkSelectionOptions)(e.parentEntityRef);t.loadViewData(l.CORE_API.ApplicationStore.findBySelector,[a]).then(function(t){return t.data}).then(function(t){return e.apps=i.default.map(t,function(t){return i.default.assign(t,{management:\"IT\"})})}).then(n),\"ORG_UNIT\"===e.parentEntityRef.kind&&t.loadViewData(l.CORE_API.EndUserAppStore.findBySelector,[a]).then(function(t){return t.data}).then(function(t){return e.endUserApps=i.default.map(t,function(t){return i.default.assign(t,{platform:t.applicationKind},d)})}).then(n)},e.$onChanges=function(){e.combinedApps=u(e.apps,e.endUserApps)},e.onInitialise=function(t){e.export=function(){return t.exportFn(\"apps.csv\")}}}p.$inject=[\"ServiceBroker\"];var f={template:o.default,bindings:{parentEntityRef:\"<\"},controller:p};e.default=f},729:function(t,e){t.exports='<div> <waltz-section-actions> <button class=\"btn btn-xs btn-primary\" ng-if=\"$ctrl.visibility.tab == 2\" ng-click=$ctrl.export()> <waltz-icon name=cloud-download></waltz-icon> Export </button> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.visibility.appOverlay = ! $ctrl.visibility.appOverlay\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.visibility.appOverlay entities=\"[\\'APPLICATION\\', \\'END_USER_APPLICATION\\']\"> </waltz-source-data-overlay> <uib-tabset ng-if=\"$ctrl.combinedApps.length > 0\"> <uib-tab heading=Summary select=\"$ctrl.visibility.tab = 1\"> <waltz-app-summary apps=$ctrl.apps end-user-apps=$ctrl.endUserApps> </waltz-app-summary> </uib-tab> <uib-tab select=\"$ctrl.visibility.tab = 2\" heading=Applications> <br> <div ng-if=\"$ctrl.visibility.tab == 2\"> <waltz-app-table applications=$ctrl.combinedApps on-initialise=$ctrl.onInitialise> </waltz-app-table> </div> </uib-tab> </uib-tabset> <waltz-no-data ng-if=\"$ctrl.combinedApps.length == 0\"> <message> There are <strong>no application </strong> associations. </message> </waltz-no-data> </div> '},730:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=u(n(1)),a=n(151),r=n(0),l=n(19),o=n(107),s=n(108),c=n(88),d=n(29);function u(t){return t&&t.__esModule?t:{default:t}}var p={apps:[],endUserApps:[],visibility:{apps:!1,endUserApps:!1}},f=70,m=function(t){return t.key},v=function(t){return(0,d.getEnumName)(c.lifecyclePhase,t.key)},g=function(t){return t?(0,d.getEnumName)(s.criticality,t.key):t},h=function(t){return(0,d.getEnumName)(o.applicationKind,t.key)},y=function(t){return(0,l.variableScale)(t.data.key)},b=function(t){return(0,l.lifecyclePhaseColorScale)(t.data.key)},w=function(t){return(0,l.criticalityColorScale)(t.data.key)};function A(t,e,n){return{config:{colorProvider:arguments.length>3&&void 0!==arguments[3]?arguments[3]:y,labelProvider:arguments.length>4&&void 0!==arguments[4]?arguments[4]:m,size:n},data:(0,a.tallyBy)(t,e)}}var S={template:u(n(731)).default,controller:function(){var t=i.default.defaultsDeep(this,p);t.$onChanges=function(){t.charts=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{apps:{byLifecyclePhase:A(t,\"lifecyclePhase\",f,b,v),byKind:A(t,\"applicationKind\",f,y,h)},endUserApps:{byLifecyclePhase:A(e,\"lifecyclePhase\",f,b,v),byKind:A(e,\"platform\",f),byRiskRating:A(e,\"riskRating\",f,w,g())}}}(t.apps,t.endUserApps),t.visibility=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{apps:(0,r.notEmpty)(t),endUserApps:(0,r.notEmpty)(e)}}(t.apps,t.endUserApps)}},bindings:{apps:\"<\",endUserApps:\"<\"}};e.default=S},731:function(t,e){t.exports='<div> <div class=row ng-if=$ctrl.visibility.apps> <h4 class=text-center> <waltz-icon name=university></waltz-icon> IT Managed </h4> <div class=col-sm-6> <div> <waltz-pie-table data=$ctrl.charts.apps.byLifecyclePhase.data config=$ctrl.charts.apps.byLifecyclePhase.config title=\"By Lifecycle Phase\"> </waltz-pie-table> </div> </div> <div class=col-sm-6> <div> <waltz-pie-table data=$ctrl.charts.apps.byKind.data config=$ctrl.charts.apps.byKind.config title=\"By Type\"> </waltz-pie-table> </div> </div> </div> <div class=row ng-if=$ctrl.visibility.endUserApps> <h4 class=text-center> <waltz-icon name=user></waltz-icon> End User Managed </h4> <div class=col-sm-4> <div> <waltz-pie-table data=$ctrl.charts.endUserApps.byLifecyclePhase.data config=$ctrl.charts.endUserApps.byLifecyclePhase.config title=\"By Lifecycle Phase\"> </waltz-pie-table> </div> </div> <div class=col-sm-4> <div> <waltz-pie-table data=$ctrl.charts.endUserApps.byKind.data config=$ctrl.charts.endUserApps.byKind.config title=\"By Platform\"> </waltz-pie-table> </div> </div> <div class=col-sm-4> <div> <waltz-pie-table data=$ctrl.charts.endUserApps.byRiskRating.data config=$ctrl.charts.endUserApps.byRiskRating.config title=\"By Risk Rating\"> </waltz-pie-table> </div> </div> </div> </div>'},732:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=l(n(1)),a=n(269),r=l(n(733));function l(t){return t&&t.__esModule?t:{default:t}}var o=[{field:\"name\",cellTemplate:'<div class=\"ui-grid-cell-contents\" \\n                            ng-switch=\"row.entity[\\'management\\']\">\\n                         <span ng-switch-when=\"End User\" \\n                               ng-bind=\"COL_FIELD\"></span>\\n                         <a ng-switch-default\\n                            ui-sref=\"main.app.view ({ id: row.entity[\\'id\\'] })\" \\n                            ng-bind=\"COL_FIELD\">\\n                         </a>\\n                       </div>'},{field:\"assetCode\"},{field:\"kindDisplay\",name:\"Kind\"},{field:\"overallRatingDisplay\",name:\"Overall Rating\"},{field:\"riskRatingDisplay\",name:\"Risk Rating\"},{field:\"businessCriticalityDisplay\",name:\"Business Criticality\"},{field:\"lifecyclePhaseDisplay\",name:\"Lifecycle Phase\"}];function s(){var t=this;t.columnDefs=o,t.$onChanges=function(){return t.gridData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return i.default.map(t||[],function(t){return Object.assign({},t,(0,a.mapToDisplayNames)(t))})}(t.applications)}}s.$inject=[];var c={template:r.default,bindings:{applications:\"<\",onInitialise:\"<\"},controller:s};e.default=c},733:function(t,e){t.exports=\"<div> <div class=row> <div class=col-md-12> <waltz-grid-with-search entries=$ctrl.gridData column-defs=$ctrl.columnDefs on-initialise=$ctrl.onInitialise> </waltz-grid-with-search> </div> </div> </div> \"},734:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=f(n(6)),a=f(n(735)),r=f(n(737)),l=f(n(740)),o=n(7),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(201)),c=f(n(742)),d=f(n(747)),u=f(n(749)),p=f(n(751));function f(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module(\"waltz.app.group\",[]);return t.config(c.default),t.directive(\"waltzAppGroupList\",d.default).directive(\"waltzAppGroupListSection\",u.default).directive(\"waltzAppGroupAppSelectionList\",p.default),(0,o.registerComponents)(t,[a.default,l.default,r.default]),(0,o.registerStores)(t,[s]),t.name}},735:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=d(n(1)),a=n(152),r=n(111),l=d(n(736)),o=n(0),s=n(2),c=n(17);function d(t){return t&&t.__esModule?t:{default:t}}var u={editable:!1,isSubscribed:!1};function p(t,e,n){var l=(0,o.initialiseData)(this,u);l.$onInit=function(){var o=(0,c.mkSelectionOptions)(l.parentEntityRef),d=n.whoami().then(function(t){return l.user=t}),u=e.loadViewData(s.CORE_API.AppGroupStore.getById,[l.parentEntityRef.id]).then(function(t){l.appGroup=t.data.appGroup,l.members=t.data.members,l.owners=i.default.filter(l.members,{role:\"OWNER\"})});t.all([d,u]).then(function(){!function(){var t=function(t){return i.default.chain(t).map(\"userId\").includes(l.user.userName).value()},e=t(l.owners),n=t(l.members);l.subscriptionStatus=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?\"NOT_APPLICABLE\":e?\"SUBSCRIBED\":\"UNSUBSCRIBED\"}(e,n),l.editable=e}()}),e.loadViewData(s.CORE_API.AssetCostStore.findTotalCostForAppSelector,[o]).then(function(t){return l.totalCost=t.data}),e.loadViewData(s.CORE_API.ComplexityStore.findBySelector,[o]).then(function(t){return l.complexitySummary=(0,r.calcComplexitySummary)(t.data)}),e.loadViewData(s.CORE_API.LogicalFlowStore.calculateStats,[o]).then(function(t){return l.flowStats=t.data}),e.loadViewData(s.CORE_API.ApplicationStore.findBySelector,[o]).then(function(t){return l.applications=t.data}),e.loadViewData(s.CORE_API.TechnologyStatisticsService.findBySelector,[o]).then(function(t){return l.enrichedServerStats=(0,a.enrichServerStats)(t.data.serverStats)}),l.onSubscribe=function(){e.execute(s.CORE_API.AppGroupStore.subscribe,[l.parentEntityRef.id]).then(function(t){return l.subscriptionStatus=\"SUBSCRIBED\"})},l.onUnsubscribe=function(){e.execute(s.CORE_API.AppGroupStore.unsubscribe,[l.parentEntityRef.id]).then(function(){return l.subscriptionStatus=\"UNSUBSCRIBED\"})}}}p.$inject=[\"$q\",\"ServiceBroker\",\"UserService\"];var f={controller:p,template:l.default,bindings:{parentEntityRef:\"<\"}};e.default={component:f,id:\"waltzAppGroupSummary\"}},736:function(t,e){t.exports='<div class=\"waltz-page-summary waltz-page-summary-attach\"> <span class=waltz-section-actions ng-if=$ctrl.appGroup> <a ng-if=$ctrl.editable ui-sref=\"main.app-group.edit ({ id:$ctrl.appGroup.id })\" class=\"btn btn-xs btn-primary wsa-action\"> <waltz-icon name=edit></waltz-icon> Edit Group </a> <waltz-subscription-buttons subscription-status=$ctrl.subscriptionStatus on-subscribe=$ctrl.onSubscribe on-unsubscribe=$ctrl.onUnsubscribe> </waltz-subscription-buttons> </span> <div class=row> <div class=col-sm-12> <div ng-if=$ctrl.appGroup> <div style=\"font-size:larger;border-bottom:2px dotted #eee;padding:6px\" class=waltz-paragraph ng-bind=$ctrl.appGroup.description> </div> <div class=row> <div class=col-sm-4> <waltz-apps-by-investment-pie applications=$ctrl.applications size=70> </waltz-apps-by-investment-pie> </div> <div class=col-sm-4> <waltz-apps-by-lifecycle-phase-pie applications=$ctrl.applications size=70> </waltz-apps-by-lifecycle-phase-pie> </div> <div class=col-sm-4> <waltz-basic-info-tile waltz-jump-to=logical-flows-section icon=random name=\"Logical Data Flows\"> <waltz-flow-cloud-diagram width=230 height=180 stats=$ctrl.flowStats> </waltz-flow-cloud-diagram> </waltz-basic-info-tile> </div> </div> <div class=row> <div class=col-sm-4> <waltz-basic-info-tile name=\"Portfolio Cost\" description=\"Cumulative value of infra and app dev costs\" waltz-jump-to=costs-section icon=money> <span style=font-size:x-large> <waltz-currency-amount amount=$ctrl.totalCost.amount simplify=true> </waltz-currency-amount> </span> </waltz-basic-info-tile> </div> <div class=col-sm-4> <waltz-basic-info-tile name=Complexity description=\"Derived from capabilities, connections and servers\" class=clickable waltz-jump-to=complexity-section icon=rocket> <div style=font-size:x-large> &Sigma; <span ng-bind=\"$ctrl.complexitySummary.cumulativeScore | toFixed:1\"></span> </div> <div class=\"small text-muted\"> <span ng-bind=\"$ctrl.complexitySummary.averageScore | toFixed:2\"></span> per app </div> </waltz-basic-info-tile> </div> <div class=col-sm-4> <waltz-basic-info-tile name=Servers class=clickable description=\"Number of servers supporting this group\" waltz-jump-to=servers-section icon=server> <div> <div style=font-size:x-large> # <span ng-bind=$ctrl.enrichedServerStats.total></span> </div> <div class=\"small text-muted\"> <span ng-bind=$ctrl.enrichedServerStats.virtualPercentage></span> % virtual </div> </div> </waltz-basic-info-tile> </div> </div> </div> <waltz-no-data ng-if=!$ctrl.appGroup> <message>No information for this app group</message> </waltz-no-data> </div> </div> <div class=\"small text-muted\" ng-if=\"$ctrl.owners.length > 0\"> &nbsp; <div class=pull-right> <strong>Group Owner/s:</strong> <span ng-repeat=\"owner in $ctrl.owners\"> <span ng-bind=owner.userId></span> &nbsp; </span> </div> </div> </div> '},737:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var l,o=t[Symbol.iterator]();!(i=(l=o.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),a=p(n(1)),r=p(n(738)),l=n(0),o=n(2),s=n(12),c=n(739),d=n(112),u=n(110);function p(t){return t&&t.__esModule?t:{default:t}}var f={edit:\"edit\",view:\"view\"},m={currentlySelectedGroup:null,relationships:[],editable:!1,mode:f.view};function v(t,e,n,r){var p=(0,l.initialiseData)(this,m),v=function(){return function(t,e,n){var r=e.loadViewData(o.CORE_API.EntityRelationshipStore.findForEntity,[n,\"ANY\"],{force:!0}).then(function(t){return t.data}),l=e.loadViewData(o.CORE_API.AppGroupStore.findRelatedByEntityRef,[n],{force:!0}).then(function(t){return a.default.reject(t.data,function(t){return(0,s.sameRef)(t,n)})});return t.all([r,l]).then(function(t){var e=i(t,2),r=e[0],l=e[1],o=a.default.keyBy(l,\"id\");return a.default.chain(r).map(function(t){return(0,s.sameRef)(n,t.a,{skipChecks:!0})?{counterpartRef:t.b,side:\"TARGET\",relationship:t}:{counterpartRef:t.a,side:\"SOURCE\",relationship:t}}).filter(function(t){return\"APP_GROUP\"===t.counterpartRef.kind}).map(function(t){return Object.assign({},t,{counterpart:o[t.counterpartRef.id]})}).filter(function(t){return null!==t.counterpart}).uniqBy(function(t){return t.counterpart.id}).orderBy(\"counterpart.name\").value()})}(t,n,p.parentEntityRef).then(function(t){return p.relationships=t})};p.$onInit=function(){v(),function(t,e,n){switch(n.kind){case\"APP_GROUP\":return(0,c.isGroupOwner)(t,n);case\"CHANGE_INITIATIVE\":return Promise.resolve(!0);case\"ROADMAP\":var i=(0,d.getEditRoleForEntityKind)(\"ROADMAP\");return e.whoami().then(function(t){return e.hasRole(t,i)});default:return Promise.resolve(!1)}}(n,r,p.parentEntityRef).then(function(t){return p.editable=t})},p.groupSelectionFilter=function(t){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=arguments[2],i=e.id;return!a.default.some(t,function(t){return t.counterpart.id===i})&&!(0,s.sameRef)(e,n)}(p.relationships,t,p.parentEntityRef)},p.onRemove=function(t){return n.execute(o.CORE_API.EntityRelationshipStore.remove,[t]).then(function(){e.info(\"Relationship removed\"),v()}).catch(function(t){return e.error(\"Failed to remove! \"+t.message)})},p.onAdd=function(){if(null!==p.currentlySelectedGroup){var t=(0,u.mkRel)(p.parentEntityRef,\"RELATES_TO\",p.currentlySelectedGroup);return n.execute(o.CORE_API.EntityRelationshipStore.create,[t]).then(function(){e.info(\"Relationship created\"),p.currentlySelectedGroup=null,v()}).catch(function(t){return e.error(\"Failed to add! \"+t.message)})}},p.onGroupSelected=function(t){return p.currentlySelectedGroup=t},p.onEdit=function(){return p.mode=f.edit},p.onCancel=function(){return p.mode=f.view}}v.$inject=[\"$q\",\"Notification\",\"ServiceBroker\",\"UserService\"];var g={controller:v,bindings:{parentEntityRef:\"<\"},template:r.default};e.default={id:\"waltzRelatedAppGroupsSection\",component:g}},738:function(t,e){t.exports='<div> <waltz-section-actions ng-if=$ctrl.editable> <button ng-click=$ctrl.onEdit(true) class=\"btn btn-xs btn-primary\" ng-if=\"$ctrl.mode === \\'view\\'\"> Edit </button> <button ng-click=$ctrl.onCancel(true) class=\"btn btn-xs btn-info\" ng-if=\"$ctrl.mode === \\'edit\\'\"> View </button> </waltz-section-actions> <div class=row> <div class=col-md-12> <div ng-if=\"$ctrl.relationships.length > 0\"> <table class=\"table table-condensed small table-hover\"> <colgroup> <col width=35%> <col width=15%> <col width=35%> <col width=15%> </colgroup> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th> <span ng-if=\"$ctrl.mode === \\'edit\\'\"> Actions </span> </th> </tr> </thead> <tbody> <tr ng-repeat=\"rel in $ctrl.relationships\" class=waltz-visibility-parent> <td> <span ng-if=\"$ctrl.mode === \\'edit\\'\"> <span ng-bind=rel.counterpart.name></span> </span> <span ng-if=\"$ctrl.mode === \\'view\\'\"> <a ui-sref=\"main.app-group.view ({id: rel.counterpart.id})\" class=clickable> <span ng-bind=rel.counterpart.name></span> </a> </span> </td> <td> <span ng-bind=\"rel.counterpart.appGroupKind | toDisplayName:\\'appGroupKind\\'\"></span> </td> <td> <span ng-bind=\"rel.counterpart.description | limitTo: 50\"></span> </td> <td> <span ng-if=\"$ctrl.mode === \\'edit\\'\"> <a ng-click=$ctrl.onRemove(rel.relationship) class=\"waltz-visibility-child-30 clickable\"> Remove </a> </span> </td> </tr> </tbody> </table> </div> <div ng-if=\"$ctrl.mode === \\'edit\\'\"> <div class=help-block> Add related app groups by searching for them here. </div> <waltz-entity-selector on-select=$ctrl.onGroupSelected current-selection=$ctrl.currentlySelectedGroup entity-kinds=\"[\\'APP_GROUP\\']\" selection-filter=$ctrl.groupSelectionFilter> </waltz-entity-selector> <a class=\"btn btn-primary\" ng-click=$ctrl.onAdd()> Add </a> </div> <waltz-no-data ng-if=\"$ctrl.relationships.length == 0 && $ctrl.mode == \\'view\\'\"> <message> <strong>No Groups have been associated with this <span ng-bind=\"::$ctrl.parentEntityRef.kind | toDisplayName:\\'entity\\'\"></span> </strong> </message> </waltz-no-data> </div> </div> </div> '},739:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.isGroupOwner=function(t,e){return r(t,e).then(function(t){return a.default.includes(t,\"OWNER\")})},e.determineGroupRoles=r;var i=n(2),a=function(t){return t&&t.__esModule?t:{default:t}}(n(1));function r(t,e){var n=null,r=[],l=t.loadAppData(i.CORE_API.UserStore.whoami).then(function(t){return n=t.data}),o=t.loadViewData(i.CORE_API.AppGroupStore.getById,[e.id]).then(function(t){return r=a.default.get(t,\"data.members\",[])});return l.then(function(){return o}).then(function(){return a.default.chain(r).filter(function(t){return t.userId===n.userName}).map(\"role\").value()})}},740:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(741)),a=n(0);var r={subscriptionStatus:\"NOT_APPLICABLE\"};var l={controller:function(){(0,a.initialiseData)(this,r)},template:i.default,bindings:{subscriptionStatus:\"<\",onSubscribe:\"<\",onUnsubscribe:\"<\"}};e.default={component:l,id:\"waltzSubscriptionButtons\"}},741:function(t,e){t.exports='<span ng-if=\"$ctrl.subscriptionStatus != \\'NOT_APPLICABLE\\'\"> <button ng-if=\"$ctrl.subscriptionStatus === \\'UNSUBSCRIBED\\'\" ng-click=$ctrl.onSubscribe() class=\"btn btn-xs btn-success wsa-action\"> Subscribe </button> <button ng-if=\"$ctrl.subscriptionStatus === \\'SUBSCRIBED\\'\" ng-click=$ctrl.onUnsubscribe() class=\"btn btn-xs btn-warning wsa-action\"> Unsubscribe </button> </span> '},742:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=r(n(743)),a=r(n(745));function r(t){return t&&t.__esModule?t:{default:t}}var l={url:\"app-group\"},o={url:\"/{id:int}\",views:{\"content@\":i.default}},s={url:\"/{id:int}/edit\",views:{\"content@\":a.default}};function c(t){t.state(\"main.app-group\",l).state(\"main.app-group.view\",o).state(\"main.app-group.edit\",s)}c.$inject=[\"$stateProvider\"],e.default=c},743:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=l(n(1)),a=n(2),r=l(n(744));function l(t){return t&&t.__esModule?t:{default:t}}var o={groupDetail:null,sections:[],availableSections:[]};function s(t,e,n,r){var l=t.id,s=Object.assign(this,o);s.entityRef={id:l,kind:\"APP_GROUP\"},s.$onInit=function(){s.availableSections=e.findAvailableSectionsForKind(\"APP_GROUP\"),s.sections=e.findUserSectionsForKind(\"APP_GROUP\"),n.loadViewData(a.CORE_API.AppGroupStore.getById,[l]).then(function(t){s.groupDetail=t.data,s.entityRef=Object.assign({},s.entityRef,{name:s.groupDetail.appGroup.name}),r.put(s.groupDetail.appGroup.name,\"APP_GROUP\",\"main.app-group.view\",{id:l})})},s.addSection=function(t){return s.sections=e.openSection(t,\"APP_GROUP\")},s.removeSection=function(t){return s.sections=e.removeSection(t,\"APP_GROUP\")},s.isGroupEditable=function(){return!!s.groupDetail&&(!!s.user&&i.default.some(s.groupDetail.members,c))};var c=function(t){return\"OWNER\"===t.role&&t.userId===s.user.userName}}s.$inject=[\"$stateParams\",\"DynamicSectionManager\",\"ServiceBroker\",\"HistoryStore\"],e.default={template:r.default,controller:s,controllerAs:\"ctrl\"}},744:function(t,e){t.exports='<div> <waltz-page-header name=\"{{ ctrl.groupDetail.appGroup.name }}\" icon=object-group small=\"{{ ctrl.groupDetail.appGroup.appGroupKind }}\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>App Group</li> <li><span ng-bind=ctrl.groupDetail.appGroup.name></span></li> </ol> </waltz-page-header> <waltz-app-group-summary parent-entity-ref=ctrl.entityRef editable=ctrl.isGroupEditable()> </waltz-app-group-summary> <div class=\"waltz-page-summary waltz-page-summary-attach\" ng-if=ctrl.groupDetail> <waltz-dynamic-section-navigation available-sections=ctrl.availableSections open-sections=ctrl.sections on-select=ctrl.addSection> </waltz-dynamic-section-navigation> </div> <br> <waltz-dynamic-sections-view ng-if=ctrl.groupDetail sections=ctrl.sections parent-entity-ref=ctrl.entityRef on-remove=ctrl.removeSection> </waltz-dynamic-sections-view> </div>'},745:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var l,o=t[Symbol.iterator]();!(i=(l=o.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),a=s(n(1)),r=n(2),l=s(n(746)),o=n(17);function s(t){return t&&t.__esModule?t:{default:t}}var c={changeInitiatives:[],selectedChangeInitiative:null,editor:\"SINGLE\",canDelete:!1,history:[]};function d(t){alert(t.data.message)}function u(t){return{owners:a.default.filter(t,function(t){return\"OWNER\"===t.role}),viewers:a.default.filter(t,function(t){return\"VIEWER\"===t.role})}}function p(t,e,n,l,s,p,f,m,v,g,h){var y=l.id,b=Object.assign(this,c);h.whoami().then(function(t){return b.user=t}),g.loadViewData(r.CORE_API.AppGroupStore.getById,[y]).then(function(t){return function(t){var e=t.applications,n=t.members,i=t.appGroup;return{owners:a.default.filter(n,function(t){return\"OWNER\"===t.role}),viewers:a.default.filter(n,function(t){return\"VIEWER\"===t.role}),applications:e,appGroup:i}}(t.data)}).then(function(t){return Object.assign(b,t)}).then(function(){return h.whoami().then(function(t){var e=a.default.find(b.owners,function(e){return e.userId==t.userName&&\"OWNER\"===e.role});b.canDelete=null!=e})}),b.addToGroup=function(t){g.execute(r.CORE_API.AppGroupStore.addApplication,[y,t.id]).then(function(t){return t.data}).then(function(t){return b.applications=t},function(t){return d(t)}).then(function(){return v.success(\"Added: \"+t.name)})},b.removeFromGroup=function(t){g.execute(r.CORE_API.AppGroupStore.removeApplication,[y,t.id]).then(function(t){return t.data}).then(function(t){return b.applications=t},function(t){return d(t)}).then(function(){return v.warning(\"Removed: \"+t.name)})},b.isAppInGroup=function(t){return a.default.some(b.applications,function(e){return t.id===e.id})},b.promoteToOwner=function(t){g.execute(r.CORE_API.AppGroupStore.addOwner,[t.groupId,t.userId]).then(function(t){return Object.assign(b,u(t.data))}).then(function(){return v.success(\"User: \"+t.userId+\" is now an owner of the group\")})},b.demoteToViewer=function(t){g.execute(r.CORE_API.AppGroupStore.removeOwner,[t.groupId,t.userId]).then(function(t){return Object.assign(b,u(t.data))}).then(function(){return v.success(\"User: \"+t.userId+\" is now an viewer of the group\")})},b.updateGroupOverview=function(){g.execute(r.CORE_API.AppGroupStore.updateGroupOverview,[y,b.appGroup]).then(function(){return v.success(\"Group details updated\")})},b.focusOnApp=function(e){var n={};s.getById(e.id).then(function(e){n.app=e;var i=[s.findRelatedById(e.id),f.findByEntityReference(\"APPLICATION\",e.id),s.findBySelector({entityReference:{id:e.organisationalUnitId,kind:\"ORG_UNIT\"},scope:\"EXACT\"})];return t.all(i)}).then(function(t){var r=i(t,3),l=r[0],o=r[1],s=r[2];n.related=a.default.flatten(a.default.values(l)),n.unitMembers=a.default.reject(s,function(t){return t.id===e.id}),n.upstream=a.default.chain(o).map(function(t){return t.source}).uniqBy(function(t){return t.id}).reject(function(t){return t.id===e.id}).value(),n.downstream=a.default.chain(o).map(function(t){return t.target}).uniqBy(function(t){return t.id}).reject(function(t){return t.id===e.id}).value()}).then(function(){return b.focusApp=n})},b.showSingleEditor=function(){b.editor=\"SINGLE\"},b.showBulkEditor=function(){b.editor=\"BULK\"},b.saveApplications=function(t){var e=a.default.chain(t).filter(function(t){return\"ADD\"===t.action}).map(function(t){return t.entityRef.id}).value(),n=a.default.chain(t).filter(function(t){return\"REMOVE\"===t.action}).map(function(t){return t.entityRef.id}).value();e.length>0&&g.execute(r.CORE_API.AppGroupStore.addApplications,[y,e]).then(function(t){return t.data}).then(function(t){return b.applications=t},function(t){return d(t)}).then(function(){return v.success(\"Added \"+e.length+\" applications\")}),n.length>0&&g.execute(r.CORE_API.AppGroupStore.removeApplications,[y,n]).then(function(t){return t.data}).then(function(t){return b.applications=t},function(t){return d(t)}).then(function(){return v.success(\"Removed \"+n.length+\" applications\")})},b.deleteGroup=function(){confirm(\"Really delete this group ? \\n \"+b.appGroup.name)&&g.execute(r.CORE_API.AppGroupStore.deleteGroup,[y]).then(function(){return v.warning(\"Deleted group: \"+b.appGroup.name)}).then(function(){!function(t,e){if(e){var n=function(t){return{name:t.name,kind:\"APP_GROUP\",state:\"main.app-group.view\",stateParams:{id:t.id}}}(e);t.remove(n.name,n.kind,n.state,n.stateParams)}}(p,b.appGroup),function(t,e){var n=e.getAll()[0];n?t.go(n.state,n.stateParams):t.go(\"main.home\")}(e,p)})},b.searchedApp={},n.$watch(\"ctrl.searchedApp.app\",function(t){a.default.isObject(t)&&(b.addToGroup(t),b.focusOnApp(t))},!0),b.history=m.get(\"history_2\").filter(function(t){return\"APPLICATION\"==t.kind})||[],b.addRecentViewed=function(t){t.id=t.stateParams.id,b.addToGroup(t),b.focusOnApp(t)},n.$watch(\"ctrl.selectedChangeInitiative\",function(t){t&&g.execute(r.CORE_API.AppGroupStore.addChangeInitiative,[y,t.id]).then(function(t){return t.data}).then(function(t){return b.changeInitiatives=t}).then(function(){return v.success(\"Associated Change Initiative: \"+t.name)})}),b.removeChangeInitiative=function(t){return g.execute(r.CORE_API.AppGroupStore.removeChangeInitiative,[y,t.id]).then(function(t){return t.data}).then(function(t){return b.changeInitiatives=t}).then(function(){return v.warning(\"Removed Change Initiative: \"+t.name)})},g.loadViewData(r.CORE_API.ChangeInitiativeStore.findBySelector,[(0,o.mkSelectionOptions)({kind:\"APP_GROUP\",id:y},\"EXACT\")]).then(function(t){return b.changeInitiatives=t.data})}p.$inject=[\"$q\",\"$state\",\"$scope\",\"$stateParams\",\"ApplicationStore\",\"HistoryStore\",\"LogicalFlowStore\",\"localStorageService\",\"Notification\",\"ServiceBroker\",\"UserService\"],e.default={template:l.default,controller:p,controllerAs:\"ctrl\"}},746:function(t,e){t.exports='<div> <waltz-page-header name=\"{{ ctrl.appGroup.name }}\" icon=edit small=Edit> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li> <a ui-sref=\"main.app-group.view ({ id:ctrl.appGroup.id })\"> {{ ctrl.appGroup.name }} </a> </li> <li>Edit</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-section-actions> <div ng-if=ctrl.canDelete> <button class=\"btn btn-xs btn-danger\" ng-click=ctrl.deleteGroup()> Delete </button> </div> </waltz-section-actions> <div class=waltz-paragraph style=\"padding:6px;border-bottom:1px dotted #eee\"> <form class=form ng-submit=ctrl.updateGroupOverview()> <input type=text class=form-control placeholder=\"Name of group\" minlength=2 ng-model=ctrl.appGroup.name> <br> <textarea class=form-control rows=5 ng-model=ctrl.appGroup.description>\\n                </textarea> <div class=radio> <label> <input type=radio ng-model=ctrl.appGroup.appGroupKind value=PRIVATE> Private - (recommended) - limited viewers and the group will not be listed in the search results. </label> </div> <div class=radio> <label> <input type=radio ng-model=ctrl.appGroup.appGroupKind value=PUBLIC> Public - anyone can search for and view this group. </label> </div> <button type=submit class=\"btn btn-success\"> Update </button> </form> </div> </div> <br> <waltz-section icon=paper-plane-o name=\"Associated Change Initiatives\"> <div class=row> <div class=col-md-6> <waltz-no-data ng-if=\"ctrl.changeInitiatives.length == 0\"> <message>No associated Change Initiatives</message> </waltz-no-data> <div ng-if=\"ctrl.changeInitiatives.length > 0\"> <table class=\"table table-condensed table-striped small\"> <thead> <tr> <th>Id</th> <th>Name</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat=\"item in ctrl.changeInitiatives\" class=waltz-visibility-parent> <td><span ng-bind=item.externalId></span></td> <td><span ng-bind=item.name></span></td> <td> <a ng-click=ctrl.removeChangeInitiative(item) href class=waltz-visibility-child-50> <waltz-icon name=trash></waltz-icon> Remove </a> </td> </tr> </tbody> </table> </div> </div> <div class=col-md-6> <span> Use the search box below to find and associate change initiatives to this group. </span> <waltz-change-initiative-selector model=ctrl.selectedChangeInitiative> </waltz-change-initiative-selector> </div> </div> </waltz-section> <waltz-section icon=desktop name=\"Applications In Group\"> <div class=row> <div class=col-md-6> <div ng-if=\"ctrl.applications.length > 0\"> <p class=waltz-paragraph> Current applications within this group, select an application to focus on it and show related apps which you may want to add. </p> <p class=waltz-paragraph> Alternatively you may use the search field to the right to locate an application to add to the group. </p> <div class=waltz-scroll-region style=height:530px> <table class=\"table table-striped table-condensed\"> <thead> <tr> <th>Application</th> <th>Operations</th> </tr> </thead> <tr ng-repeat=\"app in ctrl.applications | orderBy:\\'name\\'\" class=waltz-visibility-parent> <td> <a ng-click=ctrl.focusOnApp(app) class=clickable> {{ app.name }} </a> </td> <td> <span class=waltz-visibility-child-50> <a ng-click=ctrl.removeFromGroup(app) class=clickable> Remove </a> </span> </td> </tr> </table> </div> </div> <waltz-no-data ng-if=\"ctrl.applications.length ==0\"> <message> <waltz-icon name=warning></waltz-icon> <strong>No applications</strong> have been registered to this group yet. Use the search field on the right to start adding applications. </message> </waltz-no-data> </div> <div class=col-md-6> <p class=waltz-paragraph> Use the search box below to locate an application and add it to the group. </p> <uib-tabset> <uib-tab heading=\"Bulk Editor\"> <div style=\"padding:1em 0\"> <span> Once a selection is made related applications will also be shown. </span> <waltz-app-selector model=ctrl.searchedApp> </waltz-app-selector> </div> </uib-tab> <uib-tab heading=\"Single Editor\"> <div style=\"padding:1em 0\"> <waltz-bulk-application-selector existing-refs=ctrl.applications on-save=ctrl.saveApplications> </waltz-bulk-application-selector> </div> </uib-tab> <uib-tab heading=\"Recently Viewed\"> <div style=\"padding:1em 0\"> <ul class=list-unstyled> <li ng-repeat=\"app in ctrl.history\"> <span ng-if=!ctrl.isAppInGroup(app.stateParams) class=clickable ng-click=ctrl.addRecentViewed(app)> <waltz-icon fixed-width=true class=text-muted name=\"{{ app.kind | toIconName:\\'entity\\' }}\"></waltz-icon> <span ng-bind=::app.name></span> </span> <span ng-if=ctrl.isAppInGroup(app.stateParams) class=text-muted> <waltz-icon fixed-width=true name=\"{{ app.kind | toIconName:\\'entity\\' }}\"></waltz-icon> <span ng-bind=::app.name style=text-decoration:line-through></span> </span> </li> <waltz-no-data ng-if=\"ctrl.history.length == 0\"> <message>No information for this person</message> </waltz-no-data> </ul> </div> </uib-tab> </uib-tabset> <div ng-if=ctrl.focusApp> <hr> <h4>Focused on: {{ ctrl.focusApp.app.name }}</h4> <div class=row> <div class=col-sm-6> <h5>Related By Asset Code</h5> <div class=waltz-scroll-region style=height:200px> <waltz-app-group-app-selection-list applications=ctrl.focusApp.related is-member=ctrl.isAppInGroup add=ctrl.addToGroup refocus=ctrl.focusOnApp> </waltz-app-group-app-selection-list> </div> </div> <div class=col-sm-6> <h5> <waltz-icon name=sitemap></waltz-icon> Apps in same Org Unit </h5> <div class=waltz-scroll-region style=height:200px> <waltz-app-group-app-selection-list applications=ctrl.focusApp.unitMembers is-member=ctrl.isAppInGroup add=ctrl.addToGroup refocus=ctrl.focusOnApp> </waltz-app-group-app-selection-list> </div> </div> </div> <div class=row> <div class=col-sm-6> <h5> <waltz-icon name=arrow-up></waltz-icon> Upstream Apps </h5> <div class=waltz-scroll-region style=height:200px> <waltz-app-group-app-selection-list applications=ctrl.focusApp.upstream is-member=ctrl.isAppInGroup add=ctrl.addToGroup refocus=ctrl.focusOnApp> </waltz-app-group-app-selection-list> </div> </div> <div class=col-sm-6> <h5> <waltz-icon name=arrow-down></waltz-icon> Downstream Apps </h5> <div class=waltz-scroll-region style=height:200px> <waltz-app-group-app-selection-list applications=ctrl.focusApp.downstream is-member=ctrl.isAppInGroup add=ctrl.addToGroup refocus=ctrl.focusOnApp> </waltz-app-group-app-selection-list> </div> </div> </div> </div> </div> </div> </waltz-section> <waltz-section icon=users name=\"Group Users\"> <table class=\"table table-condensed table-striped\"> <thead> <tr> <th>Owners</th> <th>Operations</th> </tr> </thead> <tr ng-repeat=\"owner in ctrl.owners | orderBy:\\'userId\\'\"> <td><span ng-bind=owner.userId></span></td> <td> <div class=waltz-visibility-child-50 ng-if=\"owner.userId != ctrl.user.userName\"> <a ng-click=ctrl.demoteToViewer(owner) class=clickable> Demote to subscribers </a> </div> </td> </tr> </table> <div class=\"waltz-paragraph text-muted\"> <strong>Owners</strong> can add and remove applications from a group. They may also promote other subscribers to be co-owners. </div> <div ng-if=\"ctrl.viewers.length > 0\"> <hr> <br> <table class=\"table table-condensed table-striped\"> <thead> <tr> <th>Subscribers</th> <th>Operations</th> </tr> </thead> <tr ng-repeat=\"viewer in ctrl.viewers | orderBy:\\'userId\\'\" class=waltz-visibility-parent> <td> <span ng-bind=viewer.userId></span> </td> <td> <div class=waltz-visibility-child-50> <a ng-click=ctrl.promoteToOwner(viewer) class=clickable> Promote to owner </a> </div> </td> </tr> </table> <div class=\"waltz-paragraph text-muted\"> <strong>Subscribers</strong> may only view the group. </div> </div> </waltz-section> </div>'},747:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(748));var a={groupSubscriptions:\"=\",editing:\"=\",unsubscribe:\"=\",deleteGroup:\"=\"};function r(){}r.$inject=[],e.default=function(){return{restrict:\"E\",replace:!0,template:i.default,scope:{},bindToController:a,controllerAs:\"ctrl\",controller:r}}},748:function(t,e){t.exports='<span> <table class=\"table table-condensed table-bordered\"> <colgroup> <col width=80%> <col width=20%> </colgroup> <tr ng-repeat=\"subscription in ctrl.groupSubscriptions | orderBy:\\'appGroup.name\\'\"> <td> <div> <strong> <a ui-sref=\"main.app-group.view ({ id: subscription.appGroup.id })\"> {{ subscription.appGroup.name }} </a> <small>{{ subscription.appGroup.kind }}</small> </strong> </div> <div> <small>{{ subscription.appGroup.description }}</small> </div> </td> <td ng-if=ctrl.editing> <small style=text-align:right> <ul class=list-unstyled> <li ng-if=\"subscription.role == \\'OWNER\\'\"> <a class=clickable ng-click=ctrl.deleteGroup(subscription)> Delete <waltz-icon name=trash></waltz-icon> </a> </li> <li ng-if=\"subscription.role == \\'VIEWER\\'\"> <a class=clickable ng-click=ctrl.unsubscribe(subscription)> Unsubscribe <waltz-icon name=minus-circle></waltz-icon> </a> </li> <li ng-if=\"subscription.role == \\'OWNER\\'\"> <a ui-sref=\"main.app-group.edit ({ id:subscription.appGroup.id })\"> Edit <waltz-icon name=edit></waltz-icon> </a> </li> </ul> </small> </td> </tr> </table> </span>'},749:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=r(n(1)),a=r(n(750));function r(t){return t&&t.__esModule?t:{default:t}}var l={groupSubscriptions:\"=\"};function o(t,e,n,a){function r(){t.findPublicGroups().then(function(t){return function(t,e){var n=i.default.map(e,\"appGroup.id\");return i.default.reject(t,function(t){return i.default.includes(n,t.id)})}(t,l.groupSubscriptions)}).then(function(t){return l.availableGroups=t})}var l=this;l.availableGroups=[],l.editing=!1,l.toggleEditing=function(){l.editing=!l.editing,l.editing&&r()},l.createNewGroup=function(){t.createNewGroup().then(function(t){e.success(\"New group created\"),a.go(\"main.app-group.edit\",{id:t})})},l.unsubscribe=function(n){(function(e){return t.unsubscribe(e.appGroup.id)})(n).then(function(t){return l.groupSubscriptions=t}).then(function(){return e.warning(\"Unsubscribed from: \"+n.appGroup.name)})},l.deleteGroup=function(n){confirm(\"Really delete this group ? \\n \"+n.appGroup.name)&&t.deleteGroup(n.appGroup.id).then(function(t){return l.groupSubscriptions=t}).then(function(){return e.warning(\"Deleted group: \"+n.appGroup.name)})},n.$watch(\"ctrl.selectedPublicGroup\",function(n){n&&i.default.isObject(n)&&function(e){return t.subscribe(e.id)}(n).then(function(t){return l.groupSubscriptions=t}).then(function(){return e.success(\"Subscribed to: \"+n.name)}).then(function(){return l.selectedPublicGroup=null})})}o.$inject=[\"AppGroupStore\",\"Notification\",\"$scope\",\"$state\"],e.default=function(){return{restrict:\"E\",replace:!0,template:a.default,scope:{},bindToController:l,controllerAs:\"ctrl\",controller:o}}},750:function(t,e){t.exports='<div> <waltz-section icon=object-group name=\"Application Groups\" id=application-groups-section> <waltz-app-group-list group-subscriptions=ctrl.groupSubscriptions editing=ctrl.editing delete-group=ctrl.deleteGroup unsubscribe=ctrl.unsubscribe> </waltz-app-group-list> <div ng-if=!ctrl.editing class=\"small waltz-paragraph text-muted\"> Application groups are used to create ad-hoc views over a specified subset of applications within the organisation. You can create groups and assign applications to them. These groups are private by default. </div> <div ng-if=ctrl.editing> <strong>Modify groups</strong> <div class=waltz-paragraph> To add more groups you may either subscribe to an existing public group or create a new one. </div> <input type=text ng-model=ctrl.selectedPublicGroup placeholder=\"Search for public group\" uib-typeahead=\"group as group.name for group in ctrl.availableGroups | filter:{name:$viewValue}\" typeahead-template-url=app-group-list-section/app-group-search-result.html class=form-control typeahead-show-hint=true typeahead-min-length=0> <div class=waltz-paragraph> ...or <a class=clickable ng-click=ctrl.createNewGroup()> create a new group </a> </div> </div> <span class=\"pull-right small\"> <a ng-click=ctrl.toggleEditing() class=clickable> <span ng-if=\"! ctrl.editing\"> Edit <waltz-icon name=plus-circle></waltz-icon> </span> <span ng-if=ctrl.editing> Cancel &#10006; </span> </a> </span> </waltz-section> <script type=text/ng-template id=app-group-list-section/app-group-search-result.html> <a style=\"padding-left: 6px\">\\n            <span ng-bind-html=\"match.label | uibTypeaheadHighlight:query\"></span>\\n            <span class=\"small no-overflow\">\\n                -\\n                <span ng-bind=\"match.model.description | limitTo:100\"></span>\\n            </span>\\n        </a> <\\/script> </div>'},751:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(752));var a={applications:\"=\",isMember:\"=\",refocus:\"=\",add:\"=\"};function r(){}r.$inject=[],e.default=function(){return{restrict:\"E\",replace:!0,template:i.default,scope:{},bindToController:a,controllerAs:\"ctrl\",controller:r}}},752:function(t,e){t.exports='<div> <ul> <li ng-repeat=\"app in ctrl.applications | orderBy:\\'name\\'\"> <span ng-if=ctrl.isMember(app)> <span class=text-muted style=text-decoration:line-through> {{ app.name }} </span> <small> <a class=clickable ng-click=ctrl.refocus(app) title=Re-focus> (&raquo;) </a> </small> </span> <span ng-if=!ctrl.isMember(app)> <a ng-click=ctrl.add(app) class=clickable> {{ app.name }} </a> <small> <a class=clickable ng-click=\"ctrl.add(app); ctrl.refocus(app)\" title=\"Add and re-focus\"> (&raquo;) </a> </small> </span> </li> </ul> </div>'},753:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=s(n(754)),a=n(7),r=s(n(755)),l=s(n(757)),o=s(n(759));function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=angular.module(\"waltz.assessments\",[]);return(0,i.default)(t),(0,a.registerComponents)(t,[r.default,l.default,o.default]),t.name}},754:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(7),a=l(n(203)),r=l(n(204));function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.default=function(t){(0,i.registerStores)(t,[a,r])}},755:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var l,o=t[Symbol.iterator]();!(i=(l=o.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),a=n(2),r=n(0),l=n(270),o=function(t){return t&&t.__esModule?t:{default:t}}(n(756));var s={assessmentDefinitions:[],assessmentRatings:[],ratingSchemes:[]};function c(t,e){var n=(0,r.initialiseData)(this,s),o=function(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=e.loadViewData(a.CORE_API.AssessmentDefinitionStore.findByKind,[n.parentEntityRef.kind]),s=e.loadViewData(a.CORE_API.AssessmentRatingStore.findForEntityReference,[n.parentEntityRef],{force:r}),c=e.loadViewData(a.CORE_API.RatingSchemeStore.findAll);t.all([o,s,c]).then(function(t){var e=i(t,3),n=e[0],a=e[1],r=e[2];return[n.data,a.data,r.data]}).then(function(t){var e=i(t,3),a=e[0],r=e[1],o=e[2];n.assessmentDefinitions=a,n.assessmentRatings=r,n.ratingSchemes=o,n.enrichedAssessmentDefinitions=(0,l.mkEnrichedAssessmentDefinitions)(n.assessmentDefinitions,n.ratingSchemes,n.assessmentRatings)})};n.$onInit=function(){o()},n.onRatingEdit=function(t,i,r){var l=r.rating?a.CORE_API.AssessmentRatingStore.update:a.CORE_API.AssessmentRatingStore.create;return e.execute(l,[n.parentEntityRef,r.id,t,i]).then(function(){return o(!0)})},n.onRatingRemove=function(t){return console.log(\"REMOVING VALUE\",t),e.execute(a.CORE_API.AssessmentRatingStore.remove,[n.parentEntityRef,t.id]).then(function(){return o(!0)})}}c.$inject=[\"$q\",\"ServiceBroker\"];var d={template:o.default,bindings:{parentEntityRef:\"<\"},controller:c};e.default={component:d,id:\"waltzAssessmentRatingEditor\"}},756:function(t,e){t.exports='<div class=waltz-assessment-rating-editor> <div class=row> <div class=col-md-12> <table class=\"waltz-field-table waltz-field-table-border\" style=width:100%> <colgroup> <col width=30%> <col width=70%> </colgroup> <tr ng-repeat=\"def in $ctrl.enrichedAssessmentDefinitions\"> <td class=wft-label> <span ng-bind=def.name></span> <span ng-if=def.externalId> (<span ng-bind=def.externalId> </span>) </span> </td> <td valign=top> <span ng-if=\"def.isReadOnly === false\"> <waltz-editable-dropdown initial-val=def.rating.ratingId entries=def.dropdownEntries comments-allowed=true initial-comments=def.rating.description on-save=$ctrl.onRatingEdit on-remove=$ctrl.onRatingRemove edit-role=\"{{ def.permittedRole }}\" ctx=def> </waltz-editable-dropdown> </span> <span ng-if=def.isReadOnly> <span ng-bind=def.ratingItem.name> </span> <span class=\"text-muted small\" uib-popover=\"This assessment is read only and cannot be edited\" popover-trigger=mouseenter> (read only) </span> <span ng-if=def.rating.description> <br> <span class=\"small text-muted\" style=padding-left:22px ng-bind=\"def.rating.description | limitTo: 30\"> </span> <span ng-if=\"def.rating.description.length > 30\"> ... </span> </span> </span>  </td> </tr> </table> </div> </div> </div>'},757:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var l,o=t[Symbol.iterator]();!(i=(l=o.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),a=n(2),r=n(0),l=n(270),o=function(t){return t&&t.__esModule?t:{default:t}}(n(758));var s={assessmentDefinitions:[],assessmentRatings:[],ratingSchemes:[]};function c(t,e){var n=(0,r.initialiseData)(this,s);n.$onInit=function(){var r=e.loadViewData(a.CORE_API.AssessmentDefinitionStore.findByKind,[n.parentEntityRef.kind]),o=e.loadViewData(a.CORE_API.AssessmentRatingStore.findForEntityReference,[n.parentEntityRef]),s=e.loadViewData(a.CORE_API.RatingSchemeStore.findAll);t.all([r,o,s]).then(function(t){var e=i(t,3),n=e[0],a=e[1],r=e[2];return[n.data,a.data,r.data]}).then(function(t){var e=i(t,3),a=e[0],r=e[1],o=e[2];n.assessmentDefinitions=a,n.assessmentRatings=r,n.ratingSchemes=o,n.enrichedAssessmentDefinitions=(0,l.mkEnrichedAssessmentDefinitions)(n.assessmentDefinitions,n.ratingSchemes,n.assessmentRatings)})}}c.$inject=[\"$q\",\"ServiceBroker\"];var d={template:o.default,bindings:{parentEntityRef:\"<\"},controller:c};e.default={component:d,id:\"waltzAssessmentRatingPanel\"}},758:function(t,e){t.exports='<div class=waltz-assessment-rating-panel> <div class=row> <div class=col-md-12> <waltz-no-data ng-if=\"$ctrl.enrichedAssessmentDefinitions.length === 0\"> <message> <strong> No Assessments Found </strong> </message> </waltz-no-data> <div ng-if=\"$ctrl.enrichedAssessmentDefinitions.length > 0\" ng-class=\"{ \\'waltz-scroll-region-200\\' : $ctrl.enrichedAssessmentDefinitions.length > 7}\"> <table class=\"waltz-field-table waltz-field-table-border\" style=width:100%> <colgroup> <col width=30%> <col width=70%> </colgroup> <tbody> <tr ng-repeat=\"def in $ctrl.enrichedAssessmentDefinitions\"> <td class=wft-label> <span uib-popover-template=\"\\'arp-desc-popover.html\\'\" popover-placement=right popover-trigger=mouseenter popover-popup-delay=300 popover-append-to-body=true> <span ng-bind=def.name></span> <span class=\"small text-muted\" ng-if=def.externalId> (<span ng-bind=def.externalId> </span>) </span> </span> </td> <td valign=top> <span ng-if=def.rating uib-popover-template=\"\\'arp-popover.html\\'\" popover-placement=right popover-trigger=mouseenter popover-popup-delay=300 popover-append-to-body=true> <waltz-rating-indicator-cell rating=def.ratingItem> </waltz-rating-indicator-cell> <span ng-bind=def.ratingItem.name> </span> <span ng-if=def.rating.description> <br> <span class=\"small text-muted\" style=padding-left:22px ng-bind=\"def.rating.description | limitTo: 30\"> </span> <span ng-if=\"def.rating.description.length > 30\"> ... </span> </span> </span> <span ng-if=!def.rating> Not Provided </span> </td> </tr> </tbody> </table> </div> </div> </div> </div> <script type=text/ng-template id=arp-popover.html> <div>\\n        <div>\\n            <div>\\n                <strong ng-bind=\"def.ratingItem.name\"></strong>\\n            </div>\\n            <span ng-bind=\"def.rating.description\"\\n                   class=\"text-muted\">\\n            </span>\\n        </div>\\n\\n        <br>\\n\\n        <div class=\"small\">\\n            <waltz-last-updated entity=\"def.rating\">\\n            </waltz-last-updated>\\n        </div>\\n    </div> <\\/script> <script type=text/ng-template id=arp-desc-popover.html> <div>\\n        <div>\\n            <div>\\n                <strong ng-bind=\"def.name\"></strong>\\n                <span class=\"small text-muted\"\\n                      ng-if=\"def.externalId\">\\n                    (<span ng-bind=\"def.externalId\"> </span>)\\n                </span>\\n            </div>\\n            <div ng-bind=\"def.description\"\\n                  class=\"text-muted\">\\n            </div>\\n        </div>\\n    </div> <\\/script>'},759:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0),a=o(n(760)),r=n(2),l=o(n(1));function o(t){return t&&t.__esModule?t:{default:t}}var s={visibility:{editor:!1,editBtn:!1}};function c(t){var e=(0,i.initialiseData)(this,s);e.$onInit=function(){t.loadAppData(r.CORE_API.AssessmentDefinitionStore.findByKind,[e.parentEntityRef.kind]).then(function(t){var n=(t.data||[]).length>0,i=l.default.every(t.data,function(t){return t.isReadOnly});e.visibility.editBtn=n&&!i})}}c.$inject=[\"ServiceBroker\"];var d={template:a.default,bindings:{parentEntityRef:\"<\"},controller:c};e.default={component:d,id:\"waltzAssessmentRatingSubSection\"}},760:function(t,e){t.exports='<waltz-sub-section name=Assessments> <content> <div class=waltz-sub-section-content> <div ng-if=\"! $ctrl.visibility.editor\" class=waltz-highlight-if> <waltz-assessment-rating-panel parent-entity-ref=$ctrl.parentEntityRef> </waltz-assessment-rating-panel> </div> <div ng-if=$ctrl.visibility.editor class=waltz-highlight-if> <waltz-assessment-rating-editor parent-entity-ref=$ctrl.parentEntityRef> </waltz-assessment-rating-editor> </div> </div> <div class=waltz-sub-section-controls ng-if=$ctrl.visibility.editBtn> <span> <a ng-click=\"$ctrl.visibility.editor = true\" ng-if=\"! $ctrl.visibility.editor\" class=clickable> Edit </a> <a ng-click=\"$ctrl.visibility.editor = false\" ng-if=$ctrl.visibility.editor class=clickable> Done </a> </span> </div> </content> </waltz-sub-section>'},761:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=c(n(6)),a=n(7),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(207)),l=c(n(762)),o=c(n(764)),s=c(n(765));function c(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module(\"waltz.asset.cost\",[]);return(0,a.registerStores)(t,[r]),(0,a.registerComponents)(t,[l.default,o.default,s.default]),t.name}},762:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=s(n(1)),a=n(0),r=n(2),l=s(n(763)),o=n(17);function s(t){return t&&t.__esModule?t:{default:t}}var c={scope:\"CHILDREN\",csvName:\"asset-costs.csv\",visibility:{summary:!0,detail:!1}};function d(t,e){var n=(0,a.initialiseData)(this,c);n.onSummarySelect=function(t){return n.summarySelection=function(t,e){if(!e)return null;var n=i.default.map(e.costs,function(e,n){return{type:t.lookup(\"CostKind\",n)||n,amount:e}});return Object.assign({},e,{costTable:n})}(e,t)},n.showSummary=function(){n.visibility.summary=!0,n.visibility.detail=!1},n.showDetail=function(){n.visibility.summary=!1,n.visibility.detail=!0,t.loadViewData(r.CORE_API.AssetCostStore.findAppCostsByAppIdSelector,[(0,o.mkSelectionOptions)(n.parentEntityRef)]).then(function(t){return n.allCosts=t.data})},n.$onInit=function(){t.loadViewData(r.CORE_API.AssetCostStore.findTopAppCostsByAppIdSelector,[(0,o.mkSelectionOptions)(n.parentEntityRef)]).then(function(t){return n.topCosts=t.data})}}d.$inject=[\"ServiceBroker\",\"DisplayNameService\"];var u={template:l.default,bindings:{parentEntityRef:\"<\",csvName:\"@?\"},controller:d};e.default={component:u,id:\"waltzAssetCostsSection\"}},763:function(t,e){t.exports='<div> <waltz-section-actions> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.sourceDataOverlay = ! $ctrl.sourceDataOverlay\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.sourceDataOverlay entities=\"[\\'ASSET_COST\\']\"> </waltz-source-data-overlay> <div ng-if=\"$ctrl.topCosts.length === 0\"> <waltz-no-data> <message> <strong>No associated costs found.</strong> </message> </waltz-no-data> </div> <div class=row> <div class=col-sm-12> <uib-tabset ng-if=\"$ctrl.topCosts.length > 0\"> <uib-tab select=$ctrl.showSummary()> <uib-tab-heading> Top 10 </uib-tab-heading> <br> <div class=row> <div class=col-sm-9> <div ng-if=$ctrl.visibility.summary> <waltz-asset-costs-graph costs=$ctrl.topCosts style=width:95% on-select=$ctrl.onSummarySelect> </waltz-asset-costs-graph> </div> </div> <div class=col-sm-3 style=\"border-left:1px solid #eee\"> <div ng-if=\"! $ctrl.summarySelection\" class=waltz-fade-if> <waltz-static-panels group-key=SECTION.ASSET_COSTS.ABOUT class=small render-mode=minimal-border> </waltz-static-panels> </div> <div ng-if=$ctrl.summarySelection class=waltz-fade-if> <h5> <a class=clickable title=\"Go to application\" ui-sref=\"main.app.view ({ id: $ctrl.summarySelection.entityRef.id })\"> <span ng-bind=$ctrl.summarySelection.entityRef.name></span> </a> <a class=clickable title=Dismiss ng-click=\"$ctrl.summarySelection = null\"> <span class=pull-right>x</span> </a> </h5> <hr> <table class=\"table table-condensed table-striped small\"> <thead> <tr> <th>Type</th> <th> <div align=right> Amount </div> </th> </tr> </thead> <tbody> <tr ng-repeat=\"row in $ctrl.summarySelection.costTable | orderBy:\\'type\\'\"> <td> <span ng-bind=row.type></span> </td> <td align=right> <waltz-currency-amount amount=row.amount> </waltz-currency-amount> </td> </tr> <tr> <td> <strong>Total</strong> </td> <td align=right> <waltz-currency-amount amount=$ctrl.summarySelection.total> </waltz-currency-amount> </td> </tr> </tbody> </table> </div> </div> </div> </uib-tab> <uib-tab select=$ctrl.showDetail()> <uib-tab-heading> All Data </uib-tab-heading> <br> <div ng-if=$ctrl.visibility.detail> <div ng-if=\"$ctrl.allCosts.length > 0\"> <waltz-asset-cost-table options=\"{\\n                                                        showAppName: true,\\n                                                        showAssetCode: false\\n                                                    }\" csv-name=\"{{ $ctrl.csvName }}\" costs=$ctrl.allCosts> </waltz-asset-cost-table> </div> </div> </uib-tab> </uib-tabset> </div> </div> </div> '},764:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0),a=n(44),r=f(n(1)),l=n(30),o=n(5),s=n(14),c=n(90),d=n(47);n(45);var u=f(n(89)),p=n(271);function f(t){return t&&t.__esModule?t:{default:t}}var m={costs:[],onHover:r.default.identity,onSelect:r.default.identity},v=\"#F6F9EC\",g=\"#B3C95A\",h={graph:{width:600},margin:{top:0,left:150,right:50,bottom:50},circleSize:24};function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.default.identity,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.default.identity,a=arguments[4],o=(0,s.extent)(e,function(t){return t.total}),d=(0,l.scaleLinear)().range([0,h.graph.width-h.margin.left-h.margin.right]).domain([0,o[1]]),u=(0,l.scaleBand)().domain(r.default.map(e,function(t){return t.entityRef.name})).range([0,h.graph.height-(h.margin.top+h.margin.bottom)]).padding(.2),p=(0,l.scaleLinear)().domain(o).range([v,g]),f=t.append(\"g\").attr(\"transform\",\"translate(\"+h.margin.left+\",\"+h.margin.top+\")\"),m=f.selectAll(\".wacg-bar\").data(e,function(t){return t.entityRef.id}).enter().append(\"g\").classed(\"wacg-bar\",!0).attr(\"transform\",function(t,e){return\"translate(0, \"+u(t.entityRef.name)+\")\"}).on(\"mouseenter.hover\",function(t){return n(t)}).on(\"mouseleave.hover\",function(t){return n(null)}).on(\"click.select\",function(t){return i(t)});m.append(\"rect\").attr(\"x\",0).attr(\"y\",0).attr(\"width\",function(t){return d(t.total)}).attr(\"height\",u.bandwidth()).attr(\"fill\",function(t,e){return p(t.total)}),m.append(\"text\").attr(\"x\",10).attr(\"y\",u.bandwidth()/2+3).text(function(t){return a(t.total)}),function(t,e,n){var i=(0,c.axisBottom)(t).tickFormat(n).ticks(5);e.append(\"g\").attr(\"transform\",\"translate(0, \"+(h.graph.height-(h.margin.top+h.margin.bottom))+\")\").call(i)}(d,f,a),function(t,e){var n=(0,c.axisLeft)(t);e.append(\"g\").attr(\"transform\",\"translate(\"+h.margin.left+\", \"+h.margin.top+\")\").call(n)}(u,t)}function b(t,e,n){var l=(0,i.initialiseData)(this,m),s=t.find(\"div\")[0],c=(0,o.select)(s).append(\"svg\").attr(\"id\",\"waltz-asset-costs-graph\"),f=function(){},v=null,g=function(){if(!(0,i.isEmpty)(l.costs)&&v){var t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return r.default.chain(t).reduce(function(t,e){var n=t[e.application.id]||{total:0,entityRef:e.application,costs:{}};return n.costs[e.cost.costKind]=e.cost.amount,n.total+=e.cost.amount,t[e.application.id]=n,t},{}).values().orderBy(\"total\",\"desc\").value()}(l.costs);h.graph.height=100+20*t.length,c.attr(\"width\",h.graph.width).attr(\"height\",h.graph.height).attr(\"viewbox\",\"0 0 \"+h.graph.width+\" \"+h.graph.height),y(c,t,function(t){return e.$applyAsync(function(){return l.onHover(t)})},function(t){return e.$applyAsync(function(){return l.onSelect(t)})},v),f(),e.$applyAsync(function(){return f=(0,a.responsivefy)(c,\"width-only\")})}};l.$onDestroy=function(){return f()},l.$onInit=function(){n.findOrDefault(u.default.defaultCurrency,\"EUR\").then(function(t){var e=p.currenciesByCode[t];v=function(t){return\"\"+e.symbol+(0,d.format)(\",d\")(t)},g()})},l.$onChanges=g}b.$inject=[\"$element\",\"$scope\",\"SettingsService\"];var w={bindings:{costs:\"<\",onHover:\"<\",onSelect:\"<\"},template:\"<div class='waltz-asset-costs-graph'></div>\",controller:b};e.default={component:w,id:\"waltzAssetCostsGraph\"}},765:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(n(1)),a=n(27),r=n(0),l=o(n(766));function o(t){return t&&t.__esModule?t:{default:t}}var s={columnDefs:[],options:{showAssetCode:!0,showAppName:!1}};function c(t,e){return function(t,e){var n=[e.showAssetCode?t.assetCodeCol:null,e.showAppName?t.appCol:null,t.yearCol,t.kindCol,t.amountCol];return i.default.compact(n)}({kindCol:{field:\"cost.costKind\",displayName:\"Cost Type\",cellFilter:'toDisplayName:\"CostKind\"'},amountCol:{field:\"cost.amount\",displayName:\"Amount\",cellClass:\"waltz-grid-currency\",cellTemplate:'\\n            <div class=\"ui-grid-cell-contents\">\\n                <waltz-currency-amount amount=\"COL_FIELD\">\\n                </waltz-currency-amount>\\n            </div>',filters:[{condition:t.filter.GREATER_THAN,placeholder:\"Greater than\"},{condition:t.filter.LESS_THAN,placeholder:\"Less than\"}]},yearCol:{field:\"cost.year\",displayName:\"Year\"},appCol:(0,a.mkEntityLinkGridCell)(\"Application\",\"application\",\"none\"),assetCodeCol:{field:\"assetCode\"}},e)}function d(t){var e=(0,r.initialiseData)(this,s);e.$onChanges=function(){e.costs&&(e.columnDefs=c(t,e.options))},e.onGridInitialise=function(t){e.gridExportFn=t.exportFn},e.exportAssetCosts=function(){e.gridExportFn(e.csvName)}}d.$inject=[\"uiGridConstants\"];var u={controller:d,template:l.default,bindings:{costs:\"<\",options:\"<?\",csvName:\"@?\"}};e.default={component:u,id:\"waltzAssetCostTable\"}},766:function(t,e){t.exports='<div> <waltz-grid-with-search entries=$ctrl.costs column-defs=$ctrl.columnDefs on-initialise=$ctrl.onGridInitialise> </waltz-grid-with-search> <div class=pull-right style=margin-bottom:4px> <a class=\"clickable waltz-visibility-child-30\" ng-click=$ctrl.exportAssetCosts()> <waltz-icon name=download></waltz-icon> Export asset costs </a> </div> </div> '},767:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=g(n(6)),a=n(7),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(205)),l=g(n(206)),o=g(n(768)),s=g(n(770)),c=g(n(772)),d=g(n(774)),u=g(n(776)),p=g(n(778)),f=g(n(780)),m=g(n(782)),v=g(n(784));function g(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module(\"waltz.attestation\",[]);return t.config(v.default),(0,a.registerStores)(t,[r,l.default]),(0,a.registerComponents)(t,[o.default,s.default,c.default,d.default,u.default,p.default,f.default,m.default]),t.name}},768:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(n(769));var r={onConfirm:function(t){return console.log(\"default onConfirm handler for attestation-confirmation: \"+instance)},onCancel:function(){return console.log(\"default onCancel handler for attestation-confirmation\")}};function l(){var t=(0,i.initialiseData)(this,r);t.confirm=function(e){(0,i.invokeFunction)(t.onConfirm,e)},t.cancel=function(){(0,i.invokeFunction)(t.onCancel)}}l.$inject=[];var o={template:a.default,bindings:{instance:\"<\",run:\"<\",attestedEntityRef:\"<?\",onConfirm:\"<\",onCancel:\"<\"},controller:l,transclude:!0};e.default={component:o,id:\"waltzAttestationConfirmation\"}},769:function(t,e){t.exports='<div class=waltz-attestation-confirmation> <div class=wac-header> <span class=wac-declaration> You are attesting that the <waltz-attested-kind run=$ctrl.run class=wac-entity> </waltz-attested-kind> for <span ng-bind=$ctrl.instance.parentEntity.name class=wac-entity> </span> are correct. </span> <span style=padding-left:30px> <a class=\"btn btn-success btn-sm\" ng-click=$ctrl.confirm($ctrl.instance)> Confirm </a> <a ng-click=$ctrl.cancel() class=clickable> Cancel </a> </span> </div> <div class=wac-content> <ng-transclude></ng-transclude> </div> </div>'},770:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(771));function a(){}a.$inject=[];var r={template:i.default,bindings:{run:\"<\"},controller:a};e.default={component:r,id:\"waltzAttestedKind\"}},771:function(t,e){t.exports='<span> <span ng-if=$ctrl.run.attestedEntityRef> <span ng-bind=$ctrl.run.attestedEntityRef.name> </span> <span ng-bind=\"$ctrl.run.attestedEntityRef.kind | toDisplayName:\\'entity\\'\"> </span>s </span> <span ng-if=\"!$ctrl.run.attestedEntityRef && $ctrl.run.attestedEntityKind\"> <span ng-bind=\"$ctrl.run.attestedEntityKind | toDisplayName:\\'entity\\'\"> </span>s </span> </span>'},772:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(2),a=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n(773));var l={issuedByRef:null};function o(t){var e=(0,a.initialiseData)(this,l);e.$onChanges=function(n){e.run&&t.loadViewData(i.CORE_API.PersonStore.findByUserId,[e.run.issuedBy]).then(function(t){e.issuedByRef=function(t){return t?{id:t.id,name:t.displayName,kind:\"PERSON\"}:t}(t.data)})},e.getFriendlyScope=function(t){switch(t){case\"EXACT\":return\"only\";case\"PARENTS\":return\"and it's parents\";case\"CHILDREN\":return\"and it's children\";default:throw\"Unrecognised scope: \"+t}}}o.$inject=[\"ServiceBroker\"];var s={template:r.default,bindings:{run:\"<\"},controller:o};e.default={component:s,id:\"waltzAttestationRunOverview\"}},773:function(t,e){t.exports='<div ng-if=$ctrl.run> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Run Name </div> <div class=col-sm-4> <span ng-bind=$ctrl.run.name></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Attested Kind </div> <div class=col-sm-4> <waltz-attested-kind run=$ctrl.run></waltz-attested-kind> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Description </div> <div class=col-sm-10> <waltz-markdown text=$ctrl.run.description> </waltz-markdown> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Scope </div> <div class=col-sm-4> <span ng-bind=\"$ctrl.run.targetEntityKind | toDisplayName:\\'entity\\'\"></span>s within <waltz-entity-link entity-ref=$ctrl.run.selectionOptions.entityReference></waltz-entity-link> <span ng-bind=$ctrl.getFriendlyScope($ctrl.run.selectionOptions.scope)></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Issued by </div> <div class=col-sm-4> <waltz-entity-link entity-ref=$ctrl.issuedByRef> </waltz-entity-link> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Due date </div> <div class=col-sm-4> <span ng-bind=$ctrl.run.dueDate></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Issued on </div> <div class=col-sm-4> <span ng-bind=$ctrl.run.issuedOn></span> </div> </div> </div>'},774:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(n(1)),a=n(2),r=n(0),l=o(n(775));function o(t){return t&&t.__esModule?t:{default:t}}var s={recipientReferences:[],visibility:{loading:!1}};function c(t){return t?{id:t.id,name:t.displayName,kind:\"PERSON\"}:t}function d(t){var e=(0,r.initialiseData)(this,s);e.$onChanges=function(n){e.instance&&(e.recipientReferences=[],e.visibility.loading=!0,t.loadViewData(a.CORE_API.AttestationInstanceStore.findPersonsById,[e.instance.id]).then(function(t){e.recipientReferences=i.default.map(t.data,c),e.visibility.loading=!1}))}}d.$inject=[\"ServiceBroker\"];var u={template:l.default,bindings:{instance:\"<\"},controller:d};e.default={component:u,id:\"waltzAttestationRecipients\"}},775:function(t,e){t.exports='<div> <h5> Recipients for <span ng-bind=$ctrl.instance.parentEntity.name></span> </h5> <waltz-loading-notification show=$ctrl.visibility.loading name=Loading> </waltz-loading-notification> <div ng-class=\"{\\'waltz-scroll-region-250\\': $ctrl.recipientReferences.length > 10}\"> <div ng-repeat=\"recipientRef in $ctrl.recipientReferences\"> <waltz-entity-link entity-ref=recipientRef> </waltz-entity-link> </div> </div> </div>'},776:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var l,o=t[Symbol.iterator]();!(i=(l=o.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),a=n(0),r=n(2),l=s(n(1)),o=s(n(777));function s(t){return t&&t.__esModule?t:{default:t}}var c={attestationInstancesAndRuns:[]};function d(t,e){var n=(0,a.initialiseData)(this,c);n.$onChanges=function(){if(n.parentEntityRef){var a=e.loadViewData(r.CORE_API.AttestationRunStore.findByEntityRef,[n.parentEntityRef]).then(function(t){return t.data}),o=e.loadViewData(r.CORE_API.AttestationInstanceStore.findByEntityRef,[n.parentEntityRef]).then(function(t){return t.data});t.all([a,o]).then(function(t){var e=i(t,2),a=e[0],r=e[1];return n.attestations=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=l.default.keyBy(t,\"id\");return l.default.map(e,function(t){return{instance:t,run:n[t.attestationRunId]}})}(a,r)})}}}d.$inject=[\"$q\",\"ServiceBroker\"];var u={bindings:{parentEntityRef:\"<\"},template:o.default,controller:d};e.default={component:u,id:\"waltzAttestationSection\"}},777:function(t,e){t.exports='<div> <div ng-if=\"$ctrl.attestations.length > 0\"> <table class=\"table table-striped table-condensed small\"> <colgroup> <col width=16%> <col width=20%> <col width=16%> <col width=12%> <col width=12%> <col width=14%> <col width=10%> </colgroup> <thead> <tr> <th>Attestation</th> <th>Description</th> <th>Target</th> <th>Issued</th> <th>Due</th> <th>Attested by</th> <th>Attested</th> </tr> </thead> <tbody> <tr ng-repeat=\"attestation in $ctrl.attestations | orderBy: \\'issuedOn\\':true\"> <td ng-bind=attestation.run.name> </td> <td ng-bind=\"attestation.run.description | truncate:150\" uib-popover=\"{{ attestation.run.description }}\" popover-class=waltz-popover-width-700 popover-append-to-body=true popover-placement=right popover-trigger=mouseenter> </td> <td> <waltz-attested-kind run=attestation.run></waltz-attested-kind> </td> <td> <waltz-from-now timestamp=attestation.run.issuedOn days-only=true> </waltz-from-now> </td> <td> <waltz-from-now timestamp=attestation.run.dueDate days-only=true> </waltz-from-now> </td> <td ng-bind=attestation.instance.attestedBy> </td> <td> <waltz-from-now timestamp=attestation.instance.attestedAt> </waltz-from-now> </td> </tr> </tbody> </table> </div> <waltz-no-data ng-if=\"$ctrl.attestations.length == 0\"> <message> <strong>No attestations</strong> </message> </waltz-no-data> </div>'},778:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(2),a=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n(779));var l={logicalFlows:[],logicalFlowDecorators:[],physicalFlows:[],physicalSpecifications:[]};function o(t){var e=(0,a.initialiseData)(this,l);e.$onInit=function(){var n={entityReference:e.parentEntityRef,scope:\"EXACT\"};t.loadViewData(i.CORE_API.LogicalFlowStore.findByEntityReference,[e.parentEntityRef]).then(function(t){return e.logicalFlows=t.data}),t.loadViewData(i.CORE_API.LogicalFlowDecoratorStore.findBySelectorAndKind,[n,\"DATA_TYPE\"]).then(function(t){return e.logicalFlowDecorators=t.data}),t.loadViewData(i.CORE_API.PhysicalFlowStore.findByEntityReference,[e.parentEntityRef]).then(function(t){return e.physicalFlows=t.data}),t.loadViewData(i.CORE_API.PhysicalSpecificationStore.findByEntityReference,[e.parentEntityRef]).then(function(t){return e.physicalSpecifications=t.data})}}o.$inject=[\"ServiceBroker\"];var s={template:r.default,bindings:{parentEntityRef:\"<\"},controller:o};e.default={component:s,id:\"waltzInlineLogicalFlowPanel\"}},779:function(t,e){t.exports='<div> <waltz-source-and-target-panel entity-ref=$ctrl.parentEntityRef logical-flows=$ctrl.logicalFlows decorators=$ctrl.logicalFlowDecorators physical-flows=$ctrl.physicalFlows physical-specifications=$ctrl.physicalSpecifications> </waltz-source-and-target-panel> <p class=\"text-muted small\"> Diagram detailing the applications data types (Middle) from the sending system (LHS) to the receiving system on the (RHS). <span style=color:#8b0000>Red lines</span> indicate non-strategic flows, <span style=color:orange>Amber</span> indicates secondary and <span style=color:#006400>Green</span> indicates a primary system. </p> </div>'},780:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(n(1)),a=n(2),r=n(0),l=o(n(781));function o(t){return t&&t.__esModule?t:{default:t}}var s={categories:[],measurableCategory:{},ratings:[],ratingSchemesById:{},measurables:[]};function c(t,e){var n=(0,r.initialiseData)(this,s);n.$onInit=function(){return function(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l=e.loadViewData(a.CORE_API.MeasurableRatingStore.findForEntityReference,[n.parentEntityRef],{force:r}).then(function(t){return n.ratings=t.data}),o=e.loadAppData(a.CORE_API.RatingSchemeStore.findAll).then(function(t){return n.ratingSchemesById=i.default.keyBy(t.data,\"id\")}),s=e.loadAppData(a.CORE_API.MeasurableCategoryStore.getById,[n.measurableCategoryRef.id]).then(function(t){return n.measurableCategory=t.data}),c=e.loadViewData(a.CORE_API.MeasurableStore.findMeasurablesRelatedToPath,[n.parentEntityRef],{force:r}).then(function(t){return n.measurables=i.default.filter(t.data,function(t){return t.categoryId===n.measurableCategoryRef.id})});t.all([c,o,l,s]).then(function(){n.ratingScheme=n.ratingSchemesById[n.measurableCategory.ratingSchemeId],console.log(\"got data: \",{parentRef:n.parentEntityRef,cat:n.measurableCategory,vm:n})})}()},n.$onChanges=function(t){}}c.$inject=[\"$q\",\"ServiceBroker\"];var d={template:l.default,bindings:{parentEntityRef:\"<\",measurableCategoryRef:\"<\"},controller:c};e.default={component:d,id:\"waltzInlineMeasurableRatingPanel\"}},781:function(t,e){t.exports='<div> <waltz-measurable-rating-panel category=$ctrl.measurableCategory entity-reference=$ctrl.parentEntityRef measurables=$ctrl.measurables ratings=$ctrl.ratings rating-scheme=$ctrl.ratingScheme overrides=$ctrl.overridesByMeasurableId> </waltz-measurable-rating-panel> <br> <waltz-markdown class=\"text-muted small\" text=$ctrl.measurableCategory.description> </waltz-markdown> <br> <hr> </div>'},782:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(2),a=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n(783));var l={physicalFlows:[],logicalFlows:[],specifications:[]};function o(t){var e=(0,a.initialiseData)(this,l);e.$onInit=function(){t.loadViewData(i.CORE_API.PhysicalSpecificationStore.findByEntityReference,[e.parentEntityRef]).then(function(t){return e.physicalSpecifications=t.data}),t.loadViewData(i.CORE_API.LogicalFlowStore.findByEntityReference,[e.parentEntityRef]).then(function(t){return e.logicalFlows=t.data}),t.loadViewData(i.CORE_API.PhysicalFlowStore.findByEntityReference,[e.parentEntityRef]).then(function(t){return e.physicalFlows=t.data})},e.onPhysicalFlowsInitialise=function(t){e.physicalFlowProducesExportFn=t.exportProducesFn,e.physicalFlowConsumesExportFn=t.exportConsumesFn,e.physicalFlowUnusedSpecificationsExportFn=t.exportUnusedSpecificationsFn},e.exportPhysicalFlowProduces=function(){e.physicalFlowProducesExportFn()},e.exportPhysicalFlowConsumes=function(){e.physicalFlowConsumesExportFn()},e.exportPhysicalFlowUnusedSpecifications=function(){e.physicalFlowUnusedSpecificationsExportFn()}}o.$inject=[\"ServiceBroker\"];var s={template:r.default,bindings:{parentEntityRef:\"<\"},controller:o};e.default={component:s,id:\"waltzInlinePhysicalFlowPanel\"}},783:function(t,e){t.exports=\"<div> <waltz-physical-data-section specifications=$ctrl.physicalSpecifications logical-flows=$ctrl.logicalFlows primary-ref=$ctrl.parentEntityRef on-initialise=$ctrl.onPhysicalFlowsInitialise physical-flows=$ctrl.physicalFlows> </waltz-physical-data-section> </div>\"},784:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(n(785)),a=o(n(787)),r=o(n(790)),l=o(n(792));function o(t){return t&&t.__esModule?t:{default:t}}var s={url:\"attestation\"},c={url:\"/instance\"},d={url:\"/user\",views:{\"content@\":i.default}},u={url:\"/run\"},p={url:\"/create\",views:{\"content@\":a.default}},f={url:\"/list\",views:{\"content@\":r.default}},m={url:\"/{id:int}\",views:{\"content@\":l.default}};function v(t){t.state(\"main.attestation\",s).state(\"main.attestation.instance\",c).state(\"main.attestation.instance.user\",d).state(\"main.attestation.run\",u).state(\"main.attestation.run.create\",p).state(\"main.attestation.run.list\",f).state(\"main.attestation.run.view\",m)}v.$inject=[\"$stateProvider\"],e.default=v},785:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var l,o=t[Symbol.iterator]();!(i=(l=o.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),a=c(n(1)),r=n(25),l=n(2),o=n(0),s=c(n(786));function c(t){return t&&t.__esModule?t:{default:t}}var d={runsWithInstances:[],selectedAttestation:null,showAttested:!1};function u(t,e,n){var s=(0,o.initialiseData)(this,d);n.whoami().then(function(t){return s.user=t});var c=function(){var n=e.loadViewData(l.CORE_API.AttestationRunStore.findByRecipient).then(function(t){return t.data}),o=e.loadViewData(l.CORE_API.AttestationInstanceStore.findByUser,[s.showAttested],{force:!0}).then(function(t){return t.data}),c=e.loadViewData(l.CORE_API.AttestationInstanceStore.findHistoricalForPendingByUser,[],{force:!0}).then(function(t){return t.data});t.all([n,o,c]).then(function(t){var e=i(t,3),n=e[0],l=e[1],o=e[2],c=(0,r.nest)().key(function(t){return t.parentEntity.kind}).key(function(t){return t.parentEntity.id}).key(function(t){return t.childEntityKind}).object(o),d=a.default.chain(l).map(function(t){return Object.assign({},t,{historic:a.default.get(c,[t.parentEntity.kind,t.parentEntity.id,t.childEntityKind],[])})}).groupBy(\"attestationRunId\").value();s.runsWithInstances=a.default.chain(n).map(function(t){return Object.assign({},t,{instances:d[t.id]})}).filter(function(t){return t.instances}).sortBy(function(t){return t.dueDate}).value()}),e.loadAppData(l.CORE_API.NotificationStore.findAll,[],{force:!0})};c(),s.attestEntity=function(t){e.execute(l.CORE_API.AttestationInstanceStore.attestInstance,[t.id]).then(function(){return c()}).then(function(){return s.selectedAttestation=null})},s.cancelAttestation=function(){s.selectedAttestation=null},s.toggleFilter=function(){s.showAttested=!s.showAttested,c()}}u.$inject=[\"$q\",\"ServiceBroker\",\"UserService\"],e.default={template:s.default,controller:u,controllerAs:\"ctrl\"}},786:function(t,e){t.exports='<div class=waltz-attestation-instance-list-user-view> <waltz-page-header icon=check-square-o name=Attestations small={{ctrl.user.userName}}> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>Attestations</li> <li ng-bind=ctrl.user.userName></li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-section-actions> <a class=\"btn btn-primary btn-xs\" waltz-has-role=ATTESTATION_ADMIN ui-sref=main.attestation.run.list> Manage Runs </a> </waltz-section-actions> <waltz-toggle class=pull-right state=ctrl.showAttested on-toggle=ctrl.toggleFilter() label-on=\"Hide previous attestations\" label-off=\"Show previous attestations\"> </waltz-toggle> <br> <div ng-repeat=\"run in ctrl.runsWithInstances\" class=\"waltz-display-section wailuv-run waltz-animate-repeat\"> <h4 ng-bind=run.name></h4> <div class=row> <div class=col-sm-3> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Attested entity </div> <div class=col-sm-8> <waltz-attested-kind run=run></waltz-attested-kind> </div> </div> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Description </div> <div class=col-sm-8> <span ng-bind=\"run.description | truncate:150\" uib-popover=\"{{ run.description }}\" popover-class=waltz-popover-width-700 popover-append-to-body=true popover-placement=right popover-trigger=mouseenter> </span> </div> </div> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Due </div> <div class=col-sm-8> <waltz-from-now timestamp=run.dueDate days-only=true> </waltz-from-now> </div> </div> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Issued by </div> <div class=col-sm-8> <span ng-bind=run.issuedBy></span> </div> </div> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Issued on </div> <div class=col-sm-8> <waltz-from-now timestamp=run.issuedOn days-only=true> </waltz-from-now> </div> </div> </div> <div class=col-sm-9> <table class=\"table table-condensed\"> <colgroup> <col width=35%> <col width=45%> <col width=15%> </colgroup> <thead> <tr> <th>Subject</th> <th>Last Attestation</th> <th></th> </tr> </thead> <tbody ng-repeat=\"instance in run.instances\"> <tr> <td> <waltz-entity-link entity-ref=instance.parentEntity> </waltz-entity-link> </td> <td> <span ng-if=\"!instance.attestedAt && ctrl.selectedAttestation !== instance\\n                                                && instance.historic && instance.historic.length > 0\"> <span ng-bind=instance.historic[0].attestedBy></span> (<waltz-from-now timestamp=instance.historic[0].attestedAt></waltz-from-now>) </span> <span ng-if=instance.attestedAt> <span ng-bind=instance.attestedBy></span> (<waltz-from-now timestamp=instance.attestedAt></waltz-from-now>) </span> </td> <td> <a class=\"btn btn-primary btn-xs\" ng-if=\"!instance.attestedAt && ctrl.selectedAttestation !== instance\" ng-click=\"ctrl.selectedAttestation = instance\"> Attest <waltz-attested-kind run=run></waltz-attested-kind> </a> <div ng-if=instance.attestedAt class=wailuv-attested> <waltz-icon name=check size=lg> </waltz-icon> <span> <waltz-attested-kind run=run></waltz-attested-kind> </span> </div> </td> </tr> <tr ng-if=\"ctrl.selectedAttestation === instance\" class=waltz-fade-if> <td colspan=3 style=padding-right:3em;border-top:none> <waltz-attestation-confirmation instance=ctrl.selectedAttestation run=run attested-entity-ref=run.attestedEntityRef on-confirm=ctrl.attestEntity on-cancel=ctrl.cancelAttestation ng-switch=run.attestedEntityKind> <waltz-inline-logical-flow-panel parent-entity-ref=ctrl.selectedAttestation.parentEntity ng-switch-when=LOGICAL_DATA_FLOW> </waltz-inline-logical-flow-panel> <waltz-inline-physical-flow-panel parent-entity-ref=ctrl.selectedAttestation.parentEntity ng-switch-when=PHYSICAL_FLOW> </waltz-inline-physical-flow-panel> <waltz-inline-measurable-rating-panel parent-entity-ref=ctrl.selectedAttestation.parentEntity measurable-category-ref=run.attestedEntityRef ng-switch-when=MEASURABLE_CATEGORY> </waltz-inline-measurable-rating-panel> </waltz-attestation-confirmation> </td> </tr> </tbody> </table> </div> </div> </div> <div ng-if=\"ctrl.runsWithInstances.length === 0\"> <waltz-no-data> <message> <strong>You have no attestations pending.</strong> </message> </waltz-no-data> </div> </div> </div>'},787:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=s(n(1)),a=n(2),r=n(0),l=s(n(4)),o=s(n(789));function s(t){return t&&t.__esModule?t:{default:t}}var c={value:\"EXACT\",name:\"Exact\"},d={value:\"CHILDREN\",name:\"Children\"},u={attestationRun:{targetEntityKind:\"APPLICATION\",selectorEntityKind:\"APP_GROUP\",selectorScope:\"EXACT\"},availableAttestedKinds:[\"LOGICAL_DATA_FLOW\",\"PHYSICAL_FLOW\",\"MEASURABLE_CATEGORY\"],targetEntityKinds:[{name:\"Application\",value:\"APPLICATION\"}],allowedEntityKinds:[{value:\"APP_GROUP\",name:\"Application Group\"},{value:\"ORG_UNIT\",name:\"Org Unit\"},{value:\"MEASURABLE\",name:\"Measurable\"}],allowedScopes:{APP_GROUP:[c],CHANGE_INITIATIVE:[c],ORG_UNIT:[c,d],MEASURABLE:[c,d]},displaySummary:!1,loadingSummary:!1};function p(t){var e=i.default.map(t.involvementKinds,function(t){return t.id});return{name:t.name,description:t.description,selectionOptions:{entityReference:{kind:t.selectorEntityKind,id:t.selectorEntity.id},scope:t.selectorScope},targetEntityKind:t.targetEntityKind,attestedEntityKind:t.attestedEntityKind,attestedEntityId:t.attestedEntityId,involvementKindIds:e,dueDate:(0,l.default)(t.dueDate).format(r.formats.parseDateOnly)}}function f(t,e,n,i){var l=(0,r.initialiseData)(this,u);i.findAll().then(function(t){l.availableInvolvementKinds=t}),l.onSelectorEntityKindChange=function(){l.attestationRun.selectorEntity=null},l.onSelectorEntitySelect=function(t){l.attestationRun.selectorEntity=t},l.onAttestedKindChange=function(){\"MEASURABLE_CATEGORY\"===l.attestationRun.attestedEntityKind&&n.loadAppData(a.CORE_API.MeasurableCategoryStore.findAll).then(function(t){return l.measurableCategories=t.data})},l.loadCreateSummary=function(){var t=p(l.attestationRun);l.loadingSummary=!0,n.execute(a.CORE_API.AttestationRunStore.getCreateSummary,[t]).then(function(t){l.summary=t.data,l.loadingSummary=!1,l.displaySummary=!0})},l.create=function(){var i=p(l.attestationRun);n.execute(a.CORE_API.AttestationRunStore.create,[i]).then(function(i){e.success(\"Attestation run created successfully\"),n.loadAppData(a.CORE_API.NotificationStore.findAll,[],{force:!0}),t.go(\"main.attestation.run.view\",{id:i.data.id})},function(){return e.error(\"Failed to create attestation run\")})},l.cancel=function(){l.displaySummary=!1,l.summary=null}}f.$inject=[\"$state\",\"Notification\",\"ServiceBroker\",\"InvolvementKindStore\"],e.default={template:o.default,controller:f,controllerAs:\"ctrl\"}},789:function(t,e){t.exports='<div> <waltz-page-header icon=check-square-o name=\"Attestation Run\" small=create> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.attestation.instance.user>Attestations</a></li> <li><a ui-sref=main.attestation.run.list>Attestation runs</a></li> <li>Create</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <div> <form name=attestationRunForm class=\"waltz-attestation-form form-horizontal\" role=form novalidate> <div class=form-group> <label class=\"col-sm-2 control-label\"> Target kind <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=targetEntityKind required class=form-control ng-options=\"kind.value as kind.name for kind in ctrl.targetEntityKinds\" ng-model=ctrl.attestationRun.targetEntityKind> </select> </div> </div> <div class=form-group> <label for=name class=\"col-sm-2 control-label\"> Run name <span class=text-danger>*</span> </label> <div class=col-sm-10> <input class=\"form-control form-control-warning\" required id=name placeholder=\"Name for this attestation run\" ng-model=ctrl.attestationRun.name /> </div> </div> <div class=form-group> <label for=description class=\"col-sm-2 control-label\"> Run description </label> <div class=col-sm-10> <textarea id=description class=form-control placeholder=\"Description for this attestation run\" ng-model=ctrl.attestationRun.description rows=3>\\n                        </textarea> </div> </div> <div class=form-group> <label for=dueDate class=\"col-sm-2 control-label\"> Due Date </label> <div class=\"col-sm-10 col-md-3\"> <waltz-date-picker-form-input id=dueDate required=true place-holder=yyyy-MM-dd format=yyyy-MM-dd model=ctrl.attestationRun.dueDate> </waltz-date-picker-form-input> </div> </div> <div class=form-group> <label for=selectorEntityKind class=\"col-sm-2 control-label\"> Selector Kind <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=selectorEntityKind required class=form-control ng-options=\"entityKind.value as entityKind.name for entityKind in ctrl.allowedEntityKinds\" ng-change=ctrl.onSelectorEntityKindChange() ng-model=ctrl.attestationRun.selectorEntityKind> </select> </div> </div> <div class=form-group> <label for=selectorEntity class=\"col-sm-2 control-label\"> Selector Entity <span class=text-danger>*</span> </label> <div class=col-sm-10> <waltz-entity-selector current-selection=ctrl.attestationRun.selectorEntity required=true on-select=ctrl.onSelectorEntitySelect entity-kinds=[ctrl.attestationRun.selectorEntityKind]> </waltz-entity-selector> </div> </div> <div class=form-group> <label for=selectorScope class=\"col-sm-2 control-label\"> Scope <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=selectorScope required class=form-control ng-options=\"scope.value as scope.name for scope in ctrl.allowedScopes[ctrl.attestationRun.selectorEntityKind]\" ng-model=ctrl.attestationRun.selectorScope> </select> </div> </div> <div class=form-group> <label for=attestedKinds class=\"col-sm-2 control-label\"> Attested Kinds <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=attestedKinds required class=form-control ng-options=\"kind as kind | toDisplayName:\\'entity\\' for kind in ctrl.availableAttestedKinds | orderBy:\\'kind\\'\" ng-model=ctrl.attestationRun.attestedEntityKind ng-change=ctrl.onAttestedKindChange()> </select> </div> </div> <div class=form-group ng-if=\"ctrl.attestationRun.attestedEntityKind === \\'MEASURABLE_CATEGORY\\'\"> <label for=attestedKinds class=\"col-sm-2 control-label\"> Which <span ng-bind=\"ctrl.attestationRun.attestedEntityKind | toDisplayName:\\'entity\\'\"></span>? <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=measurableCategory required class=form-control ng-options=\"category.id as category.name for category in ctrl.measurableCategories | orderBy:\\'category.name\\'\" ng-model=ctrl.attestationRun.attestedEntityId> </select> </div> </div> <div class=form-group> <label for=involmentKinds class=\"col-sm-2 control-label\"> Involvement Kinds <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=involmentKinds required type=date class=form-control ng-options=\"kind as kind.name for kind in ctrl.availableInvolvementKinds | orderBy:\\'name\\' track by kind.id\" ng-model=ctrl.attestationRun.involvementKinds multiple=multiple style=height:250px> </select> </div> </div> <div class=form-group style=padding-top:10px> <div class=\"col-sm-offset-2 col-sm-10\"> <button type=button ng-if=\"!(attestationRunForm.$invalid) && !ctrl.loadingSummary && !ctrl.displaySummary\" ng-click=ctrl.loadCreateSummary() class=\"btn btn-warning\"> Next </button> <div ng-if=ctrl.displaySummary> <h3>Summary</h3> <div class=row> <div class=col-md-6> <table class=\"table table-condensed\"> <tbody> <tr> <td> # <span ng-bind=\"ctrl.attestationRun.targetEntityKind | toDisplayName:\\'entity\\'\"></span>s matching selector </td> <td ng-bind=ctrl.summary.entityCount></td> </tr> <tr> <td> # <span ng-bind=\"ctrl.attestationRun.targetEntityKind | toDisplayName:\\'entity\\'\"></span>s to be attested </td> <td ng-bind=ctrl.summary.instanceCount></td> </tr> <tr> <td># Recipients</td> <td ng-bind=ctrl.summary.recipientCount></td> </tr> </tbody> </table> </div> </div> <br> <button type=button ng-click=ctrl.create() class=\"btn btn-success\"> Create </button> <a class=clickable ng-click=ctrl.cancel()> Cancel </a> </div> <span ng-if=attestationRunForm.$invalid class=\"alert alert-warning\" style=padding-bottom:10px> Please fill in all required fields </span> </div> </div> </form> </div> </div> </div>'},790:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=s(n(1)),a=s(n(4)),r=n(0),l=s(n(791)),o=n(2);function s(t){return t&&t.__esModule?t:{default:t}}var c={runs:[],responseSummaries:{}};function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.default)()>a.default.utc(t.dueDate,r.formats.parse)}function u(t){var e=(0,r.initialiseData)(this,c);e.getPendingBarType=function(t){return d(t)?\"danger\":\"warning\"},e.isOverdue=function(t){return d(t)};t.loadViewData(o.CORE_API.AttestationRunStore.findAll).then(function(t){return e.runs=t.data}),t.loadViewData(o.CORE_API.AttestationRunStore.findResponseSummaries).then(function(t){return e.responseSummaries=i.default.keyBy(t.data,\"runId\")})}u.$inject=[\"ServiceBroker\"];var p={controller:u,controllerAs:\"ctrl\",template:l.default};e.default=p},791:function(t,e){t.exports='<div> <waltz-page-header icon=check-square-o name=\"Attestation runs\" small=list> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.attestation.instance.user>Attestations</a></li> <li>runs</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-section-actions> <a class=\"btn btn-primary btn-xs\" waltz-has-role=ATTESTATION_ADMIN ui-sref=\"main.attestation.run.create ({id: ctrl.template.id })\"> Create </a> </waltz-section-actions> <div> <table class=\"table table-condensed table-striped\"> <colgroup> <col width=20%> <col width=10%> <col width=30%> <col width=10%> <col width=10%> <col width=10%> <col width=10%> </colgroup> <thead> <tr> <th>Name</th> <th>Attested Kind</th> <th>Description</th> <th>Responses</th> <th>Issuer</th> <th>Issued</th> <th>Due</th> </tr> </thead> <tr ng-repeat=\"r in ctrl.runs\"> <td> <a ng-bind=r.name class=clickable ui-sref=\"main.attestation.run.view ({id: r.id})\"></a> </td> <td> <waltz-attested-kind run=r></waltz-attested-kind> </td> <td> <div ng-bind=\"r.description | truncate:150\" uib-popover=\"{{ r.description }}\" popover-class=waltz-popover-width-700 popover-append-to-body=true popover-placement=right popover-trigger=mouseenter> </div> </td> <td> <div uib-popover=\"{{\\n                                ctrl.responseSummaries[r.id].completeCount + \\' completed\\'\\n                                + \\', \\'\\n                                + ctrl.responseSummaries[r.id].pendingCount + \\' pending\\'\\n                            }}\" popover-trigger=mouseenter> <uib-progress max=\"ctrl.responseSummaries[r.id].completeCount + ctrl.responseSummaries[r.id].pendingCount\" animate=false> <uib-bar value=ctrl.responseSummaries[r.id].completeCount ng-bind=ctrl.responseSummaries[r.id].completeCount type=success> </uib-bar> <uib-bar value=ctrl.responseSummaries[r.id].pendingCount ng-bind=ctrl.responseSummaries[r.id].pendingCount type={{ctrl.getPendingBarType(r)}}> </uib-bar> </uib-progress> </div> </td> <td><span ng-bind=r.issuedBy></span></td> <td> <waltz-from-now timestamp=r.issuedOn days-only=true> </waltz-from-now> </td> <td ng-class=\"{\\'text-danger\\': ctrl.isOverdue(r)}\"> <waltz-from-now ng-if=r.dueDate timestamp=r.dueDate days-only=true> </waltz-from-now> </td> </tr> </table> </div> </div> </div>'},792:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var l,o=t[Symbol.iterator]();!(i=(l=o.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(t,e);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),a=u(n(1)),r=u(n(4)),l=n(2),o=n(0),s=n(27),c=n(19),d=u(n(793));function u(t){return t&&t.__esModule?t:{default:t}}var p={run:null,recipients:null,instances:[],selectedInstance:null,columnDefs:[],tableData:[],onGridInitialise:function(t){return console.log(\"default grid initialise handler for attestation-run-view\")}};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return a.default.map(e,function(e){return Object.assign({},e,{rating:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).attestedBy)return{rag:\"G\",name:\"Complete\",color:c.green};var e=r.default.utc(t.dueDate,o.formats.parse);return r.default.utc()>e?{rag:\"R\",name:\"Overdue\",color:c.red}:{rag:\"A\",name:\"Pending\",color:c.amber}}(t,e)})})}var m={R:3,A:2,G:1,Z:0},v='\\n    <div class=\"ui-grid-cell-contents\">\\n        <waltz-rating-indicator-cell rating=\"COL_FIELD\">\\n        </waltz-rating-indicator-cell>\\n    </div>';function g(t,e,n){var a=(0,o.initialiseData)(this,p),r=e.id;a.columnDefs=[(0,s.mkEntityLinkGridCell)(\"Subject\",\"parentEntity\"),{field:\"rating\",name:\"Status\",cellTemplate:v,sortingAlgorithm:function(t,e){return t.rag==e.rag?0:m[t.rag]-m[e.rag]}},{field:\"attestedBy\",name:\"Attested By\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><a ui-sref=\"main.profile.view ({userId: COL_FIELD})\"><span ng-bind=\"COL_FIELD\"></span></a></div>'},{field:\"attestedAt\",name:\"Attested At\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><waltz-from-now timestamp=\"COL_FIELD\"></waltz-from-now></div>'},{name:\"Recipients\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><a ng-click=\"grid.appScope.selectInstance(row.entity)\" class=\"clickable\">Show</a></div>'}];t.all([n.loadViewData(l.CORE_API.AttestationRunStore.getById,[r]),n.loadViewData(l.CORE_API.AttestationInstanceStore.findByRunId,[r])]).then(function(t){var e=i(t,2),n=e[0],r=e[1];a.run=n.data,a.instances=f(a.run,r.data),a.tableData=a.instances}),a.selectInstance=function(t){a.selectedInstance=t},a.onGridInitialise=function(t){a.exportData=function(){return t.exportFn(\"attestation_instances.csv\")}}}g.$inject=[\"$q\",\"$stateParams\",\"ServiceBroker\"],e.default={template:d.default,controller:g,controllerAs:\"ctrl\"}},793:function(t,e){t.exports='<div> <waltz-page-header icon=check-square-o name={{ctrl.run.name}} small=\"Attestation Run\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.attestation.run.list>Attestation runs</a></li> <li><span ng-bind=ctrl.run.name></span></li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-attestation-run-overview run=ctrl.run> </waltz-attestation-run-overview> </div> <br> <waltz-section name=Instances> <div class=row> <div class=col-sm-9> <waltz-grid-with-search scope-provider=ctrl column-defs=ctrl.columnDefs entries=ctrl.tableData searchplaceholdertext=Search exportfilename=attestation_instances.csv on-initialise=ctrl.onGridInitialise> </waltz-grid-with-search> </div> <div class=col-sm-3> <waltz-attestation-recipients class=waltz-fade-if ng-if=ctrl.selectedInstance instance=ctrl.selectedInstance> </waltz-attestation-recipients> </div> </div> <div class=row> <div class=col-sm-12> <div style=padding:.3em class=pull-right> <waltz-data-extract-link name=Export styling=link extract=attestation/{{ctrl.run.id}} filename={{ctrl.run.name}}.csv> </waltz-data-extract-link> </div> </div> </div> </waltz-section> </div>'},794:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=m(n(6)),a=f(n(208)),r=f(n(795)),l=f(n(797)),o=f(n(799)),s=f(n(801)),c=f(n(803)),d=f(n(805)),u=n(7),p=m(n(807));function f(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function m(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module(\"waltz.auth.sources\",[]);return t.directive(\"waltzRatingIndicator\",p.default),(0,u.registerStore)(t,a),(0,u.registerComponents)(t,[r,l,s,c,d,o]),t.name}},795:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.id=e.component=void 0;var i=s(n(796)),a=n(0),r=n(2),l=s(n(1)),o=n(12);function s(t){return t&&t.__esModule?t:{default:t}}var c={createForm:{dataType:null,orgUnit:null,rating:null,app:null},updateForm:{description:\"\",rating:null},preventCreateFormSubmit:!0,visibility:{createForm:!1,updateForm:!1}};function d(t,e,n){var i=(0,a.initialiseData)(this,c);i.onCreateFormChange=function(){i.preventCreateFormSubmit=l.default.some(l.default.values(i.createForm),function(t){return null===t})},i.closeForms=function(){i.visibility={createForm:!1,updateForm:!1}};var s=function(){e.loadViewData(r.CORE_API.AuthSourcesStore.findAll,[],{force:!0}).then(function(t){var e=l.default.keyBy(i.orgUnits,\"id\"),n=l.default.keyBy(i.dataTypes,\"code\"),a=t.data;i.authSourceTable=l.default.chain(a).map(function(t){return{authSource:t,orgUnit:(0,o.toEntityRef)(e[t.parentReference.id],\"ORG_UNIT\"),dataType:n[t.dataType]}}).sortBy(\"dataType.name\",\"authSource.applicationReference.name\").value()})};i.$onInit=function(){var n=[e.loadAppData(r.CORE_API.DataTypeStore.findAll).then(function(t){i.dataTypes=t.data}),e.loadAppData(r.CORE_API.OrgUnitStore.findAll).then(function(t){return i.orgUnits=t.data})];t.all(n).then(function(){return s()})},i.remove=function(t){confirm(\"Are you sure you want to delete this Authoritative Source ?\")&&e.execute(r.CORE_API.AuthSourcesStore.remove,[t.id]).then(function(){s(),n.warning(\"Authoritative Source removed\")})},i.onSelectDataType=function(t){i.createForm.dataType=Object.assign({},t,{kind:\"DATA_TYPE\"}),i.onCreateFormChange()},i.onClearDataType=function(){i.createForm.dataType=null,i.onCreateFormChange()},i.onSelectOrgUnit=function(t){i.createForm.orgUnit=Object.assign({},t,{kind:\"ORG_UNIT\"}),i.onCreateFormChange()},i.onClearOrgUnit=function(){i.createForm.orgUnit=null,i.onCreateFormChange()},i.onSelectApp=function(t){i.createForm.app=Object.assign({},t,{kind:\"APPLICATION\"}),i.onCreateFormChange()},i.onClearApp=function(){i.createForm.app=null,i.onCreateFormChange()},i.isCreateFormDisabled=function(){return i.preventCreateFormSubmit},i.onShowCreateForm=function(){i.closeForms(),i.visibility.createForm=!0},i.onDismissCreateForm=function(){i.closeForms()},i.onShowUpdateForm=function(t){i.closeForms(),i.updateForm.description=t.description,i.updateForm.rating=t.rating,i.updateForm.id=t.id,i.visibility.updateForm=!0},i.onDismissUpdateForm=function(){console.log(\"dismiss\"),i.closeForms()},i.submitUpdate=function(){console.log(\"sn\",i.updateForm);var t={description:i.updateForm.description||\"\",rating:i.updateForm.rating,id:i.updateForm.id};e.execute(r.CORE_API.AuthSourcesStore.update,[t]).then(function(){n.success(\"Authoritative Source updated\"),i.closeForms(),s()})},i.submitCreate=function(){var t={description:i.createForm.description,rating:i.createForm.rating,applicationId:i.createForm.app.id,dataTypeId:i.createForm.dataType.id,orgUnitId:i.createForm.orgUnit.id};e.execute(r.CORE_API.AuthSourcesStore.insert,[t]).then(function(){n.success(\"Authoritative Source created\"),i.closeForms(),s()})}}d.$inject=[\"$q\",\"ServiceBroker\",\"Notification\"];e.component={template:i.default,controller:d,bindings:{parentEntityRef:\"<\"}},e.id=\"waltzAuthSourceEditorPanel\"},796:function(t,e){t.exports='<div> <div ng-if=\"!($ctrl.visibility.createForm || $ctrl.visibility.updateForm)\"> <input type=search class=form-control ng-model=$ctrl.currentSearchTerms placeholder=\"Search current Authoritative Sources\"> <div ng-if=\"$ctrl.authSourceTable.length > 0\" ng-class=\"{ \\'waltz-scroll-region-300\\' : $ctrl.authSourceTable.length > 15 }\"> <table class=table> <colgroup> </colgroup> <thead> <tr> <th>Operations</th> <th>Data Type</th> <th>Declaring Org Unit</th> <th>Application</th> <th>Rating</th> <th>Description</th> </tr> </thead> <tbody> <tr ng-repeat=\"row in $ctrl.authSourceTable | filter: $ctrl.currentSearchTerms\" class=waltz-visibility-parent> <td> <div class=btn-group uib-dropdown is-open=status.isopen> <button type=button class=\"btn btn-xs btn-default\" uib-dropdown-toggle> Operations <span class=caret></span> </button> <ul class=dropdown-menu uib-dropdown-menu role=menu aria-labelledby=single-button> <li role=menuitem> <a class=clickable ng-click=$ctrl.onShowUpdateForm(row.authSource)> <waltz-icon name=sticky-note-o></waltz-icon> Update </a> </li> <li class=divider></li> <li role=menuitem> <a class=clickable ng-click=$ctrl.remove(row.authSource)> <waltz-icon name=trash></waltz-icon> Delete </a> </li> </ul> </div> </td> <td> <span ng-bind=row.dataType.name></span> </td> <td> <waltz-entity-icon-label entity-ref=row.orgUnit></waltz-entity-icon-label> </td> <td> <span ng-bind=row.authSource.applicationReference.name></span> <small class=text-muted> ( <span ng-bind=row.authSource.appOrgUnitReference.name></span> ) </small> </td> <td style=vertical-align:top> <waltz-rating-indicator value=\"{{ row.authSource.rating }}\"> </waltz-rating-indicator> </td> <td> <span ng-bind=\"row.authSource.description | limitTo:30\"></span> </td> </tr> </tbody> </table> </div> <waltz-no-data ng-if=\"$ctrl.authSourceTable.length == 0\"> <message> <strong>No Authoritative Sources</strong> have been defined for <span ng-bind=$ctrl.orgUnit.name></span>. </message> </waltz-no-data> <br> <button class=\"btn btn-sm btn-success\" ng-if=\"!($ctrl.visibility.createForm || $ctrl.visibility.updateForm)\" ng-click=$ctrl.onShowCreateForm()> Add new Authoritative Source </button> <hr> </div> <div ng-if=$ctrl.visibility.updateForm> <h4>Update Authoritative Source </h4> <form name=noteForm ng-submit=$ctrl.submitUpdate()> <fieldset ng-disabled=updateForm.$submitted> <hr> <div class=row> <div class=col-md-3> <label>Update Rating</label> <span class=help-block> </span> </div> <div class=col-md-6> <div style=margin-left:25px;margin-top:10px> <div> <input type=radio id=wasep-pri-u name=rating ng-model=$ctrl.updateForm.rating value=PRIMARY> <label for=wasep-pri-u> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=\"\\'PRIMARY\\'\"> </waltz-enum-value> </label> </div> <div> <input type=radio id=wasep-sec-u name=rating ng-model=$ctrl.updateForm.rating value=SECONDARY> <label for=wasep-sec-u> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=\"\\'SECONDARY\\'\"> </waltz-enum-value> </label> </div> </div> </div> </div> <div class=row> <div class=col-md-3> <label>Update Notes</label> <span class=help-block> Additional Notes (supports markdown formatting) </span> </div> <div class=col-md-6> <div style=margin-left:25px;margin-top:10px> <textarea ng-model=$ctrl.updateForm.description rows=5 cols=50 placeholder=\"Additional notes and information..\">\\n                           </textarea> </div> </div> </div> <div class=row> <div class=col-md-12> <input class=\"btn btn-success\" type=submit value=Submit> <a class=clickable ng-click=$ctrl.onDismissUpdateForm()> Cancel </a> </div> </div> </fieldset> </form> </div> <div ng-if=$ctrl.visibility.createForm> <h4>Add new Authoritative Source </h4> <form name=createForm ng-submit=$ctrl.submitCreate()> <fieldset ng-disabled=createForm.$submitted> <hr> <div class=row> <div class=col-md-3> <label>Data Type</label> <span class=help-block> Select the data type this authoritative source will be associated to. </span> </div> <div class=col-md-6> <div ng-if=!$ctrl.createForm.dataType> <waltz-tree-picker items=$ctrl.dataTypes on-select=$ctrl.onSelectDataType> </waltz-tree-picker> </div> <div ng-if=$ctrl.createForm.dataType> <waltz-entity-icon-label style=font-weight:700 entity-ref=$ctrl.createForm.dataType></waltz-entity-icon-label> &nbsp; <a ng-click=$ctrl.onClearDataType() class=clickable> <waltz-icon name=times></waltz-icon> Clear </a> </div> </div> </div> <hr> <div class=row> <div class=col-md-3> <label>Org Unit</label> <span class=help-block> Authoritative sources are chosen at the organisational level. Select an organisational unit that this authoritative source will apply to. </span> </div> <div class=col-md-6> <div ng-if=!$ctrl.createForm.orgUnit> <waltz-entity-selector current-selection=$ctrl.createForm.orgUnit entity-kinds=\"[\\'ORG_UNIT\\']\" limit=30 on-select=$ctrl.onSelectOrgUnit required=true> </waltz-entity-selector> </div> <div ng-if=$ctrl.createForm.orgUnit> <waltz-entity-icon-label style=font-weight:700 entity-ref=$ctrl.createForm.orgUnit> </waltz-entity-icon-label> &nbsp; <a ng-click=$ctrl.onClearOrgUnit() class=clickable> <waltz-icon name=times></waltz-icon> Clear </a> </div> </div> </div> <hr> <div class=row> <div class=col-md-3> <label>Application</label> <span class=help-block> Select the application that will be the authoritative source for the organisational unit and data type combination. </span> </div> <div class=col-md-6> <div ng-if=!$ctrl.createForm.app> <waltz-app-selector model=$ctrl.createForm on-select=$ctrl.onSelectApp> </waltz-app-selector> </div> <div ng-if=$ctrl.createForm.app> <waltz-entity-icon-label style=font-weight:700 entity-ref=$ctrl.createForm.app></waltz-entity-icon-label> &nbsp; <a ng-click=$ctrl.onClearApp() class=clickable> <waltz-icon name=times></waltz-icon> Clear </a> </div> </div> </div> <hr> <div class=row> <div class=col-md-3> <label>Rating</label> <span class=help-block> Select the rating assigned to this authoritative source </span> </div> <div class=col-md-6> <div style=margin-left:25px;margin-top:10px> <div> <input type=radio id=wasep-pri-c name=rating ng-model=$ctrl.createForm.rating ng-change=$ctrl.onCreateFormChange() value=PRIMARY> <label for=wasep-pri-c> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=\"\\'PRIMARY\\'\"> </waltz-enum-value> </label> </div> <div> <input type=radio id=wasep-sec-c name=rating ng-model=$ctrl.createForm.rating ng-change=$ctrl.onCreateFormChange() value=SECONDARY> <label for=wasep-sec-c> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=\"\\'SECONDARY\\'\"> </waltz-enum-value> </label> </div> </div> </div> </div> <hr> <div class=row> <div class=col-md-3> <label>Notes</label> <span class=help-block> Additional Notes (supports markdown formatting) </span> </div> <div class=col-md-6> <div style=margin-left:25px;margin-top:10px> <div> <textarea ng-model=$ctrl.createForm.description rows=5 cols=50 placeholder=\"Additional notes and information..\">\\n                               </textarea> </div> </div> </div> </div> <hr/> <div> <input class=\"btn btn-success\" type=submit value=Submit ng-disabled=$ctrl.isCreateFormDisabled()> <a class=clickable ng-click=$ctrl.onDismissCreateForm()> Cancel </a> </div> </fieldset> </form> </div> </div>'},797:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.id=e.component=void 0;var i=s(n(1)),a=n(0),r=n(2),l=n(27),o=s(n(798));function s(t){return t&&t.__esModule?t:{default:t}}var c={consumersByAuthSourceId:{}};function d(t){return\"DATA_TYPE\"===i.default.get(t,\"kind\",\"\")}function u(t,e){var n=(0,a.initialiseData)(this,c),o=function(){var t=i.default.keyBy(n.dataTypes,\"code\"),e=i.default.keyBy(n.orgUnits,\"id\");n.gridData=i.default.map(n.authSources,function(i){var a=n.enums.AuthoritativenessRating[i.rating];return{app:i.applicationReference,dataType:Object.assign({},t[i.dataType],{kind:\"DATA_TYPE\"}),appOrgUnit:i.appOrgUnitReference,declaringOrgUnit:Object.assign({},e[i.parentReference.id],{kind:\"ORG_UNIT\"}),description:i.description,rating:i.rating,ratingValue:a,consumers:n.consumersByAuthSourceId[i.id]||[]}})};n.$onInit=function(){if(e.loadEnums().then(function(t){return n.enums=t}),t.loadAppData(r.CORE_API.DataTypeStore.findAll).then(function(t){return n.dataTypes=t.data}).then(o),t.loadAppData(r.CORE_API.OrgUnitStore.findAll).then(function(t){return n.orgUnits=t.data}).then(o),n.columnDefs=function(t){var e=d(t)?{field:\"consumers\",displayName:\"Consumers\",cellTemplate:'\\n            <div class=\"ui-grid-cell-contents\">\\n                <span class=\"label\"\\n                      style=\"cursor: pointer\"\\n                      ng-class=\"{ \\'label-warning\\': COL_FIELD.length, \\'label-default\\': COL_FIELD.length == 0 }\"\\n                      uib-popover-template=\"\\'wast/consumers-popup.html\\'\"\\n                      popover-class=\"waltz-popover-wide\"\\n                      popover-append-to-body=\"true\"\\n                      popover-placement=\"top-right\"\\n                      popover-trigger=\"outsideClick\" \\n                      ng-bind=\"COL_FIELD.length > 0 \\n                            ? COL_FIELD.length \\n                            : \\'-\\'\">\\n                </span>\\n            </div>'}:null;return i.default.compact([(0,l.mkEntityLinkGridCell)(\"Data Type\",\"dataType\",\"none\"),(0,l.mkEntityLinkGridCell)(\"Declaring Org Unit\",\"declaringOrgUnit\",\"none\"),(0,l.mkEntityLinkGridCell)(\"Application\",\"app\",\"none\"),e,{field:\"ratingValue\",displayName:\"Rating\",cellTemplate:'\\n            <div class=\"ui-grid-cell-contents\">\\n                <span ng-bind=\"COL_FIELD.name\"\\n                      title=\"{{COL_FIELD.description}}\">\\n                </span>\\n            </div>'},{field:\"description\",displayName:\"Notes\",cellTemplate:'\\n            <div class=\"ui-grid-cell-contents\">\\n                <span ng-if=\"COL_FIELD.length > 0\">\\n                    <waltz-icon name=\"sticky-note\"\\n                                style=\"color: #337ab7; cursor: pointer\"\\n                                uib-popover-template=\"\\'wast/desc-popup.html\\'\"\\n                                popover-class=\"waltz-popover-wide\"\\n                                popover-append-to-body=\"true\"\\n                                popover-placement=\"top-right\"\\n                                popover-trigger=\"outsideClick\">\\n                    </waltz-icon>\\n                </span>\\n            </div>'}])}(n.parentEntityRef),n.gridData=[],d(n.parentEntityRef)){var a={entityReference:n.parentEntityRef,scope:\"CHILDREN\"};t.loadViewData(r.CORE_API.AuthSourcesStore.calculateConsumersForDataTypeIdSelector,[a]).then(function(t){n.consumersByAuthSourceId=i.default.chain(t.data).keyBy(function(t){return t.key.id}).mapValues(function(t){return i.default.sortBy(t.value,\"name\")}).value(),o()})}},n.$onChanges=function(){o()}}u.$inject=[\"ServiceBroker\",\"EnumValueService\"];e.component={bindings:{parentEntityRef:\"<\",authSources:\"<\",orgUnits:\"<\"},controller:u,template:o.default},e.id=\"waltzAuthSourcesTable\"},798:function(t,e){t.exports='<div class=waltz-auth-sources-table> <div class=row> <div class=col-md-12> <waltz-grid-with-search column-defs=$ctrl.columnDefs entries=$ctrl.gridData on-initialise=$ctrl.onInitialise> </waltz-grid-with-search> </div> </div> </div> <script type=text/ng-template id=wast/desc-popup.html> <div>\\n        <waltz-markdown text=\"row.entity.description\"></waltz-markdown>\\n    </div> <\\/script> <script type=text/ng-template id=wast/consumers-popup.html> <div>\\n        <div ng-if=\"row.entity.consumers.length > 0\">\\n            <table class=\"table table-condensed table-striped small\">\\n                <thead>\\n                <tr>\\n                    <th>Consumers</th>\\n                </tr>\\n                </thead>\\n                <tbody>\\n                <tr ng-repeat=\"consumer in row.entity.consumers\">\\n                    <td>\\n                        <waltz-entity-link entity-ref=\"consumer\"></waltz-entity-link>\\n                    </td>\\n                </tr>\\n                </tbody>\\n            </table>\\n        </div>\\n\\n        <div ng-if=\"row.entity.consumers.length == 0\">\\n            <p>No consumers have been defined</p>\\n        </div>\\n\\n    </div> <\\/script>'},799:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.id=e.component=void 0;var i=o(n(1)),a=n(0),r=n(2),l=o(n(800));function o(t){return t&&t.__esModule?t:{default:t}}var s={groupedNonAuthSources:[],selected:null,totalCount:0};function c(t){var e=(0,a.initialiseData)(this,s),n=function(){if(e.dataTypes){var t=i.default.keyBy(e.dataTypes,\"id\");e.groupedNonAuthSources=i.default.chain(e.nonAuthSources).groupBy(\"dataTypeId\").map(function(e,n){return{dataType:t[n],sources:i.default.sortBy(e,\"sourceReference.name\")}}).sortBy(\"dataType.name\").value(),e.totalCount=i.default.sumBy(e.nonAuthSources,\"count\")}};e.$onInit=function(){t.loadAppData(r.CORE_API.DataTypeStore.findAll).then(function(t){return e.dataTypes=t.data}).then(n)},e.$onChanges=n,e.showDetail=function(t){return e.selected=t}}c.$inject=[\"ServiceBroker\"];e.component={bindings:{nonAuthSources:\"<\"},controller:c,template:l.default},e.id=\"waltzNonAuthSourcesPanel\"},800:function(t,e){t.exports='<div class=waltz-non-auth-sources-panel> <div class=row> <div class=col-sm-4> <table class=\"table table-condensed\"> <colgroup> <col width=85%> <col width=15%> </colgroup> <thead> <tr> <th colspan=2> Data Type </th> </tr> </thead> <tbody> <tr ng-repeat=\"group in $ctrl.groupedNonAuthSources\" class=\"wnso-category clickable\" ng-class=\"{\\n                        \\'wnasp-selected\\': $ctrl.selectedGroup.dataType.id === group.dataType.id\\n                    }\" ng-click=\"$ctrl.selectedGroup = group\"> <td> <span ng-bind=group.dataType.name> </span> </td> <td> <span class=small ng-bind=group.sources.length> </span> </td> </tr> </tbody> <tbody> <tr> <td><strong>Total</strong></td> <td><span ng-bind=$ctrl.totalCount></span></td> </tr> </tbody> </table> </div> <div class=col-md-8> <div ng-class=\"{\\'waltz-scroll-region-600\\': $ctrl.selectedGroup.sources.length > 20 }\" ng-if=$ctrl.selectedGroup> <table class=\"table table-condensed\"> <colgroup> <col width=80%> <col width=20%> </colgroup> <thead> <tr> <th>Application</th> <th>Consumers</th> </tr> </thead> <tbody> <tr ng-repeat=\"source in $ctrl.selectedGroup.sources\"> <td> <waltz-entity-link entity-ref=source.sourceReference></waltz-entity-link> </td> <td> <span ng-bind=source.count></span> </td> </tr> </tbody> </table> </div> </div> </div> </div> '},801:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.id=e.component=void 0;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(802)),a=n(0),r=n(2);var l={authSources:[],showNonAuthSources:!0,visibility:{tab:0,sourceDataRatingsOverlay:!1,authSourcesList:!1}};function o(t){var e=(0,a.initialiseData)(this,l);e.$onInit=function(){e.visibility.tab=\"DATA_TYPE\"===e.parentEntityRef.kind?1:0,e.visibility.authSourcesList=\"ORG_UNIT\"===e.parentEntityRef.kind||\"DATA_TYPE\"===e.parentEntityRef.kind},e.tabSelected=function(n,i){switch(e.visibility.tab=i,e.visibility.editBtn=!1,n){case\"summary\":break;case\"authSources\":t.loadViewData(r.CORE_API.AuthSourcesStore.findAuthSources,[e.parentEntityRef]).then(function(t){e.authSources=t.data}),e.visibility.editBtn=\"ORG_UNIT\"===e.parentEntityRef.kind;break;case\"nonAuthSources\":t.loadViewData(r.CORE_API.AuthSourcesStore.findNonAuthSources,[e.parentEntityRef]).then(function(t){return e.nonAuthSources=t.data})}},e.toggleSourceDataRatingOverlay=function(){return e.visibility.sourceDataRatingsOverlay=!e.visibility.sourceDataRatingsOverlay}}o.$inject=[\"ServiceBroker\"];e.component={bindings:{parentEntityRef:\"<\",showNonAuthSources:\"@?\"},controller:o,template:i.default},e.id=\"waltzAuthSourcesSection\"},802:function(t,e){t.exports='<div> <waltz-section-actions> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=$ctrl.toggleSourceDataRatingOverlay()> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.visibility.sourceDataRatingsOverlay entities=\"[\\'AUTHORITATIVE_SOURCE\\']\"> </waltz-source-data-overlay> <uib-tabset active=$ctrl.visibility.tab> <uib-tab index=0 ng-if=\"$ctrl.parentEntityRef.kind != \\'DATA_TYPE\\'\" heading=Summary select=\"$ctrl.tabSelected(\\'summary\\', 0)\"> <div class=waltz-panel-content> <waltz-auth-sources-summary-panel parent-entity-ref=$ctrl.parentEntityRef> </waltz-auth-sources-summary-panel> </div> </uib-tab> <uib-tab index=1 heading=\"Rated Flows Scorecard\" select=\"$ctrl.tabSelected(\\'scorecard\\', 1)\"> <div class=waltz-panel-content ng-show=\"$ctrl.visibility.tab == 1\"> <waltz-rated-flow-summary-panel entity-reference=$ctrl.parentEntityRef> </waltz-rated-flow-summary-panel> </div> </uib-tab> <uib-tab index=2 heading=\"Authoritative Sources\" ng-if=$ctrl.visibility.authSourcesList select=\"$ctrl.tabSelected(\\'authSources\\', 2)\"> <div class=waltz-panel-content> <waltz-auth-sources-table ng-if=\"$ctrl.authSources.length > 0\" auth-sources=$ctrl.authSources parent-entity-ref=$ctrl.parentEntityRef show-consumers=true> </waltz-auth-sources-table> <waltz-no-data ng-if=\"$ctrl.authSources.length === 0\"> <message> <strong> None defined </strong> </message> </waltz-no-data> </div> </uib-tab> <uib-tab index=3 heading=\"Non Authoritative Sources\" select=\"$ctrl.tabSelected(\\'nonAuthSources\\', 3)\"> <div class=waltz-panel-content> <waltz-non-auth-sources-panel non-auth-sources=$ctrl.nonAuthSources ng-if=\"!($ctrl.nonAuthSources | isEmpty)\"> </waltz-non-auth-sources-panel> <waltz-no-data ng-if=\"$ctrl.nonAuthSources | isEmpty\"> <message> <strong> No Non-Authoritative Sources distributing data </strong> </message> </waltz-no-data> </div> </uib-tab> </uib-tabset> <div class=row> <div class=col-md-12> <waltz-static-panels group-key=SECTION.AUTH_SOURCES.ABOUT class=\"small text-muted\" render-mode=minimal-border> </waltz-static-panels> </div> </div> </div>'},803:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.id=e.component=void 0;var i=d(n(1)),a=n(0),r=d(n(804)),l=n(2),o=n(82),s=n(5),c=n(19);function d(t){return t&&t.__esModule?t:{default:t}}var u={rowInfo:i.default.map([\"PRIMARY\",\"SECONDARY\",\"DISCOURAGED\",\"NO_OPINION\"],function(t){return{rating:t,style:{\"border-radius\":\"2px\",\"border-color\":(0,c.authoritativeRatingColorScale)(t).toString(),\"background-color\":(0,c.authoritativeRatingColorScale)(t).brighter(2).toString()}}}),visibility:{chart:!1}},p=130,f=60,m={selector:\"#wassp-inbound\",transform:\"translate(\"+f+\", \"+p/2+\")\",startAngle:Math.PI,endAngle:2*Math.PI},v={selector:\"#wassp-outbound\",transform:\"translate(0, \"+p/2+\")\",startAngle:Math.PI,endAngle:0},g={PRIMARY:0,SECONDARY:0,DISCOURAGED:0,NO_OPINION:0};function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=Object.assign({},g);return i.default.reduce(t,function(t,e){return t[e.rating]=t[e.rating]+=e.count,t},e)}function y(t,e){var n=(0,a.initialiseData)(this,u),r=function(t,e){var n=(0,s.select)(e.selector).append(\"svg\").attr(\"width\",f).attr(\"height\",p).append(\"g\").attr(\"transform\",e.transform);if(!(0==i.default.sum(i.default.values(t)))){var a=i.default.map(t,function(t,e){return{value:t,key:e}}),r=(0,o.pie)().value(function(t){return t.value}).startAngle(e.startAngle).endAngle(e.endAngle)(a),l=(0,o.arc)().outerRadius(f-10).innerRadius(.4*f).padAngle(.07).cornerRadius(0);n.selectAll(\".arc\").data(r).enter().append(\"path\").classed(\"arc\",!0).attr(\"fill\",function(t){return(0,c.authoritativeRatingColorScale)(t.data.key).brighter()}).attr(\"stroke\",function(t){return(0,c.authoritativeRatingColorScale)(t.data.key)}).attr(\"d\",function(t){return l(t)})}},d=function(){!function(e,a){t.all([e,a]).then(function(){var t=i.default.sum(i.default.values(n.inboundStats)),e=i.default.sum(i.default.values(n.outboundStats));n.visibility.chart=t+e>0})}(e.loadViewData(l.CORE_API.LogicalFlowDecoratorStore.summarizeInboundBySelector,[{entityReference:n.parentEntityRef,scope:\"CHILDREN\"}]).then(function(t){n.inboundStats=h(t.data),r(n.inboundStats,m)}),e.loadViewData(l.CORE_API.LogicalFlowDecoratorStore.summarizeOutboundBySelector,[{entityReference:n.parentEntityRef,scope:\"CHILDREN\"}]).then(function(t){n.outboundStats=h(t.data),r(n.outboundStats,v)}))};n.$onInit=function(){d()}}y.$inject=[\"$q\",\"ServiceBroker\"];e.component={bindings:{parentEntityRef:\"<\"},template:r.default,controller:y},e.id=\"waltzAuthSourcesSummaryPanel\"},804:function(t,e){t.exports='<div class=row> <div class=col-sm-12 ng-if=\"! $ctrl.visibility.chart\"> <waltz-no-data> <message> <strong>No flow data</strong> could be found, therefore unable to show authoritative source summary </message> </waltz-no-data> </div> <div class=col-sm-8 ng-show=$ctrl.visibility.chart> <waltz-basic-info-tile name=\"Authoritative Inbound / Outbound Summary\"> <span id=wassp-inbound> </span> <span style=margin:1.5em> <table class=\"small waltz-mini-table\" style=display:inline-table;vertical-align:top;margin-top:.6em> <thead> <tr> <th style=text-align:center>Inbound</th> <th style=text-align:center>Rating</th> <th style=text-align:center>Outbound</th> </tr> </thead> <tbody> <tr ng-repeat=\"row in $ctrl.rowInfo\"> <td style=text-align:center> <div ng-style=\"{ \\'opacity\\' : $ctrl.inboundStats[row.rating] > 0 ? 1 : 0.3 }\"> <div ng-bind=$ctrl.inboundStats[row.rating] style=\"border:1px solid;padding:1px;margin:1px\" ng-style=row.style> </div> </div> </td> <td style=text-align:center> <waltz-enum-value type=\"\\'AuthoritativenessRating\\'\" show-icon=false key=row.rating> </waltz-enum-value> </td> <td style=text-align:center> <div ng-style=\"{ \\'opacity\\' : $ctrl.outboundStats[row.rating] > 0 ? 1 : 0.3 }\"> <div ng-bind=$ctrl.outboundStats[row.rating] style=\"border:1px solid;padding:1px;margin:1px\" ng-style=row.style> </div> </div> </td> </tr> </tbody> </table> </span> <span id=wassp-outbound> </span> </waltz-basic-info-tile> </div> </div>'},805:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.id=e.component=void 0;var i=o(n(806)),a=n(0),r=n(24),l=o(n(1));function o(t){return t&&t.__esModule?t:{default:t}}var s={placeholder:\"Search...\"};function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,r.buildHierarchies)(t,!1)}function d(){var t=(0,a.initialiseData)(this,s);t.$onChanges=function(){var e=l.default.map(t.items,function(t){var e=!!l.default.isUndefined(t.concrete)||t.concrete;return Object.assign({},t,{concrete:e})});t.searchNodes=(0,r.prepareSearchNodes)(e),t.hierarchy=c(e)},t.treeOptions={nodeChildren:\"children\",dirSelectable:!0,equality:function(t,e){return t&&e&&t.id===e.id}},t.doSearch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",n=(0,r.doSearch)(e,t.searchNodes);t.hierarchy=c(n),t.expandedNodes=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.length<6?l.default.clone(t):[]}(t.hierarchy)}}d.$inject=[];e.component={controller:d,bindings:{onSelect:\"<\",items:\"<\",placeholder:\"@?\"},template:i.default},e.id=\"waltzTreePicker\"},806:function(t,e){t.exports='<div class=row> <div class=col-md-6> <waltz-search-control on-query=$ctrl.doSearch min-characters=2 delay=200 placeholdertext=\"Search Data Types\"> </waltz-search-control> </div> </div> <div class=row style=padding-top:.7em> <div class=col-md-12> <treecontrol class=tree-light tree-model=$ctrl.hierarchy order-by=\"\\'-name\\'\" expanded-nodes=$ctrl.expandedNodes options=$ctrl.treeOptions> <span class=clickable ng-if=node.concrete ng-click=$ctrl.onSelect(node)> <strong ng-bind=node.name uib-popover={{node.description}} popover-append-to-body=true popover-placement=right popover-trigger=mouseenter> </strong> </span> <span ng-if=\"node.concrete == false\" style=cursor:not-allowed uib-popover={{node.description}} popover-append-to-body=true popover-placement=right popover-trigger=mouseenter ng-bind=node.name> </span> </treecontrol> </div> </div> '},807:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(5);n(45);var a=n(19),r=8,l=3;function o(t,e){var n=[\"PRIMARY\",\"SECONDARY\"],o=(0,i.select)(e[0]);o.selectAll(\"circle\").data(n).enter().append(\"circle\").attrs({cx:function(t,e){return e*(2*r+2*l)+r+l/2},cy:r+l/2,r:r}),t.$watch(\"value\",function(t){o.selectAll(\"circle\").data(n).attrs({fill:function(e){return e===t?(0,a.authoritativeSourceColorScale)(e):\"#eee\"},stroke:function(e){return e===t?(0,a.authoritativeSourceColorScale)(e).darker():\"#ddd\"}})})}e.default=function(){return{restrict:\"E\",replace:!0,template:'<svg width=\"'+3*(2*r+2*l)+'\" height=\"'+(2*r+l)+'\"></svg>',scope:{value:\"@\"},link:o}}},808:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=p(n(6)),a=n(7),r=p(n(209)),l=p(n(809)),o=p(n(811)),s=p(n(813)),c=p(n(815)),d=p(n(817)),u=p(n(819));function p(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module(\"waltz.bookmarks\",[]);return(0,a.registerStores)(t,[r.default]),(0,a.registerComponents)(t,[s.default,l.default,o.default,d.default,c.default]),t.directive(\"waltzBookmarkForm\",u.default),t.name}},809:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=l(n(1)),a=l(n(810)),r=n(2);function l(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=this;e.$onInit=function(){(function(t){return t.loadAppData(r.CORE_API.EnumValueStore.findAll).then(function(t){return i.default.chain(t.data).filter(function(t){return\"BookmarkKind\"===t.type}).sortBy(\"name\").map(function(t){return{code:t.key,name:t.name,icon:t.icon}}).value()})})(t).then(function(t){return e.kinds=t})},e.onChange=function(t){e.onSelect()?e.onSelect()(t.code,t):console.warn(\"bookmark-kind-select: No handler for change notification is registered.  Please provide an on-select callback\")}}o.$inject=[\"ServiceBroker\"];var s={template:a.default,controller:o,bindings:{selected:\"<\",disabledCondition:\"<\",onSelect:\"&\"}};e.default={component:s,id:\"waltzBookmarkKindSelect\"}},810:function(t,e){t.exports='<div> <ui-select ng-model=$ctrl.selected on-select=\"$ctrl.onChange($item, $model)\" ng-disabled=$ctrl.disabledCondition theme=bootstrap> <ui-select-match placeholder=\"Select a kind of bookmark...\"> <span ng-bind=\"$ctrl.selected | toDisplayName:\\'BookmarkKind\\'\"></span> </ui-select-match> <ui-select-choices repeat=\"kind in $ctrl.kinds | filter:$select.search\"> <waltz-icon name={{kind.icon}} style=display:inline> </waltz-icon> <span ng-bind=kind.name></span> </ui-select-choices> </ui-select> </div> '},811:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(2),a=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n(812));var l={visibility:{editor:!1}};function o(t){var e=(0,a.initialiseData)(this,l),n=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.loadViewData(i.CORE_API.BookmarkStore.findByParent,[e.parentEntityRef],{force:n}).then(function(t){return e.bookmarks=t.data})};e.$onInit=function(){e.parentEntityRef&&n()},e.onReload=function(){n(!0)},e.onDismiss=function(){e.visibility.editor=!1}}o.$inject=[\"ServiceBroker\"];var s={bindings:{parentEntityRef:\"<\"},template:r.default,controller:o};e.default={component:s,id:\"waltzBookmarksSection\"}},812:function(t,e){t.exports='<div> <waltz-section-actions> <a waltz-has-role=BOOKMARK_EDITOR ng-if=!$ctrl.visibility.editor ng-click=\"$ctrl.visibility.editor = true\" class=\"btn btn-xs btn-primary\"> Edit </a> <a waltz-has-role=BOOKMARK_EDITOR ng-if=$ctrl.visibility.editor ng-click=\"$ctrl.visibility.editor = false\" class=\"btn btn-xs btn-info\"> Done </a> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.sourceDataOverlay = ! $ctrl.sourceDataOverlay\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.sourceDataOverlay entities=\"[\\'BOOKMARK\\']\"> </waltz-source-data-overlay> <div ng-if=\"! $ctrl.visibility.editor\"> <waltz-bookmarks-view-panel bookmarks=$ctrl.bookmarks parent-entity-ref=$ctrl.parentEntityRef> </waltz-bookmarks-view-panel> </div> <div ng-if=$ctrl.visibility.editor> <waltz-bookmarks-edit-panel bookmarks=$ctrl.bookmarks parent-entity-ref=$ctrl.parentEntityRef on-reload=$ctrl.onReload on-dismiss=$ctrl.onDismiss> </waltz-bookmarks-edit-panel> </div> </div> '},813:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(n(1)),a=n(0),r=n(2),l=o(n(814));function o(t){return t&&t.__esModule?t:{default:t}}var s={bookmarks:[],kinds:[],currentSelection:null,onSelect:function(t){return\"no onSelect handler defined for bookmark-kinds: \"+t}};function c(t){var e=(0,a.initialiseData)(this,s);e.$onInit=function(){(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=i.default.groupBy(e,\"bookmarkKind\");return t.loadAppData(r.CORE_API.EnumValueStore.findAll).then(function(t){var e=t.data;return i.default.chain(e).filter({type:\"BookmarkKind\"}).sortBy(\"name\").map(function(t){return{code:t.key,name:t.name,icon:t.icon,description:t.description,count:(n[t.key]||[]).length,selected:!1}}).value()})})(t,e.bookmarks).then(function(t){return e.kinds=t})};var n=function(){e.currentSelection&&(e.currentSelection.selected=!1),e.currentSelection=null};e.select=function(t){t.count&&(e.currentSelection!=t&&n(),t.selected=!t.selected,(0,a.invokeFunction)(e.onSelect,t.selected?t.code:null),e.currentSelection=t)},e.clearSelection=function(){(0,a.invokeFunction)(e.onSelect,null),n()}}c.$inject=[\"ServiceBroker\"];var d={bindings:{bookmarks:\"<\",onSelect:\"<\"},template:l.default,controller:c};e.default={component:d,id:\"waltzBookmarkKinds\"}},814:function(t,e){t.exports=\"<div class=waltz-bookmark-kinds> <div ng-repeat=\\\"kind in $ctrl.kinds\\\" ng-click=$ctrl.select(kind) ng-class=\\\"{\\n                'wbk-no-bookmarks': kind.count === 0,\\n                'wbk-selected': kind.selected,\\n                'clickable': kind.count > 0\\n             }\\\" uib-popover={{kind.description}} popover-placement=right popover-trigger=mouseenter popover-popup-delay=300 popover-append-to-body=true> <span> <waltz-icon name={{kind.icon}} size=lg ng-class=\\\"{\\n                            'wbk-has-bookmarks': kind.count > 0,\\n                        }\\\"> </waltz-icon> <span ng-bind=kind.name class=small> </span> </span> <waltz-icon name=times ng-if=kind.selected class=\\\"clickable pull-right\\\"> </waltz-icon> </div> </div>\"},815:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=l(n(1)),a=l(n(816)),r=n(0);function l(t){return t&&t.__esModule?t:{default:t}}var o={bookmarkKind:null,filteredBookmarks:[]};var s={controller:function(){var t=(0,r.initialiseData)(this,o),e=function(){t.filteredBookmarks=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(i.default.isEmpty(t))return[];var n=i.default.groupBy(t,\"bookmarkKind\"),a=e?{kind:n[e]}:n;return i.default.map(a,function(t,e){return{kind:e,bookmarks:t}})}(t.bookmarks,t.bookmarkKind)};t.$onChanges=function(){e()},t.selectBookmarkKind=function(n){t.bookmarkKind=n,e()}},template:a.default,bindings:{bookmarks:\"<\",parentEntityRef:\"<\"}};e.default={id:\"waltzBookmarksViewPanel\",component:s}},816:function(t,e){t.exports='<div> <div class=row ng-if=\"$ctrl.bookmarks.length > 0\"> <div class=col-sm-3> <waltz-bookmark-kinds bookmarks=$ctrl.bookmarks on-select=$ctrl.selectBookmarkKind> </waltz-bookmark-kinds> </div> <div class=col-sm-9> <table class=\"table table-condensed wbs-bookmark-table\"> <colgroup> <col width=10%> <col width=70%> <col width=20%> </colgroup> <tbody ng-repeat=\"bookmarksByKind in $ctrl.filteredBookmarks | orderBy:\\'bookmarkKind\\' \"> <tr ng-repeat=\"bookmark in bookmarksByKind.bookmarks\" class=waltz-visibility-parent> <td style=vertical-align:middle;text-align:center;width:10%> <waltz-icon name=\"{{ bookmark.bookmarkKind | toIconName:\\'BookmarkKind\\' }}\" size=lg> </waltz-icon> </td> <td> <waltz-icon ng-if=bookmark.isPrimary name=star> </waltz-icon> <waltz-icon ng-if=!bookmark.isPrimary class=text-muted name=star-o> </waltz-icon> <waltz-external-link title=\"{{ bookmark.title }}\" url=\"{{ bookmark.url }}\" show-url=true> </waltz-external-link> <div> <div ng-if=bookmark.description class=\"text-muted small\"> <span ng-bind=bookmark.description> </span> </div> <div ng-if=!bookmark.description class=\"text-muted small\"> <i>No description provided</i> </div> </div> </td> <td> <div class=\"small waltz-visibility-child-30\"> Last updated: <div> <span ng-bind=bookmark.lastUpdatedBy></span> , <waltz-from-now timestamp=bookmark.lastUpdatedAt></waltz-from-now> </div> </div> </td> </tr> </tbody> </table> </div> </div> <waltz-no-data ng-if=\"$ctrl.bookmarks.length == 0\"> <message> <strong>No bookmarks</strong> for this <span ng-bind=\"$ctrl.parentEntityRef.kind | toDisplayName:\\'entity\\' | lowercase\"> </span> </message> </waltz-no-data> </div> '},817:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(n(818)),a=n(0),r=n(2);var l={showFilter:!1,visibility:{form:!1},selectedBookmark:null};function o(t,e){var n=(0,a.initialiseData)(this,l);n.edit=function(t){n.selectedBookmark=Object.assign({},t),n.visibility.form=!0},n.create=function(){n.selectedBookmark={bookmarkKind:\"DOCUMENTATION\",lastUpdatedBy:\"ignored, server will set\"},n.visibility.form=!0},n.save=function(i){i.parent=n.parentEntityRef,e.execute(r.CORE_API.BookmarkStore.save,[i]).then(function(){n.onReload(),n.resetForm(),t.success(\"Updated bookmarks\")})},n.resetForm=function(){n.visibility.form=!1,n.bookmark={bookmarkKind:\"DOCUMENTATION\",parent:n.parentEntityRef}},n.remove=function(i){n.visibility.form=!1,confirm(\"Are you sure you want to remove this bookmark ?\")&&e.execute(r.CORE_API.BookmarkStore.remove,[i.id]).then(function(){n.onReload(),t.warning(\"Removed bookmark\")})}}o.$inject=[\"Notification\",\"ServiceBroker\"];var s={controller:o,template:i.default,bindings:{bookmarks:\"<\",onDismiss:\"<\",onReload:\"<\",parentEntityRef:\"<\"}};e.default={id:\"waltzBookmarksEditPanel\",component:s}},818:function(t,e){t.exports='<div> <div ng-if=\"$ctrl.bookmarks.length > 0\"> <table class=\"table table-condensed\"> <colgroup> <col width=3%> <col width=15%> <col width=20%> <col width=22%> <col width=25%> <col width=15%> </colgroup> <thead> <tr> <th></th> <th>Kind</th> <th>Title</th> <th>URL</th> <th>Description</th> <th>Actions</th> </tr> </thead> <tbody> <tr ng-repeat=\"bookmark in $ctrl.bookmarks\" class=waltz-visibility-parent> <td> <span ng-if=bookmark.isPrimary> <waltz-icon name=star></waltz-icon> </span> <span ng-if=!bookmark.isPrimary> <waltz-icon name=star-o></waltz-icon> </span> </td> <td> <waltz-enum-value type=\"\\'BookmarkKind\\'\" key=bookmark.bookmarkKind> </waltz-enum-value> </td> <td> <span ng-bind=bookmark.title></span> </td> <td> <span ng-bind=bookmark.url></span> </td> <td> <span ng-bind=bookmark.description></span> </td> <td> <span class=waltz-visibility-child-50> <a class=\"clickable wbep-action-remove\" ng-if=\"! bookmark.isRequired\" ng-click=$ctrl.remove(bookmark)> Remove </a> <span ng-if=\"! bookmark.isRequired\"> | </span> <a class=\"clickable wbep-action-edit\" ng-click=$ctrl.edit(bookmark)> Edit </a> </span> </td> </tr> </tbody> </table> </div> <waltz-no-data ng-if=\"$ctrl.bookmarks.length == 0\"> <message> <strong>No bookmarks</strong> have been registered yet </message> </waltz-no-data> <div> <div ng-if=!$ctrl.visibility.form> <button ng-click=$ctrl.create() class=\"btn btn-sm btn-primary\"> Add New </button> &nbsp; <a class=clickable ng-click=$ctrl.onDismiss()> Done </a> </div> </div> <div ng-if=$ctrl.visibility.form> <hr> <waltz-bookmark-form bookmark=$ctrl.selectedBookmark confirm-label=\"{{ $ctrl.selectedBoookmark.id ? \\'Edit\\' : \\'Save\\'}}\" on-cancel=\"$ctrl.visibility.form = false\" on-submit=$ctrl.save(bookmark)> </waltz-bookmark-form> </div> </div> '},819:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(n(820));function r(t){var e=this;this.confirmLabel=this.confirmLabel||\"Save\",this.onKindSelect=function(t){e.bookmark.bookmarkKind=t},this.togglePrimary=function(){e.bookmark.isPrimary=!e.bookmark.isPrimary},this.submit=function(){e.onSubmit&&e.onSubmit()?e.onSubmit()(e.bookmark):console.warn(\"bookmark-form: submission handler missing.  Please provide an on-submit callback\")},this.cancel=function(){e.onCancel?e.onCancel():console.warn(\"bookmark-form: cancel handler missing.  Please provide an on-cancel callback\")};var n=function(){var t=e.bookmark.url;e.submitDisabled=(0,i.isEmpty)(t)};t.$watch(\"ctrl.bookmark\",n,!0),n()}r.$inject=[\"$scope\"],e.default=function(){return{restrict:\"E\",replace:!0,scope:{bookmark:\"=\",onSubmit:\"&\",onCancel:\"&\",confirmLabel:\"@\"},template:a.default,controller:r,controllerAs:\"ctrl\",bindToController:!0}}},820:function(t,e){t.exports='<form name=bookmarkForm class=form-horizontal novalidate role=form ng-submit=\"ctrl.onSubmit({bookmark: ctrl.bookmark})\"> <div class=form-group> <label for=title class=\"col-sm-2 control-label\"> Title </label> <div class=col-sm-10> <input class=form-control id=title placeholder=\"Link title\" ng-disabled=ctrl.bookmark.isRequired ng-model=ctrl.bookmark.title> <p class=help-block>Provide a descriptive title for this link</p> </div> </div> <div class=form-group> <label for=url class=\"col-sm-2 control-label\"> * URL </label> <div class=col-sm-10> <input class=form-control id=url ng-model=ctrl.bookmark.url maxlength=500 placeholder=URL> </div> </div> <div class=form-group> <label class=\"col-sm-2 control-label\"> Kind </label> <div class=col-sm-10> <waltz-bookmark-kind-select selected=ctrl.bookmark.bookmarkKind disabled-condition=ctrl.bookmark.isRequired on-select=ctrl.onKindSelect> </waltz-bookmark-kind-select> <p class=help-block>Categorize this bookmark according to its purpose</p> </div> </div> <div class=form-group> <label class=\"col-sm-2 control-label\"> Primary </label> <div class=col-sm-10> <waltz-toggle label-on=Primary label-off=\"Not primary\" icon-on=star icon-off=star-o on-toggle=ctrl.togglePrimary() state=ctrl.bookmark.isPrimary> </waltz-toggle> <p class=help-block>Primary links will be given preference when shown in views</p> </div> </div> <div class=form-group> <label for=description class=\"col-sm-2 control-label\"> Description </label> <div class=col-sm-10> <textarea rows=8 cols=80 id=description ng-model=ctrl.bookmark.description>\\n            </textarea> </div> </div> <div class=form-group> <div class=\"col-sm-offset-2 col-sm-10\"> <button type=submit ng-disabled=ctrl.submitDisabled class=\"btn btn-success\"> {{ ctrl.confirmLabel }} </button> <a ng-click=ctrl.cancel() class=clickable> Cancel </a> </div> </div> </form>'},821:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=d(n(6)),a=n(7),r=d(n(210)),l=d(n(822)),o=d(n(824)),s=d(n(826)),c=d(n(828));function d(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module(\"waltz.change.initiative\",[]);return t.config(c.default),(0,a.registerStore)(t,r.default),t.directive(\"waltzChangeInitiativeSelector\",l.default),(0,a.registerComponents)(t,[o.default,s.default]),t.name}},822:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(2),a=function(t){return t&&t.__esModule?t:{default:t}}(n(823));var r={results:[]};function l(t){var e=Object.assign(this,r);e.refresh=function(n){n&&t.execute(i.CORE_API.ChangeInitiativeStore.search,[n]).then(function(t){return e.results=t.data})}}l.$inject=[\"ServiceBroker\"];var o={restrict:\"E\",replace:!0,template:a.default,controller:l,controllerAs:\"ctrl\",bindToController:{model:\"=\"},scope:{}};e.default=function(){return o}},823:function(t,e){t.exports='<div class=waltz-change-initiative-selector> <ui-select ng-model=ctrl.model theme=bootstrap> <ui-select-match placeholder=\"Search for change initiative...\"> <span ng-bind=$select.selected.externalId class=wcis-selected-text></span> <span class=wcis-selected-text> - </span> <span ng-bind=$select.selected.name class=wcis-selected-text></span> </ui-select-match> <ui-select-choices repeat=\"result in ctrl.results\" refresh=ctrl.refresh($select.search) refresh-delay=300> <span class=small ng-bind-html=\"result.externalId | highlight: $select.search\"></span> - <span ng-bind-html=\"result.name | highlight: $select.search\"></span> <small style=display:block ng-bind-html=\"result.description | highlight: $select.search\"></small> </ui-select-choices> </ui-select> </div>'},824:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=d(n(1)),a=n(2),r=n(0),l=n(17),o=d(n(825)),s=n(148),c=n(29);function d(t){return t&&t.__esModule?t:{default:t}}var u={changeInitiatives:[],changeInitiativeLifecyclePhaseByKey:{},selectedChange:null,visibility:{sourcesOverlay:!1},gridOptions:{columnDefs:[{field:\"externalId\",name:\"id\",cellTemplate:'\\n    <div class=\"ui-grid-cell-contents\" style=\"vertical-align: baseline; \">\\n        <a ng-click=\"grid.appScope.onSelectViaGrid(row.entity)\"\\n           class=\"clickable\">\\n            <span ng-bind=\"row.entity.externalId\"></span>\\n            &nbsp;\\n            <waltz-icon name=\"{{row.entity.icon}}\" rotate=\"270\"></waltz-icon>\\n        </a>\\n    </div>\\n'},{field:\"name\",cellTemplate:'\\n    <div class=\"ui-grid-cell-contents\">\\n        <a ng-click=\"grid.appScope.onSelectViaGrid(row.entity)\"\\n           class=\"clickable\">\\n            <span ng-bind=\"row.entity.name\"></span>\\n        </a>\\n    </div>\\n'},{field:\"kindName\",name:\"Kind\"},{field:\"lifecyclePhaseName\",name:\"Phase\"}],data:[]}};function p(t){var e=(0,r.initialiseData)(this,u);e.onSelectViaGrid=function(t){e.selectedChange=t},e.onClearSelection=function(){return e.selectedChange=null},e.$onInit=function(){t.loadAppData(a.CORE_API.EnumValueStore.findAll).then(function(t){e.changeInitiativeLifecyclePhaseByKey=i.default.chain(t.data).filter({type:\"changeInitiativeLifecyclePhase\"}).map(function(t){return{key:t.key,name:t.name}}).keyBy(\"key\").value()})},e.$onChanges=function(n){e.parentEntityRef&&n.parentEntityRef.previousValue.id!==n.parentEntityRef.currentValue.id&&t.loadViewData(a.CORE_API.ChangeInitiativeStore.findHierarchyBySelector,[(0,l.mkSelectionOptions)(e.parentEntityRef)]).then(function(t){return function(t){var n=i.default.groupBy(t,\"parentId\"),a=i.default.chain(t).filter(function(t){return!t.parentId}).map(function(t){var i=n[t.id]||[],a=i.length>0?\"sitemap\":\"fw\",r={kindName:(0,c.getEnumName)(s.changeInitiative,t.changeInitiativeKind),lifecyclePhaseName:(0,c.getEnumName)(e.changeInitiativeLifecyclePhaseByKey,t.lifecyclePhase),icon:a,parent:null,children:i};return Object.assign({},t,r)}).value();e.changeInitiatives=a,e.gridOptions.data=a}(t.data)})}}p.$inject=[\"ServiceBroker\"];var f={template:o.default,bindings:{parentEntityRef:\"<\"},controller:p};e.default={component:f,id:\"waltzChangeInitiativeSection\"}},825:function(t,e){t.exports='<div> <waltz-section-actions> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.visibility.sourcesOverlay = ! $ctrl.visibility.sourcesOverlay\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.visibility.sourcesOverlay entities=\"[\\'CHANGE_INITIATIVE\\']\"> </waltz-source-data-overlay> <div class=row ng-if=\"$ctrl.changeInitiatives.length > 0\"> <div class=col-md-7> <waltz-grid-with-search column-defs=$ctrl.gridOptions.columnDefs entries=$ctrl.gridOptions.data scope-provider=$ctrl search-placeholder-text=Search...> </waltz-grid-with-search> </div> <div class=col-md-5> <div style=padding-top:1em class=small ng-if=$ctrl.selectedChange> <waltz-sub-section name=Detail> <content> <div class=waltz-sub-section-content> <div class=row> <div class=\"col-sm-3 waltz-display-field-label\"> Name </div> <div class=col-sm-9> <span ng-bind=$ctrl.selectedChange.name></span> </div> </div> <div class=row> <div class=\"col-sm-3 waltz-display-field-label\"> Start&nbsp;/&nbsp;End </div> <div class=col-sm-9> <span ng-bind=$ctrl.selectedChange.startDate></span> / <span ng-bind=$ctrl.selectedChange.endDate></span> </div> </div> <div class=row> <div class=\"col-sm-3 waltz-display-field-label\"> Description </div> <div class=col-sm-9> <span ng-bind=$ctrl.selectedChange.description></span> </div> </div> <div class=row ng-if=\"$ctrl.selectedChange.children.length > 0\"> <div class=col-sm-12> <div style=\"border-top:1px solid #eee;padding-top:1em;margin-top:1em\"> <div class=waltz-display-field-label> Children </div> <table class=\"table table-condensed small\"> <colgroup> <col width=10%> <col width=70%> <col width=20%> </colgroup> <tbody> <tr ng-repeat=\"child in $ctrl.selectedChange.children\" uib-popover={{child.description}} popover-trigger=mouseenter popover-popup-delay=300 popover-placement=left popover-append-to-body=true> <td> <a ui-sref=\"main.change-initiative.view ({ id: child.id })\" class=clickable> <span ng-bind=child.externalId></span> </a> </td> <td> <span ng-bind=child.name></span> </td> <td><span ng-bind=child.lifecyclePhaseName></span></td> </tr> </tbody> </table> </div> </div> </div> </div> <div class=waltz-sub-section-controls> <span> <a ng-click=$ctrl.onClearSelection() class=clickable> Close </a> &nbsp;|&nbsp; <a ui-sref=\"main.change-initiative.view ({id: $ctrl.selectedChange.id})\" class=clickable> More </a> </span> </div> </content> </waltz-sub-section> </div> </div> </div> <waltz-no-data ng-if=\"$ctrl.changeInitiatives.length == 0\"> <message> No associated Change Initiatives found </message> </waltz-no-data> </div>'},826:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=u(n(1)),a=n(2),r=n(0),l=n(17),o=n(24),s=n(148),c=n(29),d=u(n(827));function u(t){return t&&t.__esModule?t:{default:t}}var p='\\n    <div class=\"ui-grid-cell-contents\" style=\"vertical-align: baseline; \">\\n        <a ng-click=\"grid.appScope.$ctrl.onSelectViaGrid(row.entity)\"\\n           class=\"clickable\">\\n            <span ng-bind=\"row.entity.externalId\"></span>\\n            &nbsp;\\n            <waltz-icon name=\"{{row.entity.children.length > 0 ? \\'sitemap\\' : \\'fw\\'}}\" rotate=\"270\"></waltz-icon>\\n        </a>\\n    </div>\\n',f='\\n    <div class=\"ui-grid-cell-contents\">\\n        <a ng-click=\"grid.appScope.$ctrl.onSelectViaGrid(row.entity)\"\\n           class=\"clickable\">\\n            <span ng-bind=\"row.entity.name\"></span>\\n        </a>\\n    </div>\\n',m={selectedChange:null,visibility:{sourcesOverlay:!1},changeInitiativeLifecyclePhaseByKey:{},children:[],childrenGridOptions:{columnDefs:[{field:\"externalId\",name:\"id\",cellTemplate:p},{field:\"name\",cellTemplate:f},{field:\"kindName\",name:\"Kind\"},{field:\"lifecyclePhaseName\",name:\"Phase\"}],data:[],enableGridMenu:!1,enableColumnMenus:!1},parents:[],parentGridOptions:{columnDefs:[{field:\"externalId\",name:\"id\",cellTemplate:p},{field:\"name\",cellTemplate:f},{field:\"kindName\",name:\"Kind\"},{field:\"lifecyclePhaseName\",name:\"Phase\"}],data:[],enableGridMenu:!1,enableColumnMenus:!1}};function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.default.map(t,function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={kindName:(0,c.getEnumName)(s.changeInitiative,t.changeInitiativeKind),lifecyclePhaseName:(0,c.getEnumName)(e,t.lifecyclePhase)};return Object.assign({},t,n)}(t,e)});return(0,o.buildHierarchies)(n)}function g(t){var e=(0,r.initialiseData)(this,m);e.onSelectViaGrid=function(t){e.selectedChange=t},e.onClearSelection=function(){return e.selectedChange=null},e.$onInit=function(){t.loadAppData(a.CORE_API.EnumValueStore.findAll).then(function(t){e.changeInitiativeLifecyclePhaseByKey=i.default.chain(t.data).filter({type:\"changeInitiativeLifecyclePhase\"}).map(function(t){return{key:t.key,name:t.name}}).keyBy(\"key\").value()})},e.$onChanges=function(){e.parentEntityRef&&(t.loadViewData(a.CORE_API.ChangeInitiativeStore.findBySelector,[(0,l.mkSelectionOptions)(e.parentEntityRef,\"CHILDREN\")],{force:!0}).then(function(t){e.children=i.default.reject(t.data,{id:e.parentEntityRef.id}),e.childrenGridOptions.data=v(e.children,e.changeInitiativeLifecyclePhaseByKey)}),t.loadViewData(a.CORE_API.ChangeInitiativeStore.findBySelector,[(0,l.mkSelectionOptions)(e.parentEntityRef,\"PARENTS\")],{force:!0}).then(function(t){e.parents=i.default.reject(t.data,{id:e.parentEntityRef.id}),e.parentGridOptions.data=v(e.parents,e.changeInitiativeLifecyclePhaseByKey)}))}}g.$inject=[\"ServiceBroker\"];var h={template:d.default,bindings:{parentEntityRef:\"<\"},controller:g};e.default={component:h,id:\"waltzChangeInitiativeNavigatorSection\"}},827:function(t,e){t.exports=' <div> <waltz-section-actions> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.visibility.sourcesOverlay = ! $ctrl.visibility.sourcesOverlay\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.visibility.sourcesOverlay entities=\"[\\'CHANGE_INITIATIVE\\']\"> </waltz-source-data-overlay> <div class=row ng-if=\"$ctrl.parents.length > 0 || $ctrl.children.length > 0\"> <div class=col-md-7> <div ng-if=\"$ctrl.parents.length > 0\"> <h4>Parents</h4> <div class=small> <div ui-grid=$ctrl.parentGridOptions ui-grid-exporter class=waltz-grid style=min-height:100px> </div> </div> </div> <div ng-if=\"$ctrl.children.length > 0\"> <h4>Children</h4> <div class=small> <div ui-grid=$ctrl.childrenGridOptions ui-grid-exporter class=waltz-grid style=min-height:150px> </div> </div> </div> </div> <div class=col-md-5> <div style=padding-top:1em class=small ng-if=$ctrl.selectedChange> <waltz-sub-section name=Detail> <content> <div class=waltz-sub-section-content> <div class=row> <div class=\"col-sm-3 waltz-display-field-label\"> Name </div> <div class=col-sm-9> <span ng-bind=$ctrl.selectedChange.name></span> </div> </div> <div class=row> <div class=\"col-sm-3 waltz-display-field-label\"> Start&nbsp;/&nbsp;End </div> <div class=col-sm-9> <span ng-bind=$ctrl.selectedChange.startDate></span> / <span ng-bind=$ctrl.selectedChange.endDate></span> </div> </div> <div class=row> <div class=\"col-sm-3 waltz-display-field-label\"> Description </div> <div class=col-sm-9> <span ng-bind=$ctrl.selectedChange.description></span> </div> </div> <div class=row ng-if=\"$ctrl.selectedChange.children.length > 0\"> <div class=col-sm-12> <div style=\"border-top:1px solid #eee;padding-top:1em;margin-top:1em\"> <div class=waltz-display-field-label> Children </div> <table class=\"table table-condensed small\"> <colgroup> <col width=10%> <col width=70%> <col width=20%> </colgroup> <tbody> <tr ng-repeat=\"child in $ctrl.selectedChange.children\" uib-popover={{child.description}} popover-trigger=mouseenter popover-popup-delay=300 popover-placement=left popover-append-to-body=true> <td> <a ui-sref=\"main.change-initiative.view ({ id: child.id })\" class=clickable> <span ng-bind=child.externalId></span> </a> </td> <td> <span ng-bind=child.name></span> </td> <td><span ng-bind=child.lifecyclePhaseName></span></td> </tr> </tbody> </table> </div> </div> </div> </div> <div class=waltz-sub-section-controls> <span> <a ng-click=$ctrl.onClearSelection() class=clickable> Close </a> &nbsp;|&nbsp; <a ui-sref=\"main.change-initiative.view ({id: $ctrl.selectedChange.id})\" class=clickable> More </a> </span> </div> </content> </waltz-sub-section> </div> </div> </div> <waltz-no-data ng-if=\"$ctrl.parents.length == 0 && $ctrl.children.length == 0\"> <message> No associated Change Initiatives found </message> </waltz-no-data> </div>'},828:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i={url:\"change-initiative\"},a={url:\"/{id:int}\",views:{\"content@\":function(t){return t&&t.__esModule?t:{default:t}}(n(829)).default}};function r(t){t.state(\"main.change-initiative\",i).state(\"main.change-initiative.view\",a)}r.$inject=[\"$stateProvider\"],e.default=r},829:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(2),a=function(t){return t&&t.__esModule?t:{default:t}}(n(830));var r={changeInitiative:{},related:{appGroupRelationships:[]},sections:[],availableSections:[]};function l(t,e,n,a){var l=t.id,o=Object.assign(this,r);o.entityRef={kind:\"CHANGE_INITIATIVE\",id:l},o.$onInit=function(){a.loadViewData(i.CORE_API.ChangeInitiativeStore.getById,[l]).then(function(t){var e=t.data;o.changeInitiative=e,o.entityRef=Object.assign({},o.entityRef,{name:o.changeInitiative.name,description:o.changeInitiative.description}),n.put(e.name,\"CHANGE_INITIATIVE\",\"main.change-initiative.view\",{id:e.id})}),o.availableSections=e.findAvailableSectionsForKind(\"CHANGE_INITIATIVE\"),o.sections=e.findUserSectionsForKind(\"CHANGE_INITIATIVE\")},o.addSection=function(t){return o.sections=e.openSection(t,\"CHANGE_INITIATIVE\")},o.removeSection=function(t){return o.sections=e.removeSection(t,\"CHANGE_INITIATIVE\")}}l.$inject=[\"$stateParams\",\"DynamicSectionManager\",\"HistoryStore\",\"ServiceBroker\"];var o={template:a.default,controller:l,controllerAs:\"ctrl\"};e.default=o},830:function(t,e){t.exports='<div> <waltz-page-header name=\"{{ ctrl.changeInitiative.name }}\" icon=paper-plane-o small=\"{{ ctrl.changeInitiative.changeInitiativeKind | toDisplayName:\\'changeInitiative\\' }}\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>Change Initiative</li> <li><span ng-bind=ctrl.changeInitiative.name></span></li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <div class=row> <div class=col-sm-7> <div class=waltz-display-section> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Name </div> <div class=col-sm-4> <span ng-bind=ctrl.changeInitiative.name></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> External Id </div> <div class=col-sm-4> <span ng-bind=ctrl.changeInitiative.externalId></span> </div> </div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Type </div> <div class=col-sm-4> <span ng-bind=\"ctrl.changeInitiative.changeInitiativeKind | toDisplayName:\\'changeInitiative\\'\"></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Phase </div> <div class=col-sm-4> <span ng-bind=\"ctrl.changeInitiative.lifecyclePhase | toDisplayName:\\'changeInitiativeLifecyclePhase\\'\"></span> </div> </div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Start </div> <div class=col-sm-4> <span ng-bind=ctrl.changeInitiative.startDate></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> End </div> <div class=col-sm-4> <span ng-bind=ctrl.changeInitiative.endDate></span> </div> </div> <waltz-entity-enum parent-entity-ref=ctrl.entityRef> </waltz-entity-enum> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Description </div> <div class=col-sm-10> <waltz-markdown text=ctrl.changeInitiative.description> </waltz-markdown> </div> </div> <br> </div> </div> <div class=col-sm-5> <waltz-assessment-rating-sub-section parent-entity-ref=ctrl.entityRef> </waltz-assessment-rating-sub-section> </div> </div> </div> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-dynamic-section-navigation available-sections=ctrl.availableSections open-sections=ctrl.sections on-select=ctrl.addSection> </waltz-dynamic-section-navigation> </div> <br> <waltz-dynamic-sections-view sections=ctrl.sections parent-entity-ref=ctrl.entityRef on-remove=ctrl.removeSection> </waltz-dynamic-sections-view> </div>'},880:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=c(n(6)),a=n(7),r=c(n(211)),l=c(n(881)),o=c(n(884)),s=c(n(886));function c(t){return t&&t.__esModule?t:{default:t}}e.default=function(){var t=i.default.module(\"waltz.change.log\",[]);return t.config(l.default),(0,a.registerStores)(t,[r.default]),t.component(\"waltzChangeLogSection\",o.default).component(\"waltzChangeLogTable\",s.default),t.name}},881:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i={url:\"change-log\"},a={url:\"/view/entity/:kind/:id?name\",views:{\"content@\":function(t){return t&&t.__esModule?t:{default:t}}(n(882)).default}};function r(t){t.state(\"main.change-log\",i).state(\"main.change-log.view\",a)}r.$inject=[\"$stateProvider\"],e.default=r},882:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=o(n(1)),a=n(0),r=n(2),l=o(n(883));function o(t){return t&&t.__esModule?t:{default:t}}var s={entries:[],entityRef:null};function c(t,e){var n=(0,a.initialiseData)(this,s),l={kind:t.kind,id:i.default.toNumber(t.id),name:t.name};n.changeLogTableInitialised=function(t){n.exportChangeLog=function(){return t.exportFn(\"change-log.csv\")}},n.entityRef=l,e.loadViewData(r.CORE_API.ChangeLogStore.findByEntityReference,[n.entityRef,null]).then(function(t){return n.entries=t.data})}c.$inject=[\"$stateParams\",\"ServiceBroker\"];var d={template:l.default,controller:c,controllerAs:\"ctrl\"};e.default=d},883:function(t,e){t.exports='<div> <waltz-page-header name=\"Change Log\" small=\"{{ ctrl.entityRef.name }}\"> </waltz-page-header> <waltz-section name=Entries> <waltz-section-actions> <button ng-click=ctrl.exportChangeLog() class=\"btn btn-xs btn-primary\" ng-if=\"ctrl.entries.length > 0\"> <waltz-icon name=cloud-download></waltz-icon> Export </button> </waltz-section-actions> <div ng-if=\"ctrl.entries.length > 0\"> <waltz-change-log-table entries=ctrl.entries on-initialise=ctrl.changeLogTableInitialised> </waltz-change-log-table> </div> <div ng-if=\"ctrl.entries.length == 0\"> <i class=text-muted> No changes yet </i> </div> </waltz-section> </div>'},884:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0),a=n(2),r=function(t){return t&&t.__esModule?t:{default:t}}(n(885));var l={entries:[]};function o(t){var e=(0,i.initialiseData)(this,l),n=function(){var n=function(t){e.entries=t.data};e.parentEntityRef?t.loadViewData(a.CORE_API.ChangeLogStore.findByEntityReference,[e.parentEntityRef],{force:!0}).then(n):e.userName&&t.loadViewData(a.CORE_API.ChangeLogStore.findForUserName,[e.userName],{force:!0}).then(n)};e.$onChanges=function(t){(e.parentEntityRef||e.userName)&&n()},e.refresh=function(){return n()},e.changeLogTableInitialised=function(t){e.exportChangeLog=function(){return t.exportFn(\"change-log.csv\")}}}o.$inject=[\"ServiceBroker\"];var s={bindings:{parentEntityRef:\"<\",userName:\"<\"},template:r.default,controller:o};e.default=s},885:function(t,e){t.exports='<div> <waltz-section-actions> <button ng-click=$ctrl.exportChangeLog() class=\"btn btn-xs btn-primary\" ng-if=\"$ctrl.entries.length > 0\"> <waltz-icon name=cloud-download></waltz-icon> Export </button> </waltz-section-actions> <div ng-if=\"$ctrl.entries.length > 0\"> <waltz-change-log-table entries=$ctrl.entries on-initialise=$ctrl.changeLogTableInitialised> </waltz-change-log-table> <br> <div class=pull-right ng-if=$ctrl.parentEntityRef> <a class=clickable ui-sref=\"main.change-log.view ($ctrl.parentEntityRef)\"> Show all changes </a> | <a class=clickable ng-click=$ctrl.refresh()> Refresh now </a> </div> </div> <waltz-no-data ng-if=\"$ctrl.entries.length == 0\"> <message> <strong>No changes yet</strong> </message> </waltz-no-data> </div> '},886:function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var i=n(0);var a={};var r={bindings:{entries:\"<\",onInitialise:\"<\"},template:function(t){return t&&t.__esModule?t:{default:t}}(n(887)).default,controller:function(){(0,i.initialiseData)(this,a).columnDefs=[{field:\"severity\",name:\"Severity\",width:\"10%\",cellFilter:\"toDisplayName:'severity'\"},{field:\"message\",name:\"Message\",width:\"70%\"},{field:\"userId\",name:\"User\",width:\"10%\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><a ui-sref=\"main.profile.view ({userId: COL_FIELD})\"><span ng-bind=\"COL_FIELD\"></span></a></div>'},{field:\"createdAt\",name:\"Timestamp\",width:\"10%\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><waltz-from-now timestamp=\"COL_FIELD\"></waltz-from-now></div>'}]}};e.default=r},887:function(t,e){t.exports='<div> <waltz-grid-with-search column-defs=$ctrl.columnDefs entries=$ctrl.entries search-placeholder-text=\"Search changes...\" on-initialise=$ctrl.onInitialise> </waltz-grid-with-search> </div>'}}]);","extractedComments":[]}