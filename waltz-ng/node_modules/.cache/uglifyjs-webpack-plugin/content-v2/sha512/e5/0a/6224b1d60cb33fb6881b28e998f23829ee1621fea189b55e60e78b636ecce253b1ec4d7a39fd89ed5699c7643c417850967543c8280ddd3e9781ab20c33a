{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{116:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.defaultOptions=void 0,t.setupZoom=function(e){var t=r.on(\"zoom.myZoom\",function(){var t=i.event.transform.x,n=i.event.transform.y,a=i.event.transform.k;e.rowAxisContent.attr(\"transform\",\"translate(0 \"+n+\") scale(\"+a+\")\"),e.columnAxisContent.attr(\"transform\",\"translate(\"+t+\" 0) scale(\"+a+\")\"),e.gridContent.attr(\"transform\",i.event.transform)});return e.svg.call(t)},t.removeZoom=function(e){return e.svg.on(\".zoom\",null)},t.resetZoom=function(e){e.svg.transition().duration(800).call(r.transform,a.zoomIdentity.scale(1).translate(1,1))};var a=n(118),i=n(5),r=(t.defaultOptions={cols:3,sortFn:function(e){return e.node.name}},(0,a.zoom)().scaleExtent([.1,2]))},117:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.ROW_DIMENSIONS=t.ROW_CELL_DIMENSIONS=t.CELL_DIMENSIONS=void 0;var a=n(157);t.CELL_DIMENSIONS={padding:10,height:a.NODE_DIMENSIONS.height+10,width:a.NODE_DIMENSIONS.width+10},t.ROW_CELL_DIMENSIONS={padding:20},t.ROW_DIMENSIONS={padding:20}},1351:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=p(n(6)),i=n(7),r=p(n(250)),s=p(n(400)),o=p(n(1353)),l=p(n(1355)),c=p(n(1361)),d=p(n(1363)),u=p(n(1366));function p(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.scenario\",[]);return e.config(u.default),(0,i.registerComponents)(e,[l.default,o.default,c.default,d.default,s.default]),(0,i.registerStores)(e,[r.default]),e.name}},1352:function(e,t){e.exports=\"<waltz-scenario-header scenario-id=$ctrl.scenarioId available-sections=$ctrl.availableSections open-sections=$ctrl.sections on-add-section=$ctrl.addSection offset=650> </waltz-scenario-header> <br> <waltz-dynamic-sections-view sections=$ctrl.sections parent-entity-ref=$ctrl.parentEntityRef on-remove=$ctrl.removeSection> </waltz-dynamic-sections-view> \"},1353:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=o(n(1354)),i=n(0),r=n(2),s=o(n(53));function o(e){return e&&e.__esModule?e:{default:e}}var l={LOADING:\"LOADING\",VIEW:\"VIEW\",CONFIGURE_SCENARIO:\"CONFIGURE_SCENARIO\"},c={modes:l,roadmap:null,permissions:{admin:!1,edit:!1},visibility:{mode:l.LOADING}},d=function(e,t){t&&e.put(t.name,\"SCENARIO\",\"main.scenario.view\",{id:t.id})};function u(e,t,n,a,o){var u=(0,i.initialiseData)(this,c);function p(e,t,i){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:\"Updated\";return r&&_.isEmpty(i.newVal)&&!_.isDate(i.newVal)?Promise.reject(\"Waltz:updateField - Cannot set an empty value\"):i.newVal!==i.oldVal?a.execute(t,[e,i.newVal]).then(function(){return n.success(s)}):Promise.reject(\"Nothing updated\")}function v(){var t=a.loadViewData(r.CORE_API.ScenarioStore.getById,[u.scenarioId],{force:!0}).then(function(e){Object.assign(u,e.data),Object.assign(u.roadmap,{kind:\"ROADMAP\"})});return e.all([t])}u.$onInit=function(){u.visibility.mode=l.LOADING,v().then(function(){u.visibility.mode=l.VIEW,d(t,u.scenario)}),o.whoami().then(function(e){return u.permissions={admin:o.hasRole(e,s.default.SCENARIO_ADMIN),edit:o.hasRole(e,s.default.SCENARIO_EDITOR)}})},u.onSaveScenarioName=function(e,t){return p(e.id,r.CORE_API.ScenarioStore.updateName,t,!0,\"Scenario name updated\").then(function(){return v()})},u.onSaveScenarioDescription=function(e,t){return p(e.id,r.CORE_API.ScenarioStore.updateDescription,t,!1,\"Scenario description updated\").then(function(){return v()})},u.onSaveScenarioEffectiveDate=function(e,t){return p(e.id,r.CORE_API.ScenarioStore.updateEffectiveDate,t,!0,\"Scenario target date updated\")},u.onSaveScenarioType=function(e,t){return p(t.id,r.CORE_API.ScenarioStore.updateScenarioType,{newVal:e},!0,\"Scenario type updated\")},u.onConfigureScenario=function(){u.visibility.mode=l.CONFIGURE_SCENARIO},u.onAddAxisItem=function(e){var t=[u.scenario.id,e.orientation,e.domainItem,e.position];return a.execute(r.CORE_API.ScenarioStore.addAxisItem,t)},u.onRemoveAxisItem=function(e){var t=[u.scenario.id,e.orientation,e.domainItem];return a.execute(r.CORE_API.ScenarioStore.removeAxisItem,t)},u.onRepositionAxisItems=function(e,t,n){var i=[u.scenario.id,t,n];return a.execute(r.CORE_API.ScenarioStore.reorderAxis,i)},u.onCancel=function(){u.visibility.mode=l.VIEW,v()}}u.$inject=[\"$q\",\"HistoryStore\",\"Notification\",\"ServiceBroker\",\"UserService\"];var p={bindings:{scenarioId:\"<\",availableSections:\"<\",openSections:\"<\",onAddSection:\"<\"},template:a.default,controller:u};t.default={id:\"waltzScenarioHeader\",component:p}},1354:function(e,t){e.exports='<waltz-page-header name=\"{{ $ctrl.scenario.name }}\" icon=picture-o small=Scenario> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>Roadmaps</li> <li> <a ui-sref=\"main.roadmap.view ({ id: $ctrl.roadmap.id })\"> <span ng-bind=$ctrl.roadmap.name> </span> </a> </li> <li><span ng-bind=$ctrl.scenario.name></span></li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <div ng-switch=$ctrl.visibility.mode> <div ng-switch-when=LOADING> <waltz-loading-notification name=\"Loading scenario\"> </waltz-loading-notification> </div> <div ng-switch-when=CONFIGURE_SCENARIO> <waltz-sub-section name=Configure> <content> <div style=padding:8px> <waltz-roadmap-scenario-config scenario-id=$ctrl.scenario.id on-save-scenario-description=$ctrl.onSaveScenarioDescription on-save-scenario-name=$ctrl.onSaveScenarioName on-save-scenario-effective-date=$ctrl.onSaveScenarioEffectiveDate on-save-scenario-type=$ctrl.onSaveScenarioType on-add-axis-item=$ctrl.onAddAxisItem on-remove-axis-item=$ctrl.onRemoveAxisItem on-reposition-axis-items=$ctrl.onRepositionAxisItems on-cancel=$ctrl.onCancel> </waltz-roadmap-scenario-config> </div> <div class=waltz-sub-section-controls> <span> <a ng-click=$ctrl.onCancel() class=clickable> Close </a> </span> </div> </content> </waltz-sub-section> </div> <div ng-switch-when=VIEW> <div class=row> <div class=col-sm-8> <waltz-sub-section name=Overview> <content> <div style=padding:8px> <div class=row> <div class=col-sm-4> <label>Name:</label> </div> <div class=col-sm-8> <span ng-bind=$ctrl.scenario.name></span> </div> </div> <div class=row> <div class=col-sm-4> <label>Effective Date:</label> </div> <div class=col-sm-8> <span ng-bind=$ctrl.scenario.effectiveDate></span> </div> </div> <div class=row> <div class=col-sm-4> <label>Status:</label> </div> <div class=col-sm-8> <span ng-bind=\"$ctrl.scenario.scenarioType | toDisplayName:\\'scenarioType\\'\"></span> </div> </div> <div class=row> <div class=col-sm-4> <label>Description:</label> </div> <div class=col-sm-8> <waltz-markdown text=$ctrl.scenario.description> </waltz-markdown> </div> </div> <div class=row> <div class=col-sm-4> <label>Last updated:</label> </div> <div class=col-sm-8> <waltz-last-updated entity=$ctrl.scenario show-label=false> </waltz-last-updated> </div> </div> </div> <div class=waltz-sub-section-controls ng-if=$ctrl.permissions.edit> <span> <a ng-click=$ctrl.onConfigureScenario() class=clickable> Configure </a> </span> </div> </content> </waltz-sub-section> </div> <div class=col-sm-4> <waltz-sub-section name=\"Owning Roadmap\"> <content> <div style=padding:8px> <table class=waltz-mini-table> <tr> <td><label>Name:</label></td> <td> <waltz-entity-link entity-ref=$ctrl.roadmap></waltz-entity-link> </td> </tr> <tr> <td><label>Description:</label></td> <td><waltz-markdown text=$ctrl.roadmap.description></waltz-markdown></td> </tr> </table> </div> </content> </waltz-sub-section> </div> </div> <br> <waltz-sub-section name=Diagram> <content> <div style=padding:8px> <waltz-roadmap-scenario-diagram scenario-id=$ctrl.scenarioId> </waltz-roadmap-scenario-diagram> </div> <div class=waltz-sub-section-controls> <div uib-popover=\"Exports this scenario\" popover-append-to-body=true popover-trigger=mouseenter> <waltz-data-extract-link name=Export extract=scenario/{{$ctrl.scenarioId}} styling=link filename={{tab.category.name}}.csv> </waltz-data-extract-link> </div> </div> </content> </waltz-sub-section> </div> </div> <br> <waltz-dynamic-section-navigation available-sections=$ctrl.availableSections open-sections=$ctrl.sections on-select=$ctrl.onAddSection offset=650> </waltz-dynamic-section-navigation> </div> '},1355:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(0),i=n(5),r=n(44),s=n(2),o=n(19),l=n(155),c=n(116),d=m(n(1)),u=n(1356),p=n(1359),v=n(0),f=m(n(1360));function m(e){return e&&e.__esModule?e:{default:e}}var y={onNodeClick:function(e){return console.log(\"WSD: NodeClick\",e)},onNodeGridClick:function(e){return console.log(\"WSD: NodeGridClick\",e)}},g={NAME:\"name\",RATING:\"rating\"},h={hiddenAxes:[],panAndZoomEnabled:!1,sortBy:g.NAME,visibility:{diagramControls:!1},ratingScheme:null,layoutOptions:{defaultColMaxWidth:2,sortFn:function(e){return e.node.name}},onUnhideAxis:function(e){return console.log(\"WSD: UnhideAxis\",e)},onUnhideAllAxes:function(e){return console.log(\"WSD: UnhideAllAxes\",e)}};function b(e,t,n){var f=(0,a.initialiseData)(this,h),m=null,b=null,w={title:\"Disable pan and zoom\",action:function(e,n){return t(function(){return f.disablePanAndZoom()})}},S={title:\"Enable pan and zoom\",action:function(e,n){return t(function(){return f.enablePanAndZoom()})}},I={title:\"Reset view\",action:function(e,n){return t(function(){return f.resetPanAndZoom()})}},R={divider:\"pan\"};function E(){f.ratingScheme=d.default.find(f.ratingSchemes,{id:f.ratingSchemeId});var e=(0,o.mkRatingSchemeColorScale)(f.ratingScheme);if(m&&e&&f.rowData){var t=(0,l.filterData)(f.rowData,f.qry),n=d.default.keyBy(f.ratingScheme.ratings,\"rating\");switch(f.sortBy){case g.RATING:f.layoutOptions.sortFn=function(e){return n[e.state.rating]?n[e.state.rating].position:e.node.name};break;case g.NAME:f.layoutOptions.sortFn=function(e){return e.node.name}}var i=(0,u.gridLayout)(t,f.columnHeadings,f.rowHeadings,f.layoutOptions),r={colorScale:e,handlers:function(e){var t=d.default.reduce(e.contextMenus,function(e,t,n){return e[n]=function(e,n,i){var r=[f.panAndZoomEnabled?w:S,I],s=t(e,n,i);return(0,a.isEmpty)(s)?r:d.default.uniq(d.default.concat(s,[R],r))},e},{});return Object.assign(e,{contextMenus:t})}(f.handlers)};!function(e,t,n){(0,p.drawAxis)(t.columnAxisContent,t.rowAxisContent,e,n),(0,u.drawGrid)(t.gridContent,e,n)}(i,m,r)}}f.$onInit=function(){f.handlers=Object.assign({},y,f.handlers),m=function(e){var t=(0,i.select)(e.find(\"svg\")[0]),n=[{name:\"holder\",children:[{name:\"columnAxisHolder\",attrs:{\"clip-path\":\"url(#column-clip)\",transform:\"translate(\"+p.rowAxisWidth+\" 0)\"},children:[{name:\"columnAxisContent\"}]},{name:\"rowAxisHolder\",attrs:{\"clip-path\":\"url(#row-clip)\",transform:\"translate(0 \"+p.columnAxisHeight+\")\"},children:[{name:\"rowAxisContent\"}]},{name:\"gridHolder\",attrs:{\"clip-path\":\"url(#grid-clip)\",transform:\"translate(\"+p.rowAxisWidth+\" \"+p.columnAxisHeight+\")\"},children:[{name:\"gridContent\",attrs:{transform:\"translate(1, 1)\"}}]}]}];return Object.assign({},{svg:t},(0,r.createGroupElements)(t,n))}(e),b=(0,r.responsivefy)(m.svg),n.loadAppData(s.CORE_API.RatingSchemeStore.findAll).then(function(e){return f.ratingSchemes=e.data}).then(E)},f.$onDestroy=function(){b&&b()},f.doSearch=function(){E()},f.$onChanges=function(){E()},f.enablePanAndZoom=function(){f.panAndZoomEnabled=!0,(0,c.setupZoom)(m)},f.disablePanAndZoom=function(){f.panAndZoomEnabled=!1,(0,c.removeZoom)(m)},f.resetPanAndZoom=function(){(0,c.resetZoom)(m)},f.changeSort=function(e){f.sortBy=e,E()},f.showAxis=function(e){(0,v.invokeFunction)(f.onUnhideAxis,e)},f.showAllAxes=function(){(0,v.invokeFunction)(f.onUnhideAllAxes)}}b.$inject=[\"$element\",\"$timeout\",\"ServiceBroker\"];var w={template:f.default,bindings:{ratingSchemeId:\"<\",rowData:\"<\",rowHeadings:\"<\",columnHeadings:\"<\",handlers:\"<?\",hiddenAxes:\"<?\",layoutOptions:\"<?\",onUnhideAxis:\"<?\",onUnhideAllAxes:\"<?\"},controller:b};t.default={component:w,id:\"waltzScenarioDiagram\"}},1356:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.GRID_STYLES=void 0,t.gridLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.defaultOptions,l=Object.assign({},o.defaultOptions,i),c=a.default.map(e,function(e,t){return(0,r.rowLayout)(e,t,l)}),d=a.default.map(c,function(e){return e.layout.maxCellRows}),u=a.default.map(c,function(e){return e.layout.colWidths}),p=a.default.unzip(u),v=a.default.map(p,a.default.max),f=(0,s.toCumulativeCounts)(v),m=(0,s.toCumulativeCounts)(d),y=a.default.concat([0],f),g=a.default.concat([0],m);return{layout:{rowHeights:d,colWidths:v,colOffsets:y,rowOffsets:g,cumulativeColWidths:f,cumulativeRowHeights:m,totalHeight:a.default.sum(d),totalWidth:a.default.sum(v),colCount:v.length,rowCount:d.length},gridData:c,columnHeaders:t,rowHeaders:n}},t.drawGrid=function(e,t,n){var s=e.selectAll(\".\"+r.ROW_STYLES.row).data(t.gridData),o=s.enter().append(\"g\").classed(r.ROW_STYLES.row,!0);s.exit().remove(),s.merge(o).attr(\"transform\",function(e,n){var r=a.default.sum(a.default.take(t.layout.rowHeights,n))*i.CELL_DIMENSIONS.height,s=n*i.ROW_DIMENSIONS.padding,o=r+s;return\"translate(0 \"+o+\")\"}).call(d,n,t).call(r.drawRow,n,t.layout.colWidths)};var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),i=n(117),r=n(1357),s=n(156),o=n(116),l=n(115);var c=t.GRID_STYLES={columnDivider:\"wrd-column-divider\",rowDivider:\"wrd-row-divider\",nodeGridBackground:\"wrd-node-grid-background\"};function d(e,t,n){var r=e.selectAll(\".\"+c.nodeGridBackground).data(function(e,t){return a.default.map(n.columnHeaders,function(a,i){return{id:t+\".\"+i,colOffset:n.layout.colOffsets[i],colWidth:n.layout.colWidths[i],column:a.data,row:n.rowHeaders[t].data,rowHeight:e.layout.maxCellRows}})},function(e){return e.id}),s=a.default.get(t,[\"handlers\",\"contextMenus\",\"nodeGrid\"],null);r.enter().append(\"rect\").classed(c.nodeGridBackground,!0).attr(\"fill\",\"#fafafa\").attr(\"stroke\",\"#eee\").attr(\"stroke-width\",1.5).on(\"click\",t.handlers.onNodeGridClick).on(\"contextmenu\",s?(0,l.d3ContextMenu)(s):null).merge(r).attr(\"x\",function(e,t){return e.colOffset*i.CELL_DIMENSIONS.width+t*i.ROW_CELL_DIMENSIONS.padding}).attr(\"width\",function(e,t){return e.colWidth*i.CELL_DIMENSIONS.width+i.CELL_DIMENSIONS.padding}).attr(\"height\",function(e,t){return e.rowHeight*i.CELL_DIMENSIONS.height+i.CELL_DIMENSIONS.padding}),r.exit().remove()}},1357:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.ROW_STYLES=void 0,t.drawRow=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=e.selectAll(\"g.\"+o.rowCell).data(function(e){return e.data},function(e){return e.id});s.exit().remove(),s.enter().append(\"g\").classed(o.rowCell,!0).merge(s).attr(\"transform\",function(e,t){var r=a.default.sum(a.default.take(n,t)),s=r*i.CELL_DIMENSIONS.width+t*i.ROW_CELL_DIMENSIONS.padding;return\"translate(\"+s+\" 0)\"}).call(r.drawNodeGrid,t)},t.rowLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.defaultOptions,i=a.default.map(e,function(e,a){return(0,r.nodeGridLayout)(e,{row:t,col:a},n)}),o=a.default.chain(i).map(function(e){return e.layout.rowCount}).max().value(),l=a.default.chain(i).map(function(e){return e.layout.colCount}).value();return{type:\"rowLayout\",id:t,layout:{maxCellRows:o,colWidths:l},data:i}};var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),i=n(117),r=n(1358),s=n(116);var o=t.ROW_STYLES={row:\"wrd-row\",rowCell:\"wrd-row-cell\"}},1358:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.drawNodeGrid=function(e,t){var n=e.selectAll(\"g.\"+i.NODE_STYLES.nodeCell).data(function(e){return e.data},function(e){return e.id}),r=a.default.get(t,[\"handlers\",\"contextMenus\",\"node\"],null),o=n.enter().append(\"g\").classed(i.NODE_STYLES.nodeCell,!0).call(i.drawUnit,t).on(\"contextmenu\",r?(0,l.d3ContextMenu)(r):null);n.exit().remove(),o.merge(n).attr(\"transform\",function(e){var t=s.CELL_DIMENSIONS.padding+s.CELL_DIMENSIONS.height*e.layout.row,n=s.CELL_DIMENSIONS.padding+s.CELL_DIMENSIONS.width*e.layout.col;return\"translate(\"+n+\" \"+t+\")\"}).call(i.updateUnit,t)},t.nodeGridLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.defaultOptions;(0,r.checkTrue)(n.defaultColMaxWidth>0,\"gridLayout: Num cols must be greater than zero\");var i=a.default.get(a.default.head(e),[\"domainCoordinates\",\"column\",\"id\"]),s=n.maxColWidths[i]||n.defaultColMaxWidth,l=a.default.chain(e).orderBy(n.sortFn).map(function(e,t){var n={col:t%s,row:Math.floor(t/s)};return Object.assign({},e,{layout:n})}).value(),u={colCount:Math.min(s,e.length)||c,rowCount:Math.ceil(e.length/s)||d};return{id:t.col+\",\"+t.row,kind:\"nodeGridLayout\",data:l,layout:u}};var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),i=n(157),r=n(8),s=n(117),o=n(116),l=n(115);var c=.5,d=.5},1359:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.columnAxisHeight=t.rowAxisWidth=void 0,t.drawAxis=function(e,t,n,c){var d=n.layout;(function(e,t,n,s){var c=e.selectAll(\".\"+l.header).data(t,function(e){return e.id}),d=a.default.get(s,[\"handlers\",\"contextMenus\",\"axisItem\"],null),u=c.enter().append(\"g\").classed(l.header,!0).on(\"contextmenu\",d?(0,o.d3ContextMenu)(d):null);u.append(\"rect\").attr(\"fill\",\"none\").attr(\"width\",1e3).style(\"pointer-events\",\"visible\"),u.append(\"text\").text(function(e){return e.name}),c.exit().remove();var p=c.merge(u);p.attr(\"transform\",function(e,t){var a=i.ROW_DIMENSIONS.padding*t,r=n.rowOffsets[t]*i.CELL_DIMENSIONS.height;return\"translate (0 \"+(r+a)+\")\"}),p.select(\"rect\").attr(\"height\",function(e,t){var a=i.ROW_DIMENSIONS.padding/2,r=n.rowHeights[t]*i.CELL_DIMENSIONS.height;return a+r}),p.select(\"text\").attr(\"y\",function(e,t){var a=n.rowHeights[t]*i.CELL_DIMENSIONS.height;return a/2+r.NODE_DIMENSIONS.text.fontSize})})(t,n.rowHeaders,d,c),function(e,t,n,r){var c=e.selectAll(\".\"+l.header).data(t,function(e){return e.id}),d=a.default.get(r,[\"handlers\",\"contextMenus\",\"axisItem\"],null),u=c.enter().append(\"g\").classed(l.header,!0).on(\"contextmenu\",d?(0,o.d3ContextMenu)(d):null);u.append(\"rect\").attr(\"fill\",\"none\").attr(\"height\",1e3).style(\"pointer-events\",\"visible\"),u.append(\"text\").filter(function(e){return e.name.length>4}).append(\"title\").text(function(e){return e.name}),c.exit().remove();var p=c.merge(u);p.attr(\"transform\",function(e,t){var a=i.ROW_CELL_DIMENSIONS.padding*t,r=n.colOffsets[t]*i.CELL_DIMENSIONS.width;return\"translate (\"+(r+a)+\" 0)\"}),p.select(\"rect\").attr(\"width\",function(e,t){var a=i.ROW_CELL_DIMENSIONS.padding/2,r=n.colWidths[t]*i.CELL_DIMENSIONS.width;return a+r}),p.select(\"text\").attr(\"text-anchor\",\"middle\").attr(\"y\",16).attr(\"x\",function(e,t){var a=n.colWidths[t]*i.CELL_DIMENSIONS.width;return a/2}).text(function(e,t){return(0,s.truncate)(e.name,25*n.colWidths[t],\"...\")})}(e,n.columnHeaders,d,c)};var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),i=n(117),r=n(157),s=n(39),o=n(115);t.rowAxisWidth=150,t.columnAxisHeight=50;var l={header:\"wrd-axis-header\"}},1360:function(e,t){e.exports=' <div class=waltz-scenario-diagram> <div class=row> <div class=col-sm-6> <input class=\"form-control col-sm-3 input-sm\" type=search placeholder=\"Search for application by name or code\" ng-change=$ctrl.doSearch() ng-model-options=\"{ debounce: 200 }\" ng-model=$ctrl.qry> </div> </div> <br> <div class=row> <div class=col-sm-12> <div> <a ng-click=\"$ctrl.visibility.diagramControls = true\" ng-if=\"$ctrl.visibility.diagramControls === false\" class=clickable> Show Diagram Controls </a> <a ng-click=\"$ctrl.visibility.diagramControls = false\" ng-if=\"$ctrl.visibility.diagramControls === true\" class=clickable> Hide Diagram Controls </a> </div> <div ng-if=$ctrl.visibility.diagramControls> <div class=row> <div class=col-sm-6> <div> <label>Sort by:</label> <br> <label> <input name=name type=radio ng-model=$ctrl.sortBy ng-change=\"$ctrl.changeSort(\\'name\\')\" value=name /> Name </label> &nbsp; <label> <input name=rating type=radio ng-model=$ctrl.sortBy ng-change=\"$ctrl.changeSort(\\'rating\\')\" value=rating /> Rating </label> </div> <br> <div> <label>Hidden Axes:</label> <a ng-click=$ctrl.showAllAxes() ng-if=\"$ctrl.hiddenAxes.length > 0\" class=\"clickable small\"> show all <waltz-icon name=eye></waltz-icon> </a> <div class=\"small text-muted\">Axes can be hidden from the right click context menu</div> <div ng-repeat=\"axis in $ctrl.hiddenAxes\"> <span ng-bind=axis.name></span> <a ng-click=$ctrl.showAxis(axis) class=clickable title=show> <waltz-icon name=eye></waltz-icon> </a> </div> </div> <br> <div> <label>Pan & Zoom:</label> <br> <button class=\"btn btn-primary btn-sm\" ng-if=\"! $ctrl.panAndZoomEnabled\" ng-click=$ctrl.enablePanAndZoom()> Enable pan & zoom </button> <button class=\"btn btn-primary btn-sm\" ng-if=$ctrl.panAndZoomEnabled ng-click=$ctrl.disablePanAndZoom()> Disable pan & zoom </button> <button class=\"btn btn-primary btn-sm\" ng-click=$ctrl.resetPanAndZoom()> Reset </button> </div> </div> <div class=col-sm-6> <label>Legend:</label> <br> <waltz-rating-scheme-legend rating-scheme=$ctrl.ratingScheme> </waltz-rating-scheme-legend> </div> </div> </div> </div> </div> <br> <svg width=1600 class=no-text-select style=\"border-top:1px solid #eee;margin-bottom:0\" height=800 viewBox=\"0 0 1600 800\"> <clipPath id=grid-clip> <rect x=0 y=0 width=1450 height=1150 /> </clipPath> <clipPath id=columns-clip> <rect x=0 y=0 width=1450 height=50 /> </clipPath> <clipPath id=row-clip> <rect x=0 y=0 width=600 height=1150 /> </clipPath> </svg> </div> '},1361:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=o(n(1362)),i=n(0),r=o(n(53)),s=n(150);function o(e){return e&&e.__esModule?e:{default:e}}var l={permissions:{admin:!1,edit:!1},actions:[],scenarios:[]};function c(e){var t=(0,i.initialiseData)(this,l);t.$onInit=function(){e.whoami().then(function(n){return t.permissions={admin:e.hasRole(n,r.default.SCENARIO_ADMIN),edit:e.hasRole(n,r.default.SCENARIO_EDITOR)}}).then(function(){t.actions=[a,c,d,n,o,u]})};var n={type:\"action\",name:\"Clone\",predicate:function(){return t.permissions.admin},icon:\"clone\",description:\"Makes a copy of this scenario\",execute:function(e){return t.onCloneScenario(e)}},a={type:\"action\",predicate:function(e){return t.permissions.admin&&e.releaseStatus===s.releaseLifecycleStatus.DRAFT.key},name:\"Publish\",icon:\"arrow-up\",description:\"Makes this scenario viewable by all users\",execute:function(e){return t.onPublishScenario(e)}},o={type:\"action\",predicate:function(e){return t.permissions.admin&&e.releaseStatus===s.releaseLifecycleStatus.ACTIVE.key},name:\"Retire\",icon:\"arrow-down\",description:\"Marks this scenario as retired\",execute:function(e){return t.onRetireScenario(e)}},c={type:\"action\",predicate:function(e){return t.permissions.admin&&e.releaseStatus===s.releaseLifecycleStatus.ACTIVE.key},name:\"Draft\",icon:\"arrow-left\",description:\"Marks this scenario as in draft\",execute:function(e){return t.onRevertToDraftScenario(e)}},d={type:\"action\",predicate:function(e){return t.permissions.admin&&e.releaseStatus===s.releaseLifecycleStatus.DEPRECATED.key},name:\"Republish\",icon:\"arrow-left\",description:\"Marks this scenario as published\",execute:function(e){return t.onRepublishScenario(e)}},u={type:\"action\",predicate:function(e){return t.permissions.admin&&e.releaseStatus===s.releaseLifecycleStatus.DRAFT.key},name:\"Delete\",icon:\"trash\",description:\"Delete this scenario (cannot be recovered)\",execute:function(e){return t.onDeleteScenario(e)}}}c.$inject=[\"UserService\"];var d={bindings:{scenarios:\"<\",onAddScenario:\"<\",onCloneScenario:\"<\",onSelectScenario:\"<\",onConfigureScenario:\"<\",onPublishScenario:\"<\",onRetireScenario:\"<\",onRevertToDraftScenario:\"<\",onRepublishScenario:\"<\",onDeleteScenario:\"<\"},template:a.default,controller:c};t.default={id:\"waltzScenarioList\",component:d}},1362:function(e,t){e.exports=' <table class=\"small table table-condensed\"> <colgroup> <col width=30%> <col width=10%> <col width=10%> <col width=10%> <col width=20%> <col width=20%> </colgroup> <thead> <tr> <th>Scenario Name</th> <th>Effective Date Date</th> <th>Type</th> <th>Release Status</th> <th>Operations</th> <th>Last modified</th> </tr> </thead> <tr ng-repeat=\"scenario in $ctrl.scenarios track by scenario.id\" class=waltz-visibility-parent> <td> <span uib-popover-template=\"\\'wsl-popover.html\\'\" popover-trigger=mouseenter popover-enable=scenario.description popover-popup-delay=300 popover-append-to-body=true> <a ui-sref=\"main.scenario.view ({ id: scenario.id })\" class=clickable> <span ng-bind=scenario.name></span> </a> </span> </td> <td> <span ng-bind=scenario.effectiveDate> </span> </td> <td> <span class=small ng-bind=\"scenario.scenarioType | toDisplayName:\\'scenarioType\\'\"> </span> </td> <td> <span class=small ng-bind=\"scenario.releaseStatus | toDisplayName:\\'releaseLifecycleStatus\\'\"> </span> </td> <td> <span class=waltz-visibility-child-30> <waltz-mini-actions ctx=scenario actions=$ctrl.actions> </waltz-mini-actions> </span> </td> <td> <waltz-last-updated entity=scenario show-label=false> </waltz-last-updated> </td> </tr> <tr ng-if=$ctrl.permissions.admin> <td colspan=4></td> <td colspan=2> <a ng-click=$ctrl.onAddScenario(roadmap) class=clickable> <waltz-icon name=plus> </waltz-icon> Add new scenario </a> </td> </tr> </table> <script type=text/ng-template id=wsl-popover.html> <div class=\"small\">\\n        <strong ng-bind=\"scenario.name\"></strong>\\n        <hr>\\n        <waltz-markdown text=\"scenario.description\"></waltz-markdown>\\n    </div> <\\/script>'},1363:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=c(n(1)),i=n(0),r=n(2),s=n(150),o=n(1364),l=c(n(1365));function c(e){return e&&e.__esModule?e:{default:e}}var d={LOADING:\"LOADING\",LIST:\"LIST\",CONFIGURE_SCENARIO:\"CONFIGURE_SCENARIO\"},u={modes:d,scenarios:[],selectedScenario:null,visibility:{mode:d.LOADING}};function p(e,t,n){var l=(0,i.initialiseData)(this,u);function c(e,t){if(\"REMOVED\"===t.entityLifecycleStatus){var n=\"Cannot make changes to a roadmap that is deleted\";return e.error(n),Promise.reject(n)}return Promise.resolve()}function p(e,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"Success\",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:\"Failed\";t.execute(r.CORE_API.ScenarioStore.updateReleaseStatus,[e,a.key]).then(function(){return v()}).then(function(){return n.success(i)}).catch(function(e){return console.log(\"WSLS: \"+s,{error:e}),n.warning(s+\": \"+e.message)})}function v(){var n=t.loadViewData(r.CORE_API.RoadmapStore.getRoadmapById,[l.roadmapId]).then(function(e){return l.roadmap=e.data}),a=t.loadViewData(r.CORE_API.ScenarioStore.findForRoadmap,[l.roadmapId],{force:!0}).then(function(e){return l.scenarios=e.data});return e.all([a,n])}l.$onInit=function(){l.visibility.mode=d.LOADING,v().then(function(){return l.visibility.mode=d.LIST})},l.onAddScenario=function(){return c(n,l.roadmap).then(function(){var e=a.default.chain(l.scenarios).filter(function(e){return e.roadmapId=l.roadmap.id}).map(function(e){return e.name.toLowerCase()}).value(),i=\"New Scenario for \"+l.roadmap.name,s=prompt(\"Enter a name for the new scenario\",i);if(s){if(a.default.includes(e,s.toLowerCase())){var o=\"Cannot create a scenario with the same name as an existing scenario\";return n.error(o),Promise.reject(o)}return t.execute(r.CORE_API.RoadmapStore.addScenario,[l.roadmap.id,s]).then(function(){n.success(\"New scenario created\"),v()})}return Promise.reject(\"Create cancelled by user\")})},l.onCloneScenario=function(e){return c(n,l.roadmap).then(function(){var a=prompt(\"Please enter a new name for the scenario\",\"Clone of \"+e.name);if(a)return t.execute(r.CORE_API.ScenarioStore.cloneById,[e.id,a]).then(function(){return v()}).then(function(){return n.success(\"Scenario cloned\")})})},l.onPublishScenario=function(e){return c(n,l.roadmap).then(function(){return(0,o.confirmWithUser)('PUBLISH: Please confirm that you want scenario: \"'+e.name+'\" to be published',function(){return p(e.id,s.releaseLifecycleStatus.ACTIVE,\"Scenario published\",\"Failed to publish scenario\")})})},l.onRevertToDraftScenario=function(e){return c(n,l.roadmap).then(function(){return(0,o.confirmWithUser)('REVERT: Please confirm that you want to revert scenario: \"'+e.name+'\" back to draft',function(){return p(e.id,s.releaseLifecycleStatus.DRAFT,\"Scenario reverted to draft\",\"Failed to revert scenario to draft\")})})},l.onRetireScenario=function(e){return c(n,l.roadmap).then(function(){return(0,o.confirmWithUser)('RETIRE: Please confirm that you want scenario: \"'+e.name+'\" to be retired',function(){return p(e.id,s.releaseLifecycleStatus.DEPRECATED,\"Scenario retired\",\"Failed to retire scenario\")})})},l.onRepublishScenario=function(e){return c(n,l.roadmap).then(function(){return(0,o.confirmWithUser)('REPUBLISH: Please confirm that you want scenario: \"'+e.name+'\" to be republished',function(){return p(e.id,s.releaseLifecycleStatus.ACTIVE,\"Scenario republished\",\"Failed to republish scenario\")})})},l.onDeleteScenario=function(e){return c(n,l.roadmap).then(function(){return(0,o.confirmWithUser)('DELETE: Please confirm that you want scenario: \"'+e.name+'\" to be deleted, it cannot be recovered',function(){return t.execute(r.CORE_API.ScenarioStore.removeScenario,[e.id]).then(function(){return v()}).then(function(){return n.success(\"Scenario deleted\")}).catch(function(e){return console.log(\"WSLS: Failed to delete scenario\",{error:e}),n.warning(\"Failed to delete scenario: \"+e.message)})})})},l.onCancel=function(){l.visibility.mode=d.LIST,v()}}p.$inject=[\"$q\",\"ServiceBroker\",\"Notification\"];var v={bindings:{roadmapId:\"<\"},template:l.default,controller:p};t.default={id:\"waltzScenarioListSection\",component:v}},1365:function(e,t){e.exports=' <waltz-section name=Scenarios> <div ng-switch=$ctrl.visibility.mode> <div ng-switch-when=LOADING> <waltz-loading-notification name=\"Loading scenarios\"> </waltz-loading-notification> </div> <div ng-switch-when=LIST> <waltz-no-data ng-if=\"! $ctrl.scenarios\"> <message> <strong>No Scenarios</strong> associated with this roadmap </message> </waltz-no-data> <waltz-scenario-list scenarios=$ctrl.scenarios on-add-scenario=$ctrl.onAddScenario on-select-scenario=$ctrl.onSelectScenario on-clone-scenario=$ctrl.onCloneScenario on-publish-scenario=$ctrl.onPublishScenario on-revert-to-draft-scenario=$ctrl.onRevertToDraftScenario on-retire-scenario=$ctrl.onRetireScenario on-republish-scenario=$ctrl.onRepublishScenario on-delete-scenario=$ctrl.onDeleteScenario on-configure-scenario=$ctrl.onConfigureScenario> </waltz-scenario-list> <p class=help-block> Scenarios are used to show possible future states </p> </div> <div ng-switch-when=CONFIGURE_SCENARIO> <waltz-roadmap-scenario-config scenario-id=$ctrl.selectedScenario.id on-save-scenario-description=$ctrl.onSaveScenarioDescription on-save-scenario-name=$ctrl.onSaveScenarioName on-save-scenario-effective-date=$ctrl.onSaveScenarioEffectiveDate on-save-scenario-type=$ctrl.onSaveScenarioType on-add-axis-item=$ctrl.onAddAxisItem on-remove-axis-item=$ctrl.onRemoveAxisItem on-reposition-axis-items=$ctrl.onRepositionAxisItems on-cancel=$ctrl.onCancel> </waltz-roadmap-scenario-config> </div> </div> </waltz-section>'},1366:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a={},i={url:\"scenario/{id:int}\",views:{\"content@\":function(e){return e&&e.__esModule?e:{default:e}}(n(400)).default.component}};function r(e){e.state(\"main.scenario\",a).state(\"main.scenario.view\",i)}r.$inject=[\"$stateProvider\"],t.default=r},1367:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(6)),i=n(7),r=s(n(253));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.shared.preference\",[]);return(0,i.registerStores)(e,[r.default]),e.name}},1368:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=l(n(6)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(251)),r=n(7),s=l(n(1369)),o=l(n(1371));function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.server.info\",[]);return e.component(\"waltzServerPies\",s.default),e.directive(\"waltzServerList\",o.default),(0,r.registerStores)(e,[i]),e.name}},1369:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(19),i=n(0),r=n(109),s=function(e){return e&&e.__esModule?e:{default:e}}(n(1370));var o=70,l={size:o,colorProvider:function(e){return(0,a.variableScale)(e.data.key)},labelProvider:function(e){return r.endOfLifeStatus[e.key]?r.endOfLifeStatus[e.key].name:\"Unknown\"}};function c(){var e=this;e.pie={env:{config:{size:o,colorProvider:function(e){return(0,a.environmentColorScale)(e.data.key)}}},os:{config:{size:o,colorProvider:function(e){return(0,a.operatingSystemColorScale)(e.data.key)}}},location:{config:{size:o,colorProvider:function(e){return(0,a.variableScale)(e.data.key)}}},operatingSystemEndOfLifeStatus:{config:l},hardwareEndOfLifeStatus:{config:l}},e.$onChanges=function(){e.servers&&function(t){t&&(e.pie.env.data=(0,i.toKeyCounts)(t,function(e){return e.environment}),e.pie.os.data=(0,i.toKeyCounts)(t,function(e){return e.operatingSystem}),e.pie.location.data=(0,i.toKeyCounts)(t,function(e){return e.location}),e.pie.operatingSystemEndOfLifeStatus.data=(0,i.toKeyCounts)(t,function(e){return e.operatingSystemEndOfLifeStatus}),e.pie.hardwareEndOfLifeStatus.data=(0,i.toKeyCounts)(t,function(e){return e.hardwareEndOfLifeStatus}))}(e.servers)}}c.$inject=[];var d={bindings:{servers:\"<\"},template:s.default,controller:c};t.default=d},1370:function(e,t){e.exports='<div> <div class=row> <div class=col-sm-4> <waltz-pie-table data=$ctrl.pie.os.data config=$ctrl.pie.os.config title=\"By Operating System\"> </waltz-pie-table> </div> <div class=col-sm-4> <waltz-pie-table data=$ctrl.pie.env.data config=$ctrl.pie.env.config title=\"By Environment\"> </waltz-pie-table> </div> <div class=col-sm-4> <waltz-pie-table data=$ctrl.pie.location.data config=$ctrl.pie.location.config title=\"By Location\"> </waltz-pie-table> </div> </div> <div class=row> <div class=col-sm-4> <waltz-pie-table data=$ctrl.pie.operatingSystemEndOfLifeStatus.data config=$ctrl.pie.operatingSystemEndOfLifeStatus.config title=\"By Operating System EOL Status\"> </waltz-pie-table> </div> <div class=col-sm-4> <waltz-pie-table data=$ctrl.pie.hardwareEndOfLifeStatus.data config=$ctrl.pie.hardwareEndOfLifeStatus.config title=\"By Hardware EOL Status\"> </waltz-pie-table> </div> </div> </div>'},1371:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1372));var i={servers:\"=\",primaryAssetCode:\"=?\"};function r(e){this.gridOptions={enableSorting:!0,enableFiltering:!0,enableHorizontalScrollbar:e.scrollbars.NEVER,columnDefs:[{field:\"hostname\"},{field:\"environment\"},{field:\"virtual\",displayName:\"Virtual\",filter:{type:e.filter.SELECT,selectOptions:[{value:\"true\",label:\"Yes\"},{value:\"false\",label:\"No\"}]},cellTemplate:'<div class=\"ui-grid-cell-contents\"> <waltz-icon ng-if=\"COL_FIELD\" name=\"check\"></waltz-icon></div>'},{field:\"operatingSystem\"},{field:\"operatingSystemVersion\",displayName:\"Version\"},{field:\"location\"},{field:\"country\"}],data:this.servers}}r.$inject=[\"uiGridConstants\"],t.default=function(){return{restrict:\"E\",replace:!0,scope:{},template:a.default,bindToController:i,controllerAs:\"ctrl\",controller:r}}},1372:function(e,t){e.exports='<div> <style>.inherited-server{font-style:italic}</style> <uib-tabset> <uib-tab heading=Overview> <waltz-server-pies servers=ctrl.servers> </waltz-server-pies> </uib-tab> <uib-tab heading=Details select=\"showDetail=true\"> <div ng-if=showDetail> <br> <div style=font-size:smaller;height:300px ui-grid=ctrl.gridOptions> </div> </div> </uib-tab> </uib-tabset> </div> '},1373:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=c(n(6)),i=c(n(1374)),r=c(n(1375)),s=c(n(1377)),o=c(n(1379)),l=c(n(1381));function c(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.software.catalog\",[]);return e.service(\"SoftwareCatalogStore\",i.default),e.component(\"waltzSimpleSoftwareUsagePies\",r.default),e.directive(\"waltzSimpleSoftwareUsageList\",s.default).directive(\"waltzMaturityStatus\",o.default).directive(\"waltzSoftwareCatalogSection\",l.default),e.name}},1374:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1));function i(e,t){var n=t+\"/software-catalog\";return{findByAppIds:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.post(n+\"/apps\",t).then(function(e){return e.data})},findStatsForSelector:function(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"CHILDREN\",s=a.default.isObject(t)?t:{scope:r,entityReference:{id:t,kind:i}};return e.post(n+\"/stats\",s).then(function(e){return e.data})}}}i.$inject=[\"$http\",\"BaseApiUrl\"],t.default=i},1375:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(1)),i=n(19),r=s(n(1376));function s(e){return e&&e.__esModule?e:{default:e}}var o=70;function l(){var e=this;e.pieConfig={maturity:{size:o,colorProvider:function(e){return(0,i.maturityColorScale)(e.data.key)}},vendor:{size:o,colorProvider:function(e){return(0,i.variableScale)(e.data.key)}}};var t=function(){e.pieData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.default.countBy(t,\"softwarePackageId\"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return a.default.chain(e).groupBy(t).map(function(e,t){return{key:t,count:a.default.reduce(e,function(e,t){return e+n[t.id]||1},0)}}).value()};return{maturity:i(e,function(e){return e.maturityStatus}),vendor:i(e,function(e){return e.vendor})}}(e.packages,e.usages)};e.$onChanges=function(){e.packages&&e.usages&&t()}}l.$inject=[];var c={bindings:{usages:\"<\",packages:\"<\"},template:r.default,controller:l};t.default=c},1376:function(e,t){e.exports='<div class=row> <div class=col-sm-6> <waltz-pie-table data=$ctrl.pieData.maturity config=$ctrl.pieConfig.maturity title=\"By Maturity\"> </waltz-pie-table> </div> <div class=col-sm-6> <waltz-pie-table data=$ctrl.pieData.vendor config=$ctrl.pieConfig.vendor title=\"By Vendor\"> </waltz-pie-table> </div> </div>'},1377:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=r(n(1)),i=r(n(1378));function r(e){return e&&e.__esModule?e:{default:e}}var s={catalog:\"=\"},o={usages:[],packages:[]};function l(e){var t=this;e.$watch(\"ctrl.catalog\",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,n=a.default.countBy(e.usages,function(e){return e.softwarePackageId});t.countUsages=function(e){var t=n[e.id];return t>1?\"x \"+t:\"\"}})}l.$inject=[\"$scope\"],t.default=function(){return{restrict:\"E\",replace:!0,scope:{},template:i.default,bindToController:s,controllerAs:\"ctrl\",controller:l}}},1378:function(e,t){e.exports='<div> <table class=\"waltz-simple-software-usage-list small\"> <tbody ng-repeat=\"package in ctrl.catalog.packages | orderBy:\\'vendor\\'\"> <tr> <td> <span> {{ package.vendor }} </span> / <span> <strong> {{ package.name }} </strong> </span> / <span> {{ package.version }} </span> <waltz-maturity-status status=package.maturityStatus> </waltz-maturity-status> <span> &nbsp; {{ ctrl.countUsages(package) }} </span> </td> </tr> <tr> <td class=\"text-muted small\"> {{ package.description }} </td> </tr> </tbody> </table> </div>'},1379:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1380));var i={status:\"=\"};function r(){}r.$inject=[],t.default=function(){return{restrict:\"E\",replace:!0,scope:{},template:a.default,bindToController:i,controllerAs:\"ctrl\",controller:r}}},1380:function(e,t){e.exports=\"<div class=label ng-class=\\\"{\\n        'label-info' : ctrl.status == 'PLANNED',\\n        'label-success' : ctrl.status == 'INVEST',\\n        'label-warning' : ctrl.status == 'HOLD',\\n        'label-danger' : ctrl.status == 'DISINVEST' || ctrl.status == 'UNSUPPORTED' || ctrl.status == 'RESTRICTED'\\n     }\\\"> {{ ctrl.status }} </div>\"},1381:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=o(n(1)),r=n(0),s=o(n(1382));function o(e){return e&&e.__esModule?e:{default:e}}var l={catalog:\"=\"},c=[\"vendor\",\"name\",\"version\",\"maturityStatus\"];function d(e){var t=this;e.$watchGroup([\"ctrl.qry\",\"ctrl.catalog.packages\"],function(e){var n=a(e,2),i=n[0],s=n[1],o=void 0===s?[]:s;t.filteredPackages=i?(0,r.termSearch)(o,i,c):o}),e.$watch(\"ctrl.catalog.usages\",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.usages=i.default.chain(e).groupBy(\"provenance\").value()})}d.$inject=[\"$scope\"],t.default=function(){return{restrict:\"E\",replace:!0,scope:{panel:\"=\"},template:s.default,bindToController:l,controllerAs:\"ctrl\",controller:d}}},1382:function(e,t){e.exports='<div> <waltz-section name=Technologies id=technology> <div ng-if=\"ctrl.catalog.packages.length > 0\"> <waltz-section-actions> <input type=search placeholder=Search style=border-radius:6px;padding-left:3px ng-model=ctrl.qry> </waltz-section-actions> <uib-tabset> <uib-tab heading=Overview> <waltz-simple-software-usage-pies packages=ctrl.filteredPackages usages=ctrl.catalog.usages> </waltz-simple-software-usage-pies> </uib-tab> <uib-tab heading=Detail> <div class=waltz-scroll-region style=height:300px> <waltz-simple-software-usage-list packages=ctrl.filteredPackages usages=ctrl.catalog.usages> </waltz-simple-software-usage-list> </div> </uib-tab> </uib-tabset> <div class=\"waltz-paragraph text-muted pull-right small\"> <waltz-icon name=info-circle></waltz-icon> Associated software packages have been sourced from: <ul class=list-inline style=display:inline-block> <li ng-repeat=\"(source, usages) in ctrl.usages\"> {{ source }} <span ng-if=!$last>,</span> </li> </ul> </div> </div> <waltz-no-data ng-if=\"ctrl.catalog.packages.length == 0 || ! ctrl.catalog\"> <message> <strong>No associated software packages</strong> </message> </waltz-no-data> </waltz-section> </div> '},1383:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=d(n(6)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(254)),r=n(7),s=d(n(1384)),o=d(n(1386)),l=d(n(1388)),c=d(n(1391));function d(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.source.data.ratings\",[]);return e.config(l.default),(0,r.registerStore)(e,i),e.directive(\"waltzSourceDataInfo\",c.default),(0,r.registerComponents)(e,[s.default,o.default]),e.name}},1384:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=o(n(1)),i=n(0),r=n(2),s=o(n(1385));function o(e){return e&&e.__esModule?e:{default:e}}var l={filteredRatings:[],ratings:[],entities:[]};function c(e){var t=(0,i.initialiseData)(this,l);t.$onChanges=function(n){!0===t.visible&&e.loadAppData(r.CORE_API.SourceDataRatingStore.findAll).then(function(e){t.ratings=e.data,t.filteredRatings=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,i.isEmpty)(t)?e:a.default.filter(e,function(e){return a.default.includes(t,e.entityKind)})}(t.ratings,t.entities)})}}c.$inject=[\"ServiceBroker\"];var d={bindings:{entities:\"<\",visible:\"<\"},controller:c,template:s.default};t.default={component:d,id:\"waltzSourceDataOverlay\"}},1385:function(e,t){e.exports='<div> <waltz-overlay-panel name=\"Source Data\" small=\"Ratings & Freshness\" icon=map-signs visible=$ctrl.visible> <div ng-if=\"$ctrl.filteredRatings.length > 0\"> <waltz-source-data-info ratings=$ctrl.filteredRatings> </waltz-source-data-info> </div> <waltz-no-data ng-if=\"$ctrl.filteredRatings.length == 0\"> <message> <strong>No data source ratings</strong> </message> </waltz-no-data> <small class=\"text-muted small pull-right\"> Source Data Ratings are used to indicate confidence levels across aspects of the data sets being presented. </small> </waltz-overlay-panel> </div>'},1386:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a={bindings:{entities:\"<\"},template:function(e){return e&&e.__esModule?e:{default:e}}(n(1387)).default,transclude:!0};t.default={component:a,id:\"waltzSourceDataSectionAddon\"}},1387:function(e,t){e.exports=' <div ng-init=\"$ctrl.visible = false\"> <waltz-section-actions> <ng-transclude></ng-transclude> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.visible = ! $ctrl.visible\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.visible entities=$ctrl.entities> </waltz-source-data-overlay> </div>'},1388:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1389));function i(e){e.state(\"main.source-data-ratings\",{url:\"source-data-ratings\",views:{\"content@\":a.default}})}i.$inject=[\"$stateProvider\"],t.default=i},1389:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1390));var i={ratings:[]};function r(e){var t=Object.assign(this,i);e.findAll().then(function(e){return t.ratings=e})}r.$inject=[\"SourceDataRatingStore\"],t.default={template:a.default,controller:r,controllerAs:\"ctrl\",bindToController:!0,scope:{}}},1390:function(e,t){e.exports='<div> <waltz-page-header name=\"Source Data Ratings\" small=\"\" icon=map-signs> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>Source Data Ratings</li> </ol> </waltz-page-header> <waltz-section name=\"Source Data Ratings\"> <div class=row> <div class=col-md-12> <waltz-source-data-info ratings=ctrl.ratings></waltz-source-data-info> </div> </div> </waltz-section> </div> '},1391:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1392));var i={ratings:\"=\"};function r(){this.accuracyRatingToName=function(e){switch(e){case\"G\":return\"Trusted\";case\"A\":return\"Indeterminate\";case\"R\":return\"Untrusted\";default:return\"Unknown\"}},this.authoritativenessRatingToName=function(e){switch(e){case\"G\":return\"Golden\";case\"A\":return\"Indirect\";case\"R\":return\"'Found'\";default:return\"Unknown\"}},this.completenessRatingToName=function(e){switch(e){case\"G\":return\"Complete\";case\"A\":return\"Partial\";case\"R\":return\"Sparse\";default:return\"Unknown\"}}}r.$inject=[],t.default=function(){return{replace:!0,restrict:\"E\",scope:{},bindToController:i,controllerAs:\"ctrl\",controller:r,template:a.default}}},1392:function(e,t){e.exports='<div> <table class=\"table table-condensed table-striped small\"> <thead> <tr> <th>Type</th> <th>Name</th> <th>Authoritativeness</th> <th>Accuracy</th> <th>Completeness</th> <th>Last Refresh</th> </tr> </thead> <tbody> <tr ng-repeat=\"rating in ctrl.ratings | orderBy:[\\'entityKind\\',\\'sourceName\\']\"> <td> <span ng-bind=\"rating.entityKind | toDisplayName:\\'entity\\'\"></span> </td> <td> <span ng-bind=rating.sourceName></span> </td> <td> <waltz-rag-indicator name=\"{{ ctrl.authoritativenessRatingToName(rating.authoritativeness) }}\" rag-rating=rating.authoritativeness> </waltz-rag-indicator> </td> <td> <waltz-rag-indicator name=\"{{ ctrl.accuracyRatingToName(rating.accuracy) }}\" rag-rating=rating.accuracy> </waltz-rag-indicator> </td> <td> <waltz-rag-indicator name=\"{{ ctrl.completenessRatingToName(rating.completeness) }}\" rag-rating=rating.completeness> </waltz-rag-indicator> </td> <td ng-class=\"{ \\'text-center\\' : ! rating.lastImportDate }\"> <span ng-if=rating.lastImportDate> <waltz-from-now timestamp=rating.lastImportDate> </waltz-from-now> </span> <span title=N/A ng-if=\"! rating.lastImportDate\" class=text-muted> - </span> </td> </tr> </tbody> </table> </div>'},1393:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=l(n(6)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(255)),r=n(7),s=l(n(1394)),o=l(n(1396));function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.static.panel\",[]);return(0,r.registerStore)(e,i),e.component(\"waltzStaticPanels\",s.default).component(\"waltzStaticPanel\",o.default),e.name}},1394:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(0),i=n(2),r=function(e){return e&&e.__esModule?e:{default:e}}(n(1395));var s={renderMode:\"section\"};function o(e){var t=(0,a.initialiseData)(this,s);t.$onChanges=function(){t.groupKey&&e.loadAppData(i.CORE_API.StaticPanelStore.findByGroup,[t.groupKey]).then(function(e){return t.panels=e.data})}}o.$inject=[\"ServiceBroker\"];var l={bindings:{groupKey:\"@\",renderMode:\"@\"},template:r.default,controller:o};t.default=l},1395:function(e,t){e.exports=\"<div class=row> <div class=col-sm-{{panel.width}} ng-repeat=\\\"panel in $ctrl.panels | orderBy:'priority'\\\"> <waltz-static-panel panel=panel render-mode=$ctrl.renderMode> </waltz-static-panel> </div> </div> \"},1396:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1397));function i(){}i.$inject=[];var r={template:a.default,bindings:{panel:\"<\",renderMode:\"<\"},controller:i};t.default=r},1397:function(e,t){e.exports='<div class=waltz-static-panel> <waltz-section icon=\"{{ $ctrl.panel.icon }}\" name=\"{{ $ctrl.panel.title }}\" ng-if=\"$ctrl.renderMode === \\'section\\'\" id=\"{{ $ctrl.panel.title }}-section\"> <div ng-bind-html=$ctrl.panel.content> </div> </waltz-section> <div class=wsp-chromeless ng-if=\"$ctrl.renderMode === \\'chromeless\\'\"> <h3> <waltz-icon name=\"{{ $ctrl.panel.icon }}\"> </waltz-icon> <span ng-bind=$ctrl.panel.title> </span> </h3> <waltz-markdown text=$ctrl.panel.content></waltz-markdown> </div> <div class=wsp-minimal-border ng-if=\"$ctrl.renderMode === \\'minimal-border\\'\"> <h3 ng-if=$ctrl.panel.title> <waltz-icon name=\"{{ $ctrl.panel.icon }}\"> </waltz-icon> <span ng-bind=$ctrl.panel.title> </span> </h3> <waltz-icon name=\"{{ $ctrl.panel.icon }}\" ng-if=\"!$ctrl.panel.title && $ctrl.panel.icon\"> </waltz-icon> <waltz-markdown text=$ctrl.panel.content></waltz-markdown> </div> </div>'},1398:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=g(n(6)),i=n(7),r=g(n(256)),s=g(n(257)),o=g(n(258)),l=g(n(1399)),c=g(n(1401)),d=g(n(1403)),u=g(n(1424)),p=g(n(1426)),v=g(n(1428)),f=g(n(1430)),m=g(n(1432)),y=g(n(1434));function g(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.survey\",[]);return e.config(d.default),(0,i.registerComponents)(e,[c.default]),e.component(\"waltzSurveyDropdownEditor\",u.default).component(\"waltzSurveyRunCreateGeneral\",p.default).component(\"waltzSurveyRunCreateRecipient\",v.default).component(\"waltzSurveyRunOverview\",f.default).component(\"waltzSurveyTemplateOverview\",m.default),e.service(\"SurveyQuestionStore\",y.default),(0,i.registerStores)(e,[r.default,s.default,o.default]),(0,i.registerComponents)(e,[l.default]),e.name}},1399:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=n(0),r=n(2),s=c(n(1)),o=c(n(4)),l=c(n(1400));function c(e){return e&&e.__esModule?e:{default:e}}var d={surveys:[],visibility:{dataTab:0}};function u(e,t){var n=(0,i.initialiseData)(this,d);n.showTab=function(e){n.visibility.dataTab=e},n.$onChanges=function(){if(n.parentEntityRef){var i=t.loadViewData(r.CORE_API.SurveyRunStore.findByEntityReference,[n.parentEntityRef]).then(function(e){return e.data}),l=t.loadViewData(r.CORE_API.SurveyInstanceStore.findByEntityReference,[n.parentEntityRef]).then(function(e){return e.data});e.all([i,l]).then(function(e){var t=a(e,2),i=t[0],r=t[1];return n.surveys=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=s.default.keyBy(e,\"id\"),a=s.default.map(t,function(e){return{surveyInstance:e,surveyRun:n[e.surveyRunId],surveyEntity:e.surveyEntity}}),i=(0,o.default)();return s.default.groupBy(a,function(e){var t=(0,o.default)(e.surveyInstance.submittedAt);return\"WITHDRAWN\"==e.surveyInstance.status||i.diff(t,\"months\")>=12?\"ARCHIVE\":\"CURRENT\"})}(i,r)})}}}u.$inject=[\"$q\",\"ServiceBroker\"];var p={bindings:{parentEntityRef:\"<\"},template:l.default,controller:u};t.default={component:p,id:\"waltzSurveyInstanceList\"}},1400:function(e,t){e.exports='<div> <waltz-no-data ng-if=\"$ctrl.surveys | isEmpty\"> <message> <strong>No surveys</strong> </message> </waltz-no-data> <div ng-if=\"!($ctrl.surveys | isEmpty)\"> <uib-tabset active=active ng-if=!$ctrl.isAnyEditorVisible()> <uib-tab index=0 select=$ctrl.showTab(0) disable=\"$ctrl.surveys[\\'CURRENT\\'] | isEmpty\" heading=Current> <div ng-if=\"$ctrl.visibility.dataTab == 0\" style=padding-top:1em> <ng-include src=\"\\'sil-table.html\\'\" ng-init=\"surveys = $ctrl.surveys[\\'CURRENT\\']\"> </ng-include> </div> </uib-tab> <uib-tab index=1 select=$ctrl.showTab(1) disable=\"$ctrl.surveys[\\'ARCHIVE\\'] | isEmpty\" heading=Archive> <div ng-if=\"$ctrl.visibility.dataTab == 1\" style=padding-top:1em> <ng-include src=\"\\'sil-table.html\\'\" ng-init=\"surveys = $ctrl.surveys[\\'ARCHIVE\\']\"> </ng-include> </div> </uib-tab> </uib-tabset> </div> </div> <script type=text/ng-template id=sil-table.html> <table class=\"table table-condensed table-striped small\"\\n           ng-if=\"surveys.length > 0\">\\n        <colgroup>\\n            <col width=\"34%\">\\n            <col width=\"10%\">\\n            <col width=\"8%\">\\n            <col width=\"16%\">\\n            <col width=\"8%\">\\n            <col width=\"16%\">\\n            <col width=\"8%\">\\n        </colgroup>\\n        <thead>\\n        <tr>\\n            <th>Title</th>\\n            <th>Status</th>\\n            <th>Issued On</th>\\n            <th>Submitted By</th>\\n            <th>Submitted On</th>\\n            <th>Approved By</th>\\n            <th>Approved On</th>\\n        </tr>\\n        </thead>\\n        <tbody>\\n        <tr ng-repeat=\"row in surveys | orderBy:\\'surveyRun.name\\'\">\\n            <td>\\n                <a ng-if=\"row.surveyInstance.status === \\'COMPLETED\\' || row.surveyInstance.status === \\'APPROVED\\'\"\\n                   ng-bind=\"row.surveyRun.name\"\\n                   class=\"clickable\"\\n                   ui-sref=\"main.survey.instance.response.view ({id: row.surveyInstance.id })\"></a>\\n                <a ng-if=\"row.surveyInstance.status !== \\'COMPLETED\\' && row.surveyInstance.status !== \\'APPROVED\\'\"\\n                   ng-bind=\"row.surveyRun.name\"\\n                   class=\"clickable\"\\n                   ui-sref=\"main.survey.instance.response.edit ({id: row.surveyInstance.id })\"></a>\\n            </td>\\n            <td ng-bind=\"row.surveyInstance.status | toDisplayName:\\'surveyInstanceStatus\\'\">\\n            </td>\\n            <td ng-bind=\"row.surveyRun.issuedOn | date:\\'dd-MM-yyyy\\'\">\\n            </td>\\n            <td>\\n                <span ng-if=\"row.surveyInstance.submittedBy\"\\n                      ng-bind=\"row.surveyInstance.submittedBy\">\\n                </span>\\n                <span ng-if=\"! row.surveyInstance.submittedBy\">\\n                    -\\n                </span>\\n            </td>\\n            <td>\\n                <span ng-if=\"row.surveyInstance.submittedAt\"\\n                      ng-bind=\"row.surveyInstance.submittedAt | date:\\'dd-MM-yyyy\\'\">\\n                </span>\\n                <span ng-if=\"! row.surveyInstance.submittedAt\">\\n                            -\\n                </span>\\n            </td>\\n            <td>\\n                <span ng-if=\"row.surveyInstance.approvedBy\">\\n                    <span ng-bind=\"row.surveyInstance.approvedBy\">\\n                    </span>\\n                </span>\\n                <span ng-if=\"! row.surveyInstance.approvedBy\">\\n                            -\\n                </span>\\n            </td>\\n            <td>\\n                <span ng-if=\"row.surveyInstance.approvedAt\"\\n                      ng-bind=\"row.surveyInstance.approvedAt | date:\\'dd-MM-yyyy\\'\">\\n                </span>\\n                <span ng-if=\"! row.surveyInstance.approvedAt\">\\n                            -\\n                </span>\\n            </td>\\n        </tr>\\n        </tbody>\\n    </table> <\\/script> '},1401:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=l(n(1)),i=n(0),r=n(2),s=l(n(1402)),o=n(46);function l(e){return e&&e.__esModule?e:{default:e}}var c={visibility:{mode:\"list\"},selectedTemplate:null,surveyRunForm:{dueDate:null,contactEmail:null,issuanceKind:\"GROUP\",recipients:[]}};function d(e,t,n){var s=(0,i.initialiseData)(this,c);s.onSelectTemplate=function(e){s.selectedTemplate=e,s.surveyRunForm.name=e.name,s.surveyRunForm.description=e.description},s.onDeselectTemplate=function(e){s.selectedTemplate=null},s.onShowCreateForm=function(){s.visibility.mode=\"create\",s.selectedTemplate=null,t.loadViewData(r.CORE_API.SurveyTemplateStore.findAll).then(function(e){return s.templates=a.default.chain(e.data).filter(function(e){return e.targetEntityKind===s.parentEntityRef.kind}).filter(function(e){return\"ACTIVE\"===e.status}).sortBy(\"name\").value()})},s.onDismissCreateForm=function(){s.visibility.mode=\"list\"},s.submitRun=function(){!function(){var n=a.default.map(s.surveyRunForm.recipients,\"id\");if(0==n.length)return void alert(\"Please provide at least one recipient\");var i={name:s.surveyRunForm.name,description:s.surveyRunForm.description,surveyTemplateId:s.selectedTemplate.id,selectionOptions:{entityReference:s.parentEntityRef,scope:\"EXACT\"},involvementKindIds:[],issuanceKind:s.surveyRunForm.issuanceKind,dueDate:s.surveyRunForm.dueDate?(0,o.timeFormat)(\"%Y-%m-%d\")(s.surveyRunForm.dueDate):null,contactEmail:s.surveyRunForm.contactEmail};t.execute(r.CORE_API.SurveyRunStore.create,[i]).then(function(e){return e.data.id}).then(function(e){return t.execute(r.CORE_API.SurveyRunStore.createSurveyInstances,[e,n]).then(function(){return e})}).then(function(e){return t.execute(r.CORE_API.SurveyRunStore.updateStatus,[e,{newStatus:\"ISSUED\"}])}).then(function(){e.success(\"Survey issued successfully\"),s.onDismissCreateForm()})}()},s.addRecipient=function(e){if(e){var t=s.surveyRunForm.recipients;s.surveyRunForm.recipients=a.default.concat(t||[],[e])}},s.removeRecipient=function(e){if(e){var t=s.surveyRunForm.recipients;s.surveyRunForm.recipients=a.default.reject(t,function(t){return t.id==e.id})}},s.$onInit=function(){n.whoami().then(function(e){return s.surveyRunForm.contactEmail=e.userName})}}d.$inject=[\"Notification\",\"ServiceBroker\",\"UserService\"];var u={bindings:{parentEntityRef:\"<\"},template:s.default,controller:d};t.default={component:u,id:\"waltzSurveySection\"}},1402:function(e,t){e.exports='<div> <waltz-section-actions> <span waltz-has-role=SURVEY_ADMIN> <a class=\"btn btn-xs btn-primary\" ng-if=\"$ctrl.visibility.mode == \\'list\\'\" ng-click=$ctrl.onShowCreateForm()> Issue new survey </a> </span> </waltz-section-actions> <div ng-if=\"$ctrl.visibility.mode == \\'create\\'\"> <h4> <span ng-if=\"$ctrl.selectedTemplate == null\"> Select Template </span> <span ng-if=\"$ctrl.selectedTemplate != null\" ng-bind=$ctrl.selectedTemplate.name> </span> <small>Issue Survey</small> </h4> <div ng-if=\"$ctrl.selectedTemplate == null\"> <div class=help-block> Select the survey template to issue </div> <ul class=list-unstyled> <li ng-repeat=\"template in $ctrl.templates\"> <a ng-click=$ctrl.onSelectTemplate(template) class=clickable> <span ng-bind=template.name></span> </a> </li> </ul> <a ng-click=$ctrl.onDismissCreateForm() class=clickable> Cancel </a> </div> <div ng-if=\"$ctrl.selectedTemplate != null\"> <a ng-click=$ctrl.onDeselectTemplate(template) class=\"small clickable\"> <waltz-icon name=back></waltz-icon> Choose a different template </a> <hr> <form name=runForm ng-submit=$ctrl.submitRun()> <fieldset ng-disabled=$ctrl.surveyRunForm.$submitted> <div class=row> <div class=col-md-3> <label> Name <span class=text-danger>*</span> </label> </div> <div class=col-md-6> <input class=form-control type=text ng-model=$ctrl.surveyRunForm.name> <div class=\"small help-block\"> Title of this survey (defaults to template name) </div> </div> </div> <div class=row> <div class=col-md-3> <label> Description </label> </div> <div class=col-md-6> <textarea class=form-control ng-model=$ctrl.surveyRunForm.description></textarea> <div class=\"small help-block\"> Describe the purpose of this survey (defaults to template description) </div> </div> </div> <div class=row> <div class=col-md-3> <label> Contact email <span class=text-danger>*</span> </label> </div> <div class=col-md-6> <input class=form-control type=text ng-model=$ctrl.surveyRunForm.contactEmail> <div class=\"small help-block\"> Contact email for questions recipients may have regarding this survey </div> </div> </div> <div class=row> <div class=col-md-3> <label> Due date <span class=text-danger>*</span> </label> </div> <div class=col-md-3> <waltz-date-picker-form-input id=dueDate required=true place-holder=yyyy-MM-dd format=yyyy-MM-dd model=$ctrl.surveyRunForm.dueDate> </waltz-date-picker-form-input> <div class=\"small help-block\"> When does this survey need to be completed by? </div> </div> </div> <div class=row> <div class=col-md-3> <label> Recipient/s <span class=text-danger>*</span> </label> </div> <div class=col-md-3> <waltz-entity-selector required=true on-select=$ctrl.addRecipient entity-kinds=\"[\\'PERSON\\']\"> </waltz-entity-selector> <div class=\"small help-block\"> Who should fill in this survey? </div> <br> <ul class=list-unstyled> <li ng-repeat=\"p in $ctrl.surveyRunForm.recipients\"> <span ng-bind=p.name></span> <a ng-click=$ctrl.removeRecipient(p) class=clickable> <waltz-icon name=close></waltz-icon> </a> </li> </ul> </div> </div> <div class=row> <div class=col-md-3> <label> Issuance Kind <span class=text-danger>*</span> </label> </div> <div class=col-md-6> <label> <input name=issuanceKind type=radio ng-model=$ctrl.surveyRunForm.issuanceKind value=GROUP checked=checked /> Group </label> &nbsp; <label> <input name=issuanceKind type=radio ng-model=$ctrl.surveyRunForm.issuanceKind value=INDIVIDUAL /> Individual </label> <div class=\"help-block small\"> <strong>Group</strong> - one survey response per entity.<br/> <strong>Individual</strong> - one survey response per person, which could result in multiple responses per entity. </div> </div> </div> </fieldset> <hr> <button type=submit class=\"btn btn-success\"> Issue survey </button> <a ng-click=$ctrl.onDismissCreateForm() class=clickable> Cancel </a> </form> </div> </div> <div ng-if=\"$ctrl.visibility.mode == \\'list\\'\"> <waltz-survey-instance-list parent-entity-ref=$ctrl.parentEntityRef> </waltz-survey-instance-list> </div> </div>'},1403:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=v(n(1404)),i=v(n(1406)),r=v(n(1408)),s=v(n(1410)),o=v(n(1412)),l=v(n(1414)),c=v(n(1416)),d=v(n(1418)),u=v(n(1420)),p=v(n(1422));function v(e){return e&&e.__esModule?e:{default:e}}var f={url:\"survey\"},m={url:\"/run\"},y={url:\"/template\"},g={url:\"/instance\"},h={url:\"/{id:int}/response\"},b={url:\"/template/{id:int}/new-run\",views:{\"content@\":a.default}},w={url:\"/{id:int}\",views:{\"content@\":i.default}},S={url:\"/user\",views:{\"content@\":r.default}},I={url:\"/{id:int}/view\",views:{\"content@\":s.default}},R={url:\"/view\",views:{\"content@\":o.default}},E={url:\"/edit\",views:{\"content@\":l.default}},z={url:\"/list\",views:{\"content@\":c.default}},A={url:\"/create\",views:{\"content@\":d.default}},N={url:\"/{id:int}/edit\",views:{\"content@\":u.default}},x={url:\"/{id:int}/view\",views:{\"content@\":p.default}};function O(e){e.state(\"main.survey\",f).state(\"main.survey.run\",m).state(\"main.survey.run.create\",b).state(\"main.survey.run.view\",w).state(\"main.survey.instance\",g).state(\"main.survey.instance.user\",S).state(\"main.survey.instance.view\",I).state(\"main.survey.instance.response\",h).state(\"main.survey.instance.response.edit\",E).state(\"main.survey.instance.response.view\",R).state(\"main.survey.template\",y).state(\"main.survey.template.list\",z).state(\"main.survey.template.create\",A).state(\"main.survey.template.edit\",N).state(\"main.survey.template.view\",x)}O.$inject=[\"$stateProvider\"],t.default=O},1404:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=o(n(1)),i=n(0),r=n(46),s=o(n(1405));function o(e){return e&&e.__esModule?e:{default:e}}var l={step:\"GENERAL\",surveyRun:{selectorEntityKind:\"APP_GROUP\",selectorScope:\"EXACT\",issuanceKind:\"GROUP\"},onSaveGeneral:function(e){},onSaveRecipient:function(e){}};function c(e,t,n,s,o,c,d){var u=(0,i.initialiseData)(this,l),p=o.id;d.getById(p).then(function(e){u.surveyTemplate=e,u.surveyRun.surveyTemplate=e,u.surveyRun.name||(u.surveyRun.name=e.name),u.surveyRun.description||(u.surveyRun.description=e.description)});u.generateEmail=function(){var n=e[0],a=n.createElement(\"IFRAME\");a.style.width=\"0px\",a.style.height=\"0px\",a.src=u.surveyEmailHref,n.body.appendChild(a),t(function(){return n.body.removeChild(a)},100,1)},u.onSaveGeneral=function(e){var t={name:e.name,description:e.description,surveyTemplateId:e.surveyTemplate.id,selectionOptions:{entityReference:{kind:e.selectorEntityKind,id:e.selectorEntity.id},scope:e.selectorScope},involvementKindIds:a.default.map(e.involvementKinds,function(e){return e.id}),issuanceKind:e.issuanceKind,dueDate:e.dueDate?(0,r.timeFormat)(\"%Y-%m-%d\")(e.dueDate):null,contactEmail:e.contactEmail};e.id?c.update(e.id,t).then(function(){u.step=\"RECIPIENT\"}):c.create(t).then(function(e){u.surveyRun.id=e.id,u.step=\"RECIPIENT\"})},u.onSaveRecipient=function(e,t,i){c.createSurveyRunInstancesAndRecipients(e.id,i).then(function(i){return c.updateStatus(e.id,{newStatus:\"ISSUED\"}).then(function(){u.step=\"COMPLETED\",function(e,t){var i=a.default.chain(t).map(function(e){return e.person.email}).uniq().join(\";\"),r=\"Survey invitation: \"+e.name,o=encodeURIComponent(a.default.replace(n.absUrl(),\"#\"+n.url(),\"\")+s.href(\"main.survey.instance.user\")),l=\"You have been invited to participate in the following survey. %0D%0A%0D%0AName: \"+e.name+\" %0D%0A%0D%0ADescription: \"+e.description+\" %0D%0A%0D%0A%0D%0A%0D%0APlease use this URL to find and respond to this survey:  \"+o+\" %0D%0A%0D%0A\";u.surveyEmailHref=\"mailto:\"+i+\"?subject=\"+r+\"&body=\"+l}(e,t)})})},u.goBack=function(){\"RECIPIENT\"===u.step&&(u.step=\"GENERAL\")}}c.$inject=[\"$document\",\"$interval\",\"$location\",\"$state\",\"$stateParams\",\"SurveyRunStore\",\"SurveyTemplateStore\"],t.default={template:s.default,controller:c,controllerAs:\"ctrl\"}},1405:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=Survey small=create> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Survey</a></li> <li>Create</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-survey-run-create-general ng-show=\"ctrl.step === \\'GENERAL\\'\" survey-template=ctrl.surveyTemplate survey-run=ctrl.surveyRun on-save=ctrl.onSaveGeneral> </waltz-survey-run-create-general> <waltz-survey-run-create-recipient ng-if=\"ctrl.step === \\'RECIPIENT\\'\" survey-template=ctrl.surveyTemplate survey-run=ctrl.surveyRun on-save=ctrl.onSaveRecipient on-go-back=ctrl.goBack> </waltz-survey-run-create-recipient> <div ng-if=\"ctrl.step === \\'COMPLETED\\'\"> <h4><strong>Issue Survey</strong></h4> <hr/> Survey run <strong ng-bind=ctrl.surveyRun.name></strong> has been saved. <br/> <br/> Please click <a ng-click=ctrl.generateEmail() class=clickable>here</a> to generate survey invitation email. <br/> <br/> <a ui-sref=\"main.survey.template.view ({id: ctrl.surveyTemplate.id })\"> &laquo; Back to <strong ng-bind=ctrl.surveyTemplate.name></strong> template </a> </div> </div> </div>'},1406:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1407)),i=n(46);function r(e,t,n,a,r){var s=e.id,o=this,l=function(){return a.getById(s).then(function(e){return o.surveyRun=e,r.getById(e.surveyTemplateId)}).then(function(e){return o.surveyTemplate=e})},c=function(){n.findForSurveyRun(s).then(function(e){return o.surveyInstances=e})};l(),c(),o.updateDueDate=function(e){e?confirm(\"This will update the due date of all the instances under this run. Are you sure you want to continue?\")&&a.updateDueDate(s,{newDateVal:(0,i.timeFormat)(\"%Y-%m-%d\")(e)}).then(function(e){t.success(\"Survey run due date updated successfully\"),l(),c()},function(e){return t.error(\"Failed to update survey run due date\")}):t.error(\"Due date cannot be blank\")}}r.$inject=[\"$stateParams\",\"Notification\",\"SurveyInstanceStore\",\"SurveyRunStore\",\"SurveyTemplateStore\"];var s={template:a.default,controller:r,controllerAs:\"ctrl\"};t.default=s},1407:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=\"{{ ctrl.surveyRun.name }}\" small=\"Survey Run\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.survey.instance.user>Survey</a></li> <li><a ui-sref=main.survey.template.list>Templates</a></li> <li><a ui-sref=\"main.survey.template.view ({id: ctrl.surveyTemplate.id })\" ng-bind=ctrl.surveyTemplate.name></a></li> <li>Runs</li> <li ng-bind=ctrl.surveyRun.name></li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-survey-run-overview run=ctrl.surveyRun template=ctrl.surveyTemplate on-update-due-date=ctrl.updateDueDate> </waltz-survey-run-overview> </div> <br> <waltz-section name=Instances> <table class=table> <thead> <tr> <th>Entity</th> <th>Status</th> <th>Due</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat=\"instance in ctrl.surveyInstances\"> <td> <waltz-entity-link entity-ref=instance.surveyEntity> </waltz-entity-link> </td> <td> <span ng-bind=\"instance.status | toDisplayName:\\'surveyInstanceStatus\\'\"> </span> </td> <td> <waltz-from-now timestamp=instance.dueDate days-only=true> </waltz-from-now> </td> <td> <a class=clickable ui-sref=\"main.survey.instance.response.view ({id: instance.id })\" ng-if=\"instance.status === \\'COMPLETED\\' || instance.status === \\'APPROVED\\' || instance.status === \\'EXPIRED\\'\"> view response </a> <a class=clickable ui-sref=\"main.survey.instance.view ({id: instance.id })\" ng-if=\"instance.status === \\'NOT_STARTED\\' || instance.status === \\'IN_PROGRESS\\'\"> edit </a> </td> </tr> </tbody> </table> </waltz-section> </div> '},1408:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=c(n(1)),r=n(0),s=n(27),o=c(n(1409)),l=c(n(53));function c(e){return e&&e.__esModule?e:{default:e}}var d={incompleteColumnDefs:[],completeColumnDefs:[],surveyInstancesAndRuns:[],showSurveyTemplateButton:!1};function u(){return[{field:\"surveyInstance.id\",name:\"ID\",width:\"5%\"},(0,s.mkEntityLinkGridCell)(\"Subject\",\"surveyInstance.surveyEntity\"),{field:\"surveyInstance.surveyEntityExternalId\",name:\"Subject External Id\",width:\"10%\"},{field:\"surveyInstance.status\",name:\"Status\",cellFilter:\"toDisplayName:'surveyInstanceStatus'\",width:\"10%\"},{field:\"surveyRun.issuedOn\",name:\"Issued\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><waltz-from-now timestamp=\"COL_FIELD\" days-only=\"true\"></waltz-from-now></div>',width:\"10%\"},{field:\"surveyInstance.dueDate\",name:\"Due\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><waltz-from-now timestamp=\"COL_FIELD\" days-only=\"true\"></waltz-from-now></div>',width:\"10%\"}]}function p(e,t,n,o){var c=(0,r.initialiseData)(this,d);c.incompleteColumnDefs=function(){var e=u();return e.splice(0,0,Object.assign({},(0,s.mkLinkGridCell)(\"Survey\",\"surveyRun.name\",\"surveyInstance.id\",\"main.survey.instance.response.edit\"),{width:\"25%\"})),e}(),c.completeColumnDefs=function(){var e=u();return e.splice(0,0,Object.assign({},(0,s.mkLinkGridCell)(\"Survey\",\"surveyRun.name\",\"surveyInstance.id\",\"main.survey.instance.response.view\"),{width:\"25%\"})),e.push({field:\"surveyInstance.approvedBy\",name:\"Approved By\",cellTemplate:'<div class=\"ui-grid-cell-contents\">\\n                               <span ng-if=\"row.entity.surveyInstance.approvedBy\">\\n                                    <span ng-bind=\"row.entity.surveyInstance.approvedBy\">\\n                                    </span>,\\n                                </span>\\n                                <waltz-from-now class=\\'text-muted\\'\\n                                            ng-if=\"row.entity.surveyInstance.approvedAt\"\\n                                            timestamp=\"row.entity.surveyInstance.approvedAt\">\\n                                </waltz-from-now>\\n                                <span ng-if=\"! row.entity.surveyInstance.approvedAt\">\\n                                    -\\n                                </span>\\n                           </div>',width:\"15%\"}),e}(),o.whoami().then(function(e){return c.user=e}).then(function(){return c.showSurveyTemplateButton=o.hasRole(c.user,l.default.SURVEY_ADMIN)||o.hasRole(c.user,l.default.SURVEY_TEMPLATE_ADMIN)});var p=n.findForUser(),v=t.findForUser();e.all([p,v]).then(function(e){var t=a(e,2),n=t[0],r=t[1];c.surveys=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=i.default.keyBy(e,\"id\"),r=i.default.map(t,function(e){return{surveyInstance:e,surveyRun:n[e.surveyRunId]}}),s=i.default.partition(r,function(e){return\"NOT_STARTED\"===e.surveyInstance.status||\"IN_PROGRESS\"===e.surveyInstance.status||\"REJECTED\"===e.surveyInstance.status}),o=a(s,2),l=o[0],c=void 0===l?[]:l,d=o[1];return{incomplete:c,complete:void 0===d?[]:d}}(n,r)})}p.$inject=[\"$q\",\"SurveyInstanceStore\",\"SurveyRunStore\",\"UserService\"],t.default={template:o.default,controller:p,controllerAs:\"ctrl\"}},1409:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=Surveys small={{ctrl.user.userName}}> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Survey</a></li> <li ng-bind=ctrl.user.userName></li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-section-actions> <a class=\"btn btn-primary btn-xs\" ng-if=ctrl.showSurveyTemplateButton ui-sref=main.survey.template.list> Manage Templates </a> </waltz-section-actions> <h4>Incomplete</h4> <br> <div ng-if=\"ctrl.surveys.incomplete.length > 0\"> <waltz-grid-with-search column-defs=ctrl.incompleteColumnDefs entries=ctrl.surveys.incomplete search-placeholder-text=Search...> </waltz-grid-with-search> </div> <div ng-if=\"ctrl.surveys.incomplete.length == 0\"> <span class=text-muted> No incomplete surveys found </span> </div> <hr> <h4>Completed/Expired</h4> <br> <div ng-if=\"ctrl.surveys.complete.length > 0\"> <waltz-grid-with-search column-defs=ctrl.completeColumnDefs entries=ctrl.surveys.complete search-placeholder-text=Search...> </waltz-grid-with-search> </div> <div ng-if=\"ctrl.surveys.complete.length == 0\"> <span class=text-muted> No completed/expired surveys found </span> </div> </div> </div>'},1410:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=o(n(1)),i=n(0),r=n(46),s=o(n(1411));function o(e){return e&&e.__esModule?e:{default:e}}var l={surveyInstance:{},surveyRun:{},recipients:[],addingRecipient:!1,newRecipient:null};function c(e,t,n,s){var o=(0,i.initialiseData)(this,l),c=e.id,d=function(){n.getById(c).then(function(e){return o.surveyInstance=e,s.getById(e.surveyRunId)}).then(function(e){return o.surveyRun=e})},u=function(){return n.findRecipients(c).then(function(e){return o.recipients=a.default.map(e,function(e){return function(e,t){return{instanceRecipientId:e,person:{kind:\"PERSON\",id:t.id,name:t.displayName}}}(e.id,e.person)})})};o.editRecipient=function(e,a){var i=function(e,t,n){return{instanceRecipientId:e,surveyInstanceId:n,personId:t.id}}(e,a.newVal,o.surveyInstance.id);n.updateRecipient(o.surveyInstance.id,i).then(function(e){e&&(u(),t.success(\"Updated survey recipient\"))})},o.startNewRecipient=function(){o.addingRecipient=!0},o.cancelNewRecipient=function(){o.addingRecipient=!1},o.addRecipient=function(){n.addRecipient(o.surveyInstance.id,function(e,t){return{surveyInstanceId:e,personId:t.id}}(o.surveyInstance.id,o.newRecipient)).then(function(e){e&&(u(),t.success(\"Recipient added\"),o.addingRecipient=!1)})},o.selectNewRecipient=function(e){o.newRecipient=e},o.removeRecipient=function(e){n.deleteRecipient(o.surveyInstance.id,e.instanceRecipientId).then(function(e){e&&(u(),t.success(\"Recipient deleted\"))})},o.updateDueDate=function(e,a){a.newVal?n.updateDueDate(e,{newDateVal:(0,r.timeFormat)(\"%Y-%m-%d\")(a.newVal)}).then(function(){t.success(\"Survey instance due date updated successfully\"),d()},function(e){return t.error(\"Failed to update survey instance due date\")}):t.error(\"Due date cannot be blank\")},o.markAsWithdrawn=function(){confirm(\"Are you sure you want to withdraw this survey instance? \")&&n.updateStatus(o.surveyInstance.id,{newStatus:\"WITHDRAWN\"}).then(function(){t.success(\"Survey instance withdrawn\"),d()})},o.reject=function(){var e=prompt(\"Are you sure you want reject this survey? Please enter a reason below (mandatory):\");e&&n.updateStatus(o.surveyInstance.id,{newStatus:\"REJECTED\",reason:e}).then(function(){t.success(\"Survey response rejected\"),$state.reload()})},d(),u()}c.$inject=[\"$stateParams\",\"Notification\",\"SurveyInstanceStore\",\"SurveyRunStore\"];var d={controller:c,controllerAs:\"ctrl\",template:s.default};t.default=d},1411:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=\"{{ ctrl.surveyRun.name }}\" small=Instance> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li> <waltz-entity-link entity-ref=ctrl.surveyInstance.surveyEntity></waltz-entity-link> </li> <li>Surveys</li> <li> <span ng-bind=ctrl.surveyRun.name></span> </li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-section-actions> <a class=\"btn btn-danger btn-xs\" waltz-has-role=SURVEY_ADMIN ng-if=\"ctrl.surveyInstance.status !== \\'WITHDRAWN\\' && ctrl.surveyInstance.status !== \\'COMPLETED\\'\" ng-click=ctrl.markAsWithdrawn()> Withdraw </a> <a class=\"btn btn-danger btn-xs\" waltz-has-role=SURVEY_ADMIN ng-if=\"ctrl.surveyInstance.status === \\'WITHDRAWN\\'\" ng-click=ctrl.reject()> Reject </a> </waltz-section-actions> <div class=row> <div class=col-sm-12> <waltz-markdown text=ctrl.surveyRun.description> </waltz-markdown> </div> </div> <br/> <div class=row> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Survey Subject </div> <div class=col-sm-8> <waltz-entity-link entity-ref=ctrl.surveyInstance.surveyEntity> </waltz-entity-link> </div> </div> </div> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Survey ID </div> <div class=col-sm-8> <span ng-bind=ctrl.surveyInstance.id> </span> </div> </div> </div> </div> <br/> <div class=row> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Status </div> <div class=col-sm-8 ng-bind=\"ctrl.surveyInstance.status | toDisplayName:\\'surveyInstanceStatus\\'\"> </div> </div> </div> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Issued to </div> <div class=col-sm-8> <span ng-bind=\"ctrl.surveyRun.issuanceKind | toDisplayName:\\'issuance\\'\"></span> </div> </div> </div> </div> <br/> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Due </div> <div class=col-sm-4> <waltz-editable-field on-save=ctrl.updateDueDate field-type=date date-format=yyyy-MM-dd initial-val=ctrl.surveyInstance.dueDate item-id=ctrl.surveyInstance.id edit-role=SURVEY_ADMIN> </waltz-editable-field> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Issued </div> <div class=col-sm-4> <waltz-from-now timestamp=ctrl.surveyRun.issuedOn days-only=true> </waltz-from-now> </div> </div> <br/> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Recipients </div> <div class=col-sm-5> <table class=\"table table-condensed\" ng-if=\"ctrl.surveyRun.issuanceKind === \\'GROUP\\'\"> <tbody> <tr ng-repeat=\"r in ctrl.recipients | orderBy:\\'person.name\\'\" class=waltz-visibility-parent> <td width=70%> <waltz-entity-link entity-ref=r.person> </waltz-entity-link> </td> <td> <button class=\"btn btn-danger btn-xs\" waltz-has-role=SURVEY_ADMIN ng-if=\"ctrl.recipients.length > 1\" ng-click=ctrl.removeRecipient(r)> remove </button> </td> </tr> <tr> <td width=70%> <button class=\"btn btn-primary btn-xs\" waltz-has-role=SURVEY_ADMIN ng-if=\"ctrl.addingRecipient === false\" ng-click=ctrl.startNewRecipient()> Add </button> <div ng-if=\"ctrl.addingRecipient === true\"> <waltz-entity-selector on-select=ctrl.selectNewRecipient entity-kinds=\"[\\'PERSON\\']\" initial-val=ctrl.newRecipient> </waltz-entity-selector> </div> </td> <td> <button class=\"btn btn-success btn-sm\" ng-if=\"ctrl.addingRecipient === true\" ng-click=ctrl.addRecipient()> Save </button> <button class=\"btn btn-default btn-sm\" ng-if=\"ctrl.addingRecipient === true\" ng-click=ctrl.cancelNewRecipient()> Cancel </button> </td> </tr> </tbody> </table> <ul class=\"list-unstyled list-inline\" ng-if=\"ctrl.surveyRun.issuanceKind === \\'INDIVIDUAL\\'\"> <li ng-repeat=\"r in ctrl.recipients | orderBy:\\'person.name\\'\"> <waltz-editable-field on-save=ctrl.editRecipient edit-role=SURVEY_ADMIN field-type=person initial-val=r.person item-id=r.instanceRecipientId> </waltz-editable-field> </li> </ul> </div> </div> </div> </div>'},1412:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=l(n(1)),i=n(0),r=n(401),s=n(31),o=l(n(1413));function l(e){return e&&e.__esModule?e:{default:e}}var c={changeLogSection:s.dynamicSections.changeLogSection};function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a.default.chain(e).map(\"questionResponse\").map(function(e){return{questionId:e.questionId,answer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.default.isNil(e.booleanResponse)?e.stringResponse||e.numberResponse||e.dateResponse||e.entityResponse:e.booleanResponse}(e),comment:e.comment}}).keyBy(\"questionId\").value()}function u(e,t,n,s,o,l,u){var p=(0,i.initialiseData)(this,c),v=t.id;p.entityReference={id:v,kind:\"SURVEY_INSTANCE\"},o.getById(v).then(function(e){return p.surveyInstance=e,l.getById(e.surveyRunId)}).then(function(e){return p.surveyRun=e}).then(function(e){return s.getById(e.ownerId).then(function(e){return p.owner=e})}).then(function(){return o.findPreviousVersions(p.surveyInstance.originalInstanceId||v)}).then(function(e){var t=a.default.chain(e).sortBy(\"submittedAt\").map(function(e,t){return{versionNum:t+1+\".0\",instanceId:e.id,isLatest:!1}}).reverse().value(),n=p.surveyInstance.originalInstanceId||v,i=[{versionNum:t.length+1+\".0\",instanceId:n,isLatest:!0}].concat(t);p.currentResponseVersion=a.default.keyBy(i,\"instanceId\")[v],p.otherResponseVersions=a.default.filter(i,function(e){return e.instanceId!==p.currentResponseVersion.instanceId})});u.findForInstance(v).then(function(e){return p.surveyQuestionInfos=(0,r.groupQuestions)(e)}),o.findResponses(v).then(function(e){p.answers=d(e),function(e){p.participants=[],a.default.chain(e).map(\"personId\").uniq().map(function(e){return s.getById(e).then(function(e){return p.participants.push(e)})}).value()}(e)}),p.reject=function(){var t=prompt(\"Are you sure you want reject this survey? Please enter a reason below (mandatory):\");t&&o.updateStatus(p.surveyInstance.id,{newStatus:\"REJECTED\",reason:t}).then(function(t){n.success(\"Survey response rejected\"),e.reload()})},p.approve=function(){var t=prompt(\"Are you sure you want to approve this survey? Please enter a reason below (optional):\");a.default.isNil(t)||o.markApproved(p.surveyInstance.id,{newStringVal:a.default.isEmpty(t)?null:t}).then(function(t){n.success(\"Survey response approved\"),e.reload()})},p.viewOtherResponseVersion=function(t){e.go(\"main.survey.instance.response.view\",{id:t.instanceId})}}u.$inject=[\"$state\",\"$stateParams\",\"Notification\",\"PersonStore\",\"SurveyInstanceStore\",\"SurveyRunStore\",\"SurveyQuestionStore\"];var p={controller:u,controllerAs:\"ctrl\",template:o.default};t.default=p},1413:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=\"{{ ctrl.surveyRun.name }}\" small=Response> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li> <waltz-entity-link entity-ref=ctrl.surveyInstance.surveyEntity></waltz-entity-link> </li> <li>Surveys</li> <li> <span ng-bind=ctrl.surveyRun.name> </span> </li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-section-actions> <a class=\"btn btn-danger btn-xs\" waltz-has-role=SURVEY_ADMIN ng-if=\"(ctrl.surveyInstance.status === \\'COMPLETED\\' || ctrl.surveyInstance.status === \\'APPROVED\\')\\n                        && ctrl.currentResponseVersion.isLatest\" ng-click=ctrl.reject()> Reject </a> <a class=\"btn btn-success btn-xs\" waltz-has-role=SURVEY_ADMIN ng-if=\"ctrl.surveyInstance.status === \\'COMPLETED\\' && ctrl.currentResponseVersion.isLatest && !ctrl.surveyInstance.approvedAt\" ng-click=ctrl.approve()> Approve </a> </waltz-section-actions> <div class=row> <div class=col-sm-12> <waltz-markdown text=ctrl.surveyRun.description> </waltz-markdown> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Survey Subject </div> <div class=col-sm-4> <waltz-entity-link entity-ref=ctrl.surveyInstance.surveyEntity> </waltz-entity-link> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Response Version </div> <div class=col-sm-4> <span ng-bind=ctrl.currentResponseVersion.versionNum> </span> <span ng-if=ctrl.currentResponseVersion.isLatest> - <i>Latest</i> </span> <div class=btn-group uib-dropdown is-open=status.isopen> <span ng-if=\"ctrl.otherResponseVersions.length > 0\"> - <a class=clickable uib-dropdown-toggle> view a different version <span class=caret></span> </a> </span> <ul class=dropdown-menu uib-dropdown-menu role=menu> <li ng-repeat=\"ver in ctrl.otherResponseVersions\" role=menuitem> <a class=clickable ng-click=ctrl.viewOtherResponseVersion(ver)> <span ng-bind=ver.versionNum></span> </a> </li> </ul> </div> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Status </div> <div class=col-sm-4 ng-bind=\"ctrl.surveyInstance.status | toDisplayName:\\'surveyInstanceStatus\\'\"> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Survey ID </div> <div class=col-sm-4 ng-bind=ctrl.surveyInstance.id> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Submitted </div> <div class=col-sm-4> <waltz-from-now ng-if=ctrl.surveyInstance.submittedAt timestamp=ctrl.surveyInstance.submittedAt> </waltz-from-now> <span ng-if=\"! ctrl.surveyInstance.submittedAt\"> - </span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Due </div> <div class=col-sm-4> <waltz-from-now timestamp=ctrl.surveyInstance.dueDate days-only=true> </waltz-from-now> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Issued </div> <div class=col-sm-4> <waltz-from-now timestamp=ctrl.surveyRun.issuedOn days-only=true> </waltz-from-now> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Owner </div> <div class=col-sm-4> <span ng-bind=ctrl.owner.displayName></span> <span ng-if=\"! ctrl.owner\"> - </span> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Participants </div> <div class=col-sm-4> <ul class=\"list-unstyled list-inline\"> <li ng-repeat=\"p in ctrl.participants | orderBy:\\'displayName\\'\"> <span> <span ng-bind=p.displayName></span> </span> <span ng-hide=$last>, </span> </li> </ul> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Approved By </div> <div class=col-sm-4> <span ng-if=ctrl.surveyInstance.approvedBy> <span ng-bind=ctrl.surveyInstance.approvedBy> </span>, </span> <waltz-from-now class=text-muted ng-if=ctrl.surveyInstance.approvedAt timestamp=ctrl.surveyInstance.approvedAt> </waltz-from-now> <span ng-if=\"! ctrl.surveyInstance.approvedAt\"> - </span> </div> </div> </div> <br> <div class=\"alert alert-info\" ng-if=\"ctrl.surveyInstance.status === \\'IN_PROGRESS\\' || ctrl.surveyInstance.status === \\'REJECTED\\'\"> <h4>Survey In Progress</h4> <p>Survey responses cannot be viewed until they have been submitted</p> </div> <div class=\"alert alert-warning\" ng-if=\"ctrl.surveyInstance.status === \\'NOT_STARTED\\'\"> <h4>Survey Not Started</h4> <p>This survey response has not yet been started</p> </div> <div class=\"alert alert-fatal\" ng-if=\"ctrl.surveyInstance.status === \\'EXPIRED\\'\"> <h4>Survey Expired</h4> <p>This survey response expired without being submitted</p> </div> <waltz-section name=\"Survey Response\" ng-if=\"ctrl.surveyInstance.status === \\'COMPLETED\\' || ctrl.surveyInstance.status === \\'APPROVED\\'\"> <div ng-repeat=\"groupedQuestion in ctrl.surveyQuestionInfos\"> <br ng-hide=$first> <h4 ng-bind=groupedQuestion.sectionName style=\"border-bottom:1px solid #ccc\" class=text-muted> </h4> <div ng-repeat=\"qi in groupedQuestion.questionInfos\"> <div class=row> <div class=col-sm-5> <div ng-bind=qi.question.questionText class=text-muted> </div> </div> <div class=col-sm-7> <div style=\"border-bottom:1px dotted #ddd;margin-bottom:1em\"> <div ng-switch=qi.question.fieldType> <div ng-switch-when=BOOLEAN> <waltz-boolean-renderer value=ctrl.answers[qi.question.id].answer> </waltz-boolean-renderer> </div> <div ng-switch-when=APPLICATION|PERSON ng-switch-when-separator=|> <waltz-entity-link entity-ref=ctrl.answers[qi.question.id].answer> </waltz-entity-link> </div> <div ng-switch-when=NUMBER> <span ng-bind=\"ctrl.answers[qi.question.id].answer | number\"> </span> </div> <div ng-switch-when=DATE> <span ng-bind=\"ctrl.answers[qi.question.id].answer | date:\\'dd-MMM-yyyy\\'\"> </span> </div> <div ng-switch-when=TEXTAREA> <waltz-markdown text=ctrl.answers[qi.question.id].answer> </waltz-markdown> </div> <div ng-switch-default> <span ng-bind=ctrl.answers[qi.question.id].answer> </span> </div> </div> <div class=\"small text-muted\" ng-if=ctrl.answers[qi.question.id].comment> <strong>Comment:</strong> <span ng-bind=ctrl.answers[qi.question.id].comment></span> </div> </div> </div> </div> </div> </div> </waltz-section> <waltz-dynamic-section-wrapper section=ctrl.changeLogSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> </div>'},1414:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=n(0),r=n(401),s=u(n(1)),o=n(2),l=u(n(4)),c=n(31),d=u(n(1415));function u(e){return e&&e.__esModule?e:{default:e}}var p={changeLogSection:c.dynamicSections.changeLogSection,isUserInstanceRecipient:!1,instanceCanBeEdited:!1,surveyInstance:{},surveyQuestionInfos:[],surveyResponses:{},user:{}};function v(e,t,n,c,d,u,v,f,m){var y=(0,i.initialiseData)(this,p),g=n.id;y.entityReference={id:g,kind:\"SURVEY_INSTANCE\"},u.getById(g).then(function(e){return y.instanceCanBeEdited=\"NOT_STARTED\"===e.status||\"IN_PROGRESS\"===e.status||\"REJECTED\"===e.status,y.surveyInstance=e,e}).then(function(e){return v.getById(e.surveyRunId)}).then(function(e){return y.surveyRun=e}).then(function(e){return d.loadViewData(o.CORE_API.PersonStore.getById,[e.ownerId]).then(function(e){return y.owner=e.data})}),f.findForInstance(g).then(function(e){return y.surveyQuestionInfos=(0,r.groupQuestions)(e)}),Promise.all([m.whoami(),u.findRecipients(g)]).then(function(e){var t=a(e,2),n=t[0],i=void 0===n?{}:n,r=t[1],o=void 0===r?[]:r;y.user=i;var l=s.default.partition(o,function(e){return s.default.toLower(e.person.email)===s.default.toLower(i.userName)}),c=a(l,2),d=c[0],u=void 0===d?[]:d,p=c[1],v=void 0===p?[]:p;y.isUserInstanceRecipient=u.length>0,y.otherRecipients=v.map(function(e){return e.person})}),u.findResponses(g).then(function(e){return y.surveyResponses=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return s.default.chain(e).map(function(e){return e.questionResponse}).map(function(e){return s.default.isNil(e.booleanResponse)||s.default.isString(e.booleanResponse)||(e.booleanResponse=e.booleanResponse?\"true\":\"false\"),s.default.isNil(e.dateResponse)||(e.dateResponse=(0,l.default)(e.dateResponse,i.formats.parseDateOnly).toDate()),e}).keyBy(\"questionId\").value()}(e)}),y.surveyInstanceLink=encodeURIComponent(s.default.replace(e.absUrl(),\"#\"+e.url(),\"\")+t.href(\"main.survey.instance.view\",{id:g})),y.saveResponse=function(e){var t=y.surveyResponses[e];u.saveResponse(y.surveyInstance.id,Object.assign({questionId:e},t,{dateResponse:t&&t.dateResponse?(0,l.default)(t.dateResponse).format(i.formats.parseDateOnly):null}))},y.saveEntityResponse=function(e,t){y.surveyResponses[t]={entityResponse:{id:e.id,kind:e.kind,name:e.name}},y.saveResponse(t)},y.saveDateResponse=function(e,t){y.surveyResponses[e]={dateResponse:t},y.saveResponse(e)},y.saveComment=function(e,t){return y.surveyResponses[e]||(y.surveyResponses[e]={}),y.surveyResponses[e].comment=t.newVal,u.saveResponse(y.surveyInstance.id,Object.assign({questionId:e},y.surveyResponses[e]))},y.saveForLater=function(){c.success(\"Survey response saved successfully\"),t.go(\"main.survey.instance.user\")},y.submit=function(){confirm(\"The survey cannot be edited once submitted.\\nPlease ensure you have saved any comments you may have entered (by clicking 'Save' on each comment field). \\n            \\nAre you sure you want to submit your responses?\")&&u.updateStatus(y.surveyInstance.id,{newStatus:\"COMPLETED\"}).then(function(){c.success(\"Survey response submitted successfully\"),d.loadAppData(o.CORE_API.NotificationStore.findAll,[],{force:!0}),t.go(\"main.survey.instance.response.view\",{id:g})})}}v.$inject=[\"$location\",\"$state\",\"$stateParams\",\"Notification\",\"ServiceBroker\",\"SurveyInstanceStore\",\"SurveyRunStore\",\"SurveyQuestionStore\",\"UserService\"],t.default={template:d.default,controller:v,controllerAs:\"ctrl\"}},1415:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=\"{{ ctrl.surveyRun.name }}\" small=\"edit response\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li> <waltz-entity-link entity-ref=ctrl.surveyInstance.surveyEntity> </waltz-entity-link> </li> <li>Surveys</li> <li> <span ng-bind=ctrl.surveyRun.name> </span> </li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <div class=row> <div class=col-sm-12> <waltz-markdown text=ctrl.surveyRun.description> </waltz-markdown> </div> </div> <br> <div class=row> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Survey Subject </div> <div class=col-sm-8> <waltz-entity-link entity-ref=ctrl.surveyInstance.surveyEntity> </waltz-entity-link> </div> </div> </div> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Survey ID </div> <div class=col-sm-8> <span ng-bind=ctrl.surveyInstance.id> </span> </div> </div> </div> </div> <br> <div class=row> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Status </div> <div class=col-sm-8 ng-bind=\"ctrl.surveyInstance.status | toDisplayName:\\'surveyInstanceStatus\\'\"> </div> </div> </div> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Due </div> <div class=col-sm-8> <waltz-from-now timestamp=ctrl.surveyInstance.dueDate days-only=true> </waltz-from-now> </div> </div> </div> </div> <br> <div class=row> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Other Participants </div> <div class=col-sm-8> <span ng-repeat=\"recipient in ctrl.otherRecipients\"> <a href=\"mailto:{{recipient.email}}?Subject=RE: {{ctrl.surveyRun.name}}\" ng-bind=recipient.displayName> </a><span ng-hide=$last>, </span> </span> <br> <a href=\"mailto:{{ctrl.surveyRun.contactEmail}}?Subject={{ctrl.surveyRun.name}} (Instance: {{ctrl.surveyInstance.id}})&body=Survey Instance: {{ctrl.surveyInstanceLink}}%0D%0A%0D%0APlease add the following participants to this survey instance:%0D%0A%0D%0A\" ng-if=\"ctrl.isUserInstanceRecipient && ctrl.instanceCanBeEdited\" class=clickable> <strong>+Request more participants</strong> </a> </div> </div> </div> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Owner </div> <div class=col-sm-8> <span ng-bind=ctrl.owner.displayName></span> <span ng-if=\"! ctrl.owner\"> - </span> </div> </div> </div> </div> <br> <div class=row> <div class=col-sm-6> <div class=row> <div class=\"col-sm-4 waltz-display-field-label\"> Contact Email </div> <div class=col-sm-8> <a href=\"mailto:{{ctrl.surveyRun.contactEmail}}?Subject=RE: {{ctrl.surveyRun.name}}\" ng-bind=ctrl.surveyRun.contactEmail></a> </div> </div> </div> </div> </div> <br> <waltz-section name=Responses ng-if=\"ctrl.isUserInstanceRecipient && ctrl.instanceCanBeEdited\"> <form name=surveyResponseForm class=\"form-horizontal waltz-survey-form\" role=form novalidate> <div ng-repeat=\"groupedQuestion in ctrl.surveyQuestionInfos\"> <h4 ng-bind=groupedQuestion.sectionName class=text-muted></h4> <hr> <div ng-repeat=\"qi in groupedQuestion.questionInfos\" class=form-group> <label for=\"{{ qi.question.id }}\" class=\"col-sm-5 control-label\"> <span ng-bind=qi.question.questionText> </span> <span ng-if=qi.question.isMandatory class=text-danger> * </span> <waltz-markdown text=qi.question.helpText class=\"small text-muted\"> </waltz-markdown> </label> <div ng-switch=qi.question.fieldType class=col-sm-7 ng-class=\"{\\'col-md-3\\': qi.question.fieldType === \\'DATE\\'}\"> <input ng-switch-when=TEXT type=text id=\"{{ qi.question.id }}\" ng-model=ctrl.surveyResponses[qi.question.id].stringResponse ng-required=qi.question.isMandatory ng-blur=ctrl.saveResponse(qi.question.id) class=form-control /> <input ng-switch-when=NUMBER type=number id=\"{{ qi.question.id }}\" placeholder=\"please enter a number\" ng-model=ctrl.surveyResponses[qi.question.id].numberResponse ng-required=qi.question.isMandatory ng-blur=ctrl.saveResponse(qi.question.id) class=form-control /> <div ng-switch-when=BOOLEAN> <label> <input name=\"{{ qi.question.id }}\" type=radio ng-model=ctrl.surveyResponses[qi.question.id].booleanResponse ng-required=qi.question.isMandatory ng-change=ctrl.saveResponse(qi.question.id) value=true /> Yes </label> &nbsp; &nbsp; &nbsp; <label> <input name=\"{{ qi.question.id }}\" type=radio ng-model=ctrl.surveyResponses[qi.question.id].booleanResponse ng-required=qi.question.isMandatory ng-change=ctrl.saveResponse(qi.question.id) value=false /> No </label> &nbsp; &nbsp; &nbsp; <label ng-if=\"! qi.question.isMandatory\"> <input name=\"{{ qi.question.id }}\" type=radio ng-model=ctrl.surveyResponses[qi.question.id].booleanResponse ng-change=ctrl.saveResponse(qi.question.id) value=null /> N/a </label> </div> <textarea ng-switch-when=TEXTAREA id=\"{{ qi.question.id }}\" ng-model=ctrl.surveyResponses[qi.question.id].stringResponse ng-required=qi.question.isMandatory ng-blur=ctrl.saveResponse(qi.question.id) rows=4 class=form-control>\\n                        </textarea> <waltz-date-picker-form-input ng-switch-when=DATE id=\"{{ qi.question.id }}\" item-id=qi.question.id allow-past-dates=true place-holder=dd-MMM-yyyy format=dd-MMM-yyyy model=ctrl.surveyResponses[qi.question.id].dateResponse on-change=ctrl.saveDateResponse ng-required=qi.question.isMandatory> </waltz-date-picker-form-input> <select ng-switch-when=DROPDOWN id=\"{{ qi.question.id }}\" ng-model=ctrl.surveyResponses[qi.question.id].stringResponse ng-required=qi.question.isMandatory ng-blur=ctrl.saveResponse(qi.question.id) ng-options=\"entry.value as entry.value for entry in qi.dropdownEntries | orderBy:\\'position\\'\" class=form-control> </select> <waltz-entity-selector ng-switch-when=APPLICATION item-id=qi.question.id required=qi.question.isMandatory current-selection=ctrl.surveyResponses[qi.question.id].entityResponse on-select=ctrl.saveEntityResponse entity-kinds=\"[\\'APPLICATION\\']\"> </waltz-entity-selector> <waltz-entity-selector ng-switch-when=PERSON item-id=qi.question.id required=qi.question.isMandatory current-selection=ctrl.surveyResponses[qi.question.id].entityResponse on-select=ctrl.saveEntityResponse entity-kinds=\"[\\'PERSON\\']\"> </waltz-entity-selector> <waltz-editable-field ng-if=qi.question.allowComment fieldtype=textarea initial-val=ctrl.surveyResponses[qi.question.id].comment item-id=qi.question.id on-save=ctrl.saveComment button-label=Comment class=\"small text-muted\"> </waltz-editable-field> </div> </div> <hr> </div> <table class=table-condensed align=right> <tr> <td> <a class=clickable ng-click=ctrl.saveForLater()> Save For Later </a> </td> <td ng-if=surveyResponseForm.$valid> <button type=button ng-click=ctrl.submit() class=\"btn btn-success btn-lg\"> <waltz-icon name=envelope> </waltz-icon> Submit </button> </td> <td ng-if=surveyResponseForm.$invalid style=padding-bottom:10px> <span class=\"alert alert-warning\"> Survey response cannot be submitted until all required questions are answered. </span> </td> </tr> </table> </form> </waltz-section> <div class=\"alert alert-warning\" ng-if=\"ctrl.surveyInstance.status === \\'EXPIRED\\'\"> <h4>Survey Expired</h4> <p>This survey response has been expired without being submitted.</p> </div> <div class=\"alert alert-warning\" ng-if=\"ctrl.surveyInstance.status === \\'COMPLETED\\' || ctrl.surveyInstance.status === \\'APPROVED\\'\"> <h4>Survey Completed</h4> <p>This survey response has been completed and is no longer can be edited. Please follow this <a ui-sref=\"main.survey.instance.response.view ({ id: ctrl.surveyInstance.id })\">link</a> to view the responses.</p> </div> <div class=\"alert alert-warning\" ng-if=!ctrl.isUserInstanceRecipient> <h4>Permission Denied</h4> <p>You don\\'t have permission to respond to this survey.</p> </div> <waltz-dynamic-section-wrapper section=ctrl.changeLogSection parent-entity-ref=ctrl.entityReference> </waltz-dynamic-section-wrapper> </div>'},1416:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=o(n(1)),i=n(25),r=n(14),s=o(n(1417));function o(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var n=this;t.findAll().then(function(t){n.groupedTemplates=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,i.nest)().key(function(e){return e.targetEntityKind}).sortKeys(r.ascending).sortValues(function(e,t){return e.name.localeCompare(t.name)}).entries(e)}(t),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e.owners={};var i=a.default.chain(n).map(\"ownerId\").uniq().value();a.default.each(i,function(n){return t.getById(n).then(function(t){t&&(e.owners[n]=t)})})}(n,e,t)})}l.$inject=[\"PersonStore\",\"SurveyTemplateStore\"];var c={controller:l,controllerAs:\"ctrl\",template:s.default};t.default=c},1417:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=\"Survey Templates\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.survey.instance.user>Survey</a></li> <li>Templates</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-section-actions> <a class=\"btn btn-primary btn-xs\" waltz-has-role=SURVEY_TEMPLATE_ADMIN ui-sref=main.survey.template.create> Create New </a> </waltz-section-actions> <div ng-repeat=\"group in ctrl.groupedTemplates track by group.key\"> <br ng-if=!$first> <h4> <waltz-icon fixed-width=true name=\"{{ group.key | toIconName:\\'entity\\' }}\" style=color:#332b23> </waltz-icon> <span ng-bind=\"group.key | toDisplayName:\\'entity\\'\"> </span> <span class=small>Target Entity Kind</span> </h4> <table class=\"table table-condensed table-striped table-hover\"> <colgroup> <col width=30%> <col width=10%> <col width=10%> <col width=20%> <col width=30%> </colgroup> <thead> <tr> <th>Name</th> <th>Status</th> <th>Created At</th> <th>Owner</th> <th>Description</th> </tr> </thead> <tbody> <tr ng-repeat=\"template in group.values track by template.id\"> <td> <a ui-sref=\"main.survey.template.view ({id: template.id})\" class=clickable ng-bind=template.name> </a> </td> <td> <span ng-bind=\"template.status | toDisplayName:\\'releaseLifecycleStatus\\'\"></span> </td> <td> <waltz-from-now timestamp=template.createdAt></waltz-from-now> </td> <td> <span ng-bind=ctrl.owners[template.ownerId].displayName></span> </td> <td> <waltz-markdown class=small text=\"template.description | limitTo:100\"> </waltz-markdown> <span ng-if=\"template.description.length > 100\">...</span> </td> </tr> </tbody> </table> </div> </div> </div>'},1418:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(n(1419));var r={surveyTemplate:{},targetEntityKinds:[{name:\"Application\",value:\"APPLICATION\"},{name:\"Change Initiative\",value:\"CHANGE_INITIATIVE\"}]};function s(e,t,n){var i=(0,a.initialiseData)(this,r);i.onSubmit=function(){n.create(i.surveyTemplate).then(function(n){t.success(\"Survey template created successfully\"),e.go(\"main.survey.template.edit\",{id:n})},function(){t.error(\"Failed to create survey template, ensure that the template name is unique\")})}}s.$inject=[\"$state\",\"Notification\",\"SurveyTemplateStore\"];var o={controller:s,controllerAs:\"ctrl\",template:i.default};t.default=o},1419:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=\"Survey Template\" small=Create> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.survey.instance.user>Survey</a></li> <li><a ui-sref=main.survey.template.list>Templates</a></li> <li>Create</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <form name=surveyTemplateForm class=\"waltz-survey-form form-horizontal\" role=form novalidate> <div class=form-group> <label for=name class=\"col-sm-2 control-label\"> Name <span class=text-danger>*</span> </label> <div class=col-sm-10> <input class=\"form-control form-control-warning\" required id=name placeholder=\"Name for this template\" ng-model=ctrl.surveyTemplate.name /> </div> </div> <div class=form-group> <label for=description class=\"col-sm-2 control-label\"> Description </label> <div class=col-sm-10> <textarea id=description class=form-control placeholder=\"Description for this template\" ng-model=ctrl.surveyTemplate.description rows=4>\\n                </textarea> </div> </div> <div class=form-group> <label for=targetEntityKind class=\"col-sm-2 control-label\"> Target Kind <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=targetEntityKind required class=form-control ng-options=\"kind.value as kind.name for kind in ctrl.targetEntityKinds\" ng-model=ctrl.surveyTemplate.targetEntityKind> </select> </div> </div> <div class=form-group style=padding-top:10px> <div class=\"col-sm-offset-2 col-sm-10\"> <button type=button ng-if=!(surveyTemplateForm.$invalid) ng-click=ctrl.onSubmit() class=\"btn btn-success\"> Create </button> <span ng-if=surveyTemplateForm.$invalid class=\"alert alert-warning\" style=padding-bottom:10px> Please fill in all required fields </span> </div> </div> </form> </div> <br> </div> '},1420:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(1)),i=n(0),r=s(n(1421));function s(e){return e&&e.__esModule?e:{default:e}}var o={editingQuestion:!1,questionFieldTypes:[{name:\"Text\",value:\"TEXT\"},{name:\"Text Area\",value:\"TEXTAREA\"},{name:\"Number\",value:\"NUMBER\"},{name:\"Boolean\",value:\"BOOLEAN\"},{name:\"Date\",value:\"DATE\"},{name:\"Dropdown\",value:\"DROPDOWN\"},{name:\"Application\",value:\"APPLICATION\"},{name:\"Person\",value:\"PERSON\"}],selectedQuestionInfo:{},surveyQuestionInfos:[],surveyTemplate:{},targetEntityKinds:[{name:\"Application\",value:\"APPLICATION\"},{name:\"Change Initiative\",value:\"CHANGE_INITIATIVE\"}]};function l(e,t,n,r){var s=(0,i.initialiseData)(this,o);s.id=e.id,r.getById(s.id).then(function(e){return s.surveyTemplate=e});var l=function(){return n.findForTemplate(s.id).then(function(e){return s.surveyQuestionInfos=e})};s.updateTemplate=function(){r.update({id:s.surveyTemplate.id,name:s.surveyTemplate.name,description:s.surveyTemplate.description,targetEntityKind:s.surveyTemplate.targetEntityKind}).then(function(e){return t.success(\"Survey template updated successfully\")})},s.showAddQuestionForm=function(){s.editingQuestion=!0;var e=a.default.chain(s.surveyQuestionInfos).map(function(e){return e.question.position}).max().value();s.selectedQuestionInfo={question:{surveyTemplateId:s.id,isMandatory:!1,allowComment:!1,position:(e||0)+10},dropdownEntries:[]}},s.showEditQuestionForm=function(e){s.editingQuestion=!0,s.selectedQuestionInfo=a.default.cloneDeep(e)},s.cancelQuestionForm=function(){s.editingQuestion=!1,s.selectedQuestionInfo=null},s.createQuestion=function(e){n.create(e).then(function(){t.success(\"Survey question created successfully\"),l(),s.cancelQuestionForm()})},s.updateQuestion=function(e){n.update(e).then(function(){t.success(\"Survey question updated successfully\"),l(),s.cancelQuestionForm()})},s.deleteQuestion=function(e){confirm(\"Are you sure you want to delete this question?\")&&n.deleteQuestion(e.question.id).then(function(){t.success(\"Survey question deleted successfully\"),l(),s.cancelQuestionForm()})},s.updateEntries=function(e){s.selectedQuestionInfo.dropdownEntries=a.default.map(e,function(e,t){return Object.assign({questionId:s.selectedQuestionInfo.question.id,position:t+1},e)})},l()}l.$inject=[\"$stateParams\",\"Notification\",\"SurveyQuestionStore\",\"SurveyTemplateStore\"];var c={controller:l,controllerAs:\"ctrl\",template:r.default};t.default=c},1421:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=\"Survey Template\" small=Edit> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.survey.instance.user>Survey</a></li> <li><a ui-sref=main.survey.template.list>Templates</a></li> <li> <a ui-sref=\"main.survey.template.view ({id: ctrl.id})\"> <span ng-bind=ctrl.surveyTemplate.name></span> </a> </li> <li>Edit</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <form name=surveyTemplateForm class=\"waltz-survey-form form-horizontal\" role=form novalidate> <div class=form-group> <label for=name class=\"col-sm-2 control-label\"> Name <span class=text-danger>*</span> </label> <div class=col-sm-10> <input class=\"form-control form-control-warning\" required id=name placeholder=\"Name for this template\" ng-model=ctrl.surveyTemplate.name /> </div> </div> <div class=form-group> <label for=description class=\"col-sm-2 control-label\"> Description </label> <div class=col-sm-10> <textarea id=description class=form-control placeholder=\"Description for this template\" ng-model=ctrl.surveyTemplate.description rows=4>\\n                </textarea> </div> </div> <div class=form-group> <label for=targetEntityKind class=\"col-sm-2 control-label\"> Target Kind <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=targetEntityKind required class=form-control ng-options=\"kind.value as kind.name for kind in ctrl.targetEntityKinds\" ng-model=ctrl.surveyTemplate.targetEntityKind> </select> </div> </div> <div class=form-group style=padding-top:10px> <div class=\"col-sm-offset-2 col-sm-10\"> <button type=button ng-if=!(surveyTemplateForm.$invalid) ng-click=ctrl.updateTemplate() class=\"btn btn-success\"> Update </button> <span ng-if=surveyTemplateForm.$invalid class=\"alert alert-warning\" style=padding-bottom:10px> Please fill in all required fields </span> </div> </div> </form> </div> <br> <waltz-section icon=question name=Questions small=\"( {{ ctrl.surveyQuestionInfos.length }} )\"> <waltz-section-actions> <a class=\"btn btn-primary btn-xs\" waltz-has-role=SURVEY_TEMPLATE_ADMIN ng-click=ctrl.showAddQuestionForm()> Add New </a> </waltz-section-actions> <div ng-if=ctrl.editingQuestion> <form name=surveyQuestionForm class=\"waltz-survey-form form-horizontal\" role=form novalidate> <div class=form-group> <label for=qSectionName class=\"col-sm-2 control-label\"> Section Name </label> <div class=col-sm-10> <input class=\"form-control form-control-warning\" id=qSectionName placeholder=\"Section name for this question\" ng-model=ctrl.selectedQuestionInfo.question.sectionName /> </div> </div> <div class=form-group> <label for=qText class=\"col-sm-2 control-label\"> Question Text <span class=text-danger>*</span> </label> <div class=col-sm-10> <textarea id=qText class=form-control required placeholder=\"Question text\" ng-model=ctrl.selectedQuestionInfo.question.questionText rows=3>\\n                        </textarea> </div> </div> <div class=form-group> <label for=qFieldType class=\"col-sm-2 control-label\"> Field Type <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=qFieldType required class=form-control ng-options=\"fieldType.value as fieldType.name for fieldType in ctrl.questionFieldTypes\" ng-model=ctrl.selectedQuestionInfo.question.fieldType> </select> </div> <div ng-if=\"ctrl.selectedQuestionInfo.question.fieldType === \\'DROPDOWN\\'\" class=\"col-sm-7 col-sm-offset-3\" style=background-color:#f8f9f9;margin-top:10px> <waltz-survey-dropdown-editor entries=ctrl.selectedQuestionInfo.dropdownEntries on-change=ctrl.updateEntries> </waltz-survey-dropdown-editor> </div> </div> <div class=form-group> <label for=qHelpText class=\"col-sm-2 control-label\"> Help Text </label> <div class=col-sm-10> <textarea id=qHelpText class=form-control placeholder=\"Help text (appears below the question)\" ng-model=ctrl.selectedQuestionInfo.question.helpText rows=3>\\n                        </textarea> </div> </div> <div class=form-group></div> <div class=form-group> <label for=qIsMandatory class=\"col-sm-2 control-label\"> Is Mandatory </label> <div class=col-sm-4> <input class=checkbox type=checkbox id=qIsMandatory ng-model=ctrl.selectedQuestionInfo.question.isMandatory /> </div> <label for=qAllowComment class=\"col-sm-2 control-label\"> Allow Comment </label> <div class=col-sm-4> <input class=checkbox type=checkbox id=qAllowComment ng-model=ctrl.selectedQuestionInfo.question.allowComment /> </div> </div> <div class=form-group> <label for=qPosition class=\"col-sm-2 control-label\"> Position <span class=text-danger>*</span> </label> <div class=col-sm-10> <input class=\"form-control form-control-warning\" type=number id=qPosition required placeholder=\"Controls the order of the questions\" ng-model=ctrl.selectedQuestionInfo.question.position /> <div class=\"small text-muted\"> We recommended using position values in increments of 10 for easier re-ordering in future </div> </div> </div> <div class=form-group style=padding-top:10px> <div class=\"col-sm-offset-2 col-sm-10\"> <span ng-if=ctrl.selectedQuestionInfo.question.id> <button type=button ng-if=!(surveyQuestionForm.$invalid) ng-click=ctrl.updateQuestion(ctrl.selectedQuestionInfo) class=\"btn btn-success\"> Update </button> <button type=button ng-click=ctrl.deleteQuestion(ctrl.selectedQuestionInfo) class=\"btn btn-danger\"> Delete </button> </span> <span ng-if=\"! ctrl.selectedQuestionInfo.question.id\"> <button type=button ng-if=!(surveyQuestionForm.$invalid) ng-click=ctrl.createQuestion(ctrl.selectedQuestionInfo) class=\"btn btn-success\"> Create </button> </span> <span ng-if=surveyQuestionForm.$invalid class=\"alert alert-warning\" style=padding-bottom:10px> Please fill in all required fields </span> &nbsp; <a class=clickable ng-click=ctrl.cancelQuestionForm()> Cancel </a> </div> </div> </form> <hr> </div> <div class=row> <div class=col-sm-12> <table class=\"table table-hover\"> <colgroup> <col width=13%> <col width=25%> <col width=13%> <col width=24%> <col width=10%> <col width=13%> <col width=8%> <col width=4%> </colgroup> <thead> <tr> <th>Section Name</th> <th>Question Text</th> <th>Field Type</th> <th>Help Text</th> <th>Mandatory</th> <th>Allow Comment</th> <th>Position</th> </tr> </thead> <tr ng-repeat=\"qi in ctrl.surveyQuestionInfos | orderBy:\\'question.position\\'\"> <td><span ng-bind=qi.question.sectionName></span></td> <td><span ng-bind=qi.question.questionText></span></td> <td><span ng-bind=\"qi.question.fieldType | toDisplayName:\\'surveyQuestionFieldType\\'\"></span></td> <td> <waltz-markdown text=qi.question.helpText> </waltz-markdown> </td> <td> <waltz-boolean-renderer value=qi.question.isMandatory> </waltz-boolean-renderer> </td> <td> <waltz-boolean-renderer value=qi.question.allowComment> </waltz-boolean-renderer> </td> <td><span ng-bind=qi.question.position></span></td> <td><a ng-click=ctrl.showEditQuestionForm(qi) class=\"btn btn-xs waltz-visibility-child-30\"> <waltz-icon name=pencil></waltz-icon> Edit </a></td> </tr> </table> </div> </div> </waltz-section> </div> '},1422:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=l(n(1)),r=n(0),s=n(27),o=l(n(1423));function l(e){return e&&e.__esModule?e:{default:e}}var c={template:{},columnDefs:[],issuedAndCompletedRuns:[],issuedAndCompletedRunsEnriched:[],draftRuns:[],questionInfos:[],runCompletionRates:{}};function d(e,t,n,o,l,d,u,p){var v=(0,r.initialiseData)(this,c);v.columnDefs=[Object.assign({},(0,s.mkLinkGridCell)(\"Name\",\"name\",\"id\",\"main.survey.run.view\"),{width:\"25%\"}),{field:\"status\",name:\"Status\",cellFilter:\"toDisplayName:'surveyRunStatus'\",width:\"5%\"},{field:\"id\",name:\"Responses\",cellTemplate:'<div uib-popover=\"{{grid.appScope.runCompletionRates[COL_FIELD].text}}\"\\n                                popover-trigger=\"mouseenter\"\\n                                popover-append-to-body=\"true\">\\n                            <uib-progress max=\"grid.appScope.runCompletionRates[COL_FIELD].totalCount\"\\n                                          animate=\"false\"\\n                                          class=\"waltz-survey-progress\">\\n                                <uib-bar value=\"grid.appScope.runCompletionRates[COL_FIELD].completedCount\"\\n                                         ng-bind=\"grid.appScope.runCompletionRates[COL_FIELD].completedCount\"\\n                                         type=\"success\">\\n                                </uib-bar>\\n                                <uib-bar value=\"grid.appScope.runCompletionRates[COL_FIELD].inProgressCount\"\\n                                         ng-bind=\"grid.appScope.runCompletionRates[COL_FIELD].inProgressCount\"\\n                                         type=\"info\">\\n                                </uib-bar>\\n                                <uib-bar value=\"grid.appScope.runCompletionRates[COL_FIELD].notStartedCount\"\\n                                         ng-bind=\"grid.appScope.runCompletionRates[COL_FIELD].notStartedCount\"\\n                                         type=\"warning\">\\n                                </uib-bar>\\n                                <uib-bar value=\"grid.appScope.runCompletionRates[COL_FIELD].expiredCount\"\\n                                         ng-bind=\"grid.appScope.runCompletionRates[COL_FIELD].expiredCount\"\\n                                         type=\"danger\">\\n                                </uib-bar>\\n                            </uib-progress>\\n                        </div>',width:\"10%\"},{field:\"contactEmail\",name:\"Contact\"},{field:\"issuedOn\",name:\"Issued\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><waltz-from-now timestamp=\"COL_FIELD\" days-only=\"true\"></waltz-from-now></div>',width:\"10%\"},{field:\"dueDate\",name:\"Due\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><waltz-from-now timestamp=\"COL_FIELD\" days-only=\"true\"></waltz-from-now></div>',width:\"10%\"},{field:\"owner.displayName\",name:\"Owner\",cellTemplate:'<div class=\"ui-grid-cell-contents\"><span ng-bind=\"COL_FIELD\"></span></div>'}];var f=n.id;v.people={},p.getById(f).then(function(e){e&&(v.template=e,l.getById(e.ownerId).then(function(t){t&&(v.people[e.ownerId]=t)}))}),u.findByTemplateId(f).then(function(t){var n=i.default.partition(t,function(e){return\"DRAFT\"!==e.status}),r=a(n,2),s=r[0];v.issuedAndCompletedRuns=void 0===s?[]:s;var o=r[1];v.draftRuns=void 0===o?[]:o,v.issuedAndCompletedRuns.forEach(function(e){u.getCompletionRate(e.id).then(function(t){return v.runCompletionRates[e.id]=Object.assign({},t,{totalCount:t.notStartedCount+t.inProgressCount+t.completedCount+t.expiredCount},{text:\"COMPLETED\"===e.status?t.completedCount+\" completed, \"+t.expiredCount+\" expired\":t.completedCount+\" completed, \"+t.inProgressCount+\" in progress, \"+t.notStartedCount+\" not started\"})})});var c=i.default.chain(v.issuedAndCompletedRuns).map(\"ownerId\").uniq().map(function(e){return l.getById(e).then(function(e){return e&&(v.people[e.id]=e),e})}).value();e.all(c).then(function(){v.issuedAndCompletedRunsEnriched=i.default.map(v.issuedAndCompletedRuns,function(e){return Object.assign(e,{owner:v.people[e.ownerId]})})})}),d.findForTemplate(f).then(function(e){return v.questionInfos=e}),v.markTemplateAsActive=function(){p.updateStatus(f,{newStatus:\"ACTIVE\"}).then(function(e){v.template.status=\"ACTIVE\",o.success(\"Survey template successfully marked as Active\")})},v.markTemplateAsDraft=function(){confirm(\"Existing survey responses might become incompatible if questions are modified. Are you sure you want to mark this template as draft?\")&&p.updateStatus(f,{newStatus:\"DRAFT\"}).then(function(e){v.template.status=\"DRAFT\",o.success(\"Survey template successfully marked as Draft\")})},v.markTemplateAsObsolete=function(){p.updateStatus(f,{newStatus:\"OBSOLETE\"}).then(function(e){v.template.status=\"OBSOLETE\",o.success(\"Survey template successfully marked as Obsolete\")})},v.cloneTemplate=function(){confirm(\"Are you sure you want to clone this template?\")&&p.clone(f).then(function(e){o.success(\"Survey template cloned successfully\"),t.go(\"main.survey.template.view\",{id:e})})}}d.$inject=[\"$q\",\"$state\",\"$stateParams\",\"Notification\",\"PersonStore\",\"SurveyQuestionStore\",\"SurveyRunStore\",\"SurveyTemplateStore\"];var u={controller:d,controllerAs:\"ctrl\",template:o.default};t.default=u},1423:function(e,t){e.exports='<div> <waltz-page-header icon=wpforms name=\"{{ ctrl.template.name }}\" small=\"Survey Template\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.survey.instance.user>Survey</a></li> <li><a ui-sref=main.survey.template.list>Templates</a></li> <li>Templates</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <waltz-section-actions> <a class=\"btn btn-primary btn-xs\" waltz-has-role=SURVEY_TEMPLATE_ADMIN ng-if=\"ctrl.template.status === \\'DRAFT\\'\" ui-sref=\"main.survey.template.edit ({id: ctrl.template.id })\"> Edit </a> <a class=\"btn btn-primary btn-xs\" waltz-has-role=SURVEY_TEMPLATE_ADMIN ng-click=ctrl.cloneTemplate()> Clone </a> <a class=\"btn btn-success btn-xs\" waltz-has-role=SURVEY_TEMPLATE_ADMIN ng-if=\"ctrl.template.status !== \\'ACTIVE\\'\" ng-click=ctrl.markTemplateAsActive()> Mark as Active </a> <a class=\"btn btn-warning btn-xs\" waltz-has-role=SURVEY_TEMPLATE_ADMIN ng-if=\"ctrl.template.status === \\'ACTIVE\\'\" ng-click=ctrl.markTemplateAsDraft()> Mark as Draft </a> <a class=\"btn btn-danger btn-xs\" waltz-has-role=SURVEY_TEMPLATE_ADMIN ng-if=\"ctrl.template.status === \\'ACTIVE\\'\" ng-click=ctrl.markTemplateAsObsolete()> Mark as Obsolete </a> </waltz-section-actions> <waltz-survey-template-overview template=ctrl.template people=ctrl.people> </waltz-survey-template-overview> </div> <br> <waltz-section icon=bolt name=Runs small=\"( {{ctrl.issuedAndCompletedRuns.length }} )\"> <waltz-section-actions> <a class=\"btn btn-primary btn-xs\" waltz-has-role=SURVEY_ADMIN ng-if=\"ctrl.template.status === \\'ACTIVE\\'\" ui-sref=\"main.survey.run.create ({id: ctrl.template.id })\"> Create </a> </waltz-section-actions> <div> <waltz-grid-with-search column-defs=ctrl.columnDefs entries=ctrl.issuedAndCompletedRunsEnriched scope-provider=ctrl search-placeholder-text=Search...> </waltz-grid-with-search> </div> <span ng-if=\"ctrl.draftRuns.length > 0\" class=\"text-muted small\"> Excluding <b ng-bind=ctrl.draftRuns.length></b> draft run(s). </span> </waltz-section> <waltz-section icon=question name=Questions small=\"( {{ ctrl.questionInfos.length }} )\"> <div class=row> <div class=col-sm-12> <table class=\"table table-condensed table-striped\"> <colgroup> <col width=15%> <col width=25%> <col width=15%> <col width=24%> <col width=10%> <col width=13%> <col width=8%> </colgroup> <thead> <tr> <th>Section Name</th> <th>Question Text</th> <th>Field Type</th> <th>Help Text</th> <th>Mandatory</th> <th>Allow Comment</th> <th>Position</th> </tr> </thead> <tr ng-repeat=\"qi in ctrl.questionInfos | orderBy:\\'position\\'\"> <td><span ng-bind=qi.question.sectionName></span></td> <td><span ng-bind=qi.question.questionText></span></td> <td><span ng-bind=\"qi.question.fieldType | toDisplayName:\\'surveyQuestionFieldType\\'\"></span></td> <td> <waltz-markdown text=qi.question.helpText> </waltz-markdown> </td> <td> <waltz-boolean-renderer value=qi.question.isMandatory> </waltz-boolean-renderer> </td> <td> <waltz-boolean-renderer value=qi.question.allowComment> </waltz-boolean-renderer> </td> <td><span ng-bind=qi.question.position></span></td> </tr> </table> </div> </div> </waltz-section> </div> '},1424:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(1)),i=n(0),r=s(n(1425));function s(e){return e&&e.__esModule?e:{default:e}}var o={creatingEntry:!1,entries:[],bulkEntriesString:null,editor:\"TABULAR\",newEntry:null,onSave:function(){return console.log(\"default onSave \")}};function l(e,t,n){return{id:e,value:n,position:t}}function c(e){var t=this;t.$onInit=function(){(0,i.initialiseData)(t,o)};var n=function(){(0,i.invokeFunction)(t.onChange,t.entries)},r=function(e){return void 0!==a.default.find(t.entries,function(t){return t.value===e})};t.startNewEntry=function(){t.creatingEntry=!0},t.saveNewEntry=function(i){var s=l(null,null,i.value);r(s.value)?e.warning(\"'\"+i.value+\"' already exists, will not add\"):t.entries=a.default.concat(t.entries,[i]),t.newEntry=null,t.creatingEntry=!1,n()},t.cancelNewEntry=function(){t.creatingEntry=!1},t.updateValue=function(i,s){r(s.newVal)?e.warning(\"'\"+s.newVal+\"' already exists, will not add\"):t.entries=a.default.map(t.entries,function(e){return e.value===s.oldVal?l(e.id,e.position,s.newVal):e}),n()},t.removeEntry=function(e){t.entries=a.default.reject(t.entries,function(t){return t.value===e.value}),n()},t.showTabularEditor=function(){t.editor=\"TABULAR\"},t.showBulkEditor=function(){t.bulkEntriesString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a.default.chain(e).map(\"value\").join(\"\\n\")}(t.entries),t.editor=\"BULK\"},t.bulkEntriesChanged=function(){t.entries=a.default.chain(t.bulkEntriesString).trim().split(\"\\n\").uniq().map(function(e){return l(null,null,e)}).value(),n()}}c.$inject=[\"Notification\"];var d={template:r.default,bindings:{entries:\"<\",onChange:\"<\"},controller:c};t.default=d},1425:function(e,t){e.exports='<div> <div class=\"text-muted small\" style=margin-bottom:15px> <div ng-if=\"$ctrl.editor === \\'TABULAR\\'\"> <span> Please add values for dropdown options </span> <a class=\"clickable pull-right\" ng-click=$ctrl.showBulkEditor()> bulk editor <waltz-icon name=folder-o></waltz-icon> </a> </div> <div ng-if=\"$ctrl.editor === \\'BULK\\'\"> <span> Please add values for dropdown options, each option on a separate line </span> <a class=\"clickable pull-right\" ng-click=$ctrl.showTabularEditor()> tabular editor <waltz-icon name=table></waltz-icon> </a> </div> </div> <table class=\"table table-condensed\" ng-if=\"$ctrl.editor === \\'TABULAR\\'\"> <tbody> <tr ng-repeat=\"entry in $ctrl.entries | orderBy:\\'position\\'\" class=waltz-visibility-parent> <td> <waltz-editable-field on-save=$ctrl.updateValue field-type=text initial-val=entry.value item-id=entry.id> </waltz-editable-field> </td> <td> <a ng-click=$ctrl.removeEntry(entry) class=\"btn btn-xs waltz-visibility-child-30\"> <waltz-icon name=trash-o></waltz-icon> Delete </a> </td> </tr> <tr> <td> <button class=\"btn btn-primary btn-xs\" ng-if=\"$ctrl.creatingEntry === false\" ng-click=$ctrl.startNewEntry()> Add </button> <div ng-if=\"$ctrl.creatingEntry === true\"> <input type=text ng-model=$ctrl.newEntry.value class=\"form-control input-sm\"> </div> </td> <td> <button class=\"btn btn-success btn-xs\" ng-if=\"$ctrl.creatingEntry === true\" ng-click=$ctrl.saveNewEntry($ctrl.newEntry)> Save </button> <button class=\"btn btn-default btn-xs\" ng-if=\"$ctrl.creatingEntry === true\" ng-click=$ctrl.cancelNewEntry()> Cancel </button> </td> </tr> </tbody> </table> <textarea ng-if=\"$ctrl.editor === \\'BULK\\'\" rows=8 cols=95 ng-model=$ctrl.bulkEntriesString ng-model-options=\"{debounce: 300}\" ng-change=$ctrl.bulkEntriesChanged()>\\n    </textarea> </div>'},1426:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=n(0),r=function(e){return e&&e.__esModule?e:{default:e}}(n(1427));var s={value:\"EXACT\",name:\"Exact\"},o={value:\"CHILDREN\",name:\"Children\"},l={allowedEntityKinds:[{value:\"APP_GROUP\",name:\"Application Group\"},{value:\"ORG_UNIT\",name:\"Org Unit\"},{value:\"MEASURABLE\",name:\"Measurable\"}],allowedScopes:{APP_GROUP:[s],CHANGE_INITIATIVE:[s],ORG_UNIT:[s,o],MEASURABLE:[s,o]}};function c(e,t){var n=this,r=(0,i.initialiseData)(this,l);r.$onChanges=function(){r.surveyTemplate&&(r.allowedEntityKinds=function(e){var t=[{value:\"APP_GROUP\",name:\"Application Group\"},{value:\"ORG_UNIT\",name:\"Org Unit\"},{value:\"MEASURABLE\",name:\"Measurable\"}];return\"CHANGE_INITIATIVE\"===e&&t.push({value:\"CHANGE_INITIATIVE\",name:\"Change Initiative\"}),t}(r.surveyTemplate.targetEntityKind))},Promise.all([e.findPublicGroups(),e.findPrivateGroups()]).then(function(e){var t=a(e,2),n=t[0],i=void 0===n?[]:n,s=t[1],o=void 0===s?[]:s;r.availableAppGroups=[].concat(i,o)}),t.findAll().then(function(e){r.availableInvolvementKinds=e}),r.onSelectorEntityKindChange=function(){r.surveyRun.selectorEntity=null},r.onSelectorEntitySelect=function(e){r.surveyRun.selectorEntity=e},r.onSubmit=function(){r.onSave(n.surveyRun)}}c.$inject=[\"AppGroupStore\",\"InvolvementKindStore\"],t.default={bindings:{surveyTemplate:\"<\",surveyRun:\"<\",onSave:\"<\"},template:r.default,controller:c}},1427:function(e,t){e.exports='<div> <h4><strong>General</strong></h4> <hr/> <form name=surveyRunForm class=\"waltz-survey-form form-horizontal\" role=form novalidate> <div class=form-group> <label class=\"col-sm-2 control-label\">Template</label> <div class=col-sm-10> <strong ng-bind=$ctrl.surveyTemplate.name></strong> <waltz-markdown class=\"small text-muted\" text=$ctrl.surveyTemplate.description> </waltz-markdown> </div> </div> <div class=form-group> <label class=\"col-sm-2 control-label\">Target kind</label> <div class=col-sm-10> <span ng-bind=\"$ctrl.surveyTemplate.targetEntityKind | toDisplayName:\\'entity\\'\"></span> </div> </div> <div class=form-group> <label for=name class=\"col-sm-2 control-label\"> Run name <span class=text-danger>*</span> </label> <div class=col-sm-10> <input class=\"form-control form-control-warning\" required id=name placeholder=\"Name for this survey run\" ng-model=$ctrl.surveyRun.name /> </div> </div> <div class=form-group> <label for=description class=\"col-sm-2 control-label\"> Run description </label> <div class=col-sm-10> <textarea id=description class=form-control placeholder=\"Description for this survey run\" ng-model=$ctrl.surveyRun.description rows=3>\\n                </textarea> </div> </div> <div class=form-group> <label for=email class=\"col-sm-2 control-label\"> Contact Email <span class=text-danger>*</span> </label> <div class=col-sm-10> <input class=form-control required id=email placeholder=\"Email for recipients to contact for questions regarding this survey run\" ng-model=$ctrl.surveyRun.contactEmail /> </div> </div> <div class=form-group> <label for=dueDate class=\"col-sm-2 control-label\"> Due Date </label> <div class=\"col-sm-10 col-md-3\"> <waltz-date-picker-form-input id=dueDate required=true place-holder=yyyy-MM-dd format=yyyy-MM-dd model=$ctrl.surveyRun.dueDate> </waltz-date-picker-form-input> </div> </div> <div class=form-group> <label for=selectorEntityKind class=\"col-sm-2 control-label\"> Selector Kind <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=selectorEntityKind required class=form-control ng-options=\"entityKind.value as entityKind.name for entityKind in $ctrl.allowedEntityKinds\" ng-change=$ctrl.onSelectorEntityKindChange() ng-model=$ctrl.surveyRun.selectorEntityKind> </select> </div> </div> <div class=form-group> <label for=selectorEntity class=\"col-sm-2 control-label\"> Selector Entity <span class=text-danger>*</span> </label> <div class=col-sm-10> <waltz-entity-selector current-selection=$ctrl.surveyRun.selectorEntity required=true on-select=$ctrl.onSelectorEntitySelect entity-kinds=[$ctrl.surveyRun.selectorEntityKind]> </waltz-entity-selector> </div> </div> <div class=form-group> <label for=selectorScope class=\"col-sm-2 control-label\"> Scope <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=selectorScope required class=form-control ng-options=\"scope.value as scope.name for scope in $ctrl.allowedScopes[$ctrl.surveyRun.selectorEntityKind]\" ng-model=$ctrl.surveyRun.selectorScope> </select> </div> </div> <div class=form-group> <label for=involmentKinds class=\"col-sm-2 control-label\"> Involvement Kind <span class=text-danger>*</span> </label> <div class=col-sm-10> <select id=involmentKinds required type=date class=form-control ng-options=\"kind as kind.name for kind in $ctrl.availableInvolvementKinds | orderBy:\\'name\\' track by kind.id\" ng-model=$ctrl.surveyRun.involvementKinds multiple=multiple style=height:250px> </select> </div> </div> <div class=form-group> <label class=\"col-sm-2 control-label\"> Issuance Kind <span class=text-danger>*</span> </label> <div class=col-sm-10> <label> <input name=issuanceKind type=radio ng-model=$ctrl.surveyRun.issuanceKind value=GROUP checked=checked /> Group </label> &nbsp; <label> <input name=issuanceKind type=radio ng-model=$ctrl.surveyRun.issuanceKind value=INDIVIDUAL /> Individual </label> <div class=\"small text-muted\"> <strong>Group</strong> - one survey response per entity.<br/> <strong>Individual</strong> - one survey response per person, which could result in multiple responses per entity. </div> </div> </div> <div class=form-group style=padding-top:10px> <div class=\"col-sm-offset-2 col-sm-10\"> <button type=button ng-if=!(surveyRunForm.$invalid) ng-click=$ctrl.onSubmit() class=\"btn btn-success\"> Next </button> <span ng-if=surveyRunForm.$invalid class=\"alert alert-warning\" style=padding-bottom:10px> Please fill in all required fields </span> </div> </div> </form> <script type=text/ng-template id=app-group-list-section/app-group-search-result.html> <a style=\"padding-left: 6px\">\\n            <span ng-bind-html=\"match.label | uibTypeaheadHighlight:query\"></span>\\n            <span class=\"small no-overflow\">\\n                -\\n                <span ng-bind=\"match.model.description | limitTo:100\"></span>\\n            </span>\\n        </a> <\\/script> </div> '},1428:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(0),i=s(n(1)),r=s(n(1429));function s(e){return e&&e.__esModule?e:{default:e}}var o={surveyRunRecipients:[],includedRecipients:[],excludedRecipients:[]};function l(e){var t=(0,a.initialiseData)(this,o);e.generateSurveyRunRecipients(t.surveyRun.id).then(function(e){t.surveyRunRecipients=e.data,t.includedRecipients=[].concat(t.surveyRunRecipients),t.excludedRecipients=[]}),t.excludeRecipient=function(e){i.default.pull(t.includedRecipients,e),t.excludedRecipients.push(e)},t.includeRecipient=function(e){t.includedRecipients.push(e),i.default.pull(t.excludedRecipients,e)},t.isRecipientIncluded=function(e){return t.includedRecipients.indexOf(e)>=0},t.onSubmit=function(){return t.onSave(t.surveyRun,t.includedRecipients,t.excludedRecipients)},t.goBack=function(){t.onGoBack()}}l.$inject=[\"SurveyRunStore\"],t.default={bindings:{surveyTemplate:\"<\",surveyRun:\"<\",onSave:\"<\",onGoBack:\"<\"},template:r.default,controller:l}},1429:function(e,t){e.exports='<div> <h4><strong>Recipients</strong></h4> <hr/> <div ng-class=\"{\\'waltz-scroll-region-400\\': $ctrl.surveyRunRecipients.length > 15}\"> <table class=\"table table-condensed table-hover small\"> <thead> <tr> <th>Entity Name</th> <th>Person Name</th> <th>Email</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat=\"recipient in $ctrl.surveyRunRecipients\" class=waltz-visibility-parent ng-class=\"{\\'danger\\': recipient.isExcluded}\"> <td><span ng-bind=recipient.surveyInstance.surveyEntity.name></span></td> <td><span ng-bind=recipient.person.displayName></span></td> <td><span ng-bind=recipient.person.email></span></td> <td> <button class=\"btn btn-xs btn-danger waltz-visibility-child-50\" ng-if=$ctrl.isRecipientIncluded(recipient) ng-click=$ctrl.excludeRecipient(recipient) uib-popover=Exclude popover-trigger=mouseenter> <waltz-icon name=trash> </waltz-icon></button> <button class=\"btn btn-xs btn-success waltz-visibility-child-50\" ng-if=!($ctrl.isRecipientIncluded(recipient)) ng-click=$ctrl.includeRecipient(recipient) uib-popover=Include popover-trigger=mouseenter> <waltz-icon name=plus> </waltz-icon></button> </td> </tr> </tbody> </table> </div> <hr/> <div class=row> <div class=\"col-sm-offset-2 col-sm-10\"> <a ng-click=$ctrl.goBack() class=clickable> Back </a> <button type=button ng-if=\"$ctrl.includedRecipients.length > 0\" ng-click=$ctrl.onSubmit() class=\"btn btn-success\"> Next </button> <span ng-if=\"$ctrl.includedRecipients.length === 0\" class=\"alert alert-warning\" style=padding-bottom:10px> At least 1 recipient required to issue a survey run </span> </div> </div> </div> '},1430:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(0);var i={onUpdateDueDate:function(){return console.log(\"SRO: No on-update-due-date method provided\")}};var r={controller:function(){var e=(0,a.initialiseData)(this,i);e.updateDueDate=function(t,n){(0,a.invokeFunction)(e.onUpdateDueDate,n.newVal)}},template:function(e){return e&&e.__esModule?e:{default:e}}(n(1431)).default,bindings:{template:\"<\",run:\"<\",onUpdateDueDate:\"<\"}};t.default=r},1431:function(e,t){e.exports='<div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Run Name </div> <div class=col-sm-10> <span ng-bind=$ctrl.run.name></span> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Template Name </div> <div class=col-sm-10> <span ng-bind=$ctrl.template.name></span> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Description </div> <div class=col-sm-10> <waltz-markdown text=$ctrl.run.description> </waltz-markdown> </div> </div> <div waltz-has-role=SURVEY_ADMIN> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Due </div> <div class=col-sm-4> <waltz-editable-field on-save=$ctrl.updateDueDate field-type=date date-format=yyyy-MM-dd initial-val=$ctrl.run.dueDate> </waltz-editable-field> </div> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Contact </div> <div class=col-sm-4> <span ng-bind=$ctrl.run.contactEmail></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Status </div> <div class=col-sm-4> <span ng-bind=\"$ctrl.run.status | toDisplayName:\\'surveyRunStatus\\'\"></span> </div> </div> </div>'},1432:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(n(1433));var r={};function s(){var e=this;e.$onInit=function(){return(0,a.initialiseData)(e,r)}}s.$inject=[];var o={template:i.default,bindings:{template:\"<\",people:\"<\"},controller:s};t.default=o},1433:function(e,t){e.exports='<div> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Template Name </div> <div class=col-sm-10> <span ng-bind=$ctrl.template.name></span> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Description </div> <div class=col-sm-10> <waltz-markdown text=$ctrl.template.description> </waltz-markdown> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Owner </div> <div class=col-sm-4> <span ng-bind=$ctrl.people[$ctrl.template.ownerId].displayName></span> </div> <div class=\"col-sm-2 waltz-display-field-label\"> Created </div> <div class=col-sm-4> <waltz-from-now timestamp=$ctrl.template.createdAt></waltz-from-now> </div> </div> <br> <div class=row> <div class=\"col-sm-2 waltz-display-field-label\"> Status </div> <div class=col-sm-10> <span ng-bind=\"$ctrl.template.status | toDisplayName:\\'releaseLifecycleStatus\\'\"></span> </div> </div> </div>'},1434:function(e,t,n){\"use strict\";function a(e,t){var n=t+\"/survey-question\";return{create:function(t){return e.post(\"\"+n,t).then(function(e){return e.data})},update:function(t){return e.put(\"\"+n,t).then(function(e){return e.data})},deleteQuestion:function(t){return e.delete(n+\"/\"+t).then(function(e){return e.data})},findForInstance:function(t){return e.get(n+\"/instance/\"+t).then(function(e){return e.data})},findForTemplate:function(t){return e.get(n+\"/template/\"+t).then(function(e){return e.data})}}}Object.defineProperty(t,\"__esModule\",{value:!0}),a.$inject=[\"$http\",\"BaseApiUrl\"],t.default=a},1435:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=c(n(6)),i=n(7),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(259)),s=c(n(1436)),o=c(n(1437)),l=c(n(1439));function c(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.svg.diagram\",[]);return(0,i.registerStores)(e,[r]),e.component(\"waltzSvgDiagram\",s.default).component(\"waltzSvgDiagrams\",o.default).component(\"waltzCommonSvgDefs\",l.default),e.name}},1436:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(1)),i=s(n(6)),r=n(5);function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=.7*t.innerWidth||1024;(0,r.select)(e[0]).select(\"svg\").attr(\"width\",n+\"px\").attr(\"height\",.8*n+\"px\")}function l(e,t){var n=this,r=!1;n.$onInit=function(){return i.default.element(t).on(\"resize\",function(){return o(e,t)})},n.$onDestroy=function(){return i.default.element(t).off(\"resize\",function(){return o(e,t)})},n.$onChanges=function(){if(n.diagram&&!0!==r){r=null!==n.diagram&&null!==n.blockProcessor,console.log(\"diagram\",{latch:r,d:n.diagram,bp:n.blockProcessor});var i=e.append(n.diagram.svg);o(e,t);var s=\"data-\"+n.diagram.keyProperty,l=i.querySelectorAll(\"[\"+s+\"]\"),c=a.default.map(l,function(e){return{block:e,value:e.attributes[s].value}});a.default.each(c,n.blockProcessor)}}}l.$inject=[\"$element\",\"$window\"],t.default={bindings:{blockProcessor:\"<\",diagram:\"<\"},controller:l}},1437:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1438));function i(e){this.show=function(t){e(function(){return t.visible=!0},100)},this.hide=function(e){e.visible=!1}}i.$inject=[\"$timeout\"],t.default={template:a.default,bindings:{diagrams:\"<\",blockProcessor:\"<\"},controller:i}},1438:function(e,t){e.exports='<div> <uib-tabset> <uib-tab heading=\"{{ diagram.name }}\" ng-repeat=\"diagram in $ctrl.diagrams | orderBy:\\'priority\\'\" deselect=$ctrl.hide(diagram) select=$ctrl.show(diagram)> <div ng-if=diagram.visible> <waltz-svg-diagram diagram=diagram block-processor=$ctrl.blockProcessor> </waltz-svg-diagram> </div> <hr class=waltz-hr-dotted> <div class=text-muted ng-bind=diagram.description> </div> </uib-tab> </uib-tabset> </div>'},1439:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(5),i=n(10),r=function(e){return e&&e.__esModule?e:{default:e}}(n(1440));var s=\"\\n     0 0 0 0 0\\n     0 0 0 0 0\\n     0 0 0 0 0\\n     0 0 0 1 0\";function o(e){var t=(0,a.select)(e[0]).select(\"svg\").append(\"defs\");!function(e){e.selectAll(\"marker\").data([{name:\"arrowhead\",color:\"#666\"},{name:\"arrowhead-PRIMARY\",color:\"green\"},{name:\"arrowhead-SECONDARY\",color:\"orange\"},{name:\"arrowhead-DISCOURAGED\",color:\"red\"},{name:\"arrowhead-NO_OPINION\",color:\"#333\"}],function(e){return e.name}).enter().append(\"marker\").attr(\"id\",function(e){return e.name}).attr(\"refX\",20).attr(\"refY\",4).attr(\"markerUnits\",\"strokeWidth\").attr(\"markerWidth\",8).attr(\"markerHeight\",8).attr(\"orient\",\"auto\").attr(\"stroke\",function(e){return(0,i.rgb)(e.color).darker(.5).toString()}).attr(\"fill\",function(e){return(0,i.rgb)(e.color).brighter(1.5).toString()}).append(\"path\").attr(\"d\",\"M 0,0 V 8 L8,4 Z\")}(t),function(e){var t=e.append(\"filter\").attr(\"id\",\"waltz-glow\");t.append(\"feGaussianBlur\").attr(\"stdDeviation\",\"3.5\").attr(\"result\",\"coloredBlur\");var n=t.append(\"feMerge\");n.append(\"feMergeNode\").attr(\"in\",\"coloredBlur\"),n.append(\"feMergeNode\").attr(\"in\",\"SourceGraphic\")}(t),function(e){var t=e.append(\"filter\").attr(\"id\",\"waltz-outline\");t.append(\"feFlood\").attr(\"flood-color\",\"#fff\").attr(\"result\",\"base\"),t.append(\"feMorphology\").attr(\"result\",\"bigger\").attr(\"in\",\"SourceGraphic\").attr(\"operator\",\"dilate\").attr(\"radius\",3),t.append(\"feColorMatrix\").attr(\"result\",\"mask\").attr(\"in\",\"bigger\").attr(\"type\",\"matrix\").attr(\"values\",s),t.append(\"feComposite\").attr(\"result\",\"drop\").attr(\"in\",\"base\").attr(\"in2\",\"mask\").attr(\"operator\",\"in\"),t.append(\"feGaussianBlur\").attr(\"result\",\"blur\").attr(\"in\",\"drop\").attr(\"stdDeviation\",3),t.append(\"feBlend\").attr(\"in\",\"SourceGraphic\").attr(\"in2\",\"blur\").attr(\"mode\",\"normal\")}(t)}o.$inject=[\"$element\"];var l={template:r.default,controller:o,bindings:{}};t.default=l},1440:function(e,t){e.exports=\"<svg width=0 height=0> </svg>\"},1441:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=u(n(6)),i=n(7),r=u(n(1442)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(252)),o=u(n(1443)),l=u(n(1444)),c=u(n(1445)),d=u(n(1446));function u(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.system\",[]);return e.service(\"NagMessageService\",r.default).service(\"SettingsService\",o.default).service(\"HierarchiesStore\",l.default),(0,i.registerStores)(e,[s]),e.directive(\"waltzHasSetting\",c.default),e.config(d.default),e.name}},1442:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(89));function r(e,t,n){return e.all([function(e,t){return e.whoami().then(function(n){return e.hasRole(n,t)})}(t,\"BETA_TESTER\"),function(e){return e.findOrDefault(i.default.betaEnvironment,!1).then(function(e){return\"true\"===e})}(n)]).then(function(e){var t=a(e,2),n=t[0],i=t[1];return!n&&i})}function s(e,t,n){return{setupNag:function(a){r(e,n,t).then(function(e){e&&function(e){return e.findOrDefault(i.default.betaNagMessage,\"You are using a test server, data will not be preserved\")}(t).then(function(e){return a(e)})})}}}s.$inject=[\"$q\",\"SettingsService\",\"UserService\"],t.default=s},1443:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(1)),i=s(n(89)),r=n(2);function s(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.loadAppData(r.CORE_API.SettingsStore.findAll,[],{force:t}).then(function(e){return e.data})},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t().then(function(t){var i=a.default.find(t,{name:e});return i?i.value:n})};return{findAll:t,findOrDefault:n,findOrDie:function(e,t){var i=\"\\nCannot find setting: [\"+e+\"] in settings table.  \\nPlease see docs/features/configuration/settings.md for more details about this table.\\n\";return n(e,null).then(function(e){if(a.default.isNull(e))throw t||i;return e})},isDevModeEnabled:function(){return n(i.default.devExtEnabled,!1).then(function(e){return\"true\"===e})}}}o.$inject=[\"ServiceBroker\"],t.default=o},1444:function(e,t,n){\"use strict\";function a(e,t){var n=t+\"/entity-hierarchy\";return{findTallies:function(){return e.get(n+\"/tallies\").then(function(e){return e.data})},findRootTallies:function(){return e.get(n+\"/root-tallies\").then(function(e){return e.data})},findRoots:function(t){return e.get(n+\"/roots/\"+t).then(function(e){return e.data})},buildForKind:function(t){return e.post(n+\"/build/\"+t,{}).then(function(e){return e.data})}}}Object.defineProperty(t,\"__esModule\",{value:!0}),a.$inject=[\"$http\",\"BaseApiUrl\"],t.default=a},1445:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(1));var r={expr:\"@waltzHasSetting\"};function s(e){var t=this;e.findAll().then(function(e){var n=t.expr.split(/\\s*=\\s*/),r=a(n,2),s=r[0],o=r[1];t.show=i.default.find(e,{name:s}).value==o}),t.show=!1}s.$inject=[\"SettingsService\"],t.default=function(){return{replace:!1,restrict:\"A\",transclude:!0,scope:{},bindToController:r,controllerAs:\"ctrl\",template:'<div ng-show=\"ctrl.show\"><ng-transclude></ng-transclude></div>',controller:s}}},1446:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=p(n(1447)),i=p(n(1449)),r=p(n(1451)),s=p(n(1453)),o=p(n(1455)),l=p(n(1457)),c=p(n(1459)),d=p(n(1461)),u=p(n(1463));function p(e){return e&&e.__esModule?e:{default:e}}var v={url:\"system\"},f={url:\"/list\",views:{\"content@\":a.default}},m={url:\"/settings\",views:{\"content@\":i.default}},y={url:\"/hierarchies\",views:{\"content@\":r.default}},g={url:\"/orphans\",views:{\"content@\":s.default}},h={url:\"/recalculate\",views:{\"content@\":o.default}},b={url:\"/actors\",views:{\"content@\":l.default}},w={url:\"/entity-named-note-types\",views:{\"content@\":c.default}},S={url:\"/involvement-kinds\",views:{\"content@\":d.default}},I={url:\"/static-panels\",views:{\"content@\":u.default}};function R(e){e.state(\"main.system\",v).state(\"main.system.list\",f).state(\"main.system.settings\",m).state(\"main.system.hierarchies\",y).state(\"main.system.orphans\",g).state(\"main.system.actors\",b).state(\"main.system.entity-named-note-types\",w).state(\"main.system.involvement-kinds\",S).state(\"main.system.static-panels\",I).state(\"main.system.recalculate\",h)}R.$inject=[\"$stateProvider\"],t.default=R},1447:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(0),i=s(n(1448)),r=s(n(53));function s(e){return e&&e.__esModule?e:{default:e}}var o={showUserAdminItems:!1};function l(e){var t=(0,a.initialiseData)(this,o);t.$onInit=function(){e.whoami(!0).then(function(e){return t.user=e}).then(function(){return t.showUserAdminItems=e.hasRole(t.user,r.default.ADMIN)||e.hasRole(t.user,r.default.USER_ADMIN)})}}l.$inject=[\"UserService\"],t.default={template:i.default,controller:l,controllerAs:\"ctrl\",bindToController:!0,scope:{}}},1448:function(e,t){e.exports='<div> <waltz-page-header name=\"System Admin\" icon=wrench> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>System Admin</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <div class=row> <div class=col-md-12> <div ng-if=ctrl.showUserAdminItems> <h3>User Management</h3> <div> <a ui-sref=main.user.management> <waltz-icon class=text-muted fixed-width=true name=users></waltz-icon> Manage Users </a> <p class=\"text-muted small\"> Register users and alter their permissions </p> </div> <div> <a ui-sref=main.user.log> <waltz-icon class=text-muted fixed-width=true name=list-ul></waltz-icon> User Logs </a> <p class=\"text-muted small\"> See information about accessed pages and actions performed </p> </div> <div> <a ui-sref=main.user.active> <waltz-icon class=text-muted fixed-width=true name=line-chart></waltz-icon> Active Users </a> <p class=\"text-muted small\"> See which have been recently active </p> </div> <hr> </div> <div waltz-has-role=ADMIN> <h3>Maintenance</h3> <div> <a ui-sref=main.system.hierarchies> <waltz-icon class=text-muted fixed-width=true name=sitemap></waltz-icon> Hierarchy Maintenance </a> <p class=\"text-muted small\"> If hierarchies change they may need rebuilding </p> </div> <div> <a ui-sref=main.system.recalculate> <waltz-icon class=text-muted fixed-width=true name=calculator></waltz-icon> Recalculate Derived Fields </a> <p class=\"text-muted small\"> Recompute: Data Type Usages, Flow Authoritative Source Ratings </p> </div> <div> <a ui-sref=main.system.orphans> <waltz-icon class=text-muted fixed-width=true name=child></waltz-icon> Orphan entities </a> <p class=\"text-muted small\"> View entities that have erroneously become orphaned </p> </div> </div> <div waltz-has-role=ADMIN> <hr> <h3>Reference Data</h3> <div> <a ui-sref=main.system.actors> <waltz-icon class=text-muted fixed-width=true name=diamond></waltz-icon> Actors </a> <p class=\"text-muted small\"> View and edit system actors </p> </div> <div> <a ui-sref=main.system.entity-named-note-types> <waltz-icon class=text-muted fixed-width=true name=sticky-note></waltz-icon> Entity Named Note Types </a> <p class=\"text-muted small\"> View and edit system entity named node types </p> </div> <div> <a ui-sref=main.system.involvement-kinds> <waltz-icon class=text-muted fixed-width=true name=id-badge></waltz-icon> Involvement Kinds </a> <p class=\"text-muted small\"> View and edit system involvement kinds </p> </div> <div> <a ui-sref=main.system.static-panels> <waltz-icon class=text-muted fixed-width=true name=code></waltz-icon> Static Panels </a> <p class=\"text-muted small\"> View and edit static panels </p> </div> </div> <div waltz-has-role=ADMIN> <hr> <h3>Internals</h3> <div> <a ui-sref=main.system.settings> <waltz-icon class=text-muted fixed-width=true name=cog></waltz-icon> Settings </a> <p class=\"text-muted small\"> See configuration settings </p> </div> </div> </div> </div> </div> </div>'},1449:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1450));function i(e){var t=this;t.settings=[];var n=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.findAll(n).then(function(e){return t.settings=e})};t.forceRefresh=function(){n(!0)},n()}i.$inject=[\"SettingsService\"],t.default={template:a.default,controller:i,controllerAs:\"ctrl\",bindToController:!0,scope:{}}},1450:function(e,t){e.exports='<div> <waltz-page-header icon=cog name=Settings> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.system.list>System Admin</a></li> <li>Settings</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <p class=waltz-paragraph> Settings are used to configure and tune waltz. The table below shows the currently configured settings. </p> <table class=\"table table-striped\"> <thead> <tr> <th>Name</th> <th>Value</th> </tr> </thead> <tbody> <tr ng-repeat=\"setting in ctrl.settings | orderBy:\\'name\\'\"> <td><span ng-bind=setting.name></span></td> <td><span ng-bind=setting.value></span></td> </tr> <tr ng-if=\"ctrl.settings.length == 0\"> <td colspan=2> No settings </td> </tr> </tbody> </table> <div class=\"pull-right text-muted small\"> Note that settings are cached in the browser, <a ng-click=ctrl.forceRefresh() class=clickable> refresh now <waltz-icon name=refresh></waltz-icon> </a> </div> </div> </div>'},1451:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=l(n(1)),r=n(0),s=n(74),o=l(n(1452));function l(e){return e&&e.__esModule?e:{default:e}}var c={combinedTallies:[],kinds:[\"CHANGE_INITIATIVE\",\"DATA_TYPE\",\"ENTITY_STATISTIC\",\"ORG_UNIT\",\"MEASURABLE\",\"PERSON\"]};function d(e,t,n,o){var l=(0,r.initialiseData)(this,c),d=function(){var t=[n.findTallies(),n.findRootTallies()];e.all(t).then(function(e){var t=a(e,2),n=t[0],r=t[1];return l.combinedTallies=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=i.default.keyBy(t,\"id\");return i.default.chain(e).map(function(e){var t=n[e.id]||{count:0};return{id:e.id,hierarchyCount:e.count,rootCount:t.count}}).value()}(n,r)})};l.build=function(e){n.buildForKind(e).then(function(t){return o.success(\"Hierarchy rebuilt for \"+e+\" with \"+t+\" records\")}).then(d)},l.getRoots=function(e){n.findRoots(e).then(function(e){return l.roots=e})},l.goToRoot=function(e){if(\"ENTITY_STATISTIC\"!==e.kind){var n=(0,s.kindToViewState)(e.kind);t.go(n,{id:e.id})}},d()}d.$inject=[\"$q\",\"$state\",\"HierarchiesStore\",\"Notification\"],t.default={template:o.default,controller:d,controllerAs:\"ctrl\",bindToController:!0,scope:{}}},1452:function(e,t){e.exports='<div> <waltz-page-header icon=cog name=\"Hierarchy Maintenance\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.system.list>System Admin</a></li> <li>Hierarchy Maintenance</li> </ol> </waltz-page-header> <waltz-section name=Hierarchy> <div class=row> <div class=col-md-3> <h4>Actions</h4> <ul class=list-unstyled> <li ng-repeat=\"kind in ctrl.kinds\"> <a ng-click=ctrl.build(kind) class=clickable> <waltz-icon name=recycle></waltz-icon> Rebuild for <span ng-bind=\"kind | toDisplayName:\\'entity\\'\"></span> </a> </li> </ul> </div> <div class=col-md-5> <h4>Record Counts</h4> <table class=\"table table-condensed table-striped\"> <thead> <tr> <th>Entity</th> <th>Hierarchy Count</th> <th>Roots</th> </tr> </thead> <tbody> <tr ng-repeat=\"tally in ctrl.combinedTallies\"> <td> <span ng-bind=\"tally.id | toDisplayName:\\'entity\\'\"></span> </td> <td> <span ng-bind=tally.hierarchyCount></span> </td> <td> <a ng-bind=tally.rootCount class=clickable ng-click=ctrl.getRoots(tally.id)> </a> </td> </tr> </tbody> </table> </div> <div class=col-md-4 ng-if=\"ctrl.roots.length > 0\"> <h4> <span ng-bind=\"ctrl.roots[0].kind | toDisplayName:\\'entity\\'\"></span> Roots </h4> <div class=waltz-scroll-region style=height:300px> <table class=\"table table-condensed small\"> <tr ng-repeat=\"root in ctrl.roots\"> <td> <a ng-bind=root.name class=clickable ng-click=ctrl.goToRoot(root) ng-if=\"root.kind !== \\'ENTITY_STATISTIC\\'\"> </a> <span ng-bind=root.name ng-if=\"root.kind === \\'ENTITY_STATISTIC\\'\"> </span> </td> </tr> </table> </div> </div> </div> </waltz-section> </div>'},1453:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=n(0),r=n(2),s=function(e){return e&&e.__esModule?e:{default:e}}(n(1454));var o={orphans:[]};function l(e,t,n,s){var l=(0,i.initialiseData)(this,o);l.showOrphans=function(e){l.selectedOrphanValues=e};e.all([n.findAppsWithNonExistentOrgUnits(),n.findOrphanMeasurableRatings(),n.findOrphanAuthoritativeSourcesByOrgUnit(),n.findOrphanAuthoritativeSourcesByApp(),n.findOrphanAuthoritativeSourcesByDataType(),n.findOrphanChangeInitiatives(),n.findOrphanLogicalFlows(),n.findOrphanPhysicalFlows(),n.findOrphanAttestations()]).then(function(e){var t=a(e,9),n=t[0],i=t[1],r=t[2],s=t[3],o=t[4],c=t[5],d=t[6],u=t[7],p=t[8];l.orphans=[{description:\"Applications referencing non-existent Org Units\",values:n},{description:\"Application Measurable Ratings mapping to non-existent Measurables or Apps\",values:i},{description:\"Authoritative Sources with non-existent Org Unit\",values:r},{description:\"Authoritative Sources with non-existent Application\",values:s},{description:\"Authoritative Sources with non-existent Data Type\",values:o},{description:\"Change Initiatives with non-existent parent\",values:c},{description:\"Logical Flows referencing non-existent applications\",values:d},{description:\"Physical Flows referencing non-existent logical flows or specifications\",values:u},{description:\"Attestations referencing non-existent applications\",values:p}]}),l.cleanupLogicalFlows=function(){s.execute(r.CORE_API.LogicalFlowStore.cleanupOrphans,[]).then(function(e){return t.success(\"Cleaned up \"+e.data+\" flow/s\")})},l.cleanupSelfReferencingLogicalFlows=function(){s.execute(r.CORE_API.LogicalFlowStore.cleanupSelfReferences,[]).then(function(e){return t.success(\"Cleaned up \"+e.data+\" flow/s\")})},l.cleanupPhysicalFlows=function(){s.execute(r.CORE_API.PhysicalFlowStore.cleanupOrphans,[]).then(function(e){return t.success(\"Cleaned up \"+e.data+\" flow/s\")})},l.cleanupAuthSources=function(){s.execute(r.CORE_API.AuthSourcesStore.cleanupOrphans,[]).then(function(e){return t.success(\"Cleaned up \"+e.data+\" auth sources/s\")})},l.cleanupAttestations=function(){s.execute(r.CORE_API.AttestationInstanceStore.cleanupOrphans,[]).then(function(e){return t.success(\"Cleaned up \"+e.data+\" attestations/s\")})}}l.$inject=[\"$q\",\"Notification\",\"OrphanStore\",\"ServiceBroker\"],t.default={template:s.default,controller:l,controllerAs:\"ctrl\",bindToController:!0,scope:{}}},1454:function(e,t){e.exports='<div> <waltz-page-header icon=cog name=Orphans> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>System</li> <li>Settings</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <div class=row> <div class=col-md-8> <table class=\"table table-condensed table-striped\"> <thead> <tr> <th>Description</th> <th>Count</th> </tr> </thead> <tbody> <tr ng-repeat=\"orphan in ctrl.orphans\"> <td> <span ng-bind=orphan.description></span> </td> <td> <kbd ng-style=\"{ \\'background-color\\': (orphan.values.length > 0 ? \\'red\\' : \\'green\\') }\"> <a ng-bind=orphan.values.length style=color:#fff class=clickable ng-click=ctrl.showOrphans(orphan.values)> </a> </kbd> </td> </tr> </tbody> </table> </div> <div class=col-md-4 ng-if=\"ctrl.selectedOrphanValues.length > 0\"> <div class=waltz-scroll-region style=height:250px> <table class=\"table table-condensed small\"> <thead> <tr> <th>Entity A</th> <th>Entity B</th> <th>Orphan</th> </tr> </thead> <tbody> <tr ng-repeat=\"value in ctrl.selectedOrphanValues\"> <td> <span ng-bind=\"value.entityA.kind | toDisplayName:\\'entity\\'\"></span>: <span ng-if=\"value.entityA.id > 0\" ng-bind=value.entityA.id> </span> <span ng-bind=value.entityA.name> </span> </td> <td> <span ng-bind=\"value.entityB.kind | toDisplayName:\\'entity\\'\"></span>: <span ng-if=\"value.entityB.id > 0\" ng-bind=value.entityB.id> </span> <span ng-bind=value.entityB.name> </span> </td> <td> <span ng-bind=value.orphanSide></span> </td> </tr> </tbody> </table> </div> </div> </div> <hr> <h3> <waltz-icon name=life-ring></waltz-icon> Actions </h3> <div class=row> <div class=col-md-12> <h4>Cleanup Logical Flows</h4> <p class=\"small text-muted\"> Marks flows as removed if either their source or target applications no longer exist </p> <button class=\"btn btn-primary\" ng-click=ctrl.cleanupLogicalFlows()> Cleanup Logical Flows </button> <button class=\"btn btn-primary\" ng-click=ctrl.cleanupSelfReferencingLogicalFlows()> Cleanup circular flows </button> <hr> <h4>Cleanup Physical Flows</h4> <p class=\"small text-muted\"> Marks orphan physical flows as removed </p> <button class=\"btn btn-primary\" ng-click=ctrl.cleanupPhysicalFlows()> Cleanup Physical Flows </button> <hr> <h4>Cleanup Auth Sources</h4> <p class=\"small text-muted\"> Remove auth sources which either point to removed apps or org units. A change log entry is created to explain what happened on the remaining half of the app-orgunit relationhsip. </p> <button class=\"btn btn-primary\" ng-click=ctrl.cleanupAuthSources()> Cleanup Auth Sources </button> <hr> <h4>Cleanup Attestations</h4> <p class=\"small text-muted\"> Remove attestation instances and requests to recipients for all attestations where applications no longer exists, either due to removal or retirement. </p> <button class=\"btn btn-primary\" ng-click=ctrl.cleanupAttestations()> Cleanup Attestations </button> </div> </div> </div> </div>'},1455:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1456));function i(e,t,n,a){this.recalcFlowRatings=function(){e.info(\"Flow Ratings recalculation requested\"),t.recalculateAll().then(function(){return e.success(\"Flow Ratings recalculated\")})},this.recalcDataTypeUsages=function(){e.info(\"Data Type Usage recalculation requested\"),a.recalculateAll().then(function(){return e.success(\"Data Type Usage recalculated\")})},this.recalcComplexity=function(){e.info(\"Complexity recalculation requested\"),n.recalculateAll().then(function(){return e.success(\"Complexity recalculated\")})}}i.$inject=[\"Notification\",\"AuthSourcesStore\",\"ComplexityStore\",\"DataTypeUsageStore\"];var r={template:a.default,controller:i,controllerAs:\"ctrl\"};t.default=r},1456:function(e,t){e.exports='<div> <waltz-page-header icon=calculator name=\"Recalculate Derived Fields\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.system.list>System Admin</a></li> <li>Recalculate</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <div class=row> <div class=col-md-12> <p> Waltz attempts to keep derived fields in sync with the source data, however it may be necessary to rebuild some of these fields if the data changes via an external process. </p> <div> <hr> <h4>Rated Flows</h4> <p class=\"small text-muted\"> Logical flows are decorated with data types which may in turn be rated against Authoritative Sources. Use the link below to recalculate all ratings. </p> <button class=\"btn btn-primary\" ng-click=ctrl.recalcFlowRatings()> Recalculate Flow Ratings </button> </div> <div> <hr> <h4>Data Type Usages</h4> <p class=\"small text-muted\"> Applications track what data types they use and how they get used. Use the link below to recalculate all data type usage records. </p> <button class=\"btn btn-primary\" ng-click=ctrl.recalcDataTypeUsages()> Recalculate Data Type Usages </button> </div> <div> <hr> <h4>Application Complexity</h4> <p class=\"small text-muted\"> Complexity is measured by counting flows, functions and servers. Use the link below to recalculate the ratings for each application. </p> <button class=\"btn btn-primary\" ng-click=ctrl.recalcComplexity()> Recalculate Complexity Ratings </button> </div> </div> </div> </div> </div>'},1457:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(1)),i=n(0),r=s(n(1458));function s(e){return e&&e.__esModule?e:{default:e}}var o={actors:[],creatingActor:!1,newActor:{isExternal:!1}};function l(e,t,n){var r=(0,i.initialiseData)(this,o);function s(e,a){var i=Object.assign(a,{id:e});return t.update(i).then(function(){return n.success(\"Updated\")})}function l(){t.loadActors().then(function(e){r.actors=e})}r.updateName=function(t,n){return\"\"===n.newVal?e.reject(\"Too short\"):s(t,{name:n}).then(function(){return a.default.find(r.actors,{id:t}).name=n.newVal})},r.updateDescription=function(t,n){return\"\"===n.newVal?e.reject(\"Too short\"):s(t,{description:n}).then(function(){return a.default.find(r.actors,{id:t}).description=n.newVal})},r.updateIsExternal=function(t,n){return null===n.newVal?e.reject(\"No value provided\"):s(t,{isExternal:n}).then(function(){return a.default.find(r.actors,{id:t}).isExternal=n.newVal})},r.startNewActor=function(){r.creatingActor=!0},r.saveNewActor=function(){t.create(r.newActor).then(function(){n.success(\"Created\"),r.creatingActor=!1,r.newActor={},l()})},r.cancelNewActor=function(){r.creatingActor=!1,console.log(\"cancelled new\")},l()}l.$inject=[\"$q\",\"ActorService\",\"Notification\"],t.default={template:r.default,controller:l,controllerAs:\"ctrl\",bindToController:!0,scope:{}}},1458:function(e,t){e.exports='<div> <waltz-page-header icon=diamond name=Actors> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>System</li> <li>Settings</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <form class=form-inline> <div class=form-group> <label>Search</label> <input type=search class=form-control placeholder=Filter... ng-model=userQuery> </div> </form> <hr> <div class=waltz-user-admin-scroll> <table class=\"table table-condensed\"> <thead> <tr> <th>Name</th> <th>Description</th> <th>External?</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat=\"actor in ctrl.actors | orderBy:\\'name\\' | filter:userQuery\" class=waltz-visibility-parent> <td> <waltz-editable-field on-save=ctrl.updateName field-type=text initial-val=actor.name item-id=actor.id> </waltz-editable-field> </td> <td align=left> <waltz-editable-field on-save=ctrl.updateDescription field-type=text initial-val=actor.description item-id=actor.id> </waltz-editable-field> </td> <td align=left> <waltz-editable-field on-save=ctrl.updateIsExternal field-type=boolean initial-val=actor.isExternal item-id=actor.id> </waltz-editable-field> </td> <td> </td> </tr> <tr> <td> <button class=\"btn btn-primary btn-sm\" ng-if=\"ctrl.creatingActor === false\" ng-click=ctrl.startNewActor()> Add </button> <div ng-if=\"ctrl.creatingActor === true\"> <input type=text ng-model=ctrl.newActor.name class=\"form-control input-sm\"> </div> </td> <td> <div ng-if=\"ctrl.creatingActor === true\"> <input type=text ng-model=ctrl.newActor.description class=\"form-control input-sm\"> </div> </td> <td> <div ng-if=\"ctrl.creatingActor === true\"> <input type=checkbox ng-model=ctrl.newActor.isExternal class=\"form-control input-sm\"> </div> </td> <td> <button class=\"btn btn-success btn-sm\" ng-if=\"ctrl.creatingActor === true\" ng-click=ctrl.saveNewActor()> Save </button> <button class=\"btn btn-default btn-sm\" ng-if=\"ctrl.creatingActor === true\" ng-click=ctrl.cancelNewActor()> Cancel </button> </td> </tr> </tbody> </table> </div> <hr> <blockquote> <p> Deletion of Actors is not supported in the user interface because an actor could be in used in Physical Flows. Please check these before removing an actor from the system. </p> </blockquote> </div> </div>'},1459:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=o(n(1)),i=n(0),r=n(2),s=o(n(1460));function o(e){return e&&e.__esModule?e:{default:e}}var l={noteTypes:[],creatingNoteType:!1,newNoteType:{}};function c(e){return a.default.split(e,/,\\s*/)}function d(e,t,n){var s=(0,i.initialiseData)(this,l),o=\"entity-named-note-types-view\";function d(e,a){return n.execute(r.CORE_API.EntityNamedNoteTypeStore.update,[e,a]).then(function(){u(!0),t.success(\"Updated\")})}function u(){var e={force:arguments.length>0&&void 0!==arguments[0]&&arguments[0],cacheRefreshListener:{componentId:o,fn:p}};n.loadAppData(r.CORE_API.EntityNamedNoteTypeStore.findAll,[],e).then(function(e){s.noteTypes=e.data})}s.updateName=function(t,n){return a.default.isNil(n.newVal)||\"\"===n.newVal?e.reject(\"Too short\"):d(t,{name:n.newVal})},s.updateDescription=function(t,n){return a.default.isNil(n.newVal)||\"\"===n.newVal?e.reject(\"Too short\"):d(t,{description:n.newVal})},s.updateIsReadOnly=function(e,t){return d(e,{isReadOnly:t.newVal})},s.updateApplicableEntityKinds=function(t,n){return a.default.isNil(n.newVal)||\"\"===n.newVal?e.reject(\"Too short\"):d(t,{applicableEntityKinds:c(n.newVal)})},s.startNewNoteType=function(){s.creatingNoteType=!0},s.saveNewNoteType=function(){var e=[{name:s.newNoteType.name,description:s.newNoteType.description,applicableEntityKinds:c(s.newNoteType.applicableEntityKinds),isReadOnly:s.newNoteType.isReadOnly}];return n.execute(r.CORE_API.EntityNamedNoteTypeStore.create,e).then(function(){t.success(\"Created new note type: \"+s.newNoteType.name),s.creatingNoteType=!1,s.newNoteType={},u(!0)})},s.deleteNoteType=function(e){if(confirm(\"Are you sure you want to delete this note type?\"))return n.execute(r.CORE_API.EntityNamedNoteTypeStore.remove,[e]).then(function(e){e.data?(t.success(\"Deleted\"),u(!0)):t.error(\"Failed to delete, ensure that note type is not being used\")})},s.cancelNewNoteType=function(){s.creatingNoteType=!1};var p=function(e){\"REFRESH\"===e.eventType&&(0,r.getApiReference)(e.serviceName,e.serviceFnName)===r.CORE_API.EntityNamedNoteTypeStore.findAll&&u()};u()}d.$inject=[\"$q\",\"Notification\",\"ServiceBroker\"],t.default={template:s.default,controller:d,controllerAs:\"ctrl\",bindToController:!0,scope:{}}},1460:function(e,t){e.exports='<div> <waltz-page-header icon=sticky-note name=\"Entity Named Note Types\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.system.list>System Admin</a></li> <li>Settings</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <form class=form-inline> <div class=form-group> <label>Search</label> <input type=search class=form-control placeholder=Filter... ng-model=searchQuery> </div> </form> <hr> <div class=waltz-user-admin-scroll> <table class=\"table table-condensed\"> <colgroup> <col width=20%> <col width=25%> <col width=35%> <col width=10%> <col width=15%> </colgroup> <thead> <tr> <th>Name</th> <th>Description</th> <th>Applicable Entity Kinds</th> <th>Read Only</th> <th>Operation</th> </tr> </thead> <tbody> <tr ng-repeat=\"noteType in ctrl.noteTypes | orderBy:\\'name\\' | filter:searchQuery\" class=waltz-visibility-parent> <td> <waltz-editable-field on-save=ctrl.updateName field-type=text initial-val=noteType.name item-id=noteType.id> </waltz-editable-field> </td> <td align=left> <waltz-editable-field on-save=ctrl.updateDescription field-type=textarea initial-val=noteType.description item-id=noteType.id> </waltz-editable-field> </td> <td align=left> <waltz-editable-field on-save=ctrl.updateApplicableEntityKinds field-type=text initial-val=noteType.applicableEntityKinds item-id=noteType.id> </waltz-editable-field> </td> <td align=left> <waltz-editable-field on-save=ctrl.updateIsReadOnly field-type=boolean initial-val=noteType.isReadOnly item-id=noteType.id> </waltz-editable-field> </td> <td> <a class=\"clickable waltz-visibility-child-50\" ng-click=ctrl.deleteNoteType(noteType.id)> <waltz-icon name=trash></waltz-icon> Delete </a> </td> </tr> <tr ng-if=\"ctrl.creatingNoteType === false\"> <td colspan=5> <button class=\"btn btn-primary btn-sm\" ng-click=ctrl.startNewNoteType()> Add </button> </td> </tr> <tr ng-if=\"ctrl.creatingNoteType === true\"> <td> <input type=text ng-model=ctrl.newNoteType.name class=\"form-control input-sm\"> </td> <td> <textarea ng-model=ctrl.newNoteType.description class=\"form-control input-sm\">\\n                        </textarea> </td> <td> <input type=text ng-model=ctrl.newNoteType.applicableEntityKinds class=\"form-control input-sm\"> </td> <td> <input type=checkbox ng-model=ctrl.newNoteType.isReadOnly class=\"\"> </td> <td> <button class=\"btn btn-success btn-xs\" ng-click=ctrl.saveNewNoteType()> Save </button> <a class=clickable ng-click=ctrl.cancelNewNoteType()> Cancel </a> </td> </tr> </tbody> </table> </div> </div> </div>'},1461:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(1)),i=n(0),r=s(n(1462));function s(e){return e&&e.__esModule?e:{default:e}}var o={involvementKinds:[],creatinginvolvementKind:!1,newinvolvementKind:{}};function l(e,t,n){var r=(0,i.initialiseData)(this,o);function s(e,a){var i=Object.assign(a,{id:e});return t.update(i).then(function(){return n.success(\"Updated\")})}function l(){t.loadInvolvementKinds().then(function(e){r.involvementKinds=e})}r.updateName=function(t,n){return\"\"===n.newVal?e.reject(\"Too short\"):s(t,{name:n}).then(function(){return a.default.find(r.involvementKinds,{id:t}).name=n.newVal})},r.updateDescription=function(t,n){return\"\"===n.newVal?e.reject(\"Too short\"):s(t,{description:n}).then(function(){return a.default.find(r.involvementKinds,{id:t}).description=n.newVal})},r.startNewinvolvementKind=function(){r.creatinginvolvementKind=!0},r.saveNewinvolvementKind=function(){t.create(r.newinvolvementKind).then(function(e){n.success(\"Created\"),r.creatinginvolvementKind=!1,r.newinvolvementKind={},l()})},r.cancelNewinvolvementKind=function(){r.creatinginvolvementKind=!1},l()}l.$inject=[\"$q\",\"InvolvementKindService\",\"Notification\"],t.default={template:r.default,controller:l,controllerAs:\"ctrl\",bindToController:!0,scope:{}}},1462:function(e,t){e.exports='<div> <waltz-page-header icon=id-badge name=\"Involvement Kinds\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li>System</li> <li>Settings</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <form class=form-inline> <div class=form-group> <label>Search</label> <input type=search class=form-control placeholder=Filter... ng-model=userQuery> </div> </form> <hr> <div class=waltz-user-admin-scroll> <table class=\"table table-condensed\"> <thead> <tr> <th>Name</th> <th>Description</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat=\"involvementKind in ctrl.involvementKinds | orderBy:\\'name\\' | filter:userQuery\" class=waltz-visibility-parent> <td> <waltz-editable-field on-save=ctrl.updateName field-type=text initial-val=involvementKind.name item-id=involvementKind.id> </waltz-editable-field> </td> <td align=left> <waltz-editable-field on-save=ctrl.updateDescription field-type=text initial-val=involvementKind.description item-id=involvementKind.id> </waltz-editable-field> </td> <td> </td> </tr> <tr> <td> <button class=\"btn btn-primary btn-sm\" ng-if=\"ctrl.creatinginvolvementKind === false\" ng-click=ctrl.startNewinvolvementKind()> Add </button> <div ng-if=\"ctrl.creatinginvolvementKind === true\"> <input type=text ng-model=ctrl.newinvolvementKind.name class=\"form-control input-sm\"> </div> </td> <td> <div ng-if=\"ctrl.creatinginvolvementKind === true\"> <input type=text ng-model=ctrl.newinvolvementKind.description class=\"form-control input-sm\"> </div> </td> <td> <button class=\"btn btn-success btn-sm\" ng-if=\"ctrl.creatinginvolvementKind === true\" ng-click=ctrl.saveNewinvolvementKind()> Save </button> <button class=\"btn btn-default btn-sm\" ng-if=\"ctrl.creatinginvolvementKind === true\" ng-click=ctrl.cancelNewinvolvementKind()> Cancel </button> </td> </tr> </tbody> </table> </div> <hr> <blockquote> <p> Deletion of Involvement Kinds is not supported in the user interface because it can be in used in Person Involvements. Please check these before removing an involvement kind from the system. </p> </blockquote> </div> </div>'},1463:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1464)),i=n(0);var r={fieldLayout:[{className:\"row\",fieldGroup:[{className:\"col-xs-8\",fieldGroup:[{type:\"input\",key:\"title\",templateOptions:{label:\"Title\",description:\"Only shown if panel rendered in a section\",required:!0}}]},{className:\"col-xs-4\",fieldGroup:[{type:\"input\",key:\"icon\",templateOptions:{label:\"Icon\",placeholder:\"Group determines on what screens this panel will appear\",description:\"Icon names are base on fontawesome names (without the 'fa-' prefix)\",required:!0}}]}]},{className:\"row\",fieldGroup:[{className:\"col-xs-8\",fieldGroup:[{type:\"input\",key:\"group\",templateOptions:{label:\"Group\",description:\"Group determines on what screens this panel will appear\",required:!0}}]},{className:\"col-xs-4\",fieldGroup:[{type:\"number\",key:\"priority\",templateOptions:{label:\"Priority\",description:\"If multiple panels belong to the same group, priority will be used to order them (ascending)\",required:!0}}]}]},{className:\"row\",fieldGroup:[{className:\"col-xs-8\",fieldGroup:[{type:\"html\",key:\"content\",templateOptions:{label:\"Content\",description:\"HTML code, any paths should be absolute\",required:!0}}]},{className:\"col-xs-4\",fieldGroup:[{type:\"number\",key:\"width\",templateOptions:{label:\"Width\",description:\"If rendered in a grid determines the number of cells to span (1-12)\",required:!0}}]}]}]};function s(e){var t=(0,i.initialiseData)(this,r),n=function(){return e.findAll().then(function(e){return t.staticPanels=e})};n(),t.select=function(e){t.selected=e,t.formModel=Object.assign({},e)},t.dismiss=function(){t.selected=null,t.formModel=null},t.onAddClicked=function(){var e={icon:\"info\",content:\"<div>\\n    <h2>My content</h2>\\n</div>\"};t.selected=e,t.formModel=Object.assign({},e)},t.onSubmit=function(){e.save(t.formModel).then(function(){n(),t.dismiss()})}}s.$inject=[\"StaticPanelStore\"];var o={controller:s,template:a.default,controllerAs:\"ctrl\"};t.default=o},1464:function(e,t){e.exports='<div> <waltz-page-header icon=code name=\"Static Panels\"> <ol class=waltz-breadcrumbs> <li><a ui-sref=main>Home</a></li> <li><a ui-sref=main.system.list>System Admin</a></li> <li>Static Panels</li> </ol> </waltz-page-header> <div class=\"waltz-page-summary waltz-page-summary-attach\"> <table class=\"table table-condensed table-hover\" ng-if=\"! ctrl.selected\"> <thead> <tr> <th>Group</th> <th>Title</th> <th>Icon</th> <th>Priority</th> <th>Width</th> </tr> </thead> <tbody> <tr ng-repeat=\"panel in ctrl.staticPanels | orderBy:[\\'group\\',\\'priority\\']\"> <td> <a ng-click=ctrl.select(panel) class=clickable ng-bind=panel.group> </a> </td> <td> <span ng-bind=panel.title></span> </td> <td> <waltz-icon name=\"{{ panel.icon }}\"></waltz-icon> ( <span ng-bind=panel.icon></span> ) </td> <td> <span ng-bind=panel.priority></span> </td> <td> <span ng-bind=panel.width></span> </td> </tr> </tbody> <tbody> <tr> <td colspan=5> <a class=clickable ng-click=ctrl.onAddClicked()> <waltz-icon name=plus> </waltz-icon> Add new </a> </td> </tr> </tbody> </table> <div ng-if=ctrl.selected class=waltz-fade-if> <h4> <span ng-bind=ctrl.selected.title></span> <small ng-bind=ctrl.selected.group></small> <small class=\"pull-right clickable\" ng-click=ctrl.dismiss()> Dismiss </small> </h4> <form ng-submit=ctrl.onSubmit() name=ctrl.form novalidate> <formly-form form=ctrl.form model=ctrl.formModel fields=ctrl.fieldLayout> </formly-form> <hr/> <input type=submit ng-disabled=\"ctrl.form.$pristine || ctrl.form.$invalid\" value=Save style=margin-left:12px class=\"btn btn-success\"> <a ng-click=ctrl.dismiss() class=clickable> Cancel </a> </form> </div> </div> </div>'},1465:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=d(n(6)),i=n(7),r=d(n(261)),s=d(n(1466)),o=d(n(1468)),l=d(n(1470)),c=d(n(1472));function d(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.technology\",[]);return(0,i.registerServices)(e,[r.default]),(0,i.registerComponents)(e,[o.default,l.default,s.default,c.default]),e.name}},1466:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=l(n(1)),i=n(0),r=n(17),s=n(2),o=l(n(1467));function l(e){return e&&e.__esModule?e:{default:e}}var c={stats:{},hasAnyData:!1};function d(e){var t=(0,i.initialiseData)(this,c);t.$onInit=function(){var n=(0,r.mkSelectionOptions)(t.parentEntityRef);e.loadViewData(s.CORE_API.TechnologyStatisticsService.findBySelector,[n]).then(function(e){t.stats=e.data;var n=t.stats,i=n.serverStats,r=void 0===i?{}:i,s=n.databaseStats,o=void 0===s?{}:s,l=n.softwareStats,c=void 0===l?{}:l,d=r&&!a.default.isEmpty(r.environmentCounts),u=o&&!a.default.isEmpty(o.environmentCounts),p=c&&!a.default.isEmpty(c.vendorCounts);t.hasAnyData=d||u||p})}}d.$inject=[\"ServiceBroker\"];var u={bindings:{parentEntityRef:\"<\"},template:o.default,controller:d};t.default={id:\"waltzTechnologySummarySection\",component:u}},1467:function(e,t){e.exports=\"<div> <waltz-source-data-section-addon entities=\\\"['SERVER', 'DATABASE']\\\"> </waltz-source-data-section-addon> <waltz-group-technology-summary stats=$ctrl.stats ng-if=$ctrl.hasAnyData> </waltz-group-technology-summary> <waltz-no-data ng-if=\\\"! $ctrl.hasAnyData\\\"> <message> <strong>No associated technology found</strong> </message> </waltz-no-data> </div>\"},1468:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(1)),i=n(19),r=n(109);function s(e){return e&&e.__esModule?e:{default:e}}var o={visibility:{servers:!1,software:!1,databases:!1}},l={environment:{size:70,colorProvider:function(e){return(0,i.environmentColorScale)(e.data.key)}},operatingSystem:{size:70,colorProvider:function(e){return(0,i.operatingSystemColorScale)(e.data.key)}},location:{size:70,colorProvider:function(e){return(0,i.variableScale)(e.data.key)}},vendor:{size:70,colorProvider:function(e){return(0,i.variableScale)(e.data.key)}},maturity:{size:70,colorProvider:function(e){return(0,i.maturityColorScale)(e.data.key)}},endOfLifeStatus:{size:70,colorProvider:function(e){return(0,i.variableScale)(e.data.key)},labelProvider:function(e){return r.endOfLifeStatus[e.key]?r.endOfLifeStatus[e.key].name:\"Unknown\"}}},c=function(e){return{key:e.id,count:e.count}},d=function(e){return a.default.map(e,c)};var u={template:s(n(1469)).default,bindings:{stats:\"<\"},controller:function(){var e=a.default.defaultsDeep(this,o);e.$onChanges=function(){e.stats&&(Object.assign(e,function(e){return{serverStats:Object.assign({},e,{environment:d(e.environmentCounts),operatingSystem:d(e.operatingSystemCounts),location:d(e.locationCounts),operatingSystemEndOfLifeStatus:d(e.operatingSystemEndOfLifeStatusCounts),hardwareEndOfLifeStatus:d(e.hardwareEndOfLifeStatusCounts)})}}(e.stats.serverStats)),Object.assign(e,function(e){return{databaseStats:Object.assign({},e,{environment:d(e.environmentCounts),vendor:d(e.vendorCounts),endOfLifeStatus:d(e.endOfLifeStatusCounts)})}}(e.stats.databaseStats)),Object.assign(e,function(e){return{softwareStats:Object.assign({},e,{vendor:d(e.vendorCounts),maturity:d(e.maturityCounts)})}}(e.stats.softwareStats)),e.visibility=function(e){return{servers:e.serverStats.totalCount>0,databases:e.databaseStats&&a.default.keys(e.databaseStats.vendorCounts).length>0,software:e.softwareStats&&a.default.keys(e.softwareStats.vendorCounts).length>0}}(e.stats))},e.pieConfig=l}};t.default={id:\"waltzGroupTechnologySummary\",component:u}},1469:function(e,t){e.exports='<div> <div ng-if=$ctrl.visibility.servers> <h4 style=padding-left:32px> <waltz-icon name=server> </waltz-icon> Servers </h4> <div class=row> <div class=col-sm-4> <waltz-pie-table data=$ctrl.serverStats.operatingSystem config=$ctrl.pieConfig.operatingSystem title=\"By Operating System\"> </waltz-pie-table> </div> <div class=col-sm-4> <waltz-pie-table data=$ctrl.serverStats.environment config=$ctrl.pieConfig.environment title=\"By Environment\"> </waltz-pie-table> </div> <div class=col-sm-4> <waltz-pie-table data=$ctrl.serverStats.location config=$ctrl.pieConfig.location title=\"By Location\"> </waltz-pie-table> </div> </div> <div class=row> <div class=col-sm-4> <waltz-pie-table data=$ctrl.serverStats.operatingSystemEndOfLifeStatus config=$ctrl.pieConfig.endOfLifeStatus title=\"By Operating System EOL Status\"> </waltz-pie-table> </div> <div class=col-sm-4> <waltz-pie-table data=$ctrl.serverStats.hardwareEndOfLifeStatus config=$ctrl.pieConfig.endOfLifeStatus title=\"By Hardware EOL Status\"> </waltz-pie-table> </div> </div> </div> <div ng-if=$ctrl.visibility.databases style=\"border-top:2px dotted #ddd\"> <h4 style=padding-left:32px;padding-top:16px> <waltz-icon name=database> </waltz-icon> Databases </h4> <div class=row style=padding-top:8px> <div class=col-sm-4> <waltz-pie-table data=$ctrl.databaseStats.vendor config=$ctrl.pieConfig.vendor title=\"By Vendor\"> </waltz-pie-table> </div> <div class=col-sm-4> <waltz-pie-table data=$ctrl.databaseStats.environment config=$ctrl.pieConfig.environment title=\"By Environment\"> </waltz-pie-table> </div> <div class=col-sm-4> <waltz-pie-table data=$ctrl.databaseStats.endOfLifeStatus config=$ctrl.pieConfig.endOfLifeStatus title=\"By EOL Status\"> </waltz-pie-table> </div> </div> </div> <div ng-if=$ctrl.visibility.software style=\"border-top:2px dotted #ddd\"> <h4 style=padding-left:32px;padding-top:16px> <waltz-icon name=leaf> </waltz-icon> Software </h4> <div class=row style=padding-top:8px ng-if=$ctrl.visibility.software> <div class=col-sm-4> <waltz-pie-table data=$ctrl.softwareStats.vendor config=$ctrl.pieConfig.vendor title=\"By Vendor\"> </waltz-pie-table> </div> <div class=col-sm-4> <waltz-pie-table data=$ctrl.softwareStats.maturity config=$ctrl.pieConfig.maturity title=\"By Maturity\"> </waltz-pie-table> </div> </div> </div> </div>'},1470:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a={bindings:{servers:\"<\",databases:\"<\"},template:function(e){return e&&e.__esModule?e:{default:e}}(n(1471)).default};t.default={id:\"waltzTechnologySummaryPies\",component:a}},1471:function(e,t){e.exports='<div> <div style=\"border-top:2px dotted #ddd;margin-top:4px;margin-bottom:8px\" ng-if=\"$ctrl.servers.length > 0\"> <h4 class=text-center> <waltz-icon name=server></waltz-icon> Servers </h4> <waltz-server-pies servers=$ctrl.servers> </waltz-server-pies> </div> <div style=\"border-top:2px dotted #ddd;margin-top:4px;margin-bottom:8px\" ng-if=\"$ctrl.databases.length > 0\"> <h4 class=text-center> <waltz-icon name=database></waltz-icon> Databases </h4> <waltz-database-pies databases=$ctrl.databases> </waltz-database-pies> </div> </div>'},1472:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=o(n(1)),i=n(0),r=o(n(1473)),s=n(2);function o(e){return e&&e.__esModule?e:{default:e}}var l='<div class=\"ui-grid-cell-contents\"> <waltz-icon ng-if=\"COL_FIELD\" name=\"power-off\"></waltz-icon></div>';function c(e){return{type:e.filter.SELECT,selectOptions:[{value:\"true\",label:\"Yes\"},{value:\"false\",label:\"No\"}]}}function d(e){return\"END_OF_LIFE\"===e}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"export.csv\";return{columnDefs:[],data:[],enableGridMenu:!0,enableFiltering:!0,enableHorizontalScrollbar:t.scrollbars.NEVER,enableSorting:!0,exporterCsvFilename:n,exporterMenuPdf:!1,onRegisterApi:function(t){e.enabled(t.grid.element,!1)}}}function p(e,t,n){var r=this;function o(e){e?(r.filteredServers=(0,i.termSearch)(r.servers,e),r.filteredDatabases=(0,i.termSearch)(r.databases,e),console.log(\"sr\",e,r.servers.length,r.filteredServers.length)):(r.filteredServers=r.servers,r.filteredDatabases=r.databases)}r.$onInit=function(){n.loadViewData(s.CORE_API.ServerInfoStore.findByAppId,[r.parentEntityRef.id]).then(function(e){r.servers=e.data,a.default.forEach(r.servers,function(e){return Object.assign(e,{isHwEndOfLife:d(e.hardwareEndOfLifeStatus),isOperatingSystemEndOfLife:d(e.operatingSystemEndOfLifeStatus)})}),r.serverGridOptions.data=r.servers}).then(function(){return o(r.qry)}),n.loadViewData(s.CORE_API.DatabaseStore.findByAppId,[r.parentEntityRef.id]).then(function(e){r.databases=e.data,a.default.forEach(r.databases,function(e){return Object.assign(e,{isEndOfLife:d(e.endOfLifeStatus)})}),r.databaseGridOptions.data=r.databases}).then(function(){return o(r.qry)})},r.serverGridOptions=function(e,t){var n=[{field:\"hostname\",displayName:\"Host\"},{field:\"environment\"},{field:\"virtual\",displayName:\"Virtual\",width:\"5%\",filter:c(t),cellTemplate:'\\n                <div class=\"ui-grid-cell-contents\"> \\n                    <waltz-icon ng-if=\"COL_FIELD\" name=\"check\"></waltz-icon>\\n                </div>'},{field:\"operatingSystem\",displayName:\"OS\"},{field:\"operatingSystemVersion\",displayName:\"Version\"},{field:\"location\"},{field:\"country\"},{field:\"isHwEndOfLife\",displayName:\"h/w EOL\",width:\"6%\",filter:c(t),cellTemplate:l},{field:\"hardwareEndOfLifeDate\",displayName:\"h/w EOL On\"},{field:\"isOperatingSystemEndOfLife\",displayName:\"OS EOL\",width:\"6%\",filter:c(t),cellTemplate:l},{field:\"operatingSystemEndOfLifeDate\",displayName:\"OS EOL On\"},{field:\"lifecycleStatus\",displayName:\"Lifecycle\",cellFilter:\"toDisplayName:'lifecycleStatus'\"}],i=u(e,t,\"server.csv\");return a.default.extend(i,{columnDefs:n,rowTemplate:'<div ng-class=\"{\\'bg-danger\\': row.entity.isHwEndOfLife || row.entity.isOperatingSystemEndOfLife}\"><div ng-repeat=\"col in colContainer.renderedColumns track by col.colDef.name\" class=\"ui-grid-cell\" ui-grid-cell></div></div>'})}(e,t),r.databaseGridOptions=function(e,t){var n=[{field:\"instanceName\",displayName:\"Instance\"},{field:\"databaseName\",displayName:\"Database\"},{field:\"environment\"},{field:\"dbmsVendor\",displayName:\"Vendor\"},{field:\"dbmsName\",displayName:\"Product Name\"},{field:\"dbmsVersion\",displayName:\"Version\"},{field:\"isEndOfLife\",displayName:\"EOL\",width:\"5%\",filter:c(t),cellTemplate:l},{field:\"endOfLifeDate\",displayName:\"EOL On\"},{field:\"lifecycleStatus\",displayName:\"Lifecycle\",cellFilter:\"toDisplayName:'lifecycleStatus'\"}],i=u(e,t,\"database.csv\");return a.default.extend(i,{columnDefs:n,rowTemplate:'<div ng-class=\"{\\'bg-danger\\': row.entity.isEndOfLife}\"><div ng-repeat=\"col in colContainer.renderedColumns track by col.colDef.name\" class=\"ui-grid-cell\" ui-grid-cell></div></div>'})}(e,t),r.doSearch=function(){return o(r.qry)},r.hasAnyData=function(){var e=(0,i.perhaps)(function(){return r.servers.length>0},!1),t=(0,i.perhaps)(function(){return r.databases.length>0},!1);return e||t}}p.$inject=[\"$animate\",\"uiGridConstants\",\"ServiceBroker\"];var v={template:r.default,bindings:{parentEntityRef:\"<\"},controller:p};t.default={id:\"waltzTechnologySection\",component:v}},1473:function(e,t){e.exports='<div> <div ng-if=$ctrl.hasAnyData()> <waltz-section-actions> <input type=search placeholder=Search style=border-radius:6px;padding-left:3px ng-change=$ctrl.doSearch() ng-model-options=\"{ debounce: 200 }\" ng-model=$ctrl.qry> <button class=\"btn btn-xs waltz-btn-transparent\" ng-click=\"$ctrl.visibility.overlay = ! $ctrl.visibility.overlay\"> <waltz-icon name=map-signs></waltz-icon> </button> </waltz-section-actions> <waltz-source-data-overlay visible=$ctrl.visibility.overlay ratings=$ctrl.sourceDataRatings entities=\"[\\'DATABASE\\', \\'SERVER\\', \\'SOFTWARE\\']\"> </waltz-source-data-overlay> <uib-tabset> <uib-tab heading=Overview> <waltz-technology-summary-pies servers=$ctrl.filteredServers databases=$ctrl.filteredDatabases> </waltz-technology-summary-pies> </uib-tab> <uib-tab heading=Servers select=\"showServerDetail = true\" disable=\"$ctrl.servers.length == 0\"> <div ng-if=showServerDetail> <br> <div style=font-size:smaller;height:300px ui-grid-exporter ui-grid-resize-columns ui-grid=$ctrl.serverGridOptions> </div> </div> </uib-tab> <uib-tab heading=Databases select=\"showDatabaseDetail = true\" disable=\"$ctrl.databases.length == 0\"> <div ng-if=showDatabaseDetail> <br> <div style=font-size:smaller;height:300px ui-grid-exporter ui-grid-resize-columns ui-grid=$ctrl.databaseGridOptions> </div> </div> </uib-tab> </uib-tabset> <div class=\"waltz-paragraph text-muted pull-right small\"> <waltz-icon name=info-circle></waltz-icon> Associated software packages have been sourced from: <ul class=list-inline style=display:inline-block> <li ng-repeat=\"(source, usages) in $ctrl.softwareUsages\"> {{ source }} <span ng-if=!$last>,</span> </li> </ul> </div> </div> <waltz-no-data ng-if=\"! $ctrl.hasAnyData()\"> <message> <strong>No associated technology found</strong> </message> </waltz-no-data> </div> '},1474:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=c(n(6)),i=c(n(260)),r=c(n(1475)),s=c(n(1477)),o=c(n(1479)),l=n(7);function c(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=a.default.module(\"waltz.taxonomy-management\",[]);return(0,l.registerStores)(e,[i.default]),(0,l.registerComponents)(e,[r.default,s.default,o.default]),e.name}},1475:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1476)),i=n(0);var r={onSelect:function(e){return console.log(\"WPTCL:onSelect default handler\",e)}};function s(){(0,i.initialiseData)(this,r)}s.$inject=[];var o={bindings:{pendingChanges:\"<\",onSelect:\"<\"},template:a.default,controller:s};t.default={component:o,id:\"waltzPendingTaxonomyChangesList\"}},1476:function(e,t){e.exports='<div> <waltz-no-data ng-if=\"$ctrl.pendingChanges.length === 0\"> <message> <strong>No pending changes</strong> </message> </waltz-no-data> <div ng-if=\"$ctrl.pendingChanges.length > 0\"> <table class=\"table table-condensed table-hover small\"> <thead> <th>Primary Ref</th> <th>Change Type</th> </thead> <tbody> <tr ng-repeat=\"change in $ctrl.pendingChanges\" class=clickable ng-click=$ctrl.onSelect(change)> <td> <a ng-bind=change.a.name></a> </td> <td> <span ng-bind=change.changeType></span> </td> </tr> </tbody> </table> </div> </div> '},1477:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1478)),i=n(0),r=n(2);var s={pendingChanges:[]};function o(e){var t=(0,i.initialiseData)(this,s);t.$onChanges=function(n){n.changeDomain&&(t.changeDomain?e.loadViewData(r.CORE_API.TaxonomyManagementStore.findPendingChangesByDomain,[t.changeDomain],{force:!0}).then(function(e){return e.data}):Promise.resolve([])).then(function(e){return t.pendingChanges=e})},t.onSelectPendingChange=function(n){console.log(\"s\",c),e.execute(r.CORE_API.TaxonomyManagementStore.previewByChangeId,[c.id],{force:!0}).then(function(e){return t.preview=e.data})}}o.$inject=[\"ServiceBroker\"];var l={bindings:{changeDomain:\"<\"},template:a.default,controller:o};t.default={component:l,id:\"waltzPendingTaxonomyChangesSubSection\"}},1478:function(e,t){e.exports=\"<div> <waltz-pending-taxonomy-changes-list pending-changes=$ctrl.pendingChanges on-select=$ctrl.onSelectPendingChange> </waltz-pending-taxonomy-changes-list> </div> \"},1479:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1480)),i=n(0);var r={severityToBootstrapAlertClass:n(396).severityToBootstrapAlertClass};function s(){(0,i.initialiseData)(this,r)}s.$inject=[];var o={bindings:{preview:\"<\"},controller:s,template:a.default};t.default={component:o,id:\"waltzTaxonomyChangeCommandPreview\"}},1480:function(e,t){e.exports='<waltz-no-data ng-if=\"$ctrl.preview.impacts.length === 0\"> <message> No impacts </message> </waltz-no-data> <table class=\"table table-condensed\" ng-if=\"$ctrl.preview.impacts.length > 0\"> <thead> <th>Severity</th> <th>Information</th> <th>Impacted references</th> </thead> <tbody> <tr ng-repeat=\"impact in $ctrl.preview.impacts\" ng-class=$ctrl.severityToBootstrapAlertClass(impact.severity)> <td> <strong ng-bind=\"impact.severity | toDisplayName:\\'severity\\'\"></strong> </td> <td> <span ng-bind=impact.description></span> </td> <td> <span class=\"badge clickable\" ng-bind=impact.impactedReferences.length></span>  </td> </tr> </tbody> </table> '},152:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.enrichServerStats=function(e){if(!e)return;var t=e.virtualCount,n=e.physicalCount+t,a=n>0?Number(t/n*100).toFixed(1):\"-\";return Object.assign({},e,{total:n,virtualPercentage:a})}},155:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.filterData=function(e,t){var n=a.default.cloneDeep(e);if((0,i.isEmpty)(t))return n;t=t.toLowerCase();var r=function(e){return a.default.get(e,[\"searchTargetStr\"],\"\").indexOf(t)>-1},s=function(e){return a.default.filter(e,r)};return a.default.map(e,function(e){return a.default.map(e,s)})},t.enrichDatumWithSearchTargetString=s,t.prepareData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=a.default.keyBy(t,\"id\"),o=a.default.keyBy(n,\"id\"),l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=a.default.map(n,\"id\");return a.default.chain(e.axisDefinitions).filter(function(e){return!a.default.includes(i,e.domainItem.id)}).map(function(e){var n=t[e.domainItem.id];return{id:n.id,name:n.name,description:n.description,axisOrientation:e.axisOrientation,position:e.position,data:n}}).orderBy(function(e){return e.position}).groupBy(function(e){return e.axisOrientation}).value()}(e,o,i),c=l.COLUMN||[],d=l.ROW||[],u=(0,r.toOffsetMap)(c),p=(0,r.toOffsetMap)(d),v=a.default.times(d.length,function(){return a.default.times(c.length,function(){return[]})}),f=a.default.reduce(e.ratings,function(e,t){var n=t.row.id,i=t.column.id,r=t.item.id,l=r+\"_\"+n+\"_\"+i,c=s[r],d=p[n],v=u[i],f=e[d]||[],m=f[v]||[],y={row:o[t.row.id],column:o[t.column.id]},g={id:l,node:Object.assign({},c,{externalId:c.assetCode}),domainCoordinates:y,state:{rating:t.rating,comment:t.description},searchTargetStr:(c.name+\" \"+c.assetCode).toLowerCase()};return f[v]=a.default.concat(m,[g]),e[d]=f,e},v);return{columnHeadings:c,rowHeadings:d,rowData:f}},t.mkRandomRowData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return a.default.map(a.default.range(0,e),function(){return function(){var e=a.default.random(1,8);return a.default.map(a.default.range(0,e),function(){return function(){var e=a.default.random(0,1e7);return s({id:e,node:{name:\"App \"+e,externalId:e+\"-1\",description:\"about test app\"},state:{rating:(0,i.randomPick)(o),comment:\"test comment\"}})}()})}()})},t.mkRandomMeasurable=function(e,t){return{id:t+\"-\"+e,name:t+\": \"+e+\" : abcdefghijklmnopqrstuvwxyz\"}};var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),i=n(0),r=n(156);function s(e){var t=e.node,n=t.name.toLowerCase(),a=t.externalId.toLowerCase(),i=e.changeInitiative,r=n+\" \"+a+\" \"+(i?i.name.toLowerCase():\"\")+\" \"+(i?i.externalId.toLowerCase():\"\");return Object.assign({},e,{searchTargetStr:r})}var o=[\"R\",\"A\",\"G\",\"G\",\"G\",\"X\",\"X\"]},157:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.NODE_STYLES=t.NODE_DIMENSIONS=void 0,t.updateUnit=function(e,t){var n=t.colorScale;e.select(\"rect.\"+r.nodeCell).attr(\"stroke\",function(e){return n(e.state.rating)}).attr(\"fill\",function(e){return n(e.state.rating).brighter(2.5)}),e.select(\"rect.\"+r.nodeCellRatingIndicator).attr(\"fill\",function(e){return n(e.state.rating)}).attr(\"stroke\",function(e){return n(e.state.rating)}),e.select(\"path.\"+r.nodeCellCommentIndicator).attr(\"fill\",function(e){return n(e.state.rating).brighter(e.state.comment?0:2.5)})},t.drawUnit=function(e,t){e.append(\"rect\").classed(r.nodeCell,!0).attr(\"width\",i.width).attr(\"height\",i.height),e.call(d).call(c).call(l).call(o).call(s),e.on(\"click\",t.handlers.onNodeClick)};var a=n(44),i=t.NODE_DIMENSIONS={width:160,height:26,section:{height:12},text:{dy:12,dx:30,fontSize:12}},r=t.NODE_STYLES={nodeTitle:\"wrd-node-title\",nodeExternalId:\"wrd-node-external-id\",nodeChangeInitiative:\"wrd-node-change-initiative\",nodeCell:\"wrd-node-cell\",nodeCellRatingIndicator:\"node-cell-rating-indicator\",nodeCellCommentIndicator:\"node-cell-comment-indicator\"};function s(e){e.filter(function(e){return\"REMOVED\"===e.node.entityLifecycleStatus}).attr(\"opacity\",.6).append(\"line\").attr(\"x1\",0).attr(\"x2\",i.width).attr(\"y1\",i.height).attr(\"y2\",0).attr(\"stroke\",\"#c2462c\").attr(\"opacity\",.4).attr(\"stroke-width\",3)}function o(e){var t=i.width/12,n=i.height/2,a=\"\\n        M\"+(i.width-t)+\" \"+i.height+\" \\n        h \"+t+\"\\n        v \"+-1*n+\"\\n        Z \";e.append(\"path\").attr(\"transform\",\"translate(-1 -1)\").classed(r.nodeCellCommentIndicator,!0).attr(\"d\",a)}function l(e){var t=i.width/8,n=i.height;e.append(\"rect\").classed(r.nodeCellRatingIndicator,!0).attr(\"width\",t).attr(\"height\",n)}function c(e){e.append(\"rect\").classed(r.nodeExternalId,!0).attr(\"width\",i.width).attr(\"height\",i.section.height).attr(\"y\",i.section.height).attr(\"fill\",\"none\"),e.append(\"text\").classed(r.nodeExternalId,!0).text(function(e){return e.node.externalId}).attr(\"y\",i.section.height).attr(\"dy\",i.text.dy).attr(\"dx\",i.text.dx).attr(\"font-size\",i.text.fontSize-2)}function d(e){e.append(\"rect\").classed(r.nodeTitle,!0).attr(\"width\",i.width).attr(\"height\",i.section.height).attr(\"fill\",\"none\"),e.append(\"text\").classed(r.nodeTitle,!0).attr(\"dy\",i.text.dy).attr(\"dx\",i.text.dx).attr(\"font-size\",i.text.fontSize).text(function(e){return e.node.name}).call(a.truncateText,i.width-2*i.text.dx)}},1579:function(e,t,n){\"use strict\";function a(e){e.theme=\"bootstrap\",e.resetSearchInput=!0,e.appendToBody=!0}function i(e,t){e.baseUrl=t,e.withCredentials=!1,e.google({clientId:\"Google account\"}),e.github({clientId:\"GitHub Client ID\"}),e.linkedin({clientId:\"LinkedIn Client ID\"})}function r(e){e.loadExtension(function(){return[{type:\"output\",regex:/<table>/g,replace:'<table class=\"table table-condensed table-striped table-bordered\">'}]}),e.setOption(\"excludeTrailingPunctuationFromURLs\",!0),e.setOption(\"sanitize\",!0),e.setOption(\"simplifiedAutoLink\",!0),e.setOption(\"simpleLineBreaks\",!0),e.setOption(\"strikethrough\",!0),e.setOption(\"tables\",!0),e.setOption(\"tasklists\",!0)}function s(e){e.setOptions({positionX:\"right\",positionY:\"bottom\"})}Object.defineProperty(t,\"__esModule\",{value:!0}),a.$inject=[\"uiSelectConfig\"],i.$inject=[\"$authProvider\",\"BaseUrl\"],r.$inject=[\"$showdownProvider\"],s.$inject=[\"NotificationProvider\"],t.default=function(e){return function(e){e.config(a).config(i).config(r).config(s)}(e)}},250:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.ScenarioStore_API=void 0;var a=n(8);function i(e,t){var n=t+\"/scenario\";return{findForRoadmap:function(t){return e.get(n+\"/by-roadmap-id/\"+t).then(function(e){return e.data})},findByRoadmapSelector:function(t){return(0,a.checkIsIdSelector)(t),e.post(n+\"/by-roadmap-selector\",t).then(function(e){return e.data})},getById:function(t){return e.get(n+\"/id/\"+t).then(function(e){return e.data})},cloneById:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"Clone\";return e.post(n+\"/id/\"+t+\"/clone\",a).then(function(e){return e.data})},removeRating:function(t,a,i,r){return e.delete(n+\"/id/\"+t+\"/rating/\"+a+\"/\"+i+\"/\"+r).then(function(e){return e.data})},removeScenario:function(t){return e.delete(n+\"/id/\"+t).then(function(e){return e.data})},addRating:function(t,a,i,r,s){return e.post(n+\"/id/\"+t+\"/rating/\"+a+\"/\"+i+\"/\"+r+\"/\"+s).then(function(e){return e.data})},updateDescription:function(t,a){return e.post(n+\"/id/\"+t+\"/description\",a).then(function(e){return e.data})},updateName:function(t,a){return e.post(n+\"/id/\"+t+\"/name\",a).then(function(e){return e.data})},updateRating:function(t,a,i,r,s,o){return e.post(n+\"/id/\"+t+\"/rating/\"+a+\"/\"+i+\"/\"+r+\"/rating/\"+s,o).then(function(e){return e.data})},updateEffectiveDate:function(t,a){return e.post(n+\"/id/\"+t+\"/effective-date\",a).then(function(e){return e.data})},updateScenarioType:function(t,a){return e.post(n+\"/id/\"+t+\"/scenario-type/\"+a).then(function(e){return e.data})},updateReleaseStatus:function(t,a){return e.post(n+\"/id/\"+t+\"/release-status/\"+a).then(function(e){return e.data})},addAxisItem:function(t,a,i,r){return e.post(n+\"/id/\"+t+\"/axis/\"+a+\"/\"+i.kind+\"/\"+i.id,r).then(function(e){return e.data})},removeAxisItem:function(t,a,i){return e.delete(n+\"/id/\"+t+\"/axis/\"+a+\"/\"+i.kind+\"/\"+i.id).then(function(e){return e.data})},loadAxis:function(t,a){return e.get(n+\"/id/\"+t+\"/axis/\"+a).then(function(e){return e.data})},reorderAxis:function(t,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.post(n+\"/id/\"+t+\"/axis/\"+a+\"/reorder\",i).then(function(e){return e.data})}}}i.$inject=[\"$http\",\"BaseApiUrl\"];var r=\"ScenarioStore\";t.ScenarioStore_API={findByRoadmapSelector:{serviceName:r,serviceFnName:\"findByRoadmapSelector\",description:\"executes findByRoadmapSelector [roadmapSelectorOptions]\"},findForRoadmap:{serviceName:r,serviceFnName:\"findForRoadmap\",description:\"executes findForRoadmap [roadmapId]\"},getById:{serviceName:r,serviceFnName:\"getById\",description:\"executes getById [scenarioId]\"},cloneById:{serviceName:r,serviceFnName:\"cloneById\",description:\"executes cloneById [scenarioId, newName]\"},removeScenario:{serviceName:r,serviceFnName:\"removeScenario\",description:\"executes removeScenario [scenarioId]\"},removeRating:{serviceName:r,serviceFnName:\"removeRating\",description:\"executes removeRating [scenarioId, appId, columnId, rowId]\"},addRating:{serviceName:r,serviceFnName:\"addRating\",description:\"executes addRating [scenarioId, appId, columnId, rowId, rating]\"},updateRating:{serviceName:r,serviceFnName:\"updateRating\",description:\"executes updateRating [scenarioId, appId, columnId, rowId, rating, comment]\"},updateDescription:{serviceName:r,serviceFnName:\"updateDescription\",description:\"executes updateDescription [scenarioId, newDescription]\"},updateName:{serviceName:r,serviceFnName:\"updateName\",description:\"executes updateName [scenarioId, newName]\"},updateEffectiveDate:{serviceName:r,serviceFnName:\"updateEffectiveDate\",description:\"executes updateEffectiveDate [scenarioId, newDate]\"},updateScenarioType:{serviceName:r,serviceFnName:\"updateScenarioType\",description:\"executes updateScenarioType [scenarioId, newStatus]\"},updateReleaseStatus:{serviceName:r,serviceFnName:\"updateReleaseStatus\",description:\"executes updateReleaseStatus [scenarioId, newStatus]\"},addAxisItem:{serviceName:r,serviceFnName:\"addAxisItem\",description:\"executes addAxisItem [scenarioId, newName]\"},removeAxisItem:{serviceName:r,serviceFnName:\"removeAxisItem\",description:\"executes removeAxisItem [scenarioId, newName]\"},loadAxis:{serviceName:r,serviceFnName:\"loadAxis\",description:\"executes loadAxis [scenarioId, orientation]\"},reorderAxis:{serviceName:r,serviceFnName:\"reorderAxis\",description:\"executes reorderAxis [scenarioId, orientation, [ids...]]\"}};t.default={serviceName:r,store:i}},251:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.ServerInfoStore_API=t.serviceName=void 0,t.store=i;var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1));function i(e,t){var n=t+\"/server-info\";return{findByAssetCode:function(t){return e.then(function(e){return e.data})},findByAppId:function(t){return e.get(n+\"/app-id/\"+t).then(function(e){return e.data})},findStatsForSelector:function(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"EXACT\",s=a.default.isObject(t)?t:{scope:r,entityReference:{id:t,kind:i}};return e.post(n+\"/apps/stats\",s).then(function(e){return e.data})}}}i.$inject=[\"$http\",\"BaseApiUrl\"];var r=t.serviceName=\"ServerInfoStore\";t.ServerInfoStore_API={findByAssetCode:{serviceName:r,serviceFnName:\"findByAssetCode\",description:\"executes findByAssetCodes\"},findByAppId:{serviceName:r,serviceFnName:\"findByAppId\",description:\"executes findByAppId\"},findStatsForSelector:{serviceName:r,serviceFnName:\"findStatsForSelector\",description:\"executes findStatsForSelector\"}}},252:function(e,t,n){\"use strict\";function a(e,t){var n=t+\"/settings\";return{findAll:function(){return e.get(\"\"+n).then(function(e){return e.data})}}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.store=a,a.$inject=[\"$http\",\"BaseApiUrl\"];var i=t.serviceName=\"SettingsStore\";t.SettingsStore_API={findAll:{serviceName:i,serviceFnName:\"findAll\",description:\"executes findAll\"}}},253:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.SharedPreferenceStore_API=void 0;var a=n(8);function i(e,t){var n=t+\"/shared-preference\";return{getByKeyAndCategory:function(t,a){var i={key:t,category:a};return e.post(n+\"/key-category\",i).then(function(e){return e.data})},findByCategory:function(t){return(0,a.checkIsEntityRef)(ref),e.get(n+\"/category/\"+t).then(function(e){return e.data})},generateKeyRoute:function(t){return e.post(n+\"/generate-key\",t).then(function(e){return e.data})},save:function(t,a,i){var r={key:t,category:a,value:i};return e.post(n+\"/save\",r).then(function(e){return e.data})}}}i.$inject=[\"$http\",\"BaseApiUrl\"];var r=\"SharedPreferenceStore\";t.SharedPreferenceStore_API={getByKeyAndCategory:{serviceName:r,serviceFnName:\"getByKeyAndCategory\",description:\"executes getByKeyAndCategory\"},findByCategory:{serviceName:r,serviceFnName:\"findByCategory\",description:\"executes findByCategory\"},generateKeyRoute:{serviceName:r,serviceFnName:\"generateKeyRoute\",description:\"executes generateKeyRoute\"},save:{serviceName:r,serviceFnName:\"save\",description:\"executes save\"}};t.default={store:i,serviceName:r}},254:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.store=i;var a=null;function i(e,t){var n=t+\"/source-data-rating\";return{findAll:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a&&!t?a:a=e.get(\"\"+n).then(function(e){return e.data})}}}i.$inject=[\"$http\",\"BaseApiUrl\"];var r=t.serviceName=\"SourceDataRatingStore\";t.SourceDataRatingStore_API={findAll:{serviceName:r,serviceFnName:\"findAll\",description:\"retrieve all source data ratings\"}}},255:function(e,t,n){\"use strict\";function a(e,t){var n=t+\"/static-panel\",a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.get(n+\"/group\",{params:{group:t}}).then(function(e){return e.data})};return{findAll:function(){return e.get(n).then(function(e){return e.data})},findByGroup:function(e){return a([e])},findByGroups:a,save:function(t){return e.post(n,t).then(function(e){return e.data})}}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.store=a,a.$inject=[\"$http\",\"BaseApiUrl\"];var i=t.serviceName=\"StaticPanelStore\";t.StaticPanelStore_API={findAll:{serviceName:i,serviceFnName:\"findAll\",description:\"findAll\"},findByGroup:{serviceName:i,serviceFnName:\"findByGroup\",description:\"findByGroup\"},findByGroups:{serviceName:i,serviceFnName:\"findByGroups\",description:\"findByGroups\"},save:{serviceName:i,serviceFnName:\"save\",description:\"save\"}}},256:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.SurveyInstanceStore_API=void 0;var a=n(8);function i(e,t){var n=t+\"/survey-instance\";return{getById:function(t){return e.get(n+\"/id/\"+t).then(function(e){return e.data})},findByEntityReference:function(t){return(0,a.checkIsEntityRef)(t),e.get(n+\"/entity/\"+t.kind+\"/\"+t.id).then(function(e){return e.data})},findForUser:function(){return e.get(n+\"/user\").then(function(e){return e.data})},findForSurveyRun:function(t){return e.get(n+\"/run/\"+t).then(function(e){return e.data})},findPreviousVersions:function(t){return e.get(n+\"/id/\"+t+\"/previous-versions\").then(function(e){return e.data})},findRecipients:function(t){return e.get(n+\"/\"+t+\"/recipients\").then(function(e){return e.data})},findResponses:function(t){return e.get(n+\"/\"+t+\"/responses\").then(function(e){return e.data})},saveResponse:function(t,a){return e.put(n+\"/\"+t+\"/response\",a).then(function(e){return e.data})},updateStatus:function(t,a){return e.put(n+\"/\"+t+\"/status\",a).then(function(e){return e.data})},updateDueDate:function(t,a){return e.put(n+\"/\"+t+\"/due-date\",a).then(function(e){return e.data})},updateRecipient:function(t,a){return e.put(n+\"/\"+t+\"/recipient\",a).then(function(e){return e.data})},addRecipient:function(t,a){return e.post(n+\"/\"+t+\"/recipient\",a).then(function(e){return e.data})},deleteRecipient:function(t,a){return e.delete(n+\"/\"+t+\"/recipient/\"+a).then(function(e){return e.data})},markApproved:function(t,a){return e.put(n+\"/\"+t+\"/approval\",a).then(function(e){return e.data})}}}i.$inject=[\"$http\",\"BaseApiUrl\"];var r=\"SurveyInstanceStore\";t.SurveyInstanceStore_API={getById:{serviceName:r,serviceFnName:\"getById\",description:\"get survey instance for a given id\"},findByEntityReference:{serviceName:r,serviceFnName:\"findByEntityReference\",description:\"finds survey instances for a given entity reference\"},findForUser:{serviceName:r,serviceFnName:\"findForUser\",description:\"finds survey instances for a given user id\"},findForSurveyRun:{serviceName:r,serviceFnName:\"findForSurveyRun\",description:\"finds survey instances for a given survey run id\"},findRecipients:{serviceName:r,serviceFnName:\"findRecipients\",description:\"finds recipients for a given survey instance id\"},findResponses:{serviceName:r,serviceFnName:\"findResponses\",description:\"finds responses for a given survey instance id\"},saveResponse:{serviceName:r,serviceFnName:\"saveResponse\",description:\"save response for a given survey instance question\"},updateStatus:{serviceName:r,serviceFnName:\"updateStatus\",description:\"update status for a given survey instance id\"},updateDueDate:{serviceName:r,serviceFnName:\"updateDueDate\",description:\"update due date for a given survey instance id\"},updateRecipient:{serviceName:r,serviceFnName:\"updateRecipient\",description:\"update recipient for a given survey instance id\"},markApproved:{serviceName:r,serviceFnName:\"markApproved\",description:\"approve a survey instance response\"},addRecipient:{serviceName:r,serviceFnName:\"addRecipient\",description:\"add recipient to a given survey instance id\"},deleteRecipient:{serviceName:r,serviceFnName:\"deleteRecipient\",description:\"delete recipient from a given survey instance id\"}};t.default={store:i,serviceName:r}},257:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.SurveyRunStore_API=void 0;var a=n(8);function i(e,t){var n=t+\"/survey-run\";return{create:function(t){return e.post(n,t).then(function(e){return e.data})},getById:function(t){return e.get(n+\"/id/\"+t).then(function(e){return e.data})},findByTemplateId:function(t){return e.get(n+\"/template-id/\"+t).then(function(e){return e.data})},findByEntityReference:function(t){return(0,a.checkIsEntityRef)(t),e.get(n+\"/entity/\"+t.kind+\"/\"+t.id).then(function(e){return e.data})},findForUser:function(){return e.get(n+\"/user\").then(function(e){return e.data})},update:function(t,a){return e.put(n+\"/\"+t,a).then(function(e){return e.data})},updateStatus:function(t,a){return e.put(n+\"/\"+t+\"/status\",a).then(function(e){return e.data})},updateDueDate:function(t,a){return e.put(n+\"/\"+t+\"/due-date\",a).then(function(e){return e.data})},generateSurveyRunRecipients:function(t){return e.get(n+\"/\"+t+\"/recipients\")},createSurveyRunInstancesAndRecipients:function(t,a){return e.post(n+\"/\"+t+\"/recipients\",a)},getCompletionRate:function(t){return e.get(n+\"/\"+t+\"/completion-rate\").then(function(e){return e.data})},createSurveyInstances:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.post(n+\"/\"+t+\"/create-instances\",a).then(function(e){return e.data})}}}i.$inject=[\"$http\",\"BaseApiUrl\"];var r=\"SurveyRunStore\";t.SurveyRunStore_API={create:{serviceName:r,serviceFnName:\"create\",description:\"create survey run\"},getById:{serviceName:r,serviceFnName:\"getById\",description:\"get survey run for a given id\"},findByTemplateId:{serviceName:r,serviceFnName:\"findByTemplateId\",description:\"find survey runs for a given template id\"},findByEntityReference:{serviceName:r,serviceFnName:\"findByEntityReference\",description:\"find survey runs for a given entity\"},findForUser:{serviceName:r,serviceFnName:\"findForUser\",description:\"find survey runs for a given user\"},update:{serviceName:r,serviceFnName:\"update\",description:\"update a survey run\"},updateStatus:{serviceName:r,serviceFnName:\"updateStatus\",description:\"update a survey run's status\"},updateDueDate:{serviceName:r,serviceFnName:\"updateDueDate\",description:\"update a survey run's due date\"},generateSurveyRunRecipients:{serviceName:r,serviceFnName:\"generateSurveyRunRecipients\",description:\"generate recipient for a given survey run id\"},createSurveyRunInstancesAndRecipients:{serviceName:r,serviceFnName:\"createSurveyRunInstancesAndRecipients\",description:\"create a survey run, instances and recipients\"},getCompletionRate:{serviceName:r,serviceFnName:\"getCompletionRate\",description:\"get completion rate for a given survey run id\"},createSurveyInstances:{serviceName:r,serviceFnName:\"createSurveyInstances\",description:\"create a survey instance for a given survey run and list of person ids\"}};t.default={store:i,serviceName:r}},258:function(e,t,n){\"use strict\";function a(e,t){var n=t+\"/survey-template\";return{create:function(t){return e.post(\"\"+n,t).then(function(e){return e.data})},clone:function(t){return e.post(n+\"/\"+t+\"/clone\").then(function(e){return e.data})},getById:function(t){return e.get(n+\"/\"+t).then(function(e){return e.data})},findAll:function(){return e.get(\"\"+n).then(function(e){return e.data})},update:function(t){return e.put(\"\"+n,t).then(function(e){return e.data})},updateStatus:function(t,a){return e.put(n+\"/\"+t+\"/status\",a).then(function(e){return e.data})}}}Object.defineProperty(t,\"__esModule\",{value:!0}),a.$inject=[\"$http\",\"BaseApiUrl\"];var i=\"SurveyTemplateStore\";t.SurveyTemplateStore_API={create:{serviceName:i,serviceFnName:\"create\",description:\"create survey template\"},clone:{serviceName:i,serviceFnName:\"clone\",description:\"clone survey template\"},getById:{serviceName:i,serviceFnName:\"getById\",description:\"get survey template for a given id\"},findAll:{serviceName:i,serviceFnName:\"findAll\",description:\"find all survey templates\"},update:{serviceName:i,serviceFnName:\"update\",description:\"update a survey template\"},updateStatus:{serviceName:i,serviceFnName:\"updateStatus\",description:\"update a survey templates's status\"}};t.default={store:a,serviceName:i}},259:function(e,t,n){\"use strict\";function a(e,t){var n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.get(t+\"/svg-diagram/group\",{params:{group:n}}).then(function(e){return e.data})};return{findByGroup:function(e){return n([e])},findByGroups:n}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.store=a,a.$inject=[\"$http\",\"BaseApiUrl\"];var i=t.serviceName=\"SvgDiagramStore\";t.SvgDiagramStore_API={findByGroup:{serviceName:i,serviceFnName:\"findByGroup\",description:\"executes findByGroup\"},findByGroups:{serviceName:i,serviceFnName:\"findByGroups\",description:\"executes findByGroups\"}}},260:function(e,t,n){\"use strict\";function a(e,t){var n=t+\"/taxonomy-management\";return{findPendingChangesByDomain:function(t){return e.get(n+\"/pending-changes/by-domain/\"+t.kind+\"/\"+t.id).then(function(e){return e.data})},preview:function(t){return e.post(n+\"/preview\",t).then(function(e){return e.data})},previewByChangeId:function(t){return e.get(n+\"/pending-changes/\"+t+\"/preview\").then(function(e){return e.data})},submitPendingChange:function(t){return e.post(n+\"/pending-changes\",t).then(function(e){return e.data})},applyPendingChange:function(t){return e.post(n+\"/pending-changes/id/\"+t+\"/apply\").then(function(e){return e.data})}}}Object.defineProperty(t,\"__esModule\",{value:!0}),a.$inject=[\"$http\",\"BaseApiUrl\"];var i=\"TaxonomyManagementStore\";t.default={serviceName:i,store:a};t.TaxonomyManagementStore_API={applyPendingChange:{serviceName:i,serviceFnName:\"applyPendingChange\",description:\"applyPendingChange [ cmdId ]\"},findPendingChangesByDomain:{serviceName:i,serviceFnName:\"findPendingChangesByDomain\",description:\"findPendingChangesByDomain [ domainRef ]\"},preview:{serviceName:i,serviceFnName:\"preview\",description:\"preview the effect of a command [ cmd ]\"},previewByChangeId:{serviceName:i,serviceFnName:\"previewByChangeId\",description:\"preview the effect of a pending command [ cmdId ]\"},submitPendingChange:{serviceName:i,serviceFnName:\"submitPendingChange\",description:\"submit the command for later execution [ cmd ]\"}}},261:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.TechnologyStatisticsService_API=void 0;var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(1));function r(e,t,n,r){return{findBySelector:function(s,o){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"CHILDREN\",c=i.default.isObject(s)?s:{scope:l,entityReference:{id:s,kind:o}},d=[t.findStatsForSelector(c),n.findStatsForSelector(c),r.findStatsForSelector(c)];return e.all(d).then(function(e){var t=a(e,3);return{serverStats:t[0],databaseStats:t[1],softwareStats:t[2]}})}}}r.$inject=[\"$q\",\"ServerInfoStore\",\"DatabaseStore\",\"SoftwareCatalogStore\"];t.default={service:r,serviceName:\"TechnologyStatisticsService\"};t.TechnologyStatisticsService_API={findBySelector:{serviceName:\"TechnologyStatisticsService\",serviceFnName:\"findBySelector\",description:\"find stats for the given app selector\"}}},400:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1352)),i=n(0);var r={};function s(e,t){var n=(0,i.initialiseData)(this,r);n.$onInit=function(){console.log(\"onInit\"),n.scenarioId=e.id,n.parentEntityRef={kind:\"SCENARIO\",id:n.scenarioId},n.availableSections=t.findAvailableSectionsForKind(\"SCENARIO\"),n.sections=t.findUserSectionsForKind(\"SCENARIO\")},n.addSection=function(e){return n.sections=t.openSection(e,\"SCENARIO\")},n.removeSection=function(e){return n.sections=t.removeSection(e,\"SCENARIO\")}}s.$inject=[\"$stateParams\",\"DynamicSectionManager\"];var o={controller:s,template:a.default,bindings:{},controllerAs:\"$ctrl\"};t.default={id:\"waltzScenarioView\",component:o}},401:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.groupQuestions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=a.default.chain(e).map(function(e){return e.question.sectionName||\"Other\"}).uniq().value(),n=a.default.groupBy(e,function(e){return e.question.sectionName||\"Other\"});return a.default.map(t,function(e){return{sectionName:e,questionInfos:n[e]}})};var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1))},89:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default={authentication:\"web.authentication\",devExtEnabled:\"web.devext.enabled\",httpHeaderPrefix:\"web.devext.http.header.\",betaEnvironment:\"web.beta\",betaNagMessage:\"web.beta.nag-message\",defaultCurrency:\"settings.asset-cost.default-currency\"}},935:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});t.DEFAULT_CURRENCY=\"settings.asset-cost.default-currency\",t.DEFAULT_MEASURABLE=\"settings.measurable.default-category\",t.DRILL_GRID_DEFAULT_DEFINITION_ID=\"settings.drill-grid.default-definition\"}}]);","extractedComments":[]}